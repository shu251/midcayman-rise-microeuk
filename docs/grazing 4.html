<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mid-Cayman Rise analysis - Protistan grazing analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Mid-Cayman Rise analysis</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./grazing.html" aria-current="page">Grazing analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./asv.html">Sequence analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sequence-qc.html">Sequence QC &amp; import</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-format-data" id="toc-import-format-data" class="nav-link active" data-scroll-target="#import-format-data"><span class="toc-section-number">1</span>  Import &amp; format data</a>
  <ul class="collapse">
  <li><a href="#set-up-working-r-environment" id="toc-set-up-working-r-environment" class="nav-link" data-scroll-target="#set-up-working-r-environment"><span class="toc-section-number">1.1</span>  Set up working R environment</a></li>
  <li><a href="#import-raw-count-data" id="toc-import-raw-count-data" class="nav-link" data-scroll-target="#import-raw-count-data"><span class="toc-section-number">1.2</span>  Import raw count data</a></li>
  </ul></li>
  <li><a href="#calculate-cells-per-ml-euk" id="toc-calculate-cells-per-ml-euk" class="nav-link" data-scroll-target="#calculate-cells-per-ml-euk"><span class="toc-section-number">2</span>  Calculate cells per ml (euk)</a>
  <ul class="collapse">
  <li><a href="#plot-eukaryote-cells-per-ml" id="toc-plot-eukaryote-cells-per-ml" class="nav-link" data-scroll-target="#plot-eukaryote-cells-per-ml"><span class="toc-section-number">2.1</span>  Plot eukaryote cells per ml</a></li>
  <li><a href="#isolate-t0-only-counts-for-cellsml-plot" id="toc-isolate-t0-only-counts-for-cellsml-plot" class="nav-link" data-scroll-target="#isolate-t0-only-counts-for-cellsml-plot"><span class="toc-section-number">2.2</span>  Isolate T0 only counts for cells/ml plot</a></li>
  </ul></li>
  <li><a href="#bacteria-archaea-cell-counts" id="toc-bacteria-archaea-cell-counts" class="nav-link" data-scroll-target="#bacteria-archaea-cell-counts"><span class="toc-section-number">3</span>  Bacteria &amp; archaea cell counts</a>
  <ul class="collapse">
  <li><a href="#cells-per-ml-prok" id="toc-cells-per-ml-prok" class="nav-link" data-scroll-target="#cells-per-ml-prok"><span class="toc-section-number">3.1</span>  Cells per ml (prok)</a>
  <ul class="collapse">
  <li><a href="#euk-and-prok-counts" id="toc-euk-and-prok-counts" class="nav-link" data-scroll-target="#euk-and-prok-counts">Euk and prok counts</a></li>
  <li><a href="#combine-with-previous-mcr-cell-counts" id="toc-combine-with-previous-mcr-cell-counts" class="nav-link" data-scroll-target="#combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimate-grazing-effect" id="toc-estimate-grazing-effect" class="nav-link" data-scroll-target="#estimate-grazing-effect"><span class="toc-section-number">4</span>  Estimate grazing effect</a>
  <ul class="collapse">
  <li><a href="#determine-flp-per-euk-cell" id="toc-determine-flp-per-euk-cell" class="nav-link" data-scroll-target="#determine-flp-per-euk-cell"><span class="toc-section-number">4.1</span>  Determine FLP per euk cell</a></li>
  <li><a href="#calculate-flp-per-euk-cell-calculation" id="toc-calculate-flp-per-euk-cell-calculation" class="nav-link" data-scroll-target="#calculate-flp-per-euk-cell-calculation"><span class="toc-section-number">4.2</span>  Calculate FLP per euk cell calculation</a></li>
  <li><a href="#calculate-linear-regression-to-obtain-slope" id="toc-calculate-linear-regression-to-obtain-slope" class="nav-link" data-scroll-target="#calculate-linear-regression-to-obtain-slope"><span class="toc-section-number">4.3</span>  Calculate linear regression to obtain slope</a>
  <ul class="collapse">
  <li><a href="#plot-linear-regression-trend" id="toc-plot-linear-regression-trend" class="nav-link" data-scroll-target="#plot-linear-regression-trend">Plot linear regression trend</a></li>
  </ul></li>
  <li><a href="#remove-igt-tf-time-points." id="toc-remove-igt-tf-time-points." class="nav-link" data-scroll-target="#remove-igt-tf-time-points."><span class="toc-section-number">4.4</span>  Remove IGT Tf time points.</a></li>
  <li><a href="#compile-and-save-grazing-experiment-results" id="toc-compile-and-save-grazing-experiment-results" class="nav-link" data-scroll-target="#compile-and-save-grazing-experiment-results"><span class="toc-section-number">4.5</span>  Compile and save grazing experiment results</a></li>
  </ul></li>
  <li><a href="#check-flp-control-experiments" id="toc-check-flp-control-experiments" class="nav-link" data-scroll-target="#check-flp-control-experiments"><span class="toc-section-number">5</span>  Check FLP control experiments</a>
  <ul class="collapse">
  <li><a href="#bag-grazing-experiment-controls" id="toc-bag-grazing-experiment-controls" class="nav-link" data-scroll-target="#bag-grazing-experiment-controls"><span class="toc-section-number">5.1</span>  Bag grazing experiment controls</a></li>
  <li><a href="#igt-experiment-controls" id="toc-igt-experiment-controls" class="nav-link" data-scroll-target="#igt-experiment-controls"><span class="toc-section-number">5.2</span>  IGT experiment controls</a></li>
  </ul></li>
  <li><a href="#generate-complete-table-with-grazing-rates-and-values" id="toc-generate-complete-table-with-grazing-rates-and-values" class="nav-link" data-scroll-target="#generate-complete-table-with-grazing-rates-and-values"><span class="toc-section-number">6</span>  Generate complete table with grazing rates and values</a>
  <ul class="collapse">
  <li><a href="#plot-flpgrazer-minute" id="toc-plot-flpgrazer-minute" class="nav-link" data-scroll-target="#plot-flpgrazer-minute"><span class="toc-section-number">6.1</span>  Plot FLP/grazer /minute</a></li>
  </ul></li>
  <li><a href="#grazing-rate-calculations" id="toc-grazing-rate-calculations" class="nav-link" data-scroll-target="#grazing-rate-calculations"><span class="toc-section-number">7</span>  Grazing rate calculations</a>
  <ul class="collapse">
  <li><a href="#gt-table-options" id="toc-gt-table-options" class="nav-link" data-scroll-target="#gt-table-options">gt table options</a></li>
  <li><a href="#carbon-biomass" id="toc-carbon-biomass" class="nav-link" data-scroll-target="#carbon-biomass"><span class="toc-section-number">7.1</span>  Carbon biomass</a></li>
  <li><a href="#compare-carbon-biomass-with-literature" id="toc-compare-carbon-biomass-with-literature" class="nav-link" data-scroll-target="#compare-carbon-biomass-with-literature"><span class="toc-section-number">7.2</span>  Compare carbon biomass with literature</a>
  <ul class="collapse">
  <li><a href="#carbon-biomass-for-prokaryotes" id="toc-carbon-biomass-for-prokaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-prokaryotes">Carbon biomass for prokaryotes</a></li>
  </ul></li>
  <li><a href="#amend-table-with-bounded-carbon-estimates" id="toc-amend-table-with-bounded-carbon-estimates" class="nav-link" data-scroll-target="#amend-table-with-bounded-carbon-estimates"><span class="toc-section-number">7.3</span>  Amend table with ‘bounded’ carbon estimates</a></li>
  </ul></li>
  <li><a href="#compare-with-axial-euk-cell-count" id="toc-compare-with-axial-euk-cell-count" class="nav-link" data-scroll-target="#compare-with-axial-euk-cell-count"><span class="toc-section-number">8</span>  Compare with Axial euk cell count</a></li>
  <li><a href="#environmental-parameters---mcr" id="toc-environmental-parameters---mcr" class="nav-link" data-scroll-target="#environmental-parameters---mcr"><span class="toc-section-number">9</span>  Environmental parameters - MCR</a></li>
  <li><a href="#analysis-of-grazing-rate-results" id="toc-analysis-of-grazing-rate-results" class="nav-link" data-scroll-target="#analysis-of-grazing-rate-results"><span class="toc-section-number">10</span>  Analysis of grazing rate results</a>
  <ul class="collapse">
  <li><a href="#function-to-plot-grazing-results" id="toc-function-to-plot-grazing-results" class="nav-link" data-scroll-target="#function-to-plot-grazing-results"><span class="toc-section-number">10.1</span>  Function to plot grazing results</a></li>
  <li><a href="#grazing-rate-vs.-cells-ml" id="toc-grazing-rate-vs.-cells-ml" class="nav-link" data-scroll-target="#grazing-rate-vs.-cells-ml"><span class="toc-section-number">10.2</span>  Grazing rate vs.&nbsp;cells ml</a></li>
  </ul></li>
  <li><a href="#comparison-with-gorda-ridge" id="toc-comparison-with-gorda-ridge" class="nav-link" data-scroll-target="#comparison-with-gorda-ridge"><span class="toc-section-number">11</span>  Comparison with Gorda Ridge</a>
  <ul class="collapse">
  <li><a href="#combine-gr-and-mcr-data" id="toc-combine-gr-and-mcr-data" class="nav-link" data-scroll-target="#combine-gr-and-mcr-data"><span class="toc-section-number">11.1</span>  Combine GR and MCR data</a></li>
  <li><a href="#plot-combined-results" id="toc-plot-combined-results" class="nav-link" data-scroll-target="#plot-combined-results"><span class="toc-section-number">11.2</span>  Plot combined results</a>
  <ul class="collapse">
  <li><a href="#remove-undetected-grazing-rate" id="toc-remove-undetected-grazing-rate" class="nav-link" data-scroll-target="#remove-undetected-grazing-rate">Remove undetected grazing rate</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="toc-section-number">12</span>  Linear regression</a></li>
  <li><a href="#grazing-environmental-parameters" id="toc-grazing-environmental-parameters" class="nav-link" data-scroll-target="#grazing-environmental-parameters"><span class="toc-section-number">13</span>  Grazing &amp; environmental parameters</a>
  <ul class="collapse">
  <li><a href="#plot-temperature-by-eukprok-and-then-euk-and-prok" id="toc-plot-temperature-by-eukprok-and-then-euk-and-prok" class="nav-link" data-scroll-target="#plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="toc-section-number">13.1</span>  Plot temperature by euk:prok and then euk and prok</a></li>
  <li><a href="#plot-temperature-by-grazing-rate" id="toc-plot-temperature-by-grazing-rate" class="nav-link" data-scroll-target="#plot-temperature-by-grazing-rate"><span class="toc-section-number">13.2</span>  Plot temperature by grazing rate</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-investigation" id="toc-carbon-biomass-investigation" class="nav-link" data-scroll-target="#carbon-biomass-investigation"><span class="toc-section-number">14</span>  Carbon biomass investigation</a></li>
  <li><a href="#three-parameter-figures" id="toc-three-parameter-figures" class="nav-link" data-scroll-target="#three-parameter-figures"><span class="toc-section-number">15</span>  Three parameter figures</a>
  <ul class="collapse">
  <li><a href="#plot-euk-per-ml-with-temperature-and-grazing-rate" id="toc-plot-euk-per-ml-with-temperature-and-grazing-rate" class="nav-link" data-scroll-target="#plot-euk-per-ml-with-temperature-and-grazing-rate"><span class="toc-section-number">15.1</span>  Plot euk per ml with temperature and grazing rate</a></li>
  </ul></li>
  <li><a href="#prediction-of-mcr-data-with-parameters" id="toc-prediction-of-mcr-data-with-parameters" class="nav-link" data-scroll-target="#prediction-of-mcr-data-with-parameters"><span class="toc-section-number">16</span>  Prediction of MCR data with parameters</a></li>
  <li><a href="#session" id="toc-session" class="nav-link" data-scroll-target="#session"><span class="toc-section-number">17</span>  Session</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Protistan grazing analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="import-format-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Import &amp; format data</h1>
<p>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</p>
<section id="set-up-working-r-environment" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="set-up-working-r-environment"><span class="header-section-number">1.1</span> Set up working R environment</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-raw-count-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="import-raw-count-data"><span class="header-section-number">1.2</span> Import raw count data</h2>
<p>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more ‘R’ friendly.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DATE"         "SAMPLE"       "EXPID"        "VOL"          "MAG"         
 [6] "FOV"          "nanoNoFLP"    "microNoFLP"   "nanoFLP"      "microFLP"    
[11] "NOTES"        "DateCompiled"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</p>
</blockquote>
<p>Parse raw microscopy count data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calculate-cells-per-ml-euk" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Calculate cells per ml (euk)</h1>
<p>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionaly, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to &gt;20um and nano is &lt;20um. All counts were done at 100x magnification, confirm this: <code>unique(counts_occur$MAG)</code>.</p>
<p>Calculate cell concentration (cells/ml).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</p>
</blockquote>
<p>Average cells/ml across replicates, pivot to long format</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOTES on calculations:</p>
<p><em>VAR</em> = takes the sum of the squares of each value’s deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</p>
<p><em>SD</em> = standard deviation of all values</p>
<p><em>SEM</em> = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</p>
<p>Save output file</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Reformat to parse experiment information type</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format and add column that reports IGT vs bag experiment</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, <span class="fu">ends_with</span>(<span class="st">"CONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Factor cell count data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(plot_euk_conc<span class="sc">$</span>Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LotsOShrimp"    "Plume"          "Shrimpocalypse" "BSW"           
[5] "MustardStand"   "OMT"            "Rav2"           "ShrimpHole"    
[9] "X18"           </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-eukaryote-cells-per-ml" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="plot-eukaryote-cells-per-ml"><span class="header-section-number">2.1</span> Plot eukaryote cells per ml</h2>
<p><a href="#fig-boxplot-all">Figure&nbsp;1</a> reports all eukaryote cells per ml counts from all grazing assay counts..</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>conc_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_conc, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">y =</span> CONCENTRATION, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">group =</span> NameOrder,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not color by time point</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(limits = c(10,1000), expand = c(0, 0)) +</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>conc_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing non-finite values (stat_boxplot).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplot-all" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="grazing_files/figure-html/fig-boxplot-all-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. ~300 cells/ml in background and plume compared to ~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</p>
<blockquote class="blockquote">
<p>Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 * interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</p>
</blockquote>
<blockquote class="blockquote">
<p>eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</p>
</blockquote>
<p>Plot eukaryote cell concentration over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (MEAN + SD), ymin = (MEAN - SD)), width = 0.2) +</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>) <span class="sc">+</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">21</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</p>
</blockquote>
</section>
<section id="isolate-t0-only-counts-for-cellsml-plot" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="isolate-t0-only-counts-for-cellsml-plot"><span class="header-section-number">2.2</span> Isolate T0 only counts for cells/ml plot</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="ot">&lt;-</span> plot_euk_conc <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span> <span class="sc">&amp;</span> (VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteOrder, NameOrder, TimePoint, EXP_TYPE, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_conc =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM_conc =</span> (<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SiteOrder, NameOrder, EXP_TYPE, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>plot_euk_format<span class="sc">$</span>Site_Order <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_format<span class="sc">$</span>SiteOrder, <span class="at">levels =</span> site_fullname, <span class="at">labels =</span> site_fullname)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_euk_format)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_format, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> avg_conc, <span class="at">fill =</span> Site_Order)) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (avg_conc <span class="sc">+</span> SEM_conc), <span class="at">ymin =</span> (avg_conc <span class="sc">-</span> SEM_conc)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Site_Order), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#de2d26"</span>)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>euk_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Print table of eukaryote cell count information.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  SAMPLE_TYPE MEAN_cellml  min_cellml   max_cellml     num
  &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;
1 Background  9.183773e+01 9.183773e+01 9.183773e+01     1
2 Piccard     3.801791e+02 2.309063e+02 4.548154e+02     3
3 Plume       1.185379e+02 7.930115e+01 1.577747e+02     2
4 Von Damm    4.105001e+02 2.597696e+02 6.20998e+02      6</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="bacteria-archaea-cell-counts" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Bacteria &amp; archaea cell counts</h1>
<p>DAPI slide counts from prokaryotes from same sites. Import and compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cells-per-ml-prok" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="cells-per-ml-prok"><span class="header-section-number">3.1</span> Cells per ml (prok)</h2>
<p>Visualize counts</p>
<p>Factor site names, etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>, <span class="st">"HotChimlet1"</span>, <span class="st">"ShrimpGulley"</span>, <span class="st">"SouthofHotChimlet"</span>, <span class="st">"SouthofLungSnack"</span>, <span class="st">"ArrowLoop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Rav1"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>prok_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="euk-and-prok-counts" class="level3">
<h3 class="anchored" data-anchor-id="euk-and-prok-counts">Euk and prok counts</h3>
<p>Combined eukaryote and prokaryote cell counts</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="sc">+</span> prok_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combine-with-previous-mcr-cell-counts" class="level3">
<h3 class="anchored" data-anchor-id="combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</h3>
<p>Compare <em>in situ</em> prokaryote cell counts from 2020 to previous years</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Re-import 2020 data to compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot by year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="estimate-grazing-effect" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Estimate grazing effect</h1>
<p>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  counts_cellsml_all
  counts_cellsml_avg
  counts_occur</code></pre>
</div>
</div>
<section id="determine-flp-per-euk-cell" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="determine-flp-per-euk-cell"><span class="header-section-number">4.1</span> Determine FLP per euk cell</h2>
<p>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <code>counts_occur</code> data frame from above.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>optional gut check of data table modification</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Isolate counts that are &gt;0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</p>
<p>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</p>
<blockquote class="blockquote">
<p>Below code repeats process and compiles with other FLP/euk cell data.</p>
</blockquote>
<p>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "EXPID", "EXP_TYPE", "IGT_REP", "SizeFrac")</code></pre>
</div>
</div>
<p>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculate-flp-per-euk-cell-calculation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="calculate-flp-per-euk-cell-calculation"><span class="header-section-number">4.2</span> Calculate FLP per euk cell calculation</h2>
<p>First need to import and compile with metadata to get exact timing of experiments.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add metadata</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, include them as replicates!</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>COLS: Timepoint, Minutes = time point label, actual incubated minutes</p>
</blockquote>
<blockquote class="blockquote">
<p>COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</p>
</blockquote>
</section>
<section id="calculate-linear-regression-to-obtain-slope" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="calculate-linear-regression-to-obtain-slope"><span class="header-section-number">4.3</span> Calculate linear regression to obtain slope</h2>
<p>Use <code>lm()</code> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</p>
<p>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP, -SizeFrac) %&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) %&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"REP"</span>,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</p>
</blockquote>
<p>Apply to all data to obtain slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable

Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")
Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")</code></pre>
</div>
</div>
<p><em>gut check</em> linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <code>nest()</code> capability of tidyverse. Below, one experiment is subset to check the value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-linear-regression-trend" class="level3">
<h3 class="anchored" data-anchor-id="plot-linear-regression-trend">Plot linear regression trend</h3>
<p>Plot all bag experiments with estimated slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out IGT samples for now</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Site, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> Site)) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</p>
</section>
</section>
<section id="remove-igt-tf-time-points." class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="remove-igt-tf-time-points."><span class="header-section-number">4.4</span> Remove IGT Tf time points.</h2>
<p>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?
All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")
Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated grazing effect.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Site, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> Site)) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>results are more consistent across experiments.</p>
</blockquote>
</section>
<section id="compile-and-save-grazing-experiment-results" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="compile-and-save-grazing-experiment-results"><span class="header-section-number">4.5</span> Compile and save grazing experiment results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="check-flp-control-experiments" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Check FLP control experiments</h1>
<p>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 17 rows [33, 34, 35,
36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49].</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TimePoint', 'Stain', 'Site'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<section id="bag-grazing-experiment-controls" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="bag-grazing-experiment-controls"><span class="header-section-number">5.1</span> Bag grazing experiment controls</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="igt-experiment-controls" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="igt-experiment-controls"><span class="header-section-number">5.2</span> IGT experiment controls</h2>
<p>Repeat for IGT experiments.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="generate-complete-table-with-grazing-rates-and-values" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Generate complete table with grazing rates and values</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, <span class="at">Site=</span>SiteOrder, <span class="at">Name=</span>NameOrder, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Bag"</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'FLUID_ORIGIN', 'CRUISE_SAMPLE',
'EXP_TYPE', 'EXP_REPS', 'EXP_VOL', 'CTRL_REPS', 'CTRL_VOL', 'Site', 'Name'. You
can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>Amend table with estimated FLP concentration</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_conc =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Introduce factors in table for visualizations</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>vent_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#0868ac"</span>, <span class="st">"#41ab5d"</span>, <span class="st">"#e7298a"</span>, <span class="st">"#c994c7"</span>, <span class="st">"#fc4e2a"</span>, <span class="st">"#fed976"</span>, <span class="st">"#6a51a3"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#a1d99b"</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vent_colors) <span class="ot">&lt;-</span> vent_fullname</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>NAME <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-flpgrazer-minute" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="plot-flpgrazer-minute"><span class="header-section-number">6.1</span> Plot FLP/grazer /minute</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> NAME, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELD),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Amend table with eukaryote and prokaryote estimated biomass.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to master table with data</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Prok_conc =</span> MEAN, <span class="at">Prok_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp) <span class="sc">%&gt;%</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prok_conc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Prok_conc), avg_insitu, Prok_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "Site"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Name =</span> NameOrder, <span class="at">FIELD =</span> SiteOrder, <span class="at">euk_conc =</span> avg_conc, EXP_TYPE, <span class="at">euk_conc_sem =</span> SEM_conc) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp_wprok) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> Name, <span class="at">EXP =</span> EXP_TYPE, <span class="at">SAMPLE =</span> Site, <span class="at">RATE_min =</span> GRAZE_RATE, <span class="at">FLP_ml =</span> FLP_conc, <span class="at">PROK_ml =</span> Prok_conc, <span class="at">PROK_sem =</span> Prok_sem, <span class="at">EUK_ml =</span> euk_conc, <span class="at">EUK_sem =</span> euk_conc_sem, TimePoints, EXP_REPS, EXP_VOL,  CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("Name", "FIELD", "EXP_TYPE")</code></pre>
</div>
</div>
<p>Description of variables above:</p>
<ul>
<li>FIELD - vent location</li>
<li>NAME - name of vent site, or plume/background</li>
<li>EXP - experiment type, bag or IGT</li>
<li>SAMPLE - vent site</li>
<li>RATE_MIN - FLPs per grazer per minute (SLOPE of best fitline)</li>
<li>FLP_ml - FLP concentration at T0</li>
<li>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</li>
<li>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</li>
</ul>
</section>
</section>
<section id="grazing-rate-calculations" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Grazing rate calculations</h1>
<p>Based on Unrein et al.&nbsp;2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_grazerate_wflp_wprok_weuk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD         NAME EXP   SAMPLE    RATE_min    FLP_ml   PROK_ml PROK_sem
1 Von Damm   Background Bag   VD-BSW 0.002958889  4861.824  37889.62 8608.427
2 Von Damm        Plume Bag VD-Plume 0.005274231 34242.354  16478.31 2623.935
3 Von Damm         X-18 Bag   VD-X18 0.001744429  3148.722 111429.78 2973.793
4 Von Damm Old Man Tree IGT   VD-OMT 0.014510943  5352.828  71147.40       NA
5 Von Damm   Ravelin #2 Bag  VD-Rav2 0.003470217 51890.942  71147.40       NA
6 Von Damm   Ravelin #2 IGT  VD-Rav2 0.015395240  5352.828  71147.40       NA
     EUK_ml   EUK_sem        TimePoints EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL
1  91.83773  21.86613 0, 10, 15, 20, 40        3    2.00         2      0.5
2 157.77468  67.09859 0, 10, 15, 25, 57        3    2.00         2      1.0
3 314.87222 104.95741     0, 15, 20, 40        2    1.50         2      0.5
4 472.30833 122.45031          0, 7, 25        1    0.15        NA       NA
5 409.33389  73.47019 0, 10, 15, 21, 40        3    1.50         2      0.5
6 620.99799 123.17702         0, 12, 20        1    0.15        NA       NA</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_min <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explanation of units for table with calculated values.</p>
<ul>
<li><p>RATE_min &amp; RATE_hr = Grazing rate as ‘FLPs per grazer per minute’ and per hour</p></li>
<li><p>CLEARANCE_RATE = ml or nL per grazer per hour</p></li>
<li><p>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</p></li>
<li><p>GRAZING EFFECT = bacteria per ml per hour</p></li>
<li><p>Bacterial turnover rate = % per day</p></li>
</ul>
<section id="gt-table-options" class="level3">
<h3 class="anchored" data-anchor-id="gt-table-options">gt table options</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table_wcalcs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FIELD"                 "NAME"                  "EXP"                  
 [4] "SAMPLE"                "RATE_min"              "FLP_ml"               
 [7] "PROK_ml"               "PROK_sem"              "EUK_ml"               
[10] "EUK_sem"               "TimePoints"            "EXP_REPS"             
[13] "EXP_VOL"               "CTRL_REPS"             "CTRL_VOL"             
[16] "RATE_hr"               "RATE_day"              "FLP_L"                
[19] "CLEARANCE_RATE_ml"     "CLEARANCE_RATE_nL"     "SPEC_GRAZE_RATE_hr"   
[22] "GRAZE_RATE_DAY"        "GRAZING_EFFECT_hr"     "GRAZING_EFFECT_hr_min"
[25] "GRAZING_EFFECT_hr_max" "GRAZING_EFFECT_day"    "BAC_TURNOVER_PERC"    
[28] "BAC_TURNOVER_PERC_min" "BAC_TURNOVER_PERC_max"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>bkgd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>, <span class="st">"Plume"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Table S1 - grazing experiment information only</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim((table_wcalcs %&gt;% </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(FIELD, NAME, EXP, SAMPLE, TimePoints, starts_with("EXP_"), starts_with("CTRL_"), RATE_min)), file = "output-data/tables1-grazing-exp-list.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="carbon-biomass" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="carbon-biomass"><span class="header-section-number">7.1</span> Carbon biomass</h2>
<p>References for estimating biovolume <em>Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al.&nbsp;(2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782–792.</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  EXP VENT_BSW      h      d
1 IGT     vent 30.077 25.764
2 IGT     vent 89.582 10.000
3 Bag      BSW 14.595  8.036
4 Bag      BSW 12.480  8.982
5 Bag     vent  9.218  3.120
6 IGT     vent 17.255  9.986</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate volume</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SizeFrac =</span> <span class="fu">case_when</span>(</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    h <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"micro"</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nano"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Volume =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> d)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (Volume<span class="sc">^</span><span class="fl">0.939</span>))) <span class="sc">%&gt;%</span> <span class="co"># Calculate Cell biomass in pg C per cell # Menden-Deuer and Lessard 2000</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(biov_calc)</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>biov_calc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   EXP VENT_BSW      h      d SizeFrac     Volume     pgC_cell
1  IGT     vent 30.077 25.764    micro 8954.44130 1110.2426245
2  IGT     vent 89.582 10.000    micro  523.59878   77.1957618
3  Bag      BSW 14.595  8.036     nano  271.71800   41.6956679
4  Bag      BSW 12.480  8.982     nano  379.41786   57.0486460
5  Bag     vent  9.218  3.120     nano   15.90239    2.9015292
6  IGT     vent 17.255  9.986     nano  521.40274   76.8917043
7  Bag     vent 41.153 21.000    micro 4849.04826  624.1445904
8  IGT     vent 10.282  4.136     nano   37.04591    6.4194942
9  IGT     vent 29.776 25.852    micro 9046.50993 1120.9583343
10 IGT     vent 10.991  4.000     nano   33.51032    5.8424695
11 Bag     vent 14.333  2.000     nano    4.18879    0.8290772
12 Bag     vent 36.164  3.000    micro   14.13717    2.5980292
13 Bag      BSW 16.206 14.924     nano 1740.42111  238.4669404
14 Bag      BSW  7.000  7.000     nano  179.59438   28.2640658
15 Bag     vent 10.069  5.000     nano   65.44985   10.9544849</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(biov_calc<span class="sc">$</span>Volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.18879</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(biov_calc<span class="sc">$</span>Volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9046.51</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"nano"</span>))<span class="sc">$</span>Volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324.8651</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"micro"</span>))<span class="sc">$</span>Volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4677.547</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"nano"</span>))<span class="sc">$</span>pgC_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 46.93141</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"micro"</span>))<span class="sc">$</span>pgC_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 587.0279</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Volume is reported as um^3</p>
</blockquote>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by experiment type</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXP) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  EXP     VOL     C
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Bag    836.  112.
2 IGT   3186.  400.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by euk size</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SizeFrac) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  SizeFrac   VOL     C
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 micro    4678. 587. 
2 nano      325.  46.9</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by site</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  VENT_BSW   VOL     C
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 BSW       643.  91.4
2 vent     2188. 276. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>euk_vol <span class="ot">&lt;-</span> <span class="fu">mean</span>(biov_calc<span class="sc">$</span>Volume);euk_vol <span class="co"># in um^3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1775.759</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>euk_carbon <span class="ot">&lt;-</span> <span class="fu">mean</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon <span class="co"># in pg C per cell</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 226.9636</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>euk_carbon_min <span class="ot">&lt;-</span> <span class="fu">min</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon_min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8290772</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>euk_carbon_max <span class="ot">&lt;-</span> <span class="fu">max</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon_max</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1120.958</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_carbon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Avg euk biomass pg C per individual cell == <code>{r}euk_carbon</code></p>
</section>
<section id="compare-carbon-biomass-with-literature" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="compare-carbon-biomass-with-literature"><span class="header-section-number">7.2</span> Compare carbon biomass with literature</h2>
<p>LIKELY REMOVE ALL OF THIS - THIS IS CIRCULAR MATH!</p>
<p>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10^7 µm^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</p>
<p>Import the heterotroph species volume and carbon content to compare to my measured values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hu-measured</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(biov_calc<span class="sc">$</span>Volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    4.18879 9046.50993</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(biov_calc<span class="sc">$</span>pgC_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    0.8290772 1120.9583343</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, Volume, pgC_cell)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^-</span><span class="dv">3</span>),</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>carbon_compare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_min <span class="ot">&lt;-</span> <span class="fu">min</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_max <span class="ot">&lt;-</span> <span class="fu">max</span>(c_prev<span class="sc">$</span>pgC_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</p>
<p>Find lowest estimates or protist carbon, benthic estimates, and others? How does it compare to my measurements?</p>
<section id="carbon-biomass-for-prokaryotes" class="level3">
<h3 class="anchored" data-anchor-id="carbon-biomass-for-prokaryotes">Carbon biomass for prokaryotes</h3>
<p>Below adding in biomass estimates from prokaryotes and protists.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>bac_carbon_ug <span class="ot">&lt;-</span> (<span class="dv">86</span>)<span class="sc">*</span>(<span class="fl">1.00E-9</span>) <span class="co"># From Derived from Morono et al. 2011 </span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bac_carbon_ug</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>bac_carbon_ug_2 <span class="ot">&lt;-</span> (<span class="dv">173</span>)<span class="sc">*</span>(<span class="fl">1.00E-9</span>) <span class="co"># Derived from McNichol et al. 2018; LOFERER-KRO ̈ ßBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Amend all to table Incorporate calculations that include biomass of population and ug C consumed. For rate measurements, only incorporate the Morono et al.&nbsp;2011 biomass for prokaryotes. This way it is on the lower end and is comparable to Gorda Ridge work.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">euk_C_ug_Hu =</span> (euk_carbon <span class="sc">/</span> (<span class="fl">1.00E+06</span>))) <span class="sc">%&gt;%</span> <span class="co"># Convert to ug from pg</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">euk_C_ug_lit =</span> (euk_carbon_lit_mean <span class="sc">/</span> (<span class="fl">1.00E+06</span>))) <span class="sc">%&gt;%</span> <span class="co"># literature</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_C_ug =</span> bac_carbon_ug) <span class="sc">%&gt;%</span> </span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_C_ug_2 =</span> bac_carbon_ug_2) <span class="sc">%&gt;%</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grazing rate in ug C per bac per day</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_ugCbac_pergrazer_perday =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> bac_C_ug), <span class="co"># Grazing rate as ug C per grazer per day</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>         <span class="co"># % of cell carbon per day</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_INGESTION_RATE =</span> (RATE_ugCbac_pergrazer_perday <span class="sc">/</span> euk_C_ug_Hu),</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_INGESTION_RATE_lit =</span> (RATE_ugCbac_pergrazer_perday <span class="sc">/</span> euk_C_ug_lit),</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass =</span> PROK_ml <span class="sc">*</span> bac_carbon_ug,</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu =</span> EUK_ml <span class="sc">*</span> euk_C_ug_Hu,</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit =</span> EUK_ml <span class="sc">*</span> euk_C_ug_lit,</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_L =</span> PROK_ml <span class="sc">*</span> bac_carbon_ug <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_L =</span> EUK_ml <span class="sc">*</span> euk_C_ug_Hu <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_L =</span> EUK_ml <span class="sc">*</span> euk_C_ug_lit <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Repeat with SEM values</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_sem =</span> PROK_sem <span class="sc">*</span> bac_carbon_ug,</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_sem =</span> EUK_sem <span class="sc">*</span> euk_C_ug_Hu,</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_sem =</span> EUK_sem <span class="sc">*</span> euk_C_ug_lit,</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_sem_L =</span> PROK_sem <span class="sc">*</span> (bac_carbon_ug<span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_sem_L =</span> EUK_sem <span class="sc">*</span> (euk_C_ug_Hu <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_sem_L =</span> EUK_sem <span class="sc">*</span> (euk_C_ug_lit <span class="sc">*</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">detected =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>    RATE_min <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Not detected"</span>,</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Detected"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">%in%</span> bsw <span class="sc">~</span> NAME,</span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"Vent"</span>, EXP, <span class="at">sep=</span><span class="st">"-"</span>)</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>    RATE_min <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE_min</span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type_site =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">%in%</span> bsw <span class="sc">~</span> NAME,</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs_biomass)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Volume is reported as um^3</p>
</blockquote>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
</ul>
</section>
</section>
<section id="amend-table-with-bounded-carbon-estimates" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="amend-table-with-bounded-carbon-estimates"><span class="header-section-number">7.3</span> Amend table with ‘bounded’ carbon estimates</h2>
<p>Also make a “bounded” table that demonstrates the ug C consumed in the context of McNichol et al.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># G = number of cells grazed during experiment duration</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> table_wcalcs_biomass <span class="sc">%&gt;%</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">fgC_cell =</span> <span class="dv">86</span>) <span class="sc">%&gt;%</span> <span class="co"># Add in Morono et al. 2011 value</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cells_consumed_perday = (G / 1), # Rate of cells consumed * in situ prok, per day</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fgC_ml_perday =</span> (GRAZING_EFFECT_day <span class="sc">*</span> fgC_cell), <span class="co"># Convert cell amount to fg C</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>), <span class="co"># Convert to ug C per L</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_mcnichol =</span> <span class="dv">100</span><span class="sc">*</span>(ugC_L_perday <span class="sc">/</span> <span class="fl">17.3</span>),</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_mcnichol =</span> <span class="dv">100</span><span class="sc">*</span>(ugC_L_perday <span class="sc">/</span> <span class="fl">321.4</span>)</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs_biomass_bounded)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs_biomass_bounded)</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs_biomass_bounded, file = "output-data/table-wcalc.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compare-with-axial-euk-cell-count" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Compare with Axial euk cell count</h1>
<p>From Axial Seamount cruise (July 2022) - have Anemone vent and plume euk cell counts to compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>counts_ax <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../GrazingatAxial-2022/euk-cell-counts-11142022.csv"</span>, </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>counts_ax[<span class="fu">is.na</span>(counts_ax)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Modify grazing code to count euk cells/ml so it considers euk cell count samples only.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_axial <span class="ot">&lt;-</span> counts_ax <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, <span class="at">EXP =</span> <span class="st">`</span><span class="at">EXP.ID</span><span class="st">`</span>, <span class="at">VOL =</span> <span class="st">`</span><span class="at">vol..ml.</span><span class="st">`</span>, <span class="at">MAG =</span> <span class="st">`</span><span class="at">Mag..x.</span><span class="st">`</span>, <span class="at">nano =</span> <span class="st">`</span><span class="at">X.20um..no.FLP</span><span class="st">`</span>, <span class="at">micro =</span> <span class="st">`</span><span class="at">X.20um..no.FLP.1</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXP, VOL) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nano), </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(micro),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span> </span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar)))) <span class="sc">%&gt;%</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab filter rig, it is 283.385):</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'EXP'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # left_join(expmeta) %&gt;%</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(SAMPLE, c("Site", "Name"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(EXPID, c("TimePoint", "Replicate"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data.frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Thoughts on cell counts. Combining nano and micro for now, as the de-pressurization can cause issues in size. Likely underestimates for these counts.</p>
<p>This is further supported because the biovolumes of all cells were pretty low.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_cellsml_axial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 16
# Groups:   SAMPLE, EXP [6]
  SAMPLE      EXP     VOL total…¹ nanoAvg nanoVar nanoSd micro…² micro…³ microSd
  &lt;chr&gt;       &lt;chr&gt; &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Anemone     eukc…   200      30   0.9     0.921   1.92  0.0333  0.0333   0.365
2 Anemone     eukc…   200      30   0.967   0.930   1.93  0.167   0.144    0.758
3 Anemone     eukc…   200      30   1.3     1.32    2.30  0.1     0.0931   0.610
4 ASHES Plume coun…   200      30   0.4     0.455   1.35  0.133   0.120    0.691
5 ASHES Plume coun…   200      30   0.267   0.271   1.04  0.133   0.120    0.691
6 ASHES Plume coun…   200      30   0.467   0.602   1.55  0.1     0.0931   0.610
# … with 6 more variables: euksAvg &lt;dbl&gt;, euksVar &lt;dbl&gt;, euksSd &lt;dbl&gt;,
#   nanoCONC &lt;dbl&gt;, microCONC &lt;dbl&gt;, eukCONC &lt;dbl&gt;, and abbreviated variable
#   names ¹​totalFOV, ²​microAvg, ³​microVar</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(counts_cellsml_axial<span class="sc">$</span>eukCONC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_euk_conc)</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_axial)</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="sc">%&gt;%</span> </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span> <span class="sc">&amp;</span> TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(CONCENTRATION)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"MidCaymanRise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(counts_cellsml_axial <span class="sc">%&gt;%</span> </span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Name =</span> EXP, eukCONC) <span class="sc">%&gt;%</span> </span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(eukCONC)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"AxialSeamount"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"ASHES Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"International District Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Name, <span class="at">y =</span> euk_conc_mean)) <span class="sc">+</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> TYPE), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> FIELD <span class="sc">+</span> TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="environmental-parameters---mcr" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Environmental parameters - MCR</h1>
<p>Import from Hu et al.&nbsp;(<em>Molecular Ecology</em>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE, <span class="fu">everything</span>())</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate supplementary table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis-of-grazing-rate-results" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Analysis of grazing rate results</h1>
<p>Re-import table from output table with all grazing values</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Format and factor values to plot, and prioritize these values:</p>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
<li>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_wcalcs_biomass_bounded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD         NAME EXP   SAMPLE    RATE_min    FLP_ml   PROK_ml PROK_sem
1 Von Damm   Background Bag   VD-BSW 0.002958889  4861.824  37889.62 8608.427
2 Von Damm        Plume Bag VD-Plume 0.005274231 34242.354  16478.31 2623.935
3 Von Damm         X-18 Bag   VD-X18 0.001744429  3148.722 111429.78 2973.793
4 Von Damm Old Man Tree IGT   VD-OMT 0.014510943  5352.828  71147.40       NA
5 Von Damm   Ravelin #2 Bag  VD-Rav2 0.003470217 51890.942  71147.40       NA
6 Von Damm   Ravelin #2 IGT  VD-Rav2 0.015395240  5352.828  71147.40       NA
     EUK_ml   EUK_sem        TimePoints EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL
1  91.83773  21.86613 0, 10, 15, 20, 40        3    2.00         2      0.5
2 157.77468  67.09859 0, 10, 15, 25, 57        3    2.00         2      1.0
3 314.87222 104.95741     0, 15, 20, 40        2    1.50         2      0.5
4 472.30833 122.45031          0, 7, 25        1    0.15        NA       NA
5 409.33389  73.47019 0, 10, 15, 21, 40        3    1.50         2      0.5
6 620.99799 123.17702         0, 12, 20        1    0.15        NA       NA
    RATE_hr  RATE_day    FLP_L CLEARANCE_RATE_ml CLEARANCE_RATE_nL
1 0.1775333  4.260800  4861824      3.651579e-05      3.651579e-11
2 0.3164538  7.594892 34242354      9.241591e-06      9.241591e-12
3 0.1046657  2.511977  3148722      3.324070e-05      3.324070e-11
4 0.8706566 20.895758  5352828      1.626536e-04      1.626536e-10
5 0.2082130  4.997113 51890942      4.012512e-06      4.012512e-12
6 0.9237144 22.169145  5352828      1.725657e-04      1.725657e-10
  SPEC_GRAZE_RATE_hr GRAZE_RATE_DAY GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min
1          1.3835695      33.205668         127.06388              96.81058
2          0.1522858       3.654860          24.02685              13.80868
3          3.7040034      88.896081        1166.28778             777.52519
4         11.5723785     277.737084        5465.73080            4048.68948
5          0.2854798       6.851515         116.85656              95.88230
6         12.2775993     294.662382        7624.36451            6112.04639
  GRAZING_EFFECT_hr_max GRAZING_EFFECT_day BAC_TURNOVER_PERC
1             157.31719          3049.5332          8.048465
2              34.24501           576.6444          3.499414
3            1555.05037         27990.9067         25.119772
4            6882.77212        131177.5392        184.374334
5             137.83081          2804.5574          3.941897
6            9136.68264        182984.7483        257.191065
  BAC_TURNOVER_PERC_min BAC_TURNOVER_PERC_max  euk_C_ug_Hu euk_C_ug_lit
1             10.414647              6.558411 0.0002269636   0.01147298
2              4.162182              3.018725 0.0002269636   0.01147298
3             25.808540             24.466811 0.0002269636   0.01147298
4                    NA                    NA 0.0002269636   0.01147298
5                    NA                    NA 0.0002269636   0.01147298
6                    NA                    NA 0.0002269636   0.01147298
  bac_C_ug bac_C_ug_2 RATE_ugCbac_pergrazer_perday SPEC_INGESTION_RATE
1  8.6e-08   1.73e-07                 3.664288e-07         0.001614483
2  8.6e-08   1.73e-07                 6.531607e-07         0.002877822
3  8.6e-08   1.73e-07                 2.160300e-07         0.000951827
4  8.6e-08   1.73e-07                 1.797035e-06         0.007917726
5  8.6e-08   1.73e-07                 4.297517e-07         0.001893483
6  8.6e-08   1.73e-07                 1.906547e-06         0.008400232
  SPEC_INGESTION_RATE_lit Prok_biomass Euk_biomass_Hu Euk_biomass_lit
1            3.193840e-05  0.003258508     0.02084382        1.053653
2            5.693033e-05  0.001417135     0.03580910        1.810146
3            1.882946e-05  0.009582961     0.07146452        3.612524
4            1.566319e-04  0.006118676     0.10719678        5.418786
5            3.745771e-05  0.006118676     0.09290388        4.696281
6            1.661770e-04  0.006118676     0.14094392        7.124700
  Prok_biomass_L Euk_biomass_Hu_L Euk_biomass_lit_L Prok_biomass_sem
1       3.258508         20.84382          1053.653     0.0007403247
2       1.417135         35.80910          1810.146     0.0002256584
3       9.582961         71.46452          3612.524     0.0002557462
4       6.118676        107.19678          5418.786               NA
5       6.118676         92.90388          4696.281               NA
6       6.118676        140.94392          7124.700               NA
  Euk_biomass_Hu_sem Euk_biomass_lit_sem Prok_biomass_sem_L
1        0.004962814           0.2508697          0.7403247
2        0.015228935           0.7698210          0.2256584
3        0.023821507           1.2041746          0.2557462
4        0.027791758           1.4048704                 NA
5        0.016675055           0.8429222                 NA
6        0.027956696           1.4132080                 NA
  Euk_biomass_Hu_sem_L Euk_biomass_lit_sem_L detected       type  GRAZE_RATE
1             4.962814              250.8697 Detected Background 0.002958889
2            15.228935              769.8210 Detected      Plume 0.005274231
3            23.821507             1204.1746 Detected   Vent-Bag 0.001744429
4            27.791758             1404.8704 Detected   Vent-IGT 0.014510943
5            16.675055              842.9222 Detected   Vent-Bag 0.003470217
6            27.956696             1413.2080 Detected   Vent-IGT 0.015395240
   type_site fgC_cell fgC_ml_perday ugC_L_perday lower_mcnichol upper_mcnichol
1 Background       86     262259.86   0.26225986      1.5159529     0.08159921
2      Plume       86      49591.42   0.04959142      0.2866556     0.01542981
3       Vent       86    2407217.98   2.40721798     13.9145548     0.74897884
4       Vent       86   11281268.37  11.28126837     65.2096438     3.51003994
5       Vent       86     241191.93   0.24119193      1.3941730     0.07504416
6       Vent       86   15736688.36  15.73668836     90.9635165     4.89629383</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot <span class="ot">&lt;-</span> table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span> </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, type, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>        PROK_ml, EUK_ml, PROK_sem, EUK_sem,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_L, Euk_biomass_Hu_L, Euk_biomass_lit_L,</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>        GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, BAC_TURNOVER_PERC_min, BAC_TURNOVER_PERC_max,</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>        GRAZE_RATE, RATE_ugCbac_pergrazer_perday,</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>        SPEC_INGESTION_RATE, SPEC_INGESTION_RATE_lit) <span class="sc">%&gt;%</span> </span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml,</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>                        Prok_biomass_L, Euk_biomass_Hu_L, Euk_biomass_lit_L,</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>                        GRAZING_EFFECT_hr, BAC_TURNOVER_PERC,</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>                        GRAZE_RATE, RATE_ugCbac_pergrazer_perday,</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>                        SPEC_INGESTION_RATE, SPEC_INGESTION_RATE_lit),</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_sem, EUK_sem, Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>                        BAC_TURNOVER_PERC_max, BAC_TURNOVER_PERC_min, GRAZING_EFFECT_hr_max, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max),</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"SEM_variable"</span>, <span class="at">values_to =</span> <span class="st">"SEM"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>VARIABLE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>Variable, </span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PROK_ml"</span>, <span class="st">"EUK_ml"</span>,</span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prok_biomass_L"</span>, <span class="st">"Euk_biomass_Hu_L"</span>, <span class="st">"Euk_biomass_lit_L"</span>,</span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZING_EFFECT_hr"</span>, <span class="st">"BAC_TURNOVER_PERC"</span>,</span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZE_RATE"</span>, <span class="st">"RATE_ugCbac_pergrazer_perday"</span>,</span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"SPEC_INGESTION_RATE"</span>, <span class="st">"SPEC_INGESTION_RATE_lit"</span>),</span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Prokaryote~cells~mL^{-1}"</span>, <span class="st">"Eukaryote~cells~mL^{-1}"</span>,</span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prokaryote~µg~C~L^{-1}"</span>, <span class="st">"Measured~eukaryote~µg~C~L^{-1}"</span>, <span class="st">"Literature-based~eukaryote~µg~C~L^{-1}"</span>,</span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cells~mL^{-1}~hr^{-1}"</span>, <span class="st">"Prokaryote~turnover~'%'~d^{-1}"</span>,</span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"FLP~consumed~min^{-1}"</span>, <span class="st">"µg~C~grazer^{-1}~day^{-1}"</span>,</span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cell~carbon~%~day^{-1}"</span>, <span class="st">"Cell~carbon~%~day^{-1}~(lit)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="function-to-plot-grazing-results" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="function-to-plot-grazing-results"><span class="header-section-number">10.1</span> Function to plot grazing results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>conc_rate_plot_mcr <span class="ot">&lt;-</span> <span class="cf">function</span>(df, var, sem){</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> var) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> sem) <span class="sc">%&gt;%</span> </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Value <span class="sc">+</span> SEM), <span class="at">ymin =</span> (Value <span class="sc">-</span> SEM)), </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(VARIABLE_ORDER <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>), <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "PROK_ml", "PROK_sem")</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "EUK_ml", "EUK_sem")</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Prok_biomass_L", "Prok_biomass_sem_L")</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"Euk_biomass_Hu_L"</span>, <span class="st">"Euk_biomass_Hu_sem_L"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> biomass_rate_plot <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_min"</span> <span class="sc">|</span> SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_max"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> SEM_variable, <span class="at">values_from =</span> SEM) <span class="sc">%&gt;%</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">NAME_ORDER =</span> <span class="fu">factor</span>(NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(. <span class="sc">~</span> VARIABLE_ORDER, <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_flip() +</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Cells consumed per ml per hr"</span>)</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a><span class="co"># class(grazing_rate)</span></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biomass_rate_plot)</span></span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("plot-grazing-withscale.svg", h = 7, w = 6)</span></span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate</span></span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(</span></span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate + scale_y_continuous(limits = c(0,2000))</span></span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ,</span></span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a>          <span class="co"># grazing_rate,</span></span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a>          <span class="co"># ncol = 1, rel_heights = c(0.6,1))</span></span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
<section id="grazing-rate-vs.-cells-ml" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="grazing-rate-vs.-cells-ml"><span class="header-section-number">10.2</span> Grazing rate vs.&nbsp;cells ml</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>env_params <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> <span class="st">"input-data/table_wenv.txt"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(env_params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SEQ_SAMPLE"                   "VENT"                        
 [3] "COORDINATES"                  "SAMPLETYPE"                  
 [5] "DEPTH"                        "YEAR"                        
 [7] "TEMP"                         "pH"                          
 [9] "Perc"                         "Mg"                          
[11] "H2."                          "H2S"                         
[13] "CH4"                          "ProkConc"                    
[15] "Sample_actual"                "Type"                        
[17] "FIELD"                        "ref_num"                     
[19] "SITE"                         "Sample_or_Control"           
[21] "SAMPLEID"                     "NAME"                        
[23] "EXP"                          "RATE_min"                    
[25] "FLP_ml"                       "PROK_ml"                     
[27] "PROK_sem"                     "EUK_ml"                      
[29] "EUK_sem"                      "TimePoints"                  
[31] "EXP_REPS"                     "EXP_VOL"                     
[33] "CTRL_REPS"                    "CTRL_VOL"                    
[35] "RATE_hr"                      "RATE_day"                    
[37] "FLP_L"                        "CLEARANCE_RATE_ml"           
[39] "CLEARANCE_RATE_nL"            "SPEC_GRAZE_RATE_hr"          
[41] "GRAZE_RATE_DAY"               "GRAZING_EFFECT_hr"           
[43] "GRAZING_EFFECT_hr_min"        "GRAZING_EFFECT_hr_max"       
[45] "GRAZING_EFFECT_day"           "BAC_TURNOVER_PERC"           
[47] "BAC_TURNOVER_PERC_min"        "BAC_TURNOVER_PERC_max"       
[49] "euk_C_ug_Hu"                  "euk_C_ug_lit"                
[51] "bac_C_ug"                     "bac_C_ug_2"                  
[53] "RATE_ugCbac_pergrazer_perday" "SPEC_INGESTION_RATE"         
[55] "SPEC_INGESTION_RATE_lit"      "Prok_biomass"                
[57] "Euk_biomass_Hu"               "Euk_biomass_lit"             
[59] "Prok_biomass_L"               "Euk_biomass_Hu_L"            
[61] "Euk_biomass_lit_L"            "Prok_biomass_sem"            
[63] "Euk_biomass_Hu_sem"           "Euk_biomass_lit_sem"         
[65] "Prok_biomass_sem_L"           "Euk_biomass_Hu_sem_L"        
[67] "Euk_biomass_lit_sem_L"        "detected"                    
[69] "type"                         "GRAZE_RATE"                  
[71] "type_site"                    "fgC_cell"                    
[73] "fgC_ml_perday"                "ugC_L_perday"                
[75] "lower_mcnichol"               "upper_mcnichol"              </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="ot">&lt;-</span> env_params <span class="sc">%&gt;%</span> </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_hr"</span>), pH, Mg, H2., CH4, H2S)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot_wider(names_from = "name", values_from = "value", values_fill = NA)</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(plot_metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     SITE           VENT SAMPLETYPE  TEMP DEPTH   PROK_ml  PROK_sem
1 Piccard            BSW Background  4.46  4776        NA        NA
2 Piccard          Plume      Plume  4.46  4944  51429.13  4618.126
3 Piccard    LotsOShrimp       Vent 19.00  4967  53878.14 13727.191
4 Piccard Shrimpocalypse       Vent 85.00  4945 238585.68 65792.588
5 Piccard Shrimpocalypse       Vent 85.00  4945 238585.68 65792.588
6 Piccard    LotsOShrimp       Vent 36.00  4967  53878.14 13727.191
  Prok_biomass Prok_biomass_L Prok_biomass_sem Prok_biomass_sem_L    EUK_ml
1           NA             NA               NA                 NA        NA
2  0.004422905       4.422905     0.0003971588          0.3971588  79.30115
3  0.004633520       4.633520     0.0011805385          1.1805385 230.90630
4  0.020518368      20.518368     0.0056581625          5.6581625 454.81543
5  0.020518368      20.518368     0.0056581625          5.6581625 454.81543
6  0.004633520       4.633520     0.0011805385          1.1805385 230.90630
   EUK_sem  euk_C_ug_Hu euk_C_ug_lit Euk_biomass_Hu Euk_biomass_lit
1       NA           NA           NA             NA              NA
2 16.81908 0.0002269636   0.01147298     0.01799847       0.9098208
3       NA 0.0002269636   0.01147298     0.05240732       2.6491842
4       NA 0.0002269636   0.01147298     0.10322653       5.2180901
5 69.97160 0.0002269636   0.01147298     0.10322653       5.2180901
6       NA 0.0002269636   0.01147298     0.05240732       2.6491842
  Euk_biomass_Hu_L Euk_biomass_lit_L Euk_biomass_Hu_sem Euk_biomass_lit_sem
1               NA                NA                 NA                  NA
2         17.99847          909.8208        0.003817318           0.1929650
3         52.40732         2649.1842                 NA                  NA
4        103.22653         5218.0901                 NA                  NA
5        103.22653         5218.0901        0.015881005           0.8027831
6         52.40732         2649.1842                 NA                  NA
  Euk_biomass_Hu_sem_L Euk_biomass_lit_sem_L GRAZING_EFFECT_hr
1                   NA                    NA                NA
2             3.817318              192.9650           44.2593
3                   NA                    NA            0.0000
4                   NA                    NA         6006.7432
5            15.881005              802.7831        20427.1780
6                   NA                    NA            0.0000
  GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max   pH   Mg      H2.      CH4 H2S
1                    NA                    NA   NA 53.7       NA       NA  NA
2              34.87229               53.6463   NA   NA       NA       NA  NA
3                    NA                    NA 6.32 53.5     1.33 11.87376  NA
4                    NA                    NA 5.11 43.9     0.00 27.53484  NA
5           17284.53525            23569.8208 5.11 43.9     0.00 27.53484  NA
6                    NA                    NA 5.92 51.0 22700.00 11.46432  NA</code></pre>
</div>
</div>
<p>Compare microbial biomass, concentration, grazing and temperature across all sites.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>euk_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem)))) <span class="sc">+</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Microial prey cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>prok_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(euk_temp <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> prok_temp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plot other environmental parameters</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>plot_supp <span class="ot">&lt;-</span> <span class="cf">function</span>(PARAMETER){</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pH, Mg, H2., CH4, H2S), <span class="at">names_to =</span> <span class="st">"ENV"</span>, <span class="at">values_to =</span> <span class="st">"ENV_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ENV_NUM =</span> <span class="fu">as.numeric</span>(ENV_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ENV <span class="sc">==</span> PARAMETER) <span class="sc">%&gt;%</span> </span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> ENV_VALUE)) <span class="sc">+</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>,</span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> PARAMETER)</span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pH, Mg, H2., CH4, H2S</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_supp</span>(<span class="st">"pH"</span>) <span class="sc">+</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"Mg"</span>) <span class="sc">+</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2."</span>) <span class="sc">+</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"CH4"</span>) <span class="sc">+</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2S"</span>) <span class="sc">+</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
</section>
<section id="comparison-with-gorda-ridge" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Comparison with Gorda Ridge</h1>
<p>Import data from Gorda Ridge</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"/Users/sarahhu/Desktop/Projects/GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combine-gr-and-mcr-data" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="combine-gr-and-mcr-data"><span class="header-section-number">11.1</span> Combine GR and MCR data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, ugC_L_perday) <span class="sc">%&gt;%</span> </span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover, <span class="at">ugC_L_perday =</span> ugC_L_perday_morono)) <span class="sc">%&gt;%</span> </span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("NAME", "SAMPLE")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-combined-results" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="plot-combined-results"><span class="header-section-number">11.2</span> Plot combined results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add Gorda Ridge comparison to supplementary?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>allrates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-73-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="remove-undetected-grazing-rate" class="level3">
<h3 class="anchored" data-anchor-id="remove-undetected-grazing-rate">Remove undetected grazing rate</h3>
<p>Repeat grazing rate plot, but removed undetectable</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Panel plot, cells per ml and grazing rate</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("plot-gcellconc-grazing-log.svg", h = 10, w = 6)</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate + scale_y_log10(limits = c(1e-1,1e5), breaks=10^(0:7))</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>),</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>),</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>(), <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/Plot%20cell%20conc%20and%20rates-1.png" class="img-fluid" width="576"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("cells-per-ml.svg", h = 7, w = 7)</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>) <span class="sc">+</span> <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="linear-regression" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Linear regression</h1>
<p>Use tidymodels to perform linear regression. Include MCR and GR data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SAMPLE <span class="sc">==</span> <span class="st">"Piccard-Shrimpocalypse"</span> <span class="sc">&amp;</span> EXP <span class="sc">==</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, ugC_L_perday, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, ugC_L_perday), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>regression_results <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("RATE", "PARAMS")
Joining, by = c("RATE", "PARAMS")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>regression_results <span class="sc">%&gt;%</span> </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 24 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Regression thoughts</em>: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</p>
</section>
<section id="grazing-environmental-parameters" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Grazing &amp; environmental parameters</h1>
<ul>
<li><p>What parameters influence grazing rates of protists on bacteria?</p></li>
<li><p>Try triangle plots?</p></li>
<li><p>What about geom raster?</p></li>
</ul>
<p>Plot temperature by euk and prok per ml individually too.</p>
<p>Bacterial abundance typically increases with temperature (White et al.&nbsp;1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</p>
<p>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature… in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD         NAME   SAMPLE EXP   PROK_ml    EUK_ml GRAZING_EFFECT_hr
1 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
2 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
3 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
4 Von Damm        Plume VD-Plume Bag  16478.31 157.77468          24.02685
5 Von Damm         X-18   VD-X18 Bag 111429.78 314.87222        1166.28778
6 Von Damm Old Man Tree   VD-OMT IGT  71147.40 472.30833        5465.73080
  GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max BAC_TURNOVER_PERC ugC_L_perday
1              96.81058             157.31719          8.048465   0.26225986
2              96.81058             157.31719          8.048465   0.26225986
3              96.81058             157.31719          8.048465   0.26225986
4              13.80868              34.24501          3.499414   0.04959142
5             777.52519            1555.05037         25.119772   2.40721798
6            4048.68948            6882.77212        184.374334  11.28126837
  Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1        4.181 NA NA  NA NA  NA  Background
2        4.100 NA NA  NA NA  NA  Background
3        4.000 NA NA  NA NA  NA  Background
4        4.230 NA NA  NA NA  NA  Background
5       62.000 NA NA  NA NA  NA        Vent
6      121.000 NA NA  NA NA  NA        Vent</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(allvent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD         NAME   SAMPLE EXP   PROK_ml    EUK_ml GRAZING_EFFECT_hr
1 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
2 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
3 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
4 Von Damm        Plume VD-Plume Bag  16478.31 157.77468          24.02685
5 Von Damm         X-18   VD-X18 Bag 111429.78 314.87222        1166.28778
6 Von Damm Old Man Tree   VD-OMT IGT  71147.40 472.30833        5465.73080
  GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max BAC_TURNOVER_PERC ugC_L_perday
1              96.81058             157.31719          8.048465   0.26225986
2              96.81058             157.31719          8.048465   0.26225986
3              96.81058             157.31719          8.048465   0.26225986
4              13.80868              34.24501          3.499414   0.04959142
5             777.52519            1555.05037         25.119772   2.40721798
6            4048.68948            6882.77212        184.374334  11.28126837
  Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE PROK_EUK_RATIO
1        4.181 NA NA  NA NA  NA  Background       412.5714
2        4.100 NA NA  NA NA  NA  Background       412.5714
3        4.000 NA NA  NA NA  NA  Background       412.5714
4        4.230 NA NA  NA NA  NA  Background       104.4421
5       62.000 NA NA  NA NA  NA        Vent       353.8889
6      121.000 NA NA  NA NA  NA        Vent       150.6376</code></pre>
</div>
</div>
<p>Function to plot results by two parameters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-temperature-by-eukprok-and-then-euk-and-prok" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="header-section-number">13.1</span> Plot temperature by euk:prok and then euk and prok</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-temperature-by-grazing-rate" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="plot-temperature-by-grazing-rate"><span class="header-section-number">13.2</span> Plot temperature by grazing rate</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FIELD"                 "NAME"                  "SAMPLE"               
 [4] "EXP"                   "PROK_ml"               "EUK_ml"               
 [7] "GRAZING_EFFECT_hr"     "GRAZING_EFFECT_hr_min" "GRAZING_EFFECT_hr_max"
[10] "BAC_TURNOVER_PERC"     "ugC_L_perday"          "Highest.Temp"         
[13] "pH"                    "Mg"                    "H2S"                  
[16] "H2"                    "CH4"                   "SAMPLE_TYPE"          
[19] "PROK_EUK_RATIO"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, ugC_L_perday, EUK_ml, <span class="st">"ugC_L_perday"</span>, <span class="st">"Euk cells per ml"</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="carbon-biomass-investigation" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Carbon biomass investigation</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD         NAME   SAMPLE EXP   PROK_ml    EUK_ml GRAZING_EFFECT_hr
1 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
2 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
3 Von Damm   Background   VD-BSW Bag  37889.62  91.83773         127.06388
4 Von Damm        Plume VD-Plume Bag  16478.31 157.77468          24.02685
5 Von Damm         X-18   VD-X18 Bag 111429.78 314.87222        1166.28778
6 Von Damm Old Man Tree   VD-OMT IGT  71147.40 472.30833        5465.73080
  GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max BAC_TURNOVER_PERC ugC_L_perday
1              96.81058             157.31719          8.048465   0.26225986
2              96.81058             157.31719          8.048465   0.26225986
3              96.81058             157.31719          8.048465   0.26225986
4              13.80868              34.24501          3.499414   0.04959142
5             777.52519            1555.05037         25.119772   2.40721798
6            4048.68948            6882.77212        184.374334  11.28126837
  Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1        4.181 NA NA  NA NA  NA  Background
2        4.100 NA NA  NA NA  NA  Background
3        4.000 NA NA  NA NA  NA  Background
4        4.230 NA NA  NA NA  NA  Background
5       62.000 NA NA  NA NA  NA        Vent
6      121.000 NA NA  NA NA  NA        Vent</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>carbon_density <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">fgC_cell =</span> <span class="fu">seq</span>(<span class="dv">86</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">1</span>), </span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">GRAZING_EFFECT_hr =</span> <span class="fu">seq</span>(<span class="fu">min</span>(all_vents<span class="sc">$</span>GRAZING_EFFECT_hr),</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">max</span>(all_vents<span class="sc">$</span>GRAZING_EFFECT_hr),</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">length.out =</span> <span class="dv">215</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fgC_ml_perday =</span> ((GRAZING_EFFECT_hr<span class="sc">*</span><span class="dv">24</span>) <span class="sc">*</span> fgC_cell),</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>)</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>samples_lines <span class="ot">&lt;-</span> <span class="fu">select</span>(all_vents, GRAZING_EFFECT_hr, FIELD) <span class="sc">%&gt;%</span> </span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">fgC_cell =</span> <span class="fu">seq</span>(<span class="dv">86</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fgC_ml_perday =</span> ((GRAZING_EFFECT_hr<span class="sc">*</span><span class="dv">24</span>) <span class="sc">*</span> fgC_cell),</span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>)</span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(carbon_density, <span class="fu">aes</span>(<span class="at">x =</span> fgC_cell, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ugC_L_perday)) <span class="sc">+</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#fef0d9"</span>, <span class="st">"#b30000"</span>), <span class="at">name =</span> <span class="fu">bquote</span>(<span class="st">"ug C"</span><span class="sc">~</span>L<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>day<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>consumed <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"fg C"</span><span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> samples_lines,</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">87</span>,</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">shape =</span> FIELD), <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Eukaryote biomass comparison with measured vs.&nbsp;literature</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="ot">&lt;-</span> env_params <span class="sc">%&gt;%</span> </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_hr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Euk_biomass_Hu)) <span class="sc">%&gt;%</span> </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Euk_biomass_Hu_fg =</span> Euk_biomass_Hu <span class="sc">*</span> <span class="dv">1000000000</span>,</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_fg =</span> Euk_biomass_lit <span class="sc">*</span> <span class="dv">1000000000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> VENT)) <span class="sc">+</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Euk_biomass_Hu_fg), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Euk_biomass_lit), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(SAMPLETYPE <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"fg C of eukaryote population"</span>, <span class="at">y =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="three-parameter-figures" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Three parameter figures</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>density_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, area, x_title, y_title){</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  AREA <span class="ot">&lt;-</span> <span class="fu">enquo</span>(area)</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR, <span class="at">raster =</span> <span class="sc">!!</span>AREA) <span class="sc">%&gt;%</span> </span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> raster), <span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_point(size = 3, shape = 21, color = "black", aes(fill = FIELD)) +</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_abline(slope = 1, intercept = 0) +</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">density_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_ml</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">`</span><span class="at">GRAZING_EFFECT_hr</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Raster pixels are placed at uneven horizontal intervals and will be
shifted. Consider using geom_tile() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Raster pixels are placed at uneven vertical intervals and will be
shifted. Consider using geom_tile() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_raster).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FIELD"                 "NAME"                  "SAMPLE"               
 [4] "EXP"                   "PROK_ml"               "EUK_ml"               
 [7] "GRAZING_EFFECT_hr"     "GRAZING_EFFECT_hr_min" "GRAZING_EFFECT_hr_max"
[10] "BAC_TURNOVER_PERC"     "ugC_L_perday"          "Highest.Temp"         
[13] "pH"                    "Mg"                    "H2S"                  
[16] "H2"                    "CH4"                   "SAMPLE_TYPE"          
[19] "PROK_EUK_RATIO"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(allvent_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(EUK_ml), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ugC_L_perday), <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Raster pixels are placed at uneven horizontal intervals and will be
shifted. Consider using geom_tile() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Raster pixels are placed at uneven vertical intervals and will be
shifted. Consider using geom_tile() instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_raster).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="plot-euk-per-ml-with-temperature-and-grazing-rate" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="plot-euk-per-ml-with-temperature-and-grazing-rate"><span class="header-section-number">15.1</span> Plot euk per ml with temperature and grazing rate</h2>
</section>
</section>
<section id="prediction-of-mcr-data-with-parameters" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Prediction of MCR data with parameters</h1>
<p>Best model to estimate community grazing rate in Vaque et al.&nbsp;considered FLP uptake and similar experiments (in contrast to disappearance experiments).</p>
<p>From Vaque et al.&nbsp;1994 paper equation (1):</p>
<p>See Figure 6</p>
<blockquote class="blockquote">
<p>log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</p>
</blockquote>
<p><em>GT</em> = grazing rate (cells ml-1 hr-1) <em>HNF</em> = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) <em>BAC</em> = prokaryote abundance (cells ml-1)</p>
<p>Start with non-zero grazing rate values, etc. Where… <em>GT</em> == Grazing effect hr <em>HNF</em> == Euk_ml <em>BAC</em> == PROK_ml <em>T</em> == highest temp</p>
<p>We only have these for MCR data.. can include GR for the “predicting euk_ml”</p>
<p>Function to use above formula and estimate</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-30"><a href="#cb229-30" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-31"><a href="#cb229-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb229-32"><a href="#cb229-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-33"><a href="#cb229-33" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb229-34"><a href="#cb229-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb229-35"><a href="#cb229-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb229-36"><a href="#cb229-36" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb229-37"><a href="#cb229-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb229-38"><a href="#cb229-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb229-39"><a href="#cb229-39" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb229-40"><a href="#cb229-40" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb229-41"><a href="#cb229-41" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NaNs produced

Warning in FUN(X[[i]], ...): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 8 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Mid-Cayman Rise only, no undetected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0) %&gt;% filter(!(NAME %in% bsw)), "Mid-Cayman Rise only, no undetected, vents only")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"All samples where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-96-2.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NaNs produced

Warning in FUN(X[[i]], ...): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NaNs produced

Warning in FUN(X[[i]], ...): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-98-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-99-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="session" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Session</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gt_0.7.0        patchwork_1.1.2 broom_1.0.1     cowplot_1.1.1  
 [5] forcats_0.5.2   stringr_1.4.1   dplyr_1.0.10    purrr_0.3.5    
 [9] readr_2.1.2     tidyr_1.2.1     tibble_3.1.8    ggplot2_3.3.6  
[13] tidyverse_1.3.2

loaded via a namespace (and not attached):
 [1] lubridate_1.8.0     assertthat_0.2.1    digest_0.6.30      
 [4] utf8_1.2.2          R6_2.5.1            cellranger_1.1.0   
 [7] backports_1.4.1     reprex_2.0.2        evaluate_0.16      
[10] httr_1.4.4          pillar_1.8.1        rlang_1.0.6        
[13] googlesheets4_1.0.1 readxl_1.4.1        rstudioapi_0.14    
[16] rmarkdown_2.16      labeling_0.4.2      googledrive_2.0.0  
[19] htmlwidgets_1.5.4   munsell_0.5.0       compiler_4.2.1     
[22] modelr_0.1.9        xfun_0.33           pkgconfig_2.0.3    
[25] htmltools_0.5.3     tidyselect_1.2.0    fansi_1.0.3        
[28] crayon_1.5.2        tzdb_0.3.0          dbplyr_2.2.1       
[31] withr_2.5.0         grid_4.2.1          jsonlite_1.8.0     
[34] gtable_0.3.1        lifecycle_1.0.3     DBI_1.1.3          
[37] magrittr_2.0.3      scales_1.2.1        cli_3.4.1          
[40] stringi_1.7.8       farver_2.1.1        fs_1.5.2           
[43] xml2_1.3.3          ellipsis_0.3.2      generics_0.1.3     
[46] vctrs_0.5.0         RColorBrewer_1.1-3  tools_4.2.1        
[49] glue_1.6.2          hms_1.1.2           fastmap_1.1.0      
[52] yaml_2.3.5          colorspace_2.0-3    gargle_1.2.1       
[55] rvest_1.0.3         knitr_1.40          haven_2.5.1        </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb270" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Protistan grazing analysis"</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 2</span></span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Import &amp; format data</span></span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set up working R environment</span></span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import raw count data</span></span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true" tabindex="-1"></a>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-35"><a href="#cb270-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-36"><a href="#cb270-36" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb270-37"><a href="#cb270-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb270-38"><a href="#cb270-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb270-39"><a href="#cb270-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb270-40"><a href="#cb270-40" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span>
<span id="cb270-41"><a href="#cb270-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-42"><a href="#cb270-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-43"><a href="#cb270-43" aria-hidden="true" tabindex="-1"></a>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more 'R' friendly.</span>
<span id="cb270-44"><a href="#cb270-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-47"><a href="#cb270-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-48"><a href="#cb270-48" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb270-49"><a href="#cb270-49" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span>
<span id="cb270-50"><a href="#cb270-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-51"><a href="#cb270-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-52"><a href="#cb270-52" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</span></span>
<span id="cb270-53"><a href="#cb270-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-54"><a href="#cb270-54" aria-hidden="true" tabindex="-1"></a>Parse raw microscopy count data.</span>
<span id="cb270-55"><a href="#cb270-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-58"><a href="#cb270-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-59"><a href="#cb270-59" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb270-60"><a href="#cb270-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb270-61"><a href="#cb270-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-62"><a href="#cb270-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb270-63"><a href="#cb270-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb270-64"><a href="#cb270-64" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb270-65"><a href="#cb270-65" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb270-66"><a href="#cb270-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb270-67"><a href="#cb270-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb270-68"><a href="#cb270-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb270-69"><a href="#cb270-69" aria-hidden="true" tabindex="-1"></a>      data.frame</span>
<span id="cb270-70"><a href="#cb270-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-71"><a href="#cb270-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-72"><a href="#cb270-72" aria-hidden="true" tabindex="-1"></a><span class="fu"># Calculate cells per ml (euk)</span></span>
<span id="cb270-73"><a href="#cb270-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-74"><a href="#cb270-74" aria-hidden="true" tabindex="-1"></a>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionaly, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to <span class="sc">\&gt;</span>20um and nano is <span class="sc">\&lt;</span>20um. All counts were done at 100x magnification, confirm this: <span class="in">`unique(counts_occur$MAG)`</span>.</span>
<span id="cb270-75"><a href="#cb270-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-76"><a href="#cb270-76" aria-hidden="true" tabindex="-1"></a>Calculate cell concentration (cells/ml).</span>
<span id="cb270-77"><a href="#cb270-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-80"><a href="#cb270-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-81"><a href="#cb270-81" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb270-82"><a href="#cb270-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb270-83"><a href="#cb270-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb270-84"><a href="#cb270-84" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb270-85"><a href="#cb270-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb270-86"><a href="#cb270-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb270-87"><a href="#cb270-87" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb270-88"><a href="#cb270-88" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb270-89"><a href="#cb270-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb270-90"><a href="#cb270-90" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb270-91"><a href="#cb270-91" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb270-92"><a href="#cb270-92" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb270-93"><a href="#cb270-93" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-94"><a href="#cb270-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb270-95"><a href="#cb270-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb270-96"><a href="#cb270-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb270-97"><a href="#cb270-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb270-98"><a href="#cb270-98" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb270-99"><a href="#cb270-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb270-100"><a href="#cb270-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-101"><a href="#cb270-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-102"><a href="#cb270-102" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-103"><a href="#cb270-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-104"><a href="#cb270-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-105"><a href="#cb270-105" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</span></span>
<span id="cb270-106"><a href="#cb270-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-107"><a href="#cb270-107" aria-hidden="true" tabindex="-1"></a>Average cells/ml across replicates, pivot to long format</span>
<span id="cb270-108"><a href="#cb270-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-111"><a href="#cb270-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-112"><a href="#cb270-112" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb270-113"><a href="#cb270-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb270-114"><a href="#cb270-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-115"><a href="#cb270-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb270-116"><a href="#cb270-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb270-117"><a href="#cb270-117" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-118"><a href="#cb270-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-119"><a href="#cb270-119" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb270-120"><a href="#cb270-120" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-121"><a href="#cb270-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb270-122"><a href="#cb270-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-123"><a href="#cb270-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb270-124"><a href="#cb270-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb270-125"><a href="#cb270-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb270-126"><a href="#cb270-126" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb270-127"><a href="#cb270-127" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb270-128"><a href="#cb270-128" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb270-129"><a href="#cb270-129" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb270-130"><a href="#cb270-130" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb270-131"><a href="#cb270-131" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-132"><a href="#cb270-132" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-133"><a href="#cb270-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-134"><a href="#cb270-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-135"><a href="#cb270-135" aria-hidden="true" tabindex="-1"></a>NOTES on calculations:</span>
<span id="cb270-136"><a href="#cb270-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-137"><a href="#cb270-137" aria-hidden="true" tabindex="-1"></a>*VAR* = takes the sum of the squares of each value's deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</span>
<span id="cb270-138"><a href="#cb270-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-139"><a href="#cb270-139" aria-hidden="true" tabindex="-1"></a>*SD* = standard deviation of all values</span>
<span id="cb270-140"><a href="#cb270-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-141"><a href="#cb270-141" aria-hidden="true" tabindex="-1"></a>*SEM* = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</span>
<span id="cb270-142"><a href="#cb270-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-143"><a href="#cb270-143" aria-hidden="true" tabindex="-1"></a>Save output file</span>
<span id="cb270-144"><a href="#cb270-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-147"><a href="#cb270-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-148"><a href="#cb270-148" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span>
<span id="cb270-149"><a href="#cb270-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-150"><a href="#cb270-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-151"><a href="#cb270-151" aria-hidden="true" tabindex="-1"></a>Reformat to parse experiment information type</span>
<span id="cb270-152"><a href="#cb270-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-155"><a href="#cb270-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-156"><a href="#cb270-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format and add column that reports IGT vs bag experiment</span></span>
<span id="cb270-157"><a href="#cb270-157" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb270-158"><a href="#cb270-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, <span class="fu">ends_with</span>(<span class="st">"CONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-159"><a href="#cb270-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-160"><a href="#cb270-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb270-161"><a href="#cb270-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb270-162"><a href="#cb270-162" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-163"><a href="#cb270-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-164"><a href="#cb270-164" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-165"><a href="#cb270-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-166"><a href="#cb270-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-167"><a href="#cb270-167" aria-hidden="true" tabindex="-1"></a>Factor cell count data</span>
<span id="cb270-168"><a href="#cb270-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-171"><a href="#cb270-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-172"><a href="#cb270-172" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(plot_euk_conc<span class="sc">$</span>Name)</span>
<span id="cb270-173"><a href="#cb270-173" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb270-174"><a href="#cb270-174" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb270-175"><a href="#cb270-175" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-176"><a href="#cb270-176" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-177"><a href="#cb270-177" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb270-178"><a href="#cb270-178" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb270-179"><a href="#cb270-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-180"><a href="#cb270-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-181"><a href="#cb270-181" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot eukaryote cells per ml</span></span>
<span id="cb270-182"><a href="#cb270-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-183"><a href="#cb270-183" aria-hidden="true" tabindex="-1"></a>@fig-boxplot-all reports all eukaryote cells per ml counts from all grazing assay counts..</span>
<span id="cb270-184"><a href="#cb270-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-187"><a href="#cb270-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-188"><a href="#cb270-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-all</span></span>
<span id="cb270-189"><a href="#cb270-189" aria-hidden="true" tabindex="-1"></a>conc_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_conc, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, </span>
<span id="cb270-190"><a href="#cb270-190" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">y =</span> CONCENTRATION, </span>
<span id="cb270-191"><a href="#cb270-191" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">group =</span> NameOrder,</span>
<span id="cb270-192"><a href="#cb270-192" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb270-193"><a href="#cb270-193" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb270-194"><a href="#cb270-194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb270-195"><a href="#cb270-195" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not color by time point</span></span>
<span id="cb270-196"><a href="#cb270-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE,</span>
<span id="cb270-197"><a href="#cb270-197" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb270-198"><a href="#cb270-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-199"><a href="#cb270-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb270-200"><a href="#cb270-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb270-201"><a href="#cb270-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-202"><a href="#cb270-202" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(limits = c(10,1000), expand = c(0, 0)) +</span></span>
<span id="cb270-203"><a href="#cb270-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-204"><a href="#cb270-204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb270-205"><a href="#cb270-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb270-206"><a href="#cb270-206" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-207"><a href="#cb270-207" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb270-208"><a href="#cb270-208" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb270-209"><a href="#cb270-209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb270-210"><a href="#cb270-210" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb270-211"><a href="#cb270-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-212"><a href="#cb270-212" aria-hidden="true" tabindex="-1"></a>conc_boxplot</span>
<span id="cb270-213"><a href="#cb270-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-214"><a href="#cb270-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-215"><a href="#cb270-215" aria-hidden="true" tabindex="-1"></a>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. \~300 cells/ml in background and plume compared to \~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</span>
<span id="cb270-216"><a href="#cb270-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-217"><a href="#cb270-217" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 </span><span class="sc">\*</span><span class="at"> interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</span></span>
<span id="cb270-218"><a href="#cb270-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-219"><a href="#cb270-219" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</span></span>
<span id="cb270-220"><a href="#cb270-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-221"><a href="#cb270-221" aria-hidden="true" tabindex="-1"></a>Plot eukaryote cell concentration over time.</span>
<span id="cb270-222"><a href="#cb270-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-225"><a href="#cb270-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-226"><a href="#cb270-226" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb270-227"><a href="#cb270-227" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb270-228"><a href="#cb270-228" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-229"><a href="#cb270-229" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-230"><a href="#cb270-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-231"><a href="#cb270-231" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb270-232"><a href="#cb270-232" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb270-233"><a href="#cb270-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-234"><a href="#cb270-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb270-235"><a href="#cb270-235" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb270-236"><a href="#cb270-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-237"><a href="#cb270-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-238"><a href="#cb270-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb270-239"><a href="#cb270-239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb270-240"><a href="#cb270-240" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (MEAN + SD), ymin = (MEAN - SD)), width = 0.2) +</span></span>
<span id="cb270-241"><a href="#cb270-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb270-242"><a href="#cb270-242" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb270-243"><a href="#cb270-243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-244"><a href="#cb270-244" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb270-245"><a href="#cb270-245" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-246"><a href="#cb270-246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-247"><a href="#cb270-247" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-248"><a href="#cb270-248" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-249"><a href="#cb270-249" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb270-250"><a href="#cb270-250" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb270-251"><a href="#cb270-251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>) <span class="sc">+</span></span>
<span id="cb270-252"><a href="#cb270-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">21</span>)))</span>
<span id="cb270-253"><a href="#cb270-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-254"><a href="#cb270-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-255"><a href="#cb270-255" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</span></span>
<span id="cb270-256"><a href="#cb270-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-257"><a href="#cb270-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Isolate T0 only counts for cells/ml plot</span></span>
<span id="cb270-258"><a href="#cb270-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-261"><a href="#cb270-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-262"><a href="#cb270-262" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb270-263"><a href="#cb270-263" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb270-264"><a href="#cb270-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-265"><a href="#cb270-265" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="ot">&lt;-</span> plot_euk_conc <span class="sc">%&gt;%</span></span>
<span id="cb270-266"><a href="#cb270-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span> <span class="sc">&amp;</span> (VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-267"><a href="#cb270-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteOrder, NameOrder, TimePoint, EXP_TYPE, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb270-268"><a href="#cb270-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_conc =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb270-269"><a href="#cb270-269" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM_conc =</span> (<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb270-270"><a href="#cb270-270" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-271"><a href="#cb270-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SiteOrder, NameOrder, EXP_TYPE, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-272"><a href="#cb270-272" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-273"><a href="#cb270-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-274"><a href="#cb270-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb270-275"><a href="#cb270-275" aria-hidden="true" tabindex="-1"></a>plot_euk_format<span class="sc">$</span>Site_Order <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_format<span class="sc">$</span>SiteOrder, <span class="at">levels =</span> site_fullname, <span class="at">labels =</span> site_fullname)</span>
<span id="cb270-276"><a href="#cb270-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-277"><a href="#cb270-277" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_euk_format)</span></span>
<span id="cb270-278"><a href="#cb270-278" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_format, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> avg_conc, <span class="at">fill =</span> Site_Order)) <span class="sc">+</span></span>
<span id="cb270-279"><a href="#cb270-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (avg_conc <span class="sc">+</span> SEM_conc), <span class="at">ymin =</span> (avg_conc <span class="sc">-</span> SEM_conc)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb270-280"><a href="#cb270-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Site_Order), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb270-281"><a href="#cb270-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-282"><a href="#cb270-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#de2d26"</span>)) <span class="sc">+</span></span>
<span id="cb270-283"><a href="#cb270-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-284"><a href="#cb270-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-285"><a href="#cb270-285" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-286"><a href="#cb270-286" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-287"><a href="#cb270-287" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb270-288"><a href="#cb270-288" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-289"><a href="#cb270-289" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-290"><a href="#cb270-290" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-291"><a href="#cb270-291" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-292"><a href="#cb270-292" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb270-293"><a href="#cb270-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb270-294"><a href="#cb270-294" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb270-295"><a href="#cb270-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-296"><a href="#cb270-296" aria-hidden="true" tabindex="-1"></a>euk_plot</span>
<span id="cb270-297"><a href="#cb270-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-298"><a href="#cb270-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-299"><a href="#cb270-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-300"><a href="#cb270-300" aria-hidden="true" tabindex="-1"></a>Print table of eukaryote cell count information.</span>
<span id="cb270-301"><a href="#cb270-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-304"><a href="#cb270-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-305"><a href="#cb270-305" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb270-306"><a href="#cb270-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-307"><a href="#cb270-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-308"><a href="#cb270-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-309"><a href="#cb270-309" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb270-310"><a href="#cb270-310" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb270-311"><a href="#cb270-311" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb270-312"><a href="#cb270-312" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-313"><a href="#cb270-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb270-314"><a href="#cb270-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb270-315"><a href="#cb270-315" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb270-316"><a href="#cb270-316" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb270-317"><a href="#cb270-317" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span>
<span id="cb270-318"><a href="#cb270-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-319"><a href="#cb270-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-322"><a href="#cb270-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-323"><a href="#cb270-323" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs")</span></span>
<span id="cb270-324"><a href="#cb270-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-325"><a href="#cb270-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-326"><a href="#cb270-326" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bacteria &amp; archaea cell counts</span></span>
<span id="cb270-327"><a href="#cb270-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-328"><a href="#cb270-328" aria-hidden="true" tabindex="-1"></a>DAPI slide counts from prokaryotes from same sites. Import and compare.</span>
<span id="cb270-329"><a href="#cb270-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-332"><a href="#cb270-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-333"><a href="#cb270-333" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb270-334"><a href="#cb270-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-335"><a href="#cb270-335" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb270-336"><a href="#cb270-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-337"><a href="#cb270-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-338"><a href="#cb270-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb270-339"><a href="#cb270-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb270-340"><a href="#cb270-340" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb270-341"><a href="#cb270-341" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb270-342"><a href="#cb270-342" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-343"><a href="#cb270-343" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-344"><a href="#cb270-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-345"><a href="#cb270-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-346"><a href="#cb270-346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cells per ml (prok)</span></span>
<span id="cb270-347"><a href="#cb270-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-348"><a href="#cb270-348" aria-hidden="true" tabindex="-1"></a>Visualize counts</span>
<span id="cb270-349"><a href="#cb270-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-350"><a href="#cb270-350" aria-hidden="true" tabindex="-1"></a>Factor site names, etc.</span>
<span id="cb270-351"><a href="#cb270-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-354"><a href="#cb270-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-355"><a href="#cb270-355" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>, <span class="st">"HotChimlet1"</span>, <span class="st">"ShrimpGulley"</span>, <span class="st">"SouthofHotChimlet"</span>, <span class="st">"SouthofLungSnack"</span>, <span class="st">"ArrowLoop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Rav1"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb270-356"><a href="#cb270-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-357"><a href="#cb270-357" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-358"><a href="#cb270-358" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-359"><a href="#cb270-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-360"><a href="#cb270-360" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb270-361"><a href="#cb270-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-362"><a href="#cb270-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-365"><a href="#cb270-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-366"><a href="#cb270-366" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb270-367"><a href="#cb270-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb270-368"><a href="#cb270-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb270-369"><a href="#cb270-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-370"><a href="#cb270-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb270-371"><a href="#cb270-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb270-372"><a href="#cb270-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-373"><a href="#cb270-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-374"><a href="#cb270-374" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-375"><a href="#cb270-375" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-376"><a href="#cb270-376" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-377"><a href="#cb270-377" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb270-378"><a href="#cb270-378" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-379"><a href="#cb270-379" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-380"><a href="#cb270-380" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-381"><a href="#cb270-381" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-382"><a href="#cb270-382" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb270-383"><a href="#cb270-383" aria-hidden="true" tabindex="-1"></a>prok_plot</span>
<span id="cb270-384"><a href="#cb270-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-385"><a href="#cb270-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-386"><a href="#cb270-386" aria-hidden="true" tabindex="-1"></a><span class="fu">### Euk and prok counts</span></span>
<span id="cb270-387"><a href="#cb270-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-388"><a href="#cb270-388" aria-hidden="true" tabindex="-1"></a>Combined eukaryote and prokaryote cell counts</span>
<span id="cb270-391"><a href="#cb270-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-392"><a href="#cb270-392" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="sc">+</span> prok_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb270-393"><a href="#cb270-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-394"><a href="#cb270-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-395"><a href="#cb270-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-396"><a href="#cb270-396" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combine with previous MCR cell counts</span></span>
<span id="cb270-397"><a href="#cb270-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-398"><a href="#cb270-398" aria-hidden="true" tabindex="-1"></a>Compare *in situ* prokaryote cell counts from 2020 to previous years</span>
<span id="cb270-399"><a href="#cb270-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-402"><a href="#cb270-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-403"><a href="#cb270-403" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb270-404"><a href="#cb270-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-405"><a href="#cb270-405" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb270-406"><a href="#cb270-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-407"><a href="#cb270-407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb270-408"><a href="#cb270-408" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb270-409"><a href="#cb270-409" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb270-410"><a href="#cb270-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb270-411"><a href="#cb270-411" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb270-412"><a href="#cb270-412" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb270-413"><a href="#cb270-413" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb270-414"><a href="#cb270-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-415"><a href="#cb270-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span>
<span id="cb270-416"><a href="#cb270-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-417"><a href="#cb270-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-418"><a href="#cb270-418" aria-hidden="true" tabindex="-1"></a>Re-import 2020 data to compare.</span>
<span id="cb270-419"><a href="#cb270-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-422"><a href="#cb270-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-423"><a href="#cb270-423" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb270-424"><a href="#cb270-424" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb270-425"><a href="#cb270-425" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb270-426"><a href="#cb270-426" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb270-427"><a href="#cb270-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-428"><a href="#cb270-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-429"><a href="#cb270-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb270-430"><a href="#cb270-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-431"><a href="#cb270-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-432"><a href="#cb270-432" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb270-433"><a href="#cb270-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-434"><a href="#cb270-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-435"><a href="#cb270-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-436"><a href="#cb270-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-437"><a href="#cb270-437" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-438"><a href="#cb270-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-439"><a href="#cb270-439" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb270-440"><a href="#cb270-440" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb270-441"><a href="#cb270-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-442"><a href="#cb270-442" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb270-443"><a href="#cb270-443" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb270-444"><a href="#cb270-444" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb270-445"><a href="#cb270-445" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span>
<span id="cb270-446"><a href="#cb270-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-447"><a href="#cb270-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-448"><a href="#cb270-448" aria-hidden="true" tabindex="-1"></a>Plot by year.</span>
<span id="cb270-449"><a href="#cb270-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-452"><a href="#cb270-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-453"><a href="#cb270-453" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb270-454"><a href="#cb270-454" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb270-455"><a href="#cb270-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb270-456"><a href="#cb270-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb270-457"><a href="#cb270-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb270-458"><a href="#cb270-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-459"><a href="#cb270-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-460"><a href="#cb270-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb270-461"><a href="#cb270-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb270-462"><a href="#cb270-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb270-463"><a href="#cb270-463" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-464"><a href="#cb270-464" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb270-465"><a href="#cb270-465" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-466"><a href="#cb270-466" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb270-467"><a href="#cb270-467" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-468"><a href="#cb270-468" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb270-469"><a href="#cb270-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb270-470"><a href="#cb270-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span>
<span id="cb270-471"><a href="#cb270-471" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb270-472"><a href="#cb270-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-473"><a href="#cb270-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-474"><a href="#cb270-474" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimate grazing effect</span></span>
<span id="cb270-475"><a href="#cb270-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-476"><a href="#cb270-476" aria-hidden="true" tabindex="-1"></a>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</span>
<span id="cb270-477"><a href="#cb270-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-480"><a href="#cb270-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-481"><a href="#cb270-481" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb270-482"><a href="#cb270-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-483"><a href="#cb270-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-484"><a href="#cb270-484" aria-hidden="true" tabindex="-1"></a><span class="fu">## Determine FLP per euk cell</span></span>
<span id="cb270-485"><a href="#cb270-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-486"><a href="#cb270-486" aria-hidden="true" tabindex="-1"></a>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <span class="in">`counts_occur`</span> data frame from above.</span>
<span id="cb270-487"><a href="#cb270-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-490"><a href="#cb270-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-491"><a href="#cb270-491" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb270-492"><a href="#cb270-492" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb270-493"><a href="#cb270-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-494"><a href="#cb270-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-495"><a href="#cb270-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb270-496"><a href="#cb270-496" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb270-497"><a href="#cb270-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-498"><a href="#cb270-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-499"><a href="#cb270-499" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb270-500"><a href="#cb270-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-501"><a href="#cb270-501" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-502"><a href="#cb270-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-503"><a href="#cb270-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-504"><a href="#cb270-504" aria-hidden="true" tabindex="-1"></a>*optional gut check of data table modification*</span>
<span id="cb270-505"><a href="#cb270-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-508"><a href="#cb270-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-509"><a href="#cb270-509" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb270-510"><a href="#cb270-510" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb270-511"><a href="#cb270-511" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb270-512"><a href="#cb270-512" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb270-513"><a href="#cb270-513" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb270-514"><a href="#cb270-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-515"><a href="#cb270-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-516"><a href="#cb270-516" aria-hidden="true" tabindex="-1"></a>Isolate counts that are <span class="sc">\&gt;</span>0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</span>
<span id="cb270-517"><a href="#cb270-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-520"><a href="#cb270-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-521"><a href="#cb270-521" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb270-522"><a href="#cb270-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb270-523"><a href="#cb270-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-524"><a href="#cb270-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-525"><a href="#cb270-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-526"><a href="#cb270-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-527"><a href="#cb270-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-528"><a href="#cb270-528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb270-529"><a href="#cb270-529" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb270-530"><a href="#cb270-530" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-531"><a href="#cb270-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-532"><a href="#cb270-532" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb270-533"><a href="#cb270-533" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-534"><a href="#cb270-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-535"><a href="#cb270-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb270-536"><a href="#cb270-536" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb270-537"><a href="#cb270-537" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-538"><a href="#cb270-538" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-539"><a href="#cb270-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-540"><a href="#cb270-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-541"><a href="#cb270-541" aria-hidden="true" tabindex="-1"></a>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</span>
<span id="cb270-542"><a href="#cb270-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-543"><a href="#cb270-543" aria-hidden="true" tabindex="-1"></a>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</span>
<span id="cb270-544"><a href="#cb270-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-545"><a href="#cb270-545" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Below code repeats process and compiles with other FLP/euk cell data.</span></span>
<span id="cb270-546"><a href="#cb270-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-547"><a href="#cb270-547" aria-hidden="true" tabindex="-1"></a>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</span>
<span id="cb270-548"><a href="#cb270-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-551"><a href="#cb270-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-552"><a href="#cb270-552" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb270-553"><a href="#cb270-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb270-554"><a href="#cb270-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-555"><a href="#cb270-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb270-556"><a href="#cb270-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb270-557"><a href="#cb270-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-558"><a href="#cb270-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-559"><a href="#cb270-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-560"><a href="#cb270-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-561"><a href="#cb270-561" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb270-562"><a href="#cb270-562" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb270-563"><a href="#cb270-563" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-564"><a href="#cb270-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-565"><a href="#cb270-565" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb270-566"><a href="#cb270-566" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-567"><a href="#cb270-567" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb270-568"><a href="#cb270-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-569"><a href="#cb270-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb270-570"><a href="#cb270-570" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-571"><a href="#cb270-571" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb270-572"><a href="#cb270-572" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb270-573"><a href="#cb270-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb270-574"><a href="#cb270-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb270-575"><a href="#cb270-575" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-576"><a href="#cb270-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-577"><a href="#cb270-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-578"><a href="#cb270-578" aria-hidden="true" tabindex="-1"></a>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</span>
<span id="cb270-579"><a href="#cb270-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-582"><a href="#cb270-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-583"><a href="#cb270-583" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb270-584"><a href="#cb270-584" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb270-585"><a href="#cb270-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb270-586"><a href="#cb270-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb270-587"><a href="#cb270-587" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb270-588"><a href="#cb270-588" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb270-589"><a href="#cb270-589" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-590"><a href="#cb270-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb270-591"><a href="#cb270-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb270-592"><a href="#cb270-592" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-593"><a href="#cb270-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-594"><a href="#cb270-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-595"><a href="#cb270-595" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate FLP per euk cell calculation</span></span>
<span id="cb270-596"><a href="#cb270-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-597"><a href="#cb270-597" aria-hidden="true" tabindex="-1"></a>First need to import and compile with metadata to get exact timing of experiments.</span>
<span id="cb270-598"><a href="#cb270-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-601"><a href="#cb270-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-602"><a href="#cb270-602" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb270-603"><a href="#cb270-603" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span>
<span id="cb270-604"><a href="#cb270-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-605"><a href="#cb270-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-606"><a href="#cb270-606" aria-hidden="true" tabindex="-1"></a>Add metadata</span>
<span id="cb270-607"><a href="#cb270-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-610"><a href="#cb270-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-611"><a href="#cb270-611" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb270-612"><a href="#cb270-612" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb270-613"><a href="#cb270-613" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, include them as replicates!</span></span>
<span id="cb270-614"><a href="#cb270-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb270-615"><a href="#cb270-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb270-616"><a href="#cb270-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb270-617"><a href="#cb270-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-618"><a href="#cb270-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-619"><a href="#cb270-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-620"><a href="#cb270-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-621"><a href="#cb270-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-622"><a href="#cb270-622" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb270-623"><a href="#cb270-623" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb270-624"><a href="#cb270-624" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb270-625"><a href="#cb270-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-626"><a href="#cb270-626" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb270-627"><a href="#cb270-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb270-628"><a href="#cb270-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-629"><a href="#cb270-629" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-630"><a href="#cb270-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-631"><a href="#cb270-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-632"><a href="#cb270-632" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; COLS: Timepoint, Minutes = time point label, actual incubated minutes</span></span>
<span id="cb270-633"><a href="#cb270-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-634"><a href="#cb270-634" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</span></span>
<span id="cb270-635"><a href="#cb270-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-636"><a href="#cb270-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate linear regression to obtain slope</span></span>
<span id="cb270-637"><a href="#cb270-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-638"><a href="#cb270-638" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`lm()`</span> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</span>
<span id="cb270-639"><a href="#cb270-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-640"><a href="#cb270-640" aria-hidden="true" tabindex="-1"></a>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</span>
<span id="cb270-641"><a href="#cb270-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-644"><a href="#cb270-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-645"><a href="#cb270-645" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb270-646"><a href="#cb270-646" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb270-647"><a href="#cb270-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-648"><a href="#cb270-648" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb270-649"><a href="#cb270-649" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb270-650"><a href="#cb270-650" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP, -SizeFrac) %&gt;%</span></span>
<span id="cb270-651"><a href="#cb270-651" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb270-652"><a href="#cb270-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-653"><a href="#cb270-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-654"><a href="#cb270-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb270-655"><a href="#cb270-655" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-656"><a href="#cb270-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb270-657"><a href="#cb270-657" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) %&gt;%</span></span>
<span id="cb270-658"><a href="#cb270-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb270-659"><a href="#cb270-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb270-660"><a href="#cb270-660" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-661"><a href="#cb270-661" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb270-662"><a href="#cb270-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb270-663"><a href="#cb270-663" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"REP"</span>,</span>
<span id="cb270-664"><a href="#cb270-664" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb270-665"><a href="#cb270-665" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb270-666"><a href="#cb270-666" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb270-667"><a href="#cb270-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-668"><a href="#cb270-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb270-669"><a href="#cb270-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb270-670"><a href="#cb270-670" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-671"><a href="#cb270-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb270-672"><a href="#cb270-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb270-673"><a href="#cb270-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb270-674"><a href="#cb270-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb270-675"><a href="#cb270-675" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-676"><a href="#cb270-676" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb270-677"><a href="#cb270-677" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb270-678"><a href="#cb270-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb270-679"><a href="#cb270-679" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-680"><a href="#cb270-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-681"><a href="#cb270-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-682"><a href="#cb270-682" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</span></span>
<span id="cb270-683"><a href="#cb270-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-684"><a href="#cb270-684" aria-hidden="true" tabindex="-1"></a>Apply to all data to obtain slope.</span>
<span id="cb270-685"><a href="#cb270-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-688"><a href="#cb270-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-689"><a href="#cb270-689" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span>
<span id="cb270-690"><a href="#cb270-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-691"><a href="#cb270-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-692"><a href="#cb270-692" aria-hidden="true" tabindex="-1"></a>*gut check* linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <span class="in">`nest()`</span> capability of tidyverse. Below, one experiment is subset to check the value.</span>
<span id="cb270-693"><a href="#cb270-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-696"><a href="#cb270-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-697"><a href="#cb270-697" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb270-698"><a href="#cb270-698" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb270-699"><a href="#cb270-699" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb270-700"><a href="#cb270-700" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb270-701"><a href="#cb270-701" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb270-702"><a href="#cb270-702" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb270-703"><a href="#cb270-703" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb270-704"><a href="#cb270-704" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb270-705"><a href="#cb270-705" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb270-706"><a href="#cb270-706" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span>
<span id="cb270-707"><a href="#cb270-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-708"><a href="#cb270-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-709"><a href="#cb270-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot linear regression trend</span></span>
<span id="cb270-710"><a href="#cb270-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-711"><a href="#cb270-711" aria-hidden="true" tabindex="-1"></a>Plot all bag experiments with estimated slope.</span>
<span id="cb270-712"><a href="#cb270-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-715"><a href="#cb270-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-716"><a href="#cb270-716" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb270-717"><a href="#cb270-717" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb270-718"><a href="#cb270-718" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb270-719"><a href="#cb270-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-720"><a href="#cb270-720" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out IGT samples for now</span></span>
<span id="cb270-721"><a href="#cb270-721" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;%</span></span>
<span id="cb270-722"><a href="#cb270-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-723"><a href="#cb270-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Site, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb270-724"><a href="#cb270-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb270-725"><a href="#cb270-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb270-726"><a href="#cb270-726" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> Site)) <span class="sc">+</span></span>
<span id="cb270-727"><a href="#cb270-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-728"><a href="#cb270-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb270-729"><a href="#cb270-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb270-730"><a href="#cb270-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb270-731"><a href="#cb270-731" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb270-732"><a href="#cb270-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb270-733"><a href="#cb270-733" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb270-734"><a href="#cb270-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb270-735"><a href="#cb270-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-736"><a href="#cb270-736" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb270-737"><a href="#cb270-737" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-738"><a href="#cb270-738" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb270-739"><a href="#cb270-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-740"><a href="#cb270-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-741"><a href="#cb270-741" aria-hidden="true" tabindex="-1"></a>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</span>
<span id="cb270-742"><a href="#cb270-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-743"><a href="#cb270-743" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remove IGT Tf time points.</span></span>
<span id="cb270-744"><a href="#cb270-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-745"><a href="#cb270-745" aria-hidden="true" tabindex="-1"></a>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</span>
<span id="cb270-746"><a href="#cb270-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-749"><a href="#cb270-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-750"><a href="#cb270-750" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb270-751"><a href="#cb270-751" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb270-752"><a href="#cb270-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-753"><a href="#cb270-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-754"><a href="#cb270-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-755"><a href="#cb270-755" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-756"><a href="#cb270-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-757"><a href="#cb270-757" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb270-758"><a href="#cb270-758" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span>
<span id="cb270-759"><a href="#cb270-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-760"><a href="#cb270-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-761"><a href="#cb270-761" aria-hidden="true" tabindex="-1"></a>Plot IGT grazing experiments with newly calculated grazing effect.</span>
<span id="cb270-762"><a href="#cb270-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-765"><a href="#cb270-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-766"><a href="#cb270-766" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb270-767"><a href="#cb270-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb270-768"><a href="#cb270-768" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb270-769"><a href="#cb270-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-770"><a href="#cb270-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Site, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb270-771"><a href="#cb270-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb270-772"><a href="#cb270-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb270-773"><a href="#cb270-773" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> Site)) <span class="sc">+</span></span>
<span id="cb270-774"><a href="#cb270-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-775"><a href="#cb270-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb270-776"><a href="#cb270-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb270-777"><a href="#cb270-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb270-778"><a href="#cb270-778" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb270-779"><a href="#cb270-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb270-780"><a href="#cb270-780" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb270-781"><a href="#cb270-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb270-782"><a href="#cb270-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-783"><a href="#cb270-783" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb270-784"><a href="#cb270-784" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-785"><a href="#cb270-785" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb270-786"><a href="#cb270-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-787"><a href="#cb270-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-788"><a href="#cb270-788" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; results are more consistent across experiments.</span></span>
<span id="cb270-789"><a href="#cb270-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-790"><a href="#cb270-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile and save grazing experiment results</span></span>
<span id="cb270-791"><a href="#cb270-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-794"><a href="#cb270-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-795"><a href="#cb270-795" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb270-796"><a href="#cb270-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-797"><a href="#cb270-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-798"><a href="#cb270-798" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-799"><a href="#cb270-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-800"><a href="#cb270-800" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb270-801"><a href="#cb270-801" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb270-802"><a href="#cb270-802" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb270-803"><a href="#cb270-803" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-804"><a href="#cb270-804" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-805"><a href="#cb270-805" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb270-806"><a href="#cb270-806" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb270-807"><a href="#cb270-807" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb270-808"><a href="#cb270-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-809"><a href="#cb270-809" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb270-810"><a href="#cb270-810" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span>
<span id="cb270-811"><a href="#cb270-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-812"><a href="#cb270-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-813"><a href="#cb270-813" aria-hidden="true" tabindex="-1"></a><span class="fu"># Check FLP control experiments</span></span>
<span id="cb270-814"><a href="#cb270-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-815"><a href="#cb270-815" aria-hidden="true" tabindex="-1"></a>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</span>
<span id="cb270-816"><a href="#cb270-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-819"><a href="#cb270-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-820"><a href="#cb270-820" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb270-821"><a href="#cb270-821" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb270-822"><a href="#cb270-822" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb270-823"><a href="#cb270-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-824"><a href="#cb270-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-825"><a href="#cb270-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-826"><a href="#cb270-826" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-827"><a href="#cb270-827" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb270-828"><a href="#cb270-828" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb270-829"><a href="#cb270-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-830"><a href="#cb270-830" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb270-831"><a href="#cb270-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb270-832"><a href="#cb270-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-833"><a href="#cb270-833" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-834"><a href="#cb270-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-835"><a href="#cb270-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-836"><a href="#cb270-836" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bag grazing experiment controls</span></span>
<span id="cb270-837"><a href="#cb270-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-840"><a href="#cb270-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-841"><a href="#cb270-841" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb270-842"><a href="#cb270-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-843"><a href="#cb270-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb270-844"><a href="#cb270-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb270-845"><a href="#cb270-845" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb270-846"><a href="#cb270-846" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb270-847"><a href="#cb270-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb270-848"><a href="#cb270-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb270-849"><a href="#cb270-849" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb270-850"><a href="#cb270-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb270-851"><a href="#cb270-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-852"><a href="#cb270-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-853"><a href="#cb270-853" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-854"><a href="#cb270-854" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb270-855"><a href="#cb270-855" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb270-856"><a href="#cb270-856" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb270-857"><a href="#cb270-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb270-858"><a href="#cb270-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-859"><a href="#cb270-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-860"><a href="#cb270-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## IGT experiment controls</span></span>
<span id="cb270-861"><a href="#cb270-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-862"><a href="#cb270-862" aria-hidden="true" tabindex="-1"></a>Repeat for IGT experiments.</span>
<span id="cb270-863"><a href="#cb270-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-866"><a href="#cb270-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-867"><a href="#cb270-867" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb270-868"><a href="#cb270-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-869"><a href="#cb270-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb270-870"><a href="#cb270-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb270-871"><a href="#cb270-871" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb270-872"><a href="#cb270-872" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb270-873"><a href="#cb270-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb270-874"><a href="#cb270-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb270-875"><a href="#cb270-875" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb270-876"><a href="#cb270-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb270-877"><a href="#cb270-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-878"><a href="#cb270-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-879"><a href="#cb270-879" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-880"><a href="#cb270-880" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb270-881"><a href="#cb270-881" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb270-882"><a href="#cb270-882" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb270-883"><a href="#cb270-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb270-884"><a href="#cb270-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-885"><a href="#cb270-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-886"><a href="#cb270-886" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate complete table with grazing rates and values</span></span>
<span id="cb270-887"><a href="#cb270-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-890"><a href="#cb270-890" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-891"><a href="#cb270-891" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb270-892"><a href="#cb270-892" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb270-893"><a href="#cb270-893" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb270-894"><a href="#cb270-894" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb270-895"><a href="#cb270-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-896"><a href="#cb270-896" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb270-897"><a href="#cb270-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-898"><a href="#cb270-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, <span class="at">Site=</span>SiteOrder, <span class="at">Name=</span>NameOrder, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb270-899"><a href="#cb270-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-900"><a href="#cb270-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb270-901"><a href="#cb270-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-902"><a href="#cb270-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb270-903"><a href="#cb270-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-904"><a href="#cb270-904" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb270-905"><a href="#cb270-905" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb270-906"><a href="#cb270-906" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb270-907"><a href="#cb270-907" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-908"><a href="#cb270-908" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb270-909"><a href="#cb270-909" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb270-910"><a href="#cb270-910" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb270-911"><a href="#cb270-911" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Bag"</span></span>
<span id="cb270-912"><a href="#cb270-912" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-913"><a href="#cb270-913" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-914"><a href="#cb270-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-915"><a href="#cb270-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-916"><a href="#cb270-916" aria-hidden="true" tabindex="-1"></a>Amend table with estimated FLP concentration</span>
<span id="cb270-917"><a href="#cb270-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-920"><a href="#cb270-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-921"><a href="#cb270-921" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb270-922"><a href="#cb270-922" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb270-923"><a href="#cb270-923" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb270-924"><a href="#cb270-924" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb270-925"><a href="#cb270-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-926"><a href="#cb270-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-927"><a href="#cb270-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb270-928"><a href="#cb270-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb270-929"><a href="#cb270-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-930"><a href="#cb270-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_conc =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb270-931"><a href="#cb270-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-932"><a href="#cb270-932" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-933"><a href="#cb270-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-934"><a href="#cb270-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-935"><a href="#cb270-935" aria-hidden="true" tabindex="-1"></a>Introduce factors in table for visualizations</span>
<span id="cb270-936"><a href="#cb270-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-939"><a href="#cb270-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-940"><a href="#cb270-940" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb270-941"><a href="#cb270-941" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb270-942"><a href="#cb270-942" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb270-943"><a href="#cb270-943" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb270-944"><a href="#cb270-944" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-945"><a href="#cb270-945" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-946"><a href="#cb270-946" aria-hidden="true" tabindex="-1"></a>vent_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#0868ac"</span>, <span class="st">"#41ab5d"</span>, <span class="st">"#e7298a"</span>, <span class="st">"#c994c7"</span>, <span class="st">"#fc4e2a"</span>, <span class="st">"#fed976"</span>, <span class="st">"#6a51a3"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#a1d99b"</span>)</span>
<span id="cb270-947"><a href="#cb270-947" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vent_colors) <span class="ot">&lt;-</span> vent_fullname</span>
<span id="cb270-948"><a href="#cb270-948" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>NAME <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_fullname)</span>
<span id="cb270-949"><a href="#cb270-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-950"><a href="#cb270-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-951"><a href="#cb270-951" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot FLP/grazer /minute</span></span>
<span id="cb270-952"><a href="#cb270-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-955"><a href="#cb270-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-956"><a href="#cb270-956" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb270-957"><a href="#cb270-957" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb270-958"><a href="#cb270-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> NAME, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb270-959"><a href="#cb270-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELD),</span>
<span id="cb270-960"><a href="#cb270-960" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb270-961"><a href="#cb270-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-962"><a href="#cb270-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb270-963"><a href="#cb270-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-964"><a href="#cb270-964" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb270-965"><a href="#cb270-965" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-966"><a href="#cb270-966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-967"><a href="#cb270-967" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-968"><a href="#cb270-968" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-969"><a href="#cb270-969" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb270-970"><a href="#cb270-970" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-971"><a href="#cb270-971" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-972"><a href="#cb270-972" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-973"><a href="#cb270-973" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-974"><a href="#cb270-974" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb270-975"><a href="#cb270-975" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb270-976"><a href="#cb270-976" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb270-977"><a href="#cb270-977" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb270-978"><a href="#cb270-978" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb270-979"><a href="#cb270-979" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span>
<span id="cb270-980"><a href="#cb270-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-981"><a href="#cb270-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-982"><a href="#cb270-982" aria-hidden="true" tabindex="-1"></a>Amend table with eukaryote and prokaryote estimated biomass.</span>
<span id="cb270-983"><a href="#cb270-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-986"><a href="#cb270-986" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-987"><a href="#cb270-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb270-988"><a href="#cb270-988" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb270-989"><a href="#cb270-989" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb270-990"><a href="#cb270-990" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb270-991"><a href="#cb270-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-992"><a href="#cb270-992" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to master table with data</span></span>
<span id="cb270-993"><a href="#cb270-993" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb270-994"><a href="#cb270-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Prok_conc =</span> MEAN, <span class="at">Prok_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb270-995"><a href="#cb270-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp) <span class="sc">%&gt;%</span> </span>
<span id="cb270-996"><a href="#cb270-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prok_conc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Prok_conc), avg_insitu, Prok_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-997"><a href="#cb270-997" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-998"><a href="#cb270-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-999"><a href="#cb270-999" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb270-1000"><a href="#cb270-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Name =</span> NameOrder, <span class="at">FIELD =</span> SiteOrder, <span class="at">euk_conc =</span> avg_conc, EXP_TYPE, <span class="at">euk_conc_sem =</span> SEM_conc) <span class="sc">%&gt;%</span></span>
<span id="cb270-1001"><a href="#cb270-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp_wprok) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1002"><a href="#cb270-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> Name, <span class="at">EXP =</span> EXP_TYPE, <span class="at">SAMPLE =</span> Site, <span class="at">RATE_min =</span> GRAZE_RATE, <span class="at">FLP_ml =</span> FLP_conc, <span class="at">PROK_ml =</span> Prok_conc, <span class="at">PROK_sem =</span> Prok_sem, <span class="at">EUK_ml =</span> euk_conc, <span class="at">EUK_sem =</span> euk_conc_sem, TimePoints, EXP_REPS, EXP_VOL,  CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span></span>
<span id="cb270-1003"><a href="#cb270-1003" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1004"><a href="#cb270-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1005"><a href="#cb270-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1006"><a href="#cb270-1006" aria-hidden="true" tabindex="-1"></a>Description of variables above:</span>
<span id="cb270-1007"><a href="#cb270-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1008"><a href="#cb270-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FIELD - vent location</span>
<span id="cb270-1009"><a href="#cb270-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NAME - name of vent site, or plume/background</span>
<span id="cb270-1010"><a href="#cb270-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>EXP - experiment type, bag or IGT</span>
<span id="cb270-1011"><a href="#cb270-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SAMPLE - vent site</span>
<span id="cb270-1012"><a href="#cb270-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_MIN - FLPs per grazer per minute (SLOPE of best fitline)</span>
<span id="cb270-1013"><a href="#cb270-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FLP_ml - FLP concentration at T0</span>
<span id="cb270-1014"><a href="#cb270-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</span>
<span id="cb270-1015"><a href="#cb270-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</span>
<span id="cb270-1016"><a href="#cb270-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1017"><a href="#cb270-1017" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grazing rate calculations</span></span>
<span id="cb270-1018"><a href="#cb270-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1019"><a href="#cb270-1019" aria-hidden="true" tabindex="-1"></a>Based on Unrein et al. 2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</span>
<span id="cb270-1020"><a href="#cb270-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1023"><a href="#cb270-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1024"><a href="#cb270-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_grazerate_wflp_wprok_weuk)</span>
<span id="cb270-1025"><a href="#cb270-1025" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb270-1026"><a href="#cb270-1026" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb270-1027"><a href="#cb270-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_min <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb270-1028"><a href="#cb270-1028" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb270-1029"><a href="#cb270-1029" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb270-1030"><a href="#cb270-1030" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb270-1031"><a href="#cb270-1031" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb270-1032"><a href="#cb270-1032" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb270-1033"><a href="#cb270-1033" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb270-1034"><a href="#cb270-1034" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb270-1035"><a href="#cb270-1035" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb270-1036"><a href="#cb270-1036" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb270-1037"><a href="#cb270-1037" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb270-1038"><a href="#cb270-1038" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb270-1039"><a href="#cb270-1039" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb270-1040"><a href="#cb270-1040" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb270-1041"><a href="#cb270-1041" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb270-1042"><a href="#cb270-1042" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb270-1043"><a href="#cb270-1043" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb270-1044"><a href="#cb270-1044" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb270-1045"><a href="#cb270-1045" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb270-1046"><a href="#cb270-1046" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb270-1047"><a href="#cb270-1047" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb270-1048"><a href="#cb270-1048" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1049"><a href="#cb270-1049" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1050"><a href="#cb270-1050" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span>
<span id="cb270-1051"><a href="#cb270-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1052"><a href="#cb270-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1053"><a href="#cb270-1053" aria-hidden="true" tabindex="-1"></a>Explanation of units for table with calculated values.</span>
<span id="cb270-1054"><a href="#cb270-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1055"><a href="#cb270-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_min &amp; RATE_hr = Grazing rate as 'FLPs per grazer per minute' and per hour</span>
<span id="cb270-1056"><a href="#cb270-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1057"><a href="#cb270-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CLEARANCE_RATE = ml or nL per grazer per hour</span>
<span id="cb270-1058"><a href="#cb270-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1059"><a href="#cb270-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</span>
<span id="cb270-1060"><a href="#cb270-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1061"><a href="#cb270-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GRAZING EFFECT = bacteria per ml per hour</span>
<span id="cb270-1062"><a href="#cb270-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1063"><a href="#cb270-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bacterial turnover rate = % per day</span>
<span id="cb270-1064"><a href="#cb270-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1065"><a href="#cb270-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">### gt table options</span></span>
<span id="cb270-1066"><a href="#cb270-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1069"><a href="#cb270-1069" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1070"><a href="#cb270-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table_wcalcs)</span>
<span id="cb270-1071"><a href="#cb270-1071" aria-hidden="true" tabindex="-1"></a>bkgd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>, <span class="st">"Plume"</span>)</span>
<span id="cb270-1072"><a href="#cb270-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1073"><a href="#cb270-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb270-1074"><a href="#cb270-1074" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb270-1075"><a href="#cb270-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb270-1076"><a href="#cb270-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb270-1077"><a href="#cb270-1077" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb270-1078"><a href="#cb270-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb270-1079"><a href="#cb270-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb270-1080"><a href="#cb270-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb270-1081"><a href="#cb270-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb270-1082"><a href="#cb270-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb270-1083"><a href="#cb270-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb270-1084"><a href="#cb270-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb270-1085"><a href="#cb270-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1086"><a href="#cb270-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1087"><a href="#cb270-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1088"><a href="#cb270-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1089"><a href="#cb270-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb270-1090"><a href="#cb270-1090" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1091"><a href="#cb270-1091" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1092"><a href="#cb270-1092" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1093"><a href="#cb270-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1094"><a href="#cb270-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1095"><a href="#cb270-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1096"><a href="#cb270-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1097"><a href="#cb270-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1098"><a href="#cb270-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1099"><a href="#cb270-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1100"><a href="#cb270-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1101"><a href="#cb270-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb270-1102"><a href="#cb270-1102" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb270-1103"><a href="#cb270-1103" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1104"><a href="#cb270-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb270-1105"><a href="#cb270-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb270-1106"><a href="#cb270-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb270-1107"><a href="#cb270-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb270-1108"><a href="#cb270-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb270-1109"><a href="#cb270-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb270-1110"><a href="#cb270-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1111"><a href="#cb270-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb270-1112"><a href="#cb270-1112" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb270-1113"><a href="#cb270-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb270-1114"><a href="#cb270-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1115"><a href="#cb270-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb270-1116"><a href="#cb270-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb270-1117"><a href="#cb270-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb270-1118"><a href="#cb270-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1119"><a href="#cb270-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb270-1120"><a href="#cb270-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb270-1121"><a href="#cb270-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb270-1122"><a href="#cb270-1122" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1123"><a href="#cb270-1123" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb270-1124"><a href="#cb270-1124" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb270-1125"><a href="#cb270-1125" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb270-1126"><a href="#cb270-1126" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1127"><a href="#cb270-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb270-1128"><a href="#cb270-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb270-1129"><a href="#cb270-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb270-1130"><a href="#cb270-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb270-1131"><a href="#cb270-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb270-1132"><a href="#cb270-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb270-1133"><a href="#cb270-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb270-1134"><a href="#cb270-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb270-1135"><a href="#cb270-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb270-1136"><a href="#cb270-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb270-1137"><a href="#cb270-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb270-1138"><a href="#cb270-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb270-1139"><a href="#cb270-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span>
<span id="cb270-1140"><a href="#cb270-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1141"><a href="#cb270-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1142"><a href="#cb270-1142" aria-hidden="true" tabindex="-1"></a>Table S1 - grazing experiment information only</span>
<span id="cb270-1143"><a href="#cb270-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1146"><a href="#cb270-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1147"><a href="#cb270-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim((table_wcalcs %&gt;% </span></span>
<span id="cb270-1148"><a href="#cb270-1148" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(FIELD, NAME, EXP, SAMPLE, TimePoints, starts_with("EXP_"), starts_with("CTRL_"), RATE_min)), file = "output-data/tables1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb270-1149"><a href="#cb270-1149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1150"><a href="#cb270-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1151"><a href="#cb270-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Carbon biomass</span></span>
<span id="cb270-1152"><a href="#cb270-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1153"><a href="#cb270-1153" aria-hidden="true" tabindex="-1"></a>References for estimating biovolume *Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al. (2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782--792.*</span>
<span id="cb270-1154"><a href="#cb270-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1157"><a href="#cb270-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1158"><a href="#cb270-1158" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb270-1159"><a href="#cb270-1159" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb270-1160"><a href="#cb270-1160" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biov)</span>
<span id="cb270-1161"><a href="#cb270-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1162"><a href="#cb270-1162" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate volume</span></span>
<span id="cb270-1163"><a href="#cb270-1163" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb270-1164"><a href="#cb270-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SizeFrac =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1165"><a href="#cb270-1165" aria-hidden="true" tabindex="-1"></a>    h <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"micro"</span>,</span>
<span id="cb270-1166"><a href="#cb270-1166" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nano"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1167"><a href="#cb270-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Volume =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> d)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb270-1168"><a href="#cb270-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (Volume<span class="sc">^</span><span class="fl">0.939</span>))) <span class="sc">%&gt;%</span> <span class="co"># Calculate Cell biomass in pg C per cell # Menden-Deuer and Lessard 2000</span></span>
<span id="cb270-1169"><a href="#cb270-1169" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1170"><a href="#cb270-1170" aria-hidden="true" tabindex="-1"></a><span class="co"># View(biov_calc)</span></span>
<span id="cb270-1171"><a href="#cb270-1171" aria-hidden="true" tabindex="-1"></a>biov_calc</span>
<span id="cb270-1172"><a href="#cb270-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1173"><a href="#cb270-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(biov_calc<span class="sc">$</span>Volume)</span>
<span id="cb270-1174"><a href="#cb270-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(biov_calc<span class="sc">$</span>Volume)</span>
<span id="cb270-1175"><a href="#cb270-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"nano"</span>))<span class="sc">$</span>Volume)</span>
<span id="cb270-1176"><a href="#cb270-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"micro"</span>))<span class="sc">$</span>Volume)</span>
<span id="cb270-1177"><a href="#cb270-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1178"><a href="#cb270-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"nano"</span>))<span class="sc">$</span>pgC_cell)</span>
<span id="cb270-1179"><a href="#cb270-1179" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((biov_calc <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"micro"</span>))<span class="sc">$</span>pgC_cell)</span>
<span id="cb270-1180"><a href="#cb270-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1181"><a href="#cb270-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1182"><a href="#cb270-1182" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Volume is reported as um\^3</span></span>
<span id="cb270-1183"><a href="#cb270-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1184"><a href="#cb270-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Summary of biovolumes}</span></span>
<span id="cb270-1185"><a href="#cb270-1185" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by experiment type</span></span>
<span id="cb270-1186"><a href="#cb270-1186" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb270-1187"><a href="#cb270-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXP) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span>
<span id="cb270-1188"><a href="#cb270-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by euk size</span></span>
<span id="cb270-1189"><a href="#cb270-1189" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb270-1190"><a href="#cb270-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SizeFrac) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span>
<span id="cb270-1191"><a href="#cb270-1191" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by site</span></span>
<span id="cb270-1192"><a href="#cb270-1192" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb270-1193"><a href="#cb270-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span>
<span id="cb270-1194"><a href="#cb270-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1195"><a href="#cb270-1195" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb270-1196"><a href="#cb270-1196" aria-hidden="true" tabindex="-1"></a>euk_vol <span class="ot">&lt;-</span> <span class="fu">mean</span>(biov_calc<span class="sc">$</span>Volume);euk_vol <span class="co"># in um^3</span></span>
<span id="cb270-1197"><a href="#cb270-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1198"><a href="#cb270-1198" aria-hidden="true" tabindex="-1"></a>euk_carbon <span class="ot">&lt;-</span> <span class="fu">mean</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon <span class="co"># in pg C per cell</span></span>
<span id="cb270-1199"><a href="#cb270-1199" aria-hidden="true" tabindex="-1"></a>euk_carbon_min <span class="ot">&lt;-</span> <span class="fu">min</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon_min</span>
<span id="cb270-1200"><a href="#cb270-1200" aria-hidden="true" tabindex="-1"></a>euk_carbon_max <span class="ot">&lt;-</span> <span class="fu">max</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon_max</span>
<span id="cb270-1201"><a href="#cb270-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_carbon</span></span>
<span id="cb270-1202"><a href="#cb270-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1203"><a href="#cb270-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1204"><a href="#cb270-1204" aria-hidden="true" tabindex="-1"></a>Avg euk biomass pg C per individual cell == <span class="in">`{r}euk_carbon`</span></span>
<span id="cb270-1205"><a href="#cb270-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1206"><a href="#cb270-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare carbon biomass with literature</span></span>
<span id="cb270-1207"><a href="#cb270-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1208"><a href="#cb270-1208" aria-hidden="true" tabindex="-1"></a>LIKELY REMOVE ALL OF THIS - THIS IS CIRCULAR MATH!</span>
<span id="cb270-1209"><a href="#cb270-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1210"><a href="#cb270-1210" aria-hidden="true" tabindex="-1"></a>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10\^7 µm\^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</span>
<span id="cb270-1211"><a href="#cb270-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1212"><a href="#cb270-1212" aria-hidden="true" tabindex="-1"></a>Import the heterotroph species volume and carbon content to compare to my measured values.</span>
<span id="cb270-1213"><a href="#cb270-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1216"><a href="#cb270-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1217"><a href="#cb270-1217" aria-hidden="true" tabindex="-1"></a><span class="co"># Hu-measured</span></span>
<span id="cb270-1218"><a href="#cb270-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(biov_calc<span class="sc">$</span>Volume)</span>
<span id="cb270-1219"><a href="#cb270-1219" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(biov_calc<span class="sc">$</span>pgC_cell)</span>
<span id="cb270-1220"><a href="#cb270-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1221"><a href="#cb270-1221" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb270-1222"><a href="#cb270-1222" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb270-1223"><a href="#cb270-1223" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb270-1224"><a href="#cb270-1224" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb270-1225"><a href="#cb270-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1226"><a href="#cb270-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1227"><a href="#cb270-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, Volume, pgC_cell)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1228"><a href="#cb270-1228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb270-1229"><a href="#cb270-1229" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb270-1230"><a href="#cb270-1230" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb270-1231"><a href="#cb270-1231" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb270-1232"><a href="#cb270-1232" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^-</span><span class="dv">3</span>),</span>
<span id="cb270-1233"><a href="#cb270-1233" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb270-1234"><a href="#cb270-1234" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1235"><a href="#cb270-1235" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb270-1236"><a href="#cb270-1236" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb270-1237"><a href="#cb270-1237" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb270-1238"><a href="#cb270-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1239"><a href="#cb270-1239" aria-hidden="true" tabindex="-1"></a>carbon_compare</span>
<span id="cb270-1240"><a href="#cb270-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1241"><a href="#cb270-1241" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb270-1242"><a href="#cb270-1242" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_min <span class="ot">&lt;-</span> <span class="fu">min</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb270-1243"><a href="#cb270-1243" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_max <span class="ot">&lt;-</span> <span class="fu">max</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb270-1244"><a href="#cb270-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1245"><a href="#cb270-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1246"><a href="#cb270-1246" aria-hidden="true" tabindex="-1"></a>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</span>
<span id="cb270-1247"><a href="#cb270-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1248"><a href="#cb270-1248" aria-hidden="true" tabindex="-1"></a>Find lowest estimates or protist carbon, benthic estimates, and others? How does it compare to my measurements?</span>
<span id="cb270-1249"><a href="#cb270-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1250"><a href="#cb270-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">### Carbon biomass for prokaryotes</span></span>
<span id="cb270-1251"><a href="#cb270-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1252"><a href="#cb270-1252" aria-hidden="true" tabindex="-1"></a>Below adding in biomass estimates from prokaryotes and protists.</span>
<span id="cb270-1253"><a href="#cb270-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1254"><a href="#cb270-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Incorporate prokaryote carbon estimates}</span></span>
<span id="cb270-1255"><a href="#cb270-1255" aria-hidden="true" tabindex="-1"></a>bac_carbon_ug <span class="ot">&lt;-</span> (<span class="dv">86</span>)<span class="sc">*</span>(<span class="fl">1.00E-9</span>) <span class="co"># From Derived from Morono et al. 2011 </span></span>
<span id="cb270-1256"><a href="#cb270-1256" aria-hidden="true" tabindex="-1"></a><span class="co"># bac_carbon_ug</span></span>
<span id="cb270-1257"><a href="#cb270-1257" aria-hidden="true" tabindex="-1"></a>bac_carbon_ug_2 <span class="ot">&lt;-</span> (<span class="dv">173</span>)<span class="sc">*</span>(<span class="fl">1.00E-9</span>) <span class="co"># Derived from McNichol et al. 2018; LOFERER-KRO ̈ ßBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb270-1258"><a href="#cb270-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs</span></span>
<span id="cb270-1259"><a href="#cb270-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1260"><a href="#cb270-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1261"><a href="#cb270-1261" aria-hidden="true" tabindex="-1"></a>Amend all to table Incorporate calculations that include biomass of population and ug C consumed. For rate measurements, only incorporate the Morono et al. 2011 biomass for prokaryotes. This way it is on the lower end and is comparable to Gorda Ridge work.</span>
<span id="cb270-1262"><a href="#cb270-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1265"><a href="#cb270-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1266"><a href="#cb270-1266" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb270-1267"><a href="#cb270-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1268"><a href="#cb270-1268" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb270-1269"><a href="#cb270-1269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">euk_C_ug_Hu =</span> (euk_carbon <span class="sc">/</span> (<span class="fl">1.00E+06</span>))) <span class="sc">%&gt;%</span> <span class="co"># Convert to ug from pg</span></span>
<span id="cb270-1270"><a href="#cb270-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">euk_C_ug_lit =</span> (euk_carbon_lit_mean <span class="sc">/</span> (<span class="fl">1.00E+06</span>))) <span class="sc">%&gt;%</span> <span class="co"># literature</span></span>
<span id="cb270-1271"><a href="#cb270-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_C_ug =</span> bac_carbon_ug) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1272"><a href="#cb270-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_C_ug_2 =</span> bac_carbon_ug_2) <span class="sc">%&gt;%</span></span>
<span id="cb270-1273"><a href="#cb270-1273" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grazing rate in ug C per bac per day</span></span>
<span id="cb270-1274"><a href="#cb270-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_ugCbac_pergrazer_perday =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> bac_C_ug), <span class="co"># Grazing rate as ug C per grazer per day</span></span>
<span id="cb270-1275"><a href="#cb270-1275" aria-hidden="true" tabindex="-1"></a>         <span class="co"># % of cell carbon per day</span></span>
<span id="cb270-1276"><a href="#cb270-1276" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_INGESTION_RATE =</span> (RATE_ugCbac_pergrazer_perday <span class="sc">/</span> euk_C_ug_Hu),</span>
<span id="cb270-1277"><a href="#cb270-1277" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_INGESTION_RATE_lit =</span> (RATE_ugCbac_pergrazer_perday <span class="sc">/</span> euk_C_ug_lit),</span>
<span id="cb270-1278"><a href="#cb270-1278" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass =</span> PROK_ml <span class="sc">*</span> bac_carbon_ug,</span>
<span id="cb270-1279"><a href="#cb270-1279" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu =</span> EUK_ml <span class="sc">*</span> euk_C_ug_Hu,</span>
<span id="cb270-1280"><a href="#cb270-1280" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit =</span> EUK_ml <span class="sc">*</span> euk_C_ug_lit,</span>
<span id="cb270-1281"><a href="#cb270-1281" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_L =</span> PROK_ml <span class="sc">*</span> bac_carbon_ug <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb270-1282"><a href="#cb270-1282" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_L =</span> EUK_ml <span class="sc">*</span> euk_C_ug_Hu <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb270-1283"><a href="#cb270-1283" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_L =</span> EUK_ml <span class="sc">*</span> euk_C_ug_lit <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb270-1284"><a href="#cb270-1284" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Repeat with SEM values</span></span>
<span id="cb270-1285"><a href="#cb270-1285" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_sem =</span> PROK_sem <span class="sc">*</span> bac_carbon_ug,</span>
<span id="cb270-1286"><a href="#cb270-1286" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_sem =</span> EUK_sem <span class="sc">*</span> euk_C_ug_Hu,</span>
<span id="cb270-1287"><a href="#cb270-1287" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_sem =</span> EUK_sem <span class="sc">*</span> euk_C_ug_lit,</span>
<span id="cb270-1288"><a href="#cb270-1288" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_sem_L =</span> PROK_sem <span class="sc">*</span> (bac_carbon_ug<span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb270-1289"><a href="#cb270-1289" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_sem_L =</span> EUK_sem <span class="sc">*</span> (euk_C_ug_Hu <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb270-1290"><a href="#cb270-1290" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_sem_L =</span> EUK_sem <span class="sc">*</span> (euk_C_ug_lit <span class="sc">*</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1291"><a href="#cb270-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-1292"><a href="#cb270-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">detected =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1293"><a href="#cb270-1293" aria-hidden="true" tabindex="-1"></a>    RATE_min <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Not detected"</span>,</span>
<span id="cb270-1294"><a href="#cb270-1294" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Detected"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1295"><a href="#cb270-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1296"><a href="#cb270-1296" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">%in%</span> bsw <span class="sc">~</span> NAME,</span>
<span id="cb270-1297"><a href="#cb270-1297" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"Vent"</span>, EXP, <span class="at">sep=</span><span class="st">"-"</span>)</span>
<span id="cb270-1298"><a href="#cb270-1298" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1299"><a href="#cb270-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1300"><a href="#cb270-1300" aria-hidden="true" tabindex="-1"></a>    RATE_min <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb270-1301"><a href="#cb270-1301" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE_min</span>
<span id="cb270-1302"><a href="#cb270-1302" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1303"><a href="#cb270-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type_site =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1304"><a href="#cb270-1304" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">%in%</span> bsw <span class="sc">~</span> NAME,</span>
<span id="cb270-1305"><a href="#cb270-1305" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb270-1306"><a href="#cb270-1306" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb270-1307"><a href="#cb270-1307" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1308"><a href="#cb270-1308" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs_biomass)</span></span>
<span id="cb270-1309"><a href="#cb270-1309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1310"><a href="#cb270-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1311"><a href="#cb270-1311" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Volume is reported as um\^3</span></span>
<span id="cb270-1312"><a href="#cb270-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1313"><a href="#cb270-1313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing rate column == FLP per minute consumed</span>
<span id="cb270-1314"><a href="#cb270-1314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing effect hr == cells per ml per hr</span>
<span id="cb270-1315"><a href="#cb270-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1316"><a href="#cb270-1316" aria-hidden="true" tabindex="-1"></a><span class="fu">## Amend table with 'bounded' carbon estimates</span></span>
<span id="cb270-1317"><a href="#cb270-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1318"><a href="#cb270-1318" aria-hidden="true" tabindex="-1"></a>Also make a "bounded" table that demonstrates the ug C consumed in the context of McNichol et al.</span>
<span id="cb270-1319"><a href="#cb270-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1322"><a href="#cb270-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1323"><a href="#cb270-1323" aria-hidden="true" tabindex="-1"></a><span class="co"># G = number of cells grazed during experiment duration</span></span>
<span id="cb270-1324"><a href="#cb270-1324" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> table_wcalcs_biomass <span class="sc">%&gt;%</span> </span>
<span id="cb270-1325"><a href="#cb270-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">fgC_cell =</span> <span class="dv">86</span>) <span class="sc">%&gt;%</span> <span class="co"># Add in Morono et al. 2011 value</span></span>
<span id="cb270-1326"><a href="#cb270-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb270-1327"><a href="#cb270-1327" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cells_consumed_perday = (G / 1), # Rate of cells consumed * in situ prok, per day</span></span>
<span id="cb270-1328"><a href="#cb270-1328" aria-hidden="true" tabindex="-1"></a>    <span class="at">fgC_ml_perday =</span> (GRAZING_EFFECT_day <span class="sc">*</span> fgC_cell), <span class="co"># Convert cell amount to fg C</span></span>
<span id="cb270-1329"><a href="#cb270-1329" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>), <span class="co"># Convert to ug C per L</span></span>
<span id="cb270-1330"><a href="#cb270-1330" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_mcnichol =</span> <span class="dv">100</span><span class="sc">*</span>(ugC_L_perday <span class="sc">/</span> <span class="fl">17.3</span>),</span>
<span id="cb270-1331"><a href="#cb270-1331" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_mcnichol =</span> <span class="dv">100</span><span class="sc">*</span>(ugC_L_perday <span class="sc">/</span> <span class="fl">321.4</span>)</span>
<span id="cb270-1332"><a href="#cb270-1332" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1333"><a href="#cb270-1333" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1334"><a href="#cb270-1334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1335"><a href="#cb270-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1336"><a href="#cb270-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Save carbon table}</span></span>
<span id="cb270-1337"><a href="#cb270-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs_biomass_bounded)</span></span>
<span id="cb270-1338"><a href="#cb270-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs_biomass_bounded)</span></span>
<span id="cb270-1339"><a href="#cb270-1339" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs_biomass_bounded, file = "output-data/table-wcalc.txt", delim = "\t")</span></span>
<span id="cb270-1340"><a href="#cb270-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1341"><a href="#cb270-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1342"><a href="#cb270-1342" aria-hidden="true" tabindex="-1"></a><span class="fu"># Compare with Axial euk cell count</span></span>
<span id="cb270-1343"><a href="#cb270-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1344"><a href="#cb270-1344" aria-hidden="true" tabindex="-1"></a>From Axial Seamount cruise (July 2022) - have Anemone vent and plume euk cell counts to compare.</span>
<span id="cb270-1345"><a href="#cb270-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1348"><a href="#cb270-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1349"><a href="#cb270-1349" aria-hidden="true" tabindex="-1"></a>counts_ax <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../GrazingatAxial-2022/euk-cell-counts-11142022.csv"</span>, </span>
<span id="cb270-1350"><a href="#cb270-1350" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb270-1351"><a href="#cb270-1351" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb270-1352"><a href="#cb270-1352" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb270-1353"><a href="#cb270-1353" aria-hidden="true" tabindex="-1"></a>counts_ax[<span class="fu">is.na</span>(counts_ax)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span>
<span id="cb270-1354"><a href="#cb270-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1355"><a href="#cb270-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1356"><a href="#cb270-1356" aria-hidden="true" tabindex="-1"></a>Modify grazing code to count euk cells/ml so it considers euk cell count samples only.</span>
<span id="cb270-1357"><a href="#cb270-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1360"><a href="#cb270-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1361"><a href="#cb270-1361" aria-hidden="true" tabindex="-1"></a>counts_cellsml_axial <span class="ot">&lt;-</span> counts_ax <span class="sc">%&gt;%</span></span>
<span id="cb270-1362"><a href="#cb270-1362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, <span class="at">EXP =</span> <span class="st">`</span><span class="at">EXP.ID</span><span class="st">`</span>, <span class="at">VOL =</span> <span class="st">`</span><span class="at">vol..ml.</span><span class="st">`</span>, <span class="at">MAG =</span> <span class="st">`</span><span class="at">Mag..x.</span><span class="st">`</span>, <span class="at">nano =</span> <span class="st">`</span><span class="at">X.20um..no.FLP</span><span class="st">`</span>, <span class="at">micro =</span> <span class="st">`</span><span class="at">X.20um..no.FLP.1</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1363"><a href="#cb270-1363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXP, VOL) <span class="sc">%&gt;%</span></span>
<span id="cb270-1364"><a href="#cb270-1364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nano), </span>
<span id="cb270-1365"><a href="#cb270-1365" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(micro),</span>
<span id="cb270-1366"><a href="#cb270-1366" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1367"><a href="#cb270-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb270-1368"><a href="#cb270-1368" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb270-1369"><a href="#cb270-1369" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb270-1370"><a href="#cb270-1370" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb270-1371"><a href="#cb270-1371" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb270-1372"><a href="#cb270-1372" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb270-1373"><a href="#cb270-1373" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb270-1374"><a href="#cb270-1374" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb270-1375"><a href="#cb270-1375" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb270-1376"><a href="#cb270-1376" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar)))) <span class="sc">%&gt;%</span></span>
<span id="cb270-1377"><a href="#cb270-1377" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab filter rig, it is 283.385):</span></span>
<span id="cb270-1378"><a href="#cb270-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb270-1379"><a href="#cb270-1379" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb270-1380"><a href="#cb270-1380" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb270-1381"><a href="#cb270-1381" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb270-1382"><a href="#cb270-1382" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # left_join(expmeta) %&gt;%</span></span>
<span id="cb270-1383"><a href="#cb270-1383" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(SAMPLE, c("Site", "Name"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb270-1384"><a href="#cb270-1384" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(EXPID, c("TimePoint", "Replicate"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb270-1385"><a href="#cb270-1385" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data.frame</span></span>
<span id="cb270-1386"><a href="#cb270-1386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1387"><a href="#cb270-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1388"><a href="#cb270-1388" aria-hidden="true" tabindex="-1"></a>Thoughts on cell counts. Combining nano and micro for now, as the de-pressurization can cause issues in size. Likely underestimates for these counts.</span>
<span id="cb270-1389"><a href="#cb270-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1390"><a href="#cb270-1390" aria-hidden="true" tabindex="-1"></a>This is further supported because the biovolumes of all cells were pretty low.</span>
<span id="cb270-1391"><a href="#cb270-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1394"><a href="#cb270-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1395"><a href="#cb270-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_cellsml_axial)</span>
<span id="cb270-1396"><a href="#cb270-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(counts_cellsml_axial<span class="sc">$</span>eukCONC)</span>
<span id="cb270-1397"><a href="#cb270-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1398"><a href="#cb270-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1401"><a href="#cb270-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1402"><a href="#cb270-1402" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_euk_conc)</span></span>
<span id="cb270-1403"><a href="#cb270-1403" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_axial)</span></span>
<span id="cb270-1404"><a href="#cb270-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1405"><a href="#cb270-1405" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="sc">%&gt;%</span> </span>
<span id="cb270-1406"><a href="#cb270-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span> <span class="sc">&amp;</span> TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1407"><a href="#cb270-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1408"><a href="#cb270-1408" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(CONCENTRATION)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1409"><a href="#cb270-1409" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"MidCaymanRise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1410"><a href="#cb270-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(counts_cellsml_axial <span class="sc">%&gt;%</span> </span>
<span id="cb270-1411"><a href="#cb270-1411" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Name =</span> EXP, eukCONC) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1412"><a href="#cb270-1412" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1413"><a href="#cb270-1413" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(eukCONC)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1414"><a href="#cb270-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"AxialSeamount"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1415"><a href="#cb270-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1416"><a href="#cb270-1416" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb270-1417"><a href="#cb270-1417" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb270-1418"><a href="#cb270-1418" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"ASHES Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb270-1419"><a href="#cb270-1419" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"International District Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb270-1420"><a href="#cb270-1420" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb270-1421"><a href="#cb270-1421" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb270-1422"><a href="#cb270-1422" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1423"><a href="#cb270-1423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Name, <span class="at">y =</span> euk_conc_mean)) <span class="sc">+</span></span>
<span id="cb270-1424"><a href="#cb270-1424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> TYPE), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb270-1425"><a href="#cb270-1425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-1426"><a href="#cb270-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> FIELD <span class="sc">+</span> TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-1427"><a href="#cb270-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-1428"><a href="#cb270-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb270-1429"><a href="#cb270-1429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span>
<span id="cb270-1430"><a href="#cb270-1430" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-1431"><a href="#cb270-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1432"><a href="#cb270-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1433"><a href="#cb270-1433" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environmental parameters - MCR</span></span>
<span id="cb270-1434"><a href="#cb270-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1435"><a href="#cb270-1435" aria-hidden="true" tabindex="-1"></a>Import from Hu et al. (*Molecular Ecology*).</span>
<span id="cb270-1436"><a href="#cb270-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1439"><a href="#cb270-1439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1440"><a href="#cb270-1440" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb270-1441"><a href="#cb270-1441" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb270-1442"><a href="#cb270-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1443"><a href="#cb270-1443" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb270-1444"><a href="#cb270-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1445"><a href="#cb270-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb270-1446"><a href="#cb270-1446" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb270-1447"><a href="#cb270-1447" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1448"><a href="#cb270-1448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1449"><a href="#cb270-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE, <span class="fu">everything</span>())</span>
<span id="cb270-1450"><a href="#cb270-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1451"><a href="#cb270-1451" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb270-1452"><a href="#cb270-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1453"><a href="#cb270-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1454"><a href="#cb270-1454" aria-hidden="true" tabindex="-1"></a>Generate supplementary table.</span>
<span id="cb270-1455"><a href="#cb270-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1458"><a href="#cb270-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1459"><a href="#cb270-1459" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb270-1460"><a href="#cb270-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc)</span>
<span id="cb270-1461"><a href="#cb270-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1462"><a href="#cb270-1462" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb270-1463"><a href="#cb270-1463" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span>
<span id="cb270-1464"><a href="#cb270-1464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1465"><a href="#cb270-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1466"><a href="#cb270-1466" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis of grazing rate results</span></span>
<span id="cb270-1467"><a href="#cb270-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1468"><a href="#cb270-1468" aria-hidden="true" tabindex="-1"></a>Re-import table from output table with all grazing values</span>
<span id="cb270-1469"><a href="#cb270-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1472"><a href="#cb270-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1473"><a href="#cb270-1473" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb270-1474"><a href="#cb270-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1475"><a href="#cb270-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1476"><a href="#cb270-1476" aria-hidden="true" tabindex="-1"></a>Format and factor values to plot, and prioritize these values:</span>
<span id="cb270-1477"><a href="#cb270-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1478"><a href="#cb270-1478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing rate column == FLP per minute consumed</span>
<span id="cb270-1479"><a href="#cb270-1479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing effect hr == cells per ml per hr</span>
<span id="cb270-1480"><a href="#cb270-1480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</span>
<span id="cb270-1481"><a href="#cb270-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1484"><a href="#cb270-1484" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1485"><a href="#cb270-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_wcalcs_biomass_bounded)</span>
<span id="cb270-1486"><a href="#cb270-1486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1487"><a href="#cb270-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1490"><a href="#cb270-1490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1491"><a href="#cb270-1491" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot <span class="ot">&lt;-</span> table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span> </span>
<span id="cb270-1492"><a href="#cb270-1492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, type, </span>
<span id="cb270-1493"><a href="#cb270-1493" aria-hidden="true" tabindex="-1"></a>        PROK_ml, EUK_ml, PROK_sem, EUK_sem,</span>
<span id="cb270-1494"><a href="#cb270-1494" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_L, Euk_biomass_Hu_L, Euk_biomass_lit_L,</span>
<span id="cb270-1495"><a href="#cb270-1495" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span>
<span id="cb270-1496"><a href="#cb270-1496" aria-hidden="true" tabindex="-1"></a>        GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, BAC_TURNOVER_PERC_min, BAC_TURNOVER_PERC_max,</span>
<span id="cb270-1497"><a href="#cb270-1497" aria-hidden="true" tabindex="-1"></a>        GRAZE_RATE, RATE_ugCbac_pergrazer_perday,</span>
<span id="cb270-1498"><a href="#cb270-1498" aria-hidden="true" tabindex="-1"></a>        SPEC_INGESTION_RATE, SPEC_INGESTION_RATE_lit) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1499"><a href="#cb270-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml,</span>
<span id="cb270-1500"><a href="#cb270-1500" aria-hidden="true" tabindex="-1"></a>                        Prok_biomass_L, Euk_biomass_Hu_L, Euk_biomass_lit_L,</span>
<span id="cb270-1501"><a href="#cb270-1501" aria-hidden="true" tabindex="-1"></a>                        GRAZING_EFFECT_hr, BAC_TURNOVER_PERC,</span>
<span id="cb270-1502"><a href="#cb270-1502" aria-hidden="true" tabindex="-1"></a>                        GRAZE_RATE, RATE_ugCbac_pergrazer_perday,</span>
<span id="cb270-1503"><a href="#cb270-1503" aria-hidden="true" tabindex="-1"></a>                        SPEC_INGESTION_RATE, SPEC_INGESTION_RATE_lit),</span>
<span id="cb270-1504"><a href="#cb270-1504" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1505"><a href="#cb270-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_sem, EUK_sem, Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span>
<span id="cb270-1506"><a href="#cb270-1506" aria-hidden="true" tabindex="-1"></a>                        BAC_TURNOVER_PERC_max, BAC_TURNOVER_PERC_min, GRAZING_EFFECT_hr_max, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max),</span>
<span id="cb270-1507"><a href="#cb270-1507" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"SEM_variable"</span>, <span class="at">values_to =</span> <span class="st">"SEM"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1508"><a href="#cb270-1508" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1509"><a href="#cb270-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1510"><a href="#cb270-1510" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb270-1511"><a href="#cb270-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1512"><a href="#cb270-1512" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>VARIABLE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>Variable, </span>
<span id="cb270-1513"><a href="#cb270-1513" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PROK_ml"</span>, <span class="st">"EUK_ml"</span>,</span>
<span id="cb270-1514"><a href="#cb270-1514" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prok_biomass_L"</span>, <span class="st">"Euk_biomass_Hu_L"</span>, <span class="st">"Euk_biomass_lit_L"</span>,</span>
<span id="cb270-1515"><a href="#cb270-1515" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZING_EFFECT_hr"</span>, <span class="st">"BAC_TURNOVER_PERC"</span>,</span>
<span id="cb270-1516"><a href="#cb270-1516" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZE_RATE"</span>, <span class="st">"RATE_ugCbac_pergrazer_perday"</span>,</span>
<span id="cb270-1517"><a href="#cb270-1517" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"SPEC_INGESTION_RATE"</span>, <span class="st">"SPEC_INGESTION_RATE_lit"</span>),</span>
<span id="cb270-1518"><a href="#cb270-1518" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Prokaryote~cells~mL^{-1}"</span>, <span class="st">"Eukaryote~cells~mL^{-1}"</span>,</span>
<span id="cb270-1519"><a href="#cb270-1519" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prokaryote~µg~C~L^{-1}"</span>, <span class="st">"Measured~eukaryote~µg~C~L^{-1}"</span>, <span class="st">"Literature-based~eukaryote~µg~C~L^{-1}"</span>,</span>
<span id="cb270-1520"><a href="#cb270-1520" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cells~mL^{-1}~hr^{-1}"</span>, <span class="st">"Prokaryote~turnover~'%'~d^{-1}"</span>,</span>
<span id="cb270-1521"><a href="#cb270-1521" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"FLP~consumed~min^{-1}"</span>, <span class="st">"µg~C~grazer^{-1}~day^{-1}"</span>,</span>
<span id="cb270-1522"><a href="#cb270-1522" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cell~carbon~%~day^{-1}"</span>, <span class="st">"Cell~carbon~%~day^{-1}~(lit)"</span>))</span>
<span id="cb270-1523"><a href="#cb270-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1524"><a href="#cb270-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1525"><a href="#cb270-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">## Function to plot grazing results</span></span>
<span id="cb270-1526"><a href="#cb270-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1529"><a href="#cb270-1529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1530"><a href="#cb270-1530" aria-hidden="true" tabindex="-1"></a>conc_rate_plot_mcr <span class="ot">&lt;-</span> <span class="cf">function</span>(df, var, sem){</span>
<span id="cb270-1531"><a href="#cb270-1531" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb270-1532"><a href="#cb270-1532" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> var) <span class="sc">%&gt;%</span></span>
<span id="cb270-1533"><a href="#cb270-1533" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> sem) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1534"><a href="#cb270-1534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb270-1535"><a href="#cb270-1535" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Value <span class="sc">+</span> SEM), <span class="at">ymin =</span> (Value <span class="sc">-</span> SEM)), </span>
<span id="cb270-1536"><a href="#cb270-1536" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1537"><a href="#cb270-1537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb270-1538"><a href="#cb270-1538" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1539"><a href="#cb270-1539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb270-1540"><a href="#cb270-1540" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb270-1541"><a href="#cb270-1541" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(VARIABLE_ORDER <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb270-1542"><a href="#cb270-1542" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>), <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb270-1543"><a href="#cb270-1543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb270-1544"><a href="#cb270-1544" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb270-1545"><a href="#cb270-1545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-1546"><a href="#cb270-1546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1547"><a href="#cb270-1547" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-1548"><a href="#cb270-1548" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-1549"><a href="#cb270-1549" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb270-1550"><a href="#cb270-1550" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-1551"><a href="#cb270-1551" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1552"><a href="#cb270-1552" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb270-1553"><a href="#cb270-1553" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-1554"><a href="#cb270-1554" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1555"><a href="#cb270-1555" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb270-1556"><a href="#cb270-1556" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1557"><a href="#cb270-1557" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb270-1558"><a href="#cb270-1558" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb270-1559"><a href="#cb270-1559" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb270-1560"><a href="#cb270-1560" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb270-1561"><a href="#cb270-1561" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-1562"><a href="#cb270-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1563"><a href="#cb270-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1566"><a href="#cb270-1566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1567"><a href="#cb270-1567" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "PROK_ml", "PROK_sem")</span></span>
<span id="cb270-1568"><a href="#cb270-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1569"><a href="#cb270-1569" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "EUK_ml", "EUK_sem")</span></span>
<span id="cb270-1570"><a href="#cb270-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1571"><a href="#cb270-1571" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Prok_biomass_L", "Prok_biomass_sem_L")</span></span>
<span id="cb270-1572"><a href="#cb270-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1573"><a href="#cb270-1573" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"Euk_biomass_Hu_L"</span>, <span class="st">"Euk_biomass_Hu_sem_L"</span>)</span>
<span id="cb270-1574"><a href="#cb270-1574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1575"><a href="#cb270-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1576"><a href="#cb270-1576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=6}</span></span>
<span id="cb270-1577"><a href="#cb270-1577" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb270-1578"><a href="#cb270-1578" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> biomass_rate_plot <span class="sc">%&gt;%</span> </span>
<span id="cb270-1579"><a href="#cb270-1579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-1580"><a href="#cb270-1580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-1581"><a href="#cb270-1581" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_min"</span> <span class="sc">|</span> SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_max"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1582"><a href="#cb270-1582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> SEM_variable, <span class="at">values_from =</span> SEM) <span class="sc">%&gt;%</span></span>
<span id="cb270-1583"><a href="#cb270-1583" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">NAME_ORDER =</span> <span class="fu">factor</span>(NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1584"><a href="#cb270-1584" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb270-1585"><a href="#cb270-1585" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb270-1586"><a href="#cb270-1586" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1587"><a href="#cb270-1587" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb270-1588"><a href="#cb270-1588" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1589"><a href="#cb270-1589" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-1590"><a href="#cb270-1590" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb270-1591"><a href="#cb270-1591" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(. <span class="sc">~</span> VARIABLE_ORDER, <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb270-1592"><a href="#cb270-1592" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb270-1593"><a href="#cb270-1593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb270-1594"><a href="#cb270-1594" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_flip() +</span></span>
<span id="cb270-1595"><a href="#cb270-1595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1596"><a href="#cb270-1596" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-1597"><a href="#cb270-1597" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-1598"><a href="#cb270-1598" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb270-1599"><a href="#cb270-1599" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-1600"><a href="#cb270-1600" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1601"><a href="#cb270-1601" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb270-1602"><a href="#cb270-1602" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-1603"><a href="#cb270-1603" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1604"><a href="#cb270-1604" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb270-1605"><a href="#cb270-1605" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1606"><a href="#cb270-1606" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb270-1607"><a href="#cb270-1607" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb270-1608"><a href="#cb270-1608" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb270-1609"><a href="#cb270-1609" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Cells consumed per ml per hr"</span>)</span>
<span id="cb270-1610"><a href="#cb270-1610" aria-hidden="true" tabindex="-1"></a><span class="co"># class(grazing_rate)</span></span>
<span id="cb270-1611"><a href="#cb270-1611" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biomass_rate_plot)</span></span>
<span id="cb270-1612"><a href="#cb270-1612" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("plot-grazing-withscale.svg", h = 7, w = 6)</span></span>
<span id="cb270-1613"><a href="#cb270-1613" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate</span></span>
<span id="cb270-1614"><a href="#cb270-1614" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(</span></span>
<span id="cb270-1615"><a href="#cb270-1615" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate + scale_y_continuous(limits = c(0,2000))</span></span>
<span id="cb270-1616"><a href="#cb270-1616" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ,</span></span>
<span id="cb270-1617"><a href="#cb270-1617" aria-hidden="true" tabindex="-1"></a>          <span class="co"># grazing_rate,</span></span>
<span id="cb270-1618"><a href="#cb270-1618" aria-hidden="true" tabindex="-1"></a>          <span class="co"># ncol = 1, rel_heights = c(0.6,1))</span></span>
<span id="cb270-1619"><a href="#cb270-1619" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb270-1620"><a href="#cb270-1620" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e4</span>))</span>
<span id="cb270-1621"><a href="#cb270-1621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1622"><a href="#cb270-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1623"><a href="#cb270-1623" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grazing rate vs. cells ml</span></span>
<span id="cb270-1624"><a href="#cb270-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1627"><a href="#cb270-1627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1628"><a href="#cb270-1628" aria-hidden="true" tabindex="-1"></a>env_params <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> <span class="st">"input-data/table_wenv.txt"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb270-1629"><a href="#cb270-1629" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(env_params)</span>
<span id="cb270-1630"><a href="#cb270-1630" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="ot">&lt;-</span> env_params <span class="sc">%&gt;%</span> </span>
<span id="cb270-1631"><a href="#cb270-1631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-1632"><a href="#cb270-1632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1633"><a href="#cb270-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_hr"</span>), pH, Mg, H2., CH4, H2S)</span>
<span id="cb270-1634"><a href="#cb270-1634" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot_wider(names_from = "name", values_from = "value", values_fill = NA)</span></span>
<span id="cb270-1635"><a href="#cb270-1635" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(plot_metadata)</span>
<span id="cb270-1636"><a href="#cb270-1636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1637"><a href="#cb270-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1638"><a href="#cb270-1638" aria-hidden="true" tabindex="-1"></a>Compare microbial biomass, concentration, grazing and temperature across all sites.</span>
<span id="cb270-1639"><a href="#cb270-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1642"><a href="#cb270-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1643"><a href="#cb270-1643" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb270-1644"><a href="#cb270-1644" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1645"><a href="#cb270-1645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb270-1646"><a href="#cb270-1646" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb270-1647"><a href="#cb270-1647" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb270-1648"><a href="#cb270-1648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb270-1649"><a href="#cb270-1649" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb270-1650"><a href="#cb270-1650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb270-1651"><a href="#cb270-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb270-1652"><a href="#cb270-1652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb270-1653"><a href="#cb270-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb270-1654"><a href="#cb270-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-1655"><a href="#cb270-1655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-1656"><a href="#cb270-1656" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-1657"><a href="#cb270-1657" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb270-1658"><a href="#cb270-1658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb270-1659"><a href="#cb270-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1660"><a href="#cb270-1660" aria-hidden="true" tabindex="-1"></a>euk_temp</span>
<span id="cb270-1661"><a href="#cb270-1661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1662"><a href="#cb270-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1665"><a href="#cb270-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1666"><a href="#cb270-1666" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb270-1667"><a href="#cb270-1667" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1668"><a href="#cb270-1668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb270-1669"><a href="#cb270-1669" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb270-1670"><a href="#cb270-1670" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb270-1671"><a href="#cb270-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem)))) <span class="sc">+</span></span>
<span id="cb270-1672"><a href="#cb270-1672" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb270-1673"><a href="#cb270-1673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb270-1674"><a href="#cb270-1674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb270-1675"><a href="#cb270-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb270-1676"><a href="#cb270-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb270-1677"><a href="#cb270-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-1678"><a href="#cb270-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-1679"><a href="#cb270-1679" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-1680"><a href="#cb270-1680" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb270-1681"><a href="#cb270-1681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Microial prey cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb270-1682"><a href="#cb270-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1683"><a href="#cb270-1683" aria-hidden="true" tabindex="-1"></a>prok_temp</span>
<span id="cb270-1684"><a href="#cb270-1684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1685"><a href="#cb270-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1686"><a href="#cb270-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=7}</span></span>
<span id="cb270-1687"><a href="#cb270-1687" aria-hidden="true" tabindex="-1"></a>(euk_temp <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> prok_temp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb270-1688"><a href="#cb270-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1689"><a href="#cb270-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1690"><a href="#cb270-1690" aria-hidden="true" tabindex="-1"></a>Plot other environmental parameters</span>
<span id="cb270-1691"><a href="#cb270-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1694"><a href="#cb270-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1695"><a href="#cb270-1695" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb270-1696"><a href="#cb270-1696" aria-hidden="true" tabindex="-1"></a>plot_supp <span class="ot">&lt;-</span> <span class="cf">function</span>(PARAMETER){</span>
<span id="cb270-1697"><a href="#cb270-1697" aria-hidden="true" tabindex="-1"></a>  plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb270-1698"><a href="#cb270-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pH, Mg, H2., CH4, H2S), <span class="at">names_to =</span> <span class="st">"ENV"</span>, <span class="at">values_to =</span> <span class="st">"ENV_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1699"><a href="#cb270-1699" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ENV_NUM =</span> <span class="fu">as.numeric</span>(ENV_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1700"><a href="#cb270-1700" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ENV <span class="sc">==</span> PARAMETER) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1701"><a href="#cb270-1701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> ENV_VALUE)) <span class="sc">+</span></span>
<span id="cb270-1702"><a href="#cb270-1702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb270-1703"><a href="#cb270-1703" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb270-1704"><a href="#cb270-1704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb270-1705"><a href="#cb270-1705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb270-1706"><a href="#cb270-1706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb270-1707"><a href="#cb270-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb270-1708"><a href="#cb270-1708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-1709"><a href="#cb270-1709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-1710"><a href="#cb270-1710" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-1711"><a href="#cb270-1711" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb270-1712"><a href="#cb270-1712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>,</span>
<span id="cb270-1713"><a href="#cb270-1713" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> PARAMETER)</span>
<span id="cb270-1714"><a href="#cb270-1714" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb270-1715"><a href="#cb270-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1716"><a href="#cb270-1716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1717"><a href="#cb270-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1718"><a href="#cb270-1718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=16, fig.width=15}</span></span>
<span id="cb270-1719"><a href="#cb270-1719" aria-hidden="true" tabindex="-1"></a><span class="co"># pH, Mg, H2., CH4, H2S</span></span>
<span id="cb270-1720"><a href="#cb270-1720" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_supp</span>(<span class="st">"pH"</span>) <span class="sc">+</span></span>
<span id="cb270-1721"><a href="#cb270-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"Mg"</span>) <span class="sc">+</span></span>
<span id="cb270-1722"><a href="#cb270-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2."</span>) <span class="sc">+</span></span>
<span id="cb270-1723"><a href="#cb270-1723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"CH4"</span>) <span class="sc">+</span></span>
<span id="cb270-1724"><a href="#cb270-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2S"</span>) <span class="sc">+</span></span>
<span id="cb270-1725"><a href="#cb270-1725" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span>
<span id="cb270-1726"><a href="#cb270-1726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1727"><a href="#cb270-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1728"><a href="#cb270-1728" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison with Gorda Ridge</span></span>
<span id="cb270-1729"><a href="#cb270-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1730"><a href="#cb270-1730" aria-hidden="true" tabindex="-1"></a>Import data from Gorda Ridge</span>
<span id="cb270-1731"><a href="#cb270-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1734"><a href="#cb270-1734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1735"><a href="#cb270-1735" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb270-1736"><a href="#cb270-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1737"><a href="#cb270-1737" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"/Users/sarahhu/Desktop/Projects/GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb270-1738"><a href="#cb270-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1739"><a href="#cb270-1739" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb270-1740"><a href="#cb270-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1741"><a href="#cb270-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1742"><a href="#cb270-1742" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combine GR and MCR data</span></span>
<span id="cb270-1743"><a href="#cb270-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1746"><a href="#cb270-1746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1747"><a href="#cb270-1747" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb270-1748"><a href="#cb270-1748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-1749"><a href="#cb270-1749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, ugC_L_perday) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1750"><a href="#cb270-1750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb270-1751"><a href="#cb270-1751" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1752"><a href="#cb270-1752" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1753"><a href="#cb270-1753" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1754"><a href="#cb270-1754" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover, <span class="at">ugC_L_perday =</span> ugC_L_perday_morono)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1755"><a href="#cb270-1755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1756"><a href="#cb270-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb270-1757"><a href="#cb270-1757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb270-1758"><a href="#cb270-1758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb270-1759"><a href="#cb270-1759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb270-1760"><a href="#cb270-1760" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb270-1761"><a href="#cb270-1761" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb270-1762"><a href="#cb270-1762" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb270-1763"><a href="#cb270-1763" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb270-1764"><a href="#cb270-1764" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb270-1765"><a href="#cb270-1765" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span>
<span id="cb270-1766"><a href="#cb270-1766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1767"><a href="#cb270-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1768"><a href="#cb270-1768" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot combined results</span></span>
<span id="cb270-1769"><a href="#cb270-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1772"><a href="#cb270-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1773"><a href="#cb270-1773" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-1774"><a href="#cb270-1774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1775"><a href="#cb270-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-1776"><a href="#cb270-1776" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb270-1777"><a href="#cb270-1777" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb270-1778"><a href="#cb270-1778" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1779"><a href="#cb270-1779" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb270-1780"><a href="#cb270-1780" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1781"><a href="#cb270-1781" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-1782"><a href="#cb270-1782" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb270-1783"><a href="#cb270-1783" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-1784"><a href="#cb270-1784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-1785"><a href="#cb270-1785" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1786"><a href="#cb270-1786" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-1787"><a href="#cb270-1787" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-1788"><a href="#cb270-1788" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb270-1789"><a href="#cb270-1789" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-1790"><a href="#cb270-1790" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1791"><a href="#cb270-1791" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1792"><a href="#cb270-1792" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-1793"><a href="#cb270-1793" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1794"><a href="#cb270-1794" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb270-1795"><a href="#cb270-1795" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1796"><a href="#cb270-1796" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb270-1797"><a href="#cb270-1797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb270-1798"><a href="#cb270-1798" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb270-1799"><a href="#cb270-1799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb270-1800"><a href="#cb270-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1801"><a href="#cb270-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1802"><a href="#cb270-1802" aria-hidden="true" tabindex="-1"></a>Add Gorda Ridge comparison to supplementary?</span>
<span id="cb270-1803"><a href="#cb270-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1806"><a href="#cb270-1806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1807"><a href="#cb270-1807" aria-hidden="true" tabindex="-1"></a>allrates</span>
<span id="cb270-1808"><a href="#cb270-1808" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb270-1809"><a href="#cb270-1809" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span>
<span id="cb270-1810"><a href="#cb270-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1811"><a href="#cb270-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1812"><a href="#cb270-1812" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove undetected grazing rate</span></span>
<span id="cb270-1813"><a href="#cb270-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1814"><a href="#cb270-1814" aria-hidden="true" tabindex="-1"></a>Repeat grazing rate plot, but removed undetectable</span>
<span id="cb270-1815"><a href="#cb270-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1818"><a href="#cb270-1818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1819"><a href="#cb270-1819" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb270-1820"><a href="#cb270-1820" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-1821"><a href="#cb270-1821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1822"><a href="#cb270-1822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1823"><a href="#cb270-1823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-1824"><a href="#cb270-1824" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb270-1825"><a href="#cb270-1825" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb270-1826"><a href="#cb270-1826" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1827"><a href="#cb270-1827" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb270-1828"><a href="#cb270-1828" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb270-1829"><a href="#cb270-1829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-1830"><a href="#cb270-1830" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb270-1831"><a href="#cb270-1831" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-1832"><a href="#cb270-1832" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-1833"><a href="#cb270-1833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1834"><a href="#cb270-1834" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb270-1835"><a href="#cb270-1835" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb270-1836"><a href="#cb270-1836" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb270-1837"><a href="#cb270-1837" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb270-1838"><a href="#cb270-1838" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1839"><a href="#cb270-1839" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1840"><a href="#cb270-1840" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb270-1841"><a href="#cb270-1841" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1842"><a href="#cb270-1842" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb270-1843"><a href="#cb270-1843" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb270-1844"><a href="#cb270-1844" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb270-1845"><a href="#cb270-1845" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb270-1846"><a href="#cb270-1846" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb270-1847"><a href="#cb270-1847" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb270-1848"><a href="#cb270-1848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1849"><a href="#cb270-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1850"><a href="#cb270-1850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=7}</span></span>
<span id="cb270-1851"><a href="#cb270-1851" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb270-1852"><a href="#cb270-1852" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb270-1853"><a href="#cb270-1853" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb270-1854"><a href="#cb270-1854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1855"><a href="#cb270-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1856"><a href="#cb270-1856" aria-hidden="true" tabindex="-1"></a>Panel plot, cells per ml and grazing rate</span>
<span id="cb270-1857"><a href="#cb270-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1858"><a href="#cb270-1858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Plot cell conc and rates, fig.width=6, fig.height=10}</span></span>
<span id="cb270-1859"><a href="#cb270-1859" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("plot-gcellconc-grazing-log.svg", h = 10, w = 6)</span></span>
<span id="cb270-1860"><a href="#cb270-1860" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate + scale_y_log10(limits = c(1e-1,1e5), breaks=10^(0:7))</span></span>
<span id="cb270-1861"><a href="#cb270-1861" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>),</span>
<span id="cb270-1862"><a href="#cb270-1862" aria-hidden="true" tabindex="-1"></a>          <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>),</span>
<span id="cb270-1863"><a href="#cb270-1863" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>(), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb270-1864"><a href="#cb270-1864" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb270-1865"><a href="#cb270-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1866"><a href="#cb270-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1867"><a href="#cb270-1867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=7, fig.height=7}</span></span>
<span id="cb270-1868"><a href="#cb270-1868" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("cells-per-ml.svg", h = 7, w = 7)</span></span>
<span id="cb270-1869"><a href="#cb270-1869" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>) <span class="sc">+</span> <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span>
<span id="cb270-1870"><a href="#cb270-1870" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb270-1871"><a href="#cb270-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1872"><a href="#cb270-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1873"><a href="#cb270-1873" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear regression</span></span>
<span id="cb270-1874"><a href="#cb270-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1875"><a href="#cb270-1875" aria-hidden="true" tabindex="-1"></a>Use tidymodels to perform linear regression. Include MCR and GR data.</span>
<span id="cb270-1876"><a href="#cb270-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1879"><a href="#cb270-1879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1880"><a href="#cb270-1880" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb270-1881"><a href="#cb270-1881" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb270-1882"><a href="#cb270-1882" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb270-1883"><a href="#cb270-1883" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb270-1884"><a href="#cb270-1884" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-1885"><a href="#cb270-1885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SAMPLE <span class="sc">==</span> <span class="st">"Piccard-Shrimpocalypse"</span> <span class="sc">&amp;</span> EXP <span class="sc">==</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1886"><a href="#cb270-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1887"><a href="#cb270-1887" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, ugC_L_perday, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1888"><a href="#cb270-1888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1889"><a href="#cb270-1889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, ugC_L_perday), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1890"><a href="#cb270-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1891"><a href="#cb270-1891" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1892"><a href="#cb270-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1893"><a href="#cb270-1893" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb270-1894"><a href="#cb270-1894" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb270-1895"><a href="#cb270-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1896"><a href="#cb270-1896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1897"><a href="#cb270-1897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb270-1898"><a href="#cb270-1898" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1899"><a href="#cb270-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1900"><a href="#cb270-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb270-1901"><a href="#cb270-1901" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1902"><a href="#cb270-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1903"><a href="#cb270-1903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb270-1904"><a href="#cb270-1904" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1905"><a href="#cb270-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1906"><a href="#cb270-1906" aria-hidden="true" tabindex="-1"></a>regression_results <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb270-1907"><a href="#cb270-1907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1908"><a href="#cb270-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1909"><a href="#cb270-1909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb270-1910"><a href="#cb270-1910" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1911"><a href="#cb270-1911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1912"><a href="#cb270-1912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1913"><a href="#cb270-1913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb270-1914"><a href="#cb270-1914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb270-1915"><a href="#cb270-1915" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-1916"><a href="#cb270-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1917"><a href="#cb270-1917" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span>
<span id="cb270-1918"><a href="#cb270-1918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1919"><a href="#cb270-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1920"><a href="#cb270-1920" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb270-1921"><a href="#cb270-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1922"><a href="#cb270-1922" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb270-1923"><a href="#cb270-1923" aria-hidden="true" tabindex="-1"></a>regression_results <span class="sc">%&gt;%</span> </span>
<span id="cb270-1924"><a href="#cb270-1924" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb270-1925"><a href="#cb270-1925" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb270-1926"><a href="#cb270-1926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb270-1927"><a href="#cb270-1927" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb270-1928"><a href="#cb270-1928" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb270-1929"><a href="#cb270-1929" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb270-1930"><a href="#cb270-1930" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb270-1931"><a href="#cb270-1931" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb270-1932"><a href="#cb270-1932" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb270-1933"><a href="#cb270-1933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-1934"><a href="#cb270-1934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb270-1935"><a href="#cb270-1935" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-1936"><a href="#cb270-1936" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb270-1937"><a href="#cb270-1937" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb270-1938"><a href="#cb270-1938" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb270-1939"><a href="#cb270-1939" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb270-1940"><a href="#cb270-1940" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb270-1941"><a href="#cb270-1941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1942"><a href="#cb270-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1943"><a href="#cb270-1943" aria-hidden="true" tabindex="-1"></a>*Regression thoughts*: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</span>
<span id="cb270-1944"><a href="#cb270-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1945"><a href="#cb270-1945" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grazing &amp; environmental parameters</span></span>
<span id="cb270-1946"><a href="#cb270-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1947"><a href="#cb270-1947" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What parameters influence grazing rates of protists on bacteria?</span>
<span id="cb270-1948"><a href="#cb270-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1949"><a href="#cb270-1949" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Try triangle plots?</span>
<span id="cb270-1950"><a href="#cb270-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1951"><a href="#cb270-1951" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What about geom raster?</span>
<span id="cb270-1952"><a href="#cb270-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1953"><a href="#cb270-1953" aria-hidden="true" tabindex="-1"></a>Plot temperature by euk and prok per ml individually too.</span>
<span id="cb270-1954"><a href="#cb270-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1955"><a href="#cb270-1955" aria-hidden="true" tabindex="-1"></a>Bacterial abundance typically increases with temperature (White et al. 1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</span>
<span id="cb270-1956"><a href="#cb270-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1957"><a href="#cb270-1957" aria-hidden="true" tabindex="-1"></a>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature... in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</span>
<span id="cb270-1958"><a href="#cb270-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1961"><a href="#cb270-1961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1962"><a href="#cb270-1962" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb270-1963"><a href="#cb270-1963" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-1964"><a href="#cb270-1964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb270-1965"><a href="#cb270-1965" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(allvent_data)</span>
<span id="cb270-1966"><a href="#cb270-1966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1967"><a href="#cb270-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1968"><a href="#cb270-1968" aria-hidden="true" tabindex="-1"></a>Function to plot results by two parameters.</span>
<span id="cb270-1969"><a href="#cb270-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1972"><a href="#cb270-1972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1973"><a href="#cb270-1973" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb270-1974"><a href="#cb270-1974" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb270-1975"><a href="#cb270-1975" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb270-1976"><a href="#cb270-1976" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb270-1977"><a href="#cb270-1977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb270-1978"><a href="#cb270-1978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-1979"><a href="#cb270-1979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb270-1980"><a href="#cb270-1980" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb270-1981"><a href="#cb270-1981" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-1982"><a href="#cb270-1982" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-1983"><a href="#cb270-1983" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb270-1984"><a href="#cb270-1984" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-1985"><a href="#cb270-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1986"><a href="#cb270-1986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1987"><a href="#cb270-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1988"><a href="#cb270-1988" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by euk:prok and then euk and prok</span></span>
<span id="cb270-1989"><a href="#cb270-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1992"><a href="#cb270-1992" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-1993"><a href="#cb270-1993" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span>
<span id="cb270-1994"><a href="#cb270-1994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-1995"><a href="#cb270-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-1996"><a href="#cb270-1996" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by grazing rate</span></span>
<span id="cb270-1997"><a href="#cb270-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2000"><a href="#cb270-2000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2001"><a href="#cb270-2001" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span>
<span id="cb270-2002"><a href="#cb270-2002" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb270-2003"><a href="#cb270-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2004"><a href="#cb270-2004" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, ugC_L_perday, EUK_ml, <span class="st">"ugC_L_perday"</span>, <span class="st">"Euk cells per ml"</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb270-2005"><a href="#cb270-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2006"><a href="#cb270-2006" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span>
<span id="cb270-2007"><a href="#cb270-2007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2008"><a href="#cb270-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2009"><a href="#cb270-2009" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass investigation</span></span>
<span id="cb270-2010"><a href="#cb270-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2013"><a href="#cb270-2013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2014"><a href="#cb270-2014" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb270-2015"><a href="#cb270-2015" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span>
<span id="cb270-2016"><a href="#cb270-2016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2017"><a href="#cb270-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2018"><a href="#cb270-2018" aria-hidden="true" tabindex="-1"></a>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</span>
<span id="cb270-2019"><a href="#cb270-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2022"><a href="#cb270-2022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2023"><a href="#cb270-2023" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb270-2024"><a href="#cb270-2024" aria-hidden="true" tabindex="-1"></a>carbon_density <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">fgC_cell =</span> <span class="fu">seq</span>(<span class="dv">86</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">1</span>), </span>
<span id="cb270-2025"><a href="#cb270-2025" aria-hidden="true" tabindex="-1"></a>                             <span class="at">GRAZING_EFFECT_hr =</span> <span class="fu">seq</span>(<span class="fu">min</span>(all_vents<span class="sc">$</span>GRAZING_EFFECT_hr),</span>
<span id="cb270-2026"><a href="#cb270-2026" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">max</span>(all_vents<span class="sc">$</span>GRAZING_EFFECT_hr),</span>
<span id="cb270-2027"><a href="#cb270-2027" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">length.out =</span> <span class="dv">215</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb270-2028"><a href="#cb270-2028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fgC_ml_perday =</span> ((GRAZING_EFFECT_hr<span class="sc">*</span><span class="dv">24</span>) <span class="sc">*</span> fgC_cell),</span>
<span id="cb270-2029"><a href="#cb270-2029" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>)</span>
<span id="cb270-2030"><a href="#cb270-2030" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb270-2031"><a href="#cb270-2031" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb270-2032"><a href="#cb270-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2033"><a href="#cb270-2033" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb270-2034"><a href="#cb270-2034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2035"><a href="#cb270-2035" aria-hidden="true" tabindex="-1"></a>samples_lines <span class="ot">&lt;-</span> <span class="fu">select</span>(all_vents, GRAZING_EFFECT_hr, FIELD) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2036"><a href="#cb270-2036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-2037"><a href="#cb270-2037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">fgC_cell =</span> <span class="fu">seq</span>(<span class="dv">86</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-2038"><a href="#cb270-2038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fgC_ml_perday =</span> ((GRAZING_EFFECT_hr<span class="sc">*</span><span class="dv">24</span>) <span class="sc">*</span> fgC_cell),</span>
<span id="cb270-2039"><a href="#cb270-2039" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>)</span>
<span id="cb270-2040"><a href="#cb270-2040" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb270-2041"><a href="#cb270-2041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2042"><a href="#cb270-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2045"><a href="#cb270-2045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2046"><a href="#cb270-2046" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(carbon_density, <span class="fu">aes</span>(<span class="at">x =</span> fgC_cell, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb270-2047"><a href="#cb270-2047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ugC_L_perday)) <span class="sc">+</span></span>
<span id="cb270-2048"><a href="#cb270-2048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#fef0d9"</span>, <span class="st">"#b30000"</span>), <span class="at">name =</span> <span class="fu">bquote</span>(<span class="st">"ug C"</span><span class="sc">~</span>L<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>day<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb270-2049"><a href="#cb270-2049" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb270-2050"><a href="#cb270-2050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb270-2051"><a href="#cb270-2051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb270-2052"><a href="#cb270-2052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-2053"><a href="#cb270-2053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb270-2054"><a href="#cb270-2054" aria-hidden="true" tabindex="-1"></a>        <span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-2055"><a href="#cb270-2055" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb270-2056"><a href="#cb270-2056" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb270-2057"><a href="#cb270-2057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>consumed <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"fg C"</span><span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb270-2058"><a href="#cb270-2058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> samples_lines,</span>
<span id="cb270-2059"><a href="#cb270-2059" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">87</span>,</span>
<span id="cb270-2060"><a href="#cb270-2060" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">shape =</span> FIELD), <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb270-2061"><a href="#cb270-2061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2062"><a href="#cb270-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2063"><a href="#cb270-2063" aria-hidden="true" tabindex="-1"></a>Eukaryote biomass comparison with measured vs. literature</span>
<span id="cb270-2064"><a href="#cb270-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2067"><a href="#cb270-2067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2068"><a href="#cb270-2068" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb270-2069"><a href="#cb270-2069" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="ot">&lt;-</span> env_params <span class="sc">%&gt;%</span> </span>
<span id="cb270-2070"><a href="#cb270-2070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-2071"><a href="#cb270-2071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2072"><a href="#cb270-2072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_hr"</span>))</span>
<span id="cb270-2073"><a href="#cb270-2073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2074"><a href="#cb270-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2075"><a href="#cb270-2075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=5}</span></span>
<span id="cb270-2076"><a href="#cb270-2076" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb270-2077"><a href="#cb270-2077" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb270-2078"><a href="#cb270-2078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Euk_biomass_Hu)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2079"><a href="#cb270-2079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Euk_biomass_Hu_fg =</span> Euk_biomass_Hu <span class="sc">*</span> <span class="dv">1000000000</span>,</span>
<span id="cb270-2080"><a href="#cb270-2080" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_fg =</span> Euk_biomass_lit <span class="sc">*</span> <span class="dv">1000000000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2081"><a href="#cb270-2081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> VENT)) <span class="sc">+</span></span>
<span id="cb270-2082"><a href="#cb270-2082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Euk_biomass_Hu_fg), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb270-2083"><a href="#cb270-2083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Euk_biomass_lit), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb270-2084"><a href="#cb270-2084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb270-2085"><a href="#cb270-2085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-2086"><a href="#cb270-2086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb270-2087"><a href="#cb270-2087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(SAMPLETYPE <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb270-2088"><a href="#cb270-2088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"fg C of eukaryote population"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb270-2089"><a href="#cb270-2089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2090"><a href="#cb270-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2091"><a href="#cb270-2091" aria-hidden="true" tabindex="-1"></a><span class="fu"># Three parameter figures</span></span>
<span id="cb270-2092"><a href="#cb270-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2095"><a href="#cb270-2095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2096"><a href="#cb270-2096" aria-hidden="true" tabindex="-1"></a>density_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, area, x_title, y_title){</span>
<span id="cb270-2097"><a href="#cb270-2097" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb270-2098"><a href="#cb270-2098" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb270-2099"><a href="#cb270-2099" aria-hidden="true" tabindex="-1"></a>  AREA <span class="ot">&lt;-</span> <span class="fu">enquo</span>(area)</span>
<span id="cb270-2100"><a href="#cb270-2100" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb270-2101"><a href="#cb270-2101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR, <span class="at">raster =</span> <span class="sc">!!</span>AREA) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2102"><a href="#cb270-2102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-2103"><a href="#cb270-2103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb270-2104"><a href="#cb270-2104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> raster), <span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb270-2105"><a href="#cb270-2105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_point(size = 3, shape = 21, color = "black", aes(fill = FIELD)) +</span></span>
<span id="cb270-2106"><a href="#cb270-2106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_abline(slope = 1, intercept = 0) +</span></span>
<span id="cb270-2107"><a href="#cb270-2107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb270-2108"><a href="#cb270-2108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb270-2109"><a href="#cb270-2109" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-2110"><a href="#cb270-2110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2111"><a href="#cb270-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2114"><a href="#cb270-2114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2115"><a href="#cb270-2115" aria-hidden="true" tabindex="-1"></a><span class="fu">density_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_ml</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">`</span><span class="at">GRAZING_EFFECT_hr</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span>
<span id="cb270-2116"><a href="#cb270-2116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2117"><a href="#cb270-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2120"><a href="#cb270-2120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2121"><a href="#cb270-2121" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span>
<span id="cb270-2122"><a href="#cb270-2122" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(allvent_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(EUK_ml), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb270-2123"><a href="#cb270-2123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ugC_L_perday), <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb270-2124"><a href="#cb270-2124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2125"><a href="#cb270-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2126"><a href="#cb270-2126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot euk per ml with temperature and grazing rate</span></span>
<span id="cb270-2127"><a href="#cb270-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2128"><a href="#cb270-2128" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction of MCR data with parameters</span></span>
<span id="cb270-2129"><a href="#cb270-2129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2130"><a href="#cb270-2130" aria-hidden="true" tabindex="-1"></a>Best model to estimate community grazing rate in Vaque et al. considered FLP uptake and similar experiments (in contrast to disappearance experiments).</span>
<span id="cb270-2131"><a href="#cb270-2131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2132"><a href="#cb270-2132" aria-hidden="true" tabindex="-1"></a>From Vaque et al. 1994 paper equation (1):</span>
<span id="cb270-2133"><a href="#cb270-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2134"><a href="#cb270-2134" aria-hidden="true" tabindex="-1"></a>See Figure 6</span>
<span id="cb270-2135"><a href="#cb270-2135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2136"><a href="#cb270-2136" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</span></span>
<span id="cb270-2137"><a href="#cb270-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2138"><a href="#cb270-2138" aria-hidden="true" tabindex="-1"></a>*GT* = grazing rate (cells ml-1 hr-1) *HNF* = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) *BAC* = prokaryote abundance (cells ml-1)</span>
<span id="cb270-2139"><a href="#cb270-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2140"><a href="#cb270-2140" aria-hidden="true" tabindex="-1"></a>Start with non-zero grazing rate values, etc. Where... *GT* == Grazing effect hr *HNF* == Euk_ml *BAC* == PROK_ml *T* == highest temp</span>
<span id="cb270-2141"><a href="#cb270-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2142"><a href="#cb270-2142" aria-hidden="true" tabindex="-1"></a>We only have these for MCR data.. can include GR for the "predicting euk_ml"</span>
<span id="cb270-2143"><a href="#cb270-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2144"><a href="#cb270-2144" aria-hidden="true" tabindex="-1"></a>Function to use above formula and estimate</span>
<span id="cb270-2145"><a href="#cb270-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2148"><a href="#cb270-2148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2149"><a href="#cb270-2149" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb270-2150"><a href="#cb270-2150" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb270-2151"><a href="#cb270-2151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2152"><a href="#cb270-2152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2153"><a href="#cb270-2153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2154"><a href="#cb270-2154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb270-2155"><a href="#cb270-2155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb270-2156"><a href="#cb270-2156" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb270-2157"><a href="#cb270-2157" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb270-2158"><a href="#cb270-2158" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb270-2159"><a href="#cb270-2159" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb270-2160"><a href="#cb270-2160" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2161"><a href="#cb270-2161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb270-2162"><a href="#cb270-2162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2163"><a href="#cb270-2163" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2164"><a href="#cb270-2164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb270-2165"><a href="#cb270-2165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2166"><a href="#cb270-2166" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2167"><a href="#cb270-2167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb270-2168"><a href="#cb270-2168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2169"><a href="#cb270-2169" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2170"><a href="#cb270-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb270-2171"><a href="#cb270-2171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2172"><a href="#cb270-2172" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2173"><a href="#cb270-2173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb270-2174"><a href="#cb270-2174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2175"><a href="#cb270-2175" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2176"><a href="#cb270-2176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb270-2177"><a href="#cb270-2177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2178"><a href="#cb270-2178" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2179"><a href="#cb270-2179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb270-2180"><a href="#cb270-2180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2181"><a href="#cb270-2181" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb270-2182"><a href="#cb270-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb270-2183"><a href="#cb270-2183" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb270-2184"><a href="#cb270-2184" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb270-2185"><a href="#cb270-2185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb270-2186"><a href="#cb270-2186" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb270-2187"><a href="#cb270-2187" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb270-2188"><a href="#cb270-2188" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb270-2189"><a href="#cb270-2189" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span>
<span id="cb270-2190"><a href="#cb270-2190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2191"><a href="#cb270-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2192"><a href="#cb270-2192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2193"><a href="#cb270-2193" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span>
<span id="cb270-2194"><a href="#cb270-2194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2195"><a href="#cb270-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2196"><a href="#cb270-2196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2197"><a href="#cb270-2197" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb270-2198"><a href="#cb270-2198" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb270-2199"><a href="#cb270-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2200"><a href="#cb270-2200" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb270-2201"><a href="#cb270-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2202"><a href="#cb270-2202" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Mid-Cayman Rise only, no undetected"</span>)</span>
<span id="cb270-2203"><a href="#cb270-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2204"><a href="#cb270-2204" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0) %&gt;% filter(!(NAME %in% bsw)), "Mid-Cayman Rise only, no undetected, vents only")</span></span>
<span id="cb270-2205"><a href="#cb270-2205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2206"><a href="#cb270-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2207"><a href="#cb270-2207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2208"><a href="#cb270-2208" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"All samples where grazing was detected"</span>)</span>
<span id="cb270-2209"><a href="#cb270-2209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2210"><a href="#cb270-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2211"><a href="#cb270-2211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2212"><a href="#cb270-2212" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb270-2213"><a href="#cb270-2213" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb270-2214"><a href="#cb270-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2215"><a href="#cb270-2215" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span>
<span id="cb270-2216"><a href="#cb270-2216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2217"><a href="#cb270-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2218"><a href="#cb270-2218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2219"><a href="#cb270-2219" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb270-2220"><a href="#cb270-2220" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-2221"><a href="#cb270-2221" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2222"><a href="#cb270-2222" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2223"><a href="#cb270-2223" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb270-2224"><a href="#cb270-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2225"><a href="#cb270-2225" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-2226"><a href="#cb270-2226" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2227"><a href="#cb270-2227" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2228"><a href="#cb270-2228" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb270-2229"><a href="#cb270-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2230"><a href="#cb270-2230" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb270-2231"><a href="#cb270-2231" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb270-2232"><a href="#cb270-2232" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb270-2233"><a href="#cb270-2233" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb270-2234"><a href="#cb270-2234" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span>
<span id="cb270-2235"><a href="#cb270-2235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2236"><a href="#cb270-2236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2239"><a href="#cb270-2239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2240"><a href="#cb270-2240" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span>
<span id="cb270-2241"><a href="#cb270-2241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2242"><a href="#cb270-2242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2243"><a href="#cb270-2243" aria-hidden="true" tabindex="-1"></a>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</span>
<span id="cb270-2244"><a href="#cb270-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2245"><a href="#cb270-2245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2246"><a href="#cb270-2246" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-2247"><a href="#cb270-2247" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb270-2248"><a href="#cb270-2248" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span>
<span id="cb270-2249"><a href="#cb270-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2250"><a href="#cb270-2250" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-2251"><a href="#cb270-2251" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb270-2252"><a href="#cb270-2252" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span>
<span id="cb270-2253"><a href="#cb270-2253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2254"><a href="#cb270-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2255"><a href="#cb270-2255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb270-2256"><a href="#cb270-2256" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-2257"><a href="#cb270-2257" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-2258"><a href="#cb270-2258" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span>
<span id="cb270-2259"><a href="#cb270-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2260"><a href="#cb270-2260" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb270-2261"><a href="#cb270-2261" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-2262"><a href="#cb270-2262" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span>
<span id="cb270-2263"><a href="#cb270-2263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb270-2264"><a href="#cb270-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2265"><a href="#cb270-2265" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session</span></span>
<span id="cb270-2266"><a href="#cb270-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-2269"><a href="#cb270-2269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb270-2270"><a href="#cb270-2270" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb270-2271"><a href="#cb270-2271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>