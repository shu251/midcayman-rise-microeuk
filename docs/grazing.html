<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mid-Cayman Rise analysis - Protistan grazing analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Mid-Cayman Rise analysis</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./results.html">Summary of results</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./grazing.html" aria-current="page">Grazing analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./asv-analysis.html">Sequence analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sequence-qc.html">Sequence QC &amp; import</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-format-data" id="toc-import-format-data" class="nav-link active" data-scroll-target="#import-format-data"><span class="toc-section-number">1</span>  Import &amp; format data</a>
  <ul class="collapse">
  <li><a href="#set-up-working-r-environment" id="toc-set-up-working-r-environment" class="nav-link" data-scroll-target="#set-up-working-r-environment"><span class="toc-section-number">1.1</span>  Set up working R environment</a></li>
  <li><a href="#import-raw-count-data" id="toc-import-raw-count-data" class="nav-link" data-scroll-target="#import-raw-count-data"><span class="toc-section-number">1.2</span>  Import raw count data</a></li>
  </ul></li>
  <li><a href="#calculate-cells-per-ml-euk" id="toc-calculate-cells-per-ml-euk" class="nav-link" data-scroll-target="#calculate-cells-per-ml-euk"><span class="toc-section-number">2</span>  Calculate cells per ml (euk)</a>
  <ul class="collapse">
  <li><a href="#plot-eukaryote-cells-per-ml-for-all-time-points" id="toc-plot-eukaryote-cells-per-ml-for-all-time-points" class="nav-link" data-scroll-target="#plot-eukaryote-cells-per-ml-for-all-time-points"><span class="toc-section-number">2.1</span>  Plot eukaryote cells per ml for all time points</a>
  <ul class="collapse">
  <li><a href="#figure-s1" id="toc-figure-s1" class="nav-link" data-scroll-target="#figure-s1">Figure S1</a></li>
  </ul></li>
  <li><a href="#plot-eukaryote-cell-concentration-over-time." id="toc-plot-eukaryote-cell-concentration-over-time." class="nav-link" data-scroll-target="#plot-eukaryote-cell-concentration-over-time."><span class="toc-section-number">2.2</span>  Plot eukaryote cell concentration over time.</a></li>
  <li><a href="#plot-t0-only-counts-for-cellsml-plot" id="toc-plot-t0-only-counts-for-cellsml-plot" class="nav-link" data-scroll-target="#plot-t0-only-counts-for-cellsml-plot"><span class="toc-section-number">2.3</span>  Plot T0 only counts for cells/ml plot</a></li>
  </ul></li>
  <li><a href="#bacteria-archaea-cell-counts" id="toc-bacteria-archaea-cell-counts" class="nav-link" data-scroll-target="#bacteria-archaea-cell-counts"><span class="toc-section-number">3</span>  Bacteria &amp; archaea cell counts</a>
  <ul class="collapse">
  <li><a href="#cells-per-ml-prok" id="toc-cells-per-ml-prok" class="nav-link" data-scroll-target="#cells-per-ml-prok"><span class="toc-section-number">3.1</span>  Cells per ml (prok)</a>
  <ul class="collapse">
  <li><a href="#euk-and-prok-counts" id="toc-euk-and-prok-counts" class="nav-link" data-scroll-target="#euk-and-prok-counts">Euk and prok counts</a></li>
  <li><a href="#combine-with-previous-mcr-cell-counts" id="toc-combine-with-previous-mcr-cell-counts" class="nav-link" data-scroll-target="#combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</a></li>
  </ul></li>
  <li><a href="#compile-table-with-euk-and-prok-counts" id="toc-compile-table-with-euk-and-prok-counts" class="nav-link" data-scroll-target="#compile-table-with-euk-and-prok-counts"><span class="toc-section-number">3.2</span>  Compile table with euk and prok counts</a></li>
  </ul></li>
  <li><a href="#estimate-grazing-effect" id="toc-estimate-grazing-effect" class="nav-link" data-scroll-target="#estimate-grazing-effect"><span class="toc-section-number">4</span>  Estimate grazing effect</a>
  <ul class="collapse">
  <li><a href="#determine-flp-per-euk-cell" id="toc-determine-flp-per-euk-cell" class="nav-link" data-scroll-target="#determine-flp-per-euk-cell"><span class="toc-section-number">4.1</span>  Determine FLP per euk cell</a></li>
  <li><a href="#calculate-flp-per-euk-cell-calculation" id="toc-calculate-flp-per-euk-cell-calculation" class="nav-link" data-scroll-target="#calculate-flp-per-euk-cell-calculation"><span class="toc-section-number">4.2</span>  Calculate FLP per euk cell calculation</a>
  <ul class="collapse">
  <li><a href="#consider-igt-replicates." id="toc-consider-igt-replicates." class="nav-link" data-scroll-target="#consider-igt-replicates.">Consider IGT replicates.</a></li>
  </ul></li>
  <li><a href="#calculate-linear-regression-to-obtain-slope" id="toc-calculate-linear-regression-to-obtain-slope" class="nav-link" data-scroll-target="#calculate-linear-regression-to-obtain-slope"><span class="toc-section-number">4.3</span>  Calculate linear regression to obtain slope</a>
  <ul class="collapse">
  <li><a href="#plot-linear-regression-trend" id="toc-plot-linear-regression-trend" class="nav-link" data-scroll-target="#plot-linear-regression-trend">Plot linear regression trend</a></li>
  </ul></li>
  <li><a href="#remove-igt-tf-time-points." id="toc-remove-igt-tf-time-points." class="nav-link" data-scroll-target="#remove-igt-tf-time-points."><span class="toc-section-number">4.4</span>  Remove IGT Tf time points.</a>
  <ul class="collapse">
  <li><a href="#repeat-but-include-technical-replicates" id="toc-repeat-but-include-technical-replicates" class="nav-link" data-scroll-target="#repeat-but-include-technical-replicates">Repeat, but include technical replicates</a></li>
  </ul></li>
  <li><a href="#compile-and-save-grazing-experiment-results" id="toc-compile-and-save-grazing-experiment-results" class="nav-link" data-scroll-target="#compile-and-save-grazing-experiment-results"><span class="toc-section-number">4.5</span>  Compile and save grazing experiment results</a></li>
  </ul></li>
  <li><a href="#check-flp-control-experiments" id="toc-check-flp-control-experiments" class="nav-link" data-scroll-target="#check-flp-control-experiments"><span class="toc-section-number">5</span>  Check FLP control experiments</a>
  <ul class="collapse">
  <li><a href="#bag-grazing-experiment-controls" id="toc-bag-grazing-experiment-controls" class="nav-link" data-scroll-target="#bag-grazing-experiment-controls"><span class="toc-section-number">5.1</span>  Bag grazing experiment controls</a></li>
  <li><a href="#igt-experiment-controls" id="toc-igt-experiment-controls" class="nav-link" data-scroll-target="#igt-experiment-controls"><span class="toc-section-number">5.2</span>  IGT experiment controls</a></li>
  </ul></li>
  <li><a href="#generate-complete-table-with-grazing-rates-and-values" id="toc-generate-complete-table-with-grazing-rates-and-values" class="nav-link" data-scroll-target="#generate-complete-table-with-grazing-rates-and-values"><span class="toc-section-number">6</span>  Generate complete table with grazing rates and values</a>
  <ul class="collapse">
  <li><a href="#plot-flpgrazer-minute" id="toc-plot-flpgrazer-minute" class="nav-link" data-scroll-target="#plot-flpgrazer-minute"><span class="toc-section-number">6.1</span>  Plot FLP/grazer /minute</a>
  <ul class="collapse">
  <li><a href="#table-1" id="toc-table-1" class="nav-link" data-scroll-target="#table-1">Table 1</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#grazing-rate-calculations" id="toc-grazing-rate-calculations" class="nav-link" data-scroll-target="#grazing-rate-calculations"><span class="toc-section-number">7</span>  Grazing rate calculations</a>
  <ul class="collapse">
  <li><a href="#gt-table-options" id="toc-gt-table-options" class="nav-link" data-scroll-target="#gt-table-options">gt table options</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-for-eukaryotes" id="toc-carbon-biomass-for-eukaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-eukaryotes"><span class="toc-section-number">8</span>  Carbon biomass for eukaryotes</a>
  <ul class="collapse">
  <li><a href="#c-factor-based-on-biovolume" id="toc-c-factor-based-on-biovolume" class="nav-link" data-scroll-target="#c-factor-based-on-biovolume"><span class="toc-section-number">8.1</span>  C factor based on biovolume</a></li>
  <li><a href="#table-s4-biomass-summaries" id="toc-table-s4-biomass-summaries" class="nav-link" data-scroll-target="#table-s4-biomass-summaries"><span class="toc-section-number">8.2</span>  Table S4 biomass summaries</a></li>
  <li><a href="#c-biomass-based-on-size-fraction" id="toc-c-biomass-based-on-size-fraction" class="nav-link" data-scroll-target="#c-biomass-based-on-size-fraction"><span class="toc-section-number">8.3</span>  C biomass based on size fraction</a></li>
  <li><a href="#figure-s2" id="toc-figure-s2" class="nav-link" data-scroll-target="#figure-s2"><span class="toc-section-number">8.4</span>  Figure S2</a></li>
  <li><a href="#compare-total-carbon-biomass---euks" id="toc-compare-total-carbon-biomass---euks" class="nav-link" data-scroll-target="#compare-total-carbon-biomass---euks"><span class="toc-section-number">8.5</span>  Compare total carbon biomass - euks</a>
  <ul class="collapse">
  <li><a href="#table-s4" id="toc-table-s4" class="nav-link" data-scroll-target="#table-s4">Table S4</a></li>
  </ul></li>
  <li><a href="#compare-biovolumes-from-literature-to-measured-in-this-study" id="toc-compare-biovolumes-from-literature-to-measured-in-this-study" class="nav-link" data-scroll-target="#compare-biovolumes-from-literature-to-measured-in-this-study"><span class="toc-section-number">8.6</span>  Compare biovolumes from literature to measured in this study</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-for-prokaryotes" id="toc-carbon-biomass-for-prokaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-prokaryotes"><span class="toc-section-number">9</span>  Carbon biomass for prokaryotes</a>
  <ul class="collapse">
  <li><a href="#incorporate-carbon-biomass-of-prey-and-grazing-rate" id="toc-incorporate-carbon-biomass-of-prey-and-grazing-rate" class="nav-link" data-scroll-target="#incorporate-carbon-biomass-of-prey-and-grazing-rate"><span class="toc-section-number">9.1</span>  Incorporate carbon biomass of prey and grazing rate</a></li>
  </ul></li>
  <li><a href="#environmental-parameters---mcr" id="toc-environmental-parameters---mcr" class="nav-link" data-scroll-target="#environmental-parameters---mcr"><span class="toc-section-number">10</span>  Environmental parameters - MCR</a></li>
  <li><a href="#analysis-of-grazing-rate-results" id="toc-analysis-of-grazing-rate-results" class="nav-link" data-scroll-target="#analysis-of-grazing-rate-results"><span class="toc-section-number">11</span>  Analysis of grazing rate results</a></li>
  <li><a href="#figure-1-compilation" id="toc-figure-1-compilation" class="nav-link" data-scroll-target="#figure-1-compilation"><span class="toc-section-number">12</span>  Figure 1 compilation</a>
  <ul class="collapse">
  <li><a href="#grazing-rate-vs.-cells-ml" id="toc-grazing-rate-vs.-cells-ml" class="nav-link" data-scroll-target="#grazing-rate-vs.-cells-ml"><span class="toc-section-number">12.1</span>  Grazing rate vs.&nbsp;cells ml</a></li>
  </ul></li>
  <li><a href="#figure-2-compilation" id="toc-figure-2-compilation" class="nav-link" data-scroll-target="#figure-2-compilation"><span class="toc-section-number">13</span>  Figure 2 compilation</a></li>
  <li><a href="#comparison-with-gorda-ridge" id="toc-comparison-with-gorda-ridge" class="nav-link" data-scroll-target="#comparison-with-gorda-ridge"><span class="toc-section-number">14</span>  Comparison with Gorda Ridge</a>
  <ul class="collapse">
  <li><a href="#combine-gr-and-mcr-data" id="toc-combine-gr-and-mcr-data" class="nav-link" data-scroll-target="#combine-gr-and-mcr-data"><span class="toc-section-number">14.1</span>  Combine GR and MCR data</a></li>
  <li><a href="#plot-combined-results" id="toc-plot-combined-results" class="nav-link" data-scroll-target="#plot-combined-results"><span class="toc-section-number">14.2</span>  Plot combined results</a>
  <ul class="collapse">
  <li><a href="#remove-undetected-grazing-rate" id="toc-remove-undetected-grazing-rate" class="nav-link" data-scroll-target="#remove-undetected-grazing-rate">Remove undetected grazing rate</a></li>
  </ul></li>
  <li><a href="#plot-variables-as-a-factor-of-grazing-rate." id="toc-plot-variables-as-a-factor-of-grazing-rate." class="nav-link" data-scroll-target="#plot-variables-as-a-factor-of-grazing-rate."><span class="toc-section-number">14.3</span>  Plot variables as a factor of grazing rate.</a></li>
  </ul></li>
  <li><a href="#linear-regression-tidy-models" id="toc-linear-regression-tidy-models" class="nav-link" data-scroll-target="#linear-regression-tidy-models"><span class="toc-section-number">15</span>  Linear regression &amp; tidy models</a>
  <ul class="collapse">
  <li><a href="#mcr-and-gr-data-as-input" id="toc-mcr-and-gr-data-as-input" class="nav-link" data-scroll-target="#mcr-and-gr-data-as-input"><span class="toc-section-number">15.1</span>  MCR and GR data as input</a></li>
  <li><a href="#mcr-only" id="toc-mcr-only" class="nav-link" data-scroll-target="#mcr-only"><span class="toc-section-number">15.2</span>  MCR only</a></li>
  <li><a href="#mcr-vent-sites-only" id="toc-mcr-vent-sites-only" class="nav-link" data-scroll-target="#mcr-vent-sites-only"><span class="toc-section-number">15.3</span>  MCR vent sites only</a></li>
  <li><a href="#plot-temperature-by-eukprok-and-then-euk-and-prok" id="toc-plot-temperature-by-eukprok-and-then-euk-and-prok" class="nav-link" data-scroll-target="#plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="toc-section-number">15.4</span>  Plot temperature by euk:prok and then euk and prok</a></li>
  <li><a href="#plot-temperature-by-grazing-rate" id="toc-plot-temperature-by-grazing-rate" class="nav-link" data-scroll-target="#plot-temperature-by-grazing-rate"><span class="toc-section-number">15.5</span>  Plot temperature by grazing rate</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-investigation" id="toc-carbon-biomass-investigation" class="nav-link" data-scroll-target="#carbon-biomass-investigation"><span class="toc-section-number">16</span>  Carbon biomass investigation</a></li>
  <li><a href="#prediction-of-mcr-data-with-parameters" id="toc-prediction-of-mcr-data-with-parameters" class="nav-link" data-scroll-target="#prediction-of-mcr-data-with-parameters"><span class="toc-section-number">17</span>  Prediction of MCR data with parameters</a></li>
  <li><a href="#session" id="toc-session" class="nav-link" data-scroll-target="#session"><span class="toc-section-number">18</span>  Session</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Protistan grazing analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="import-format-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Import &amp; format data</h1>
<p>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</p>
<section id="set-up-working-r-environment" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="set-up-working-r-environment"><span class="header-section-number">1.1</span> Set up working R environment</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Set color schematic</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_ids &lt;- c("BSW","Plume", "Shrimpocalypse", "LotsOShrimp", "X18", "OMT", "Rav2", "MustardStand", "ShrimpHole")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_fullname &lt;- c("Background","Plume", "Shrimpocalypse", "Lots 'O Shrimp", "X-18", "Old Man Tree", "Ravelin #2", "Mustard Stand", "Shrimp Hole")</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by temperature</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>whole_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>,<span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#eae2b7"</span>, <span class="st">"#5f0f40"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#941b0c"</span>, <span class="st">"#577590"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-raw-count-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="import-raw-count-data"><span class="header-section-number">1.2</span> Import raw count data</h2>
<p>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more ‘R’ friendly.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DATE"         "SAMPLE"       "EXPID"        "VOL"          "MAG"         
 [6] "FOV"          "nanoNoFLP"    "microNoFLP"   "nanoFLP"      "microFLP"    
[11] "NOTES"        "DateCompiled"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</p>
</blockquote>
<p>Parse raw microscopy count data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calculate-cells-per-ml-euk" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Calculate cells per ml (euk)</h1>
<p>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionally, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to &gt;20um and nano is &lt;20um. All counts were done at 100x magnification, confirm this: <code>unique(counts_occur$MAG)</code>.</p>
<p>Calculate cell concentration (cells/ml).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</p>
</blockquote>
<p>Average cells/ml across replicates, pivot to long format</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOTES on calculations:</p>
<p><em>VAR</em> = takes the sum of the squares of each value’s deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</p>
<p><em>SD</em> = standard deviation of all values</p>
<p><em>SEM</em> = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</p>
<p>Save output file</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-eukaryote-cells-per-ml-for-all-time-points" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="plot-eukaryote-cells-per-ml-for-all-time-points"><span class="header-section-number">2.1</span> Plot eukaryote cells per ml for all time points</h2>
<p>The average euk cells per ml value was taken when TRUE replicates were conducted and we observed a cell count.</p>
<p>Plot all euk cell counts for supplement</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by temperature</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_avg)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="figure-s1" class="level3">
<h3 class="anchored" data-anchor-id="figure-s1">Figure S1</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS1.svg")</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot with outline vs. solid circle</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">group =</span> NameOrder,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">color =</span> VARIABLE,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE, <span class="at">color =</span> VARIABLE,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: fill,
colour
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: fill,
colour
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: fill,
colour
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: fill,
colour
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="768"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. ~300 cells/ml in background and plume compared to ~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</p>
<blockquote class="blockquote">
<p>Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 * interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</p>
</blockquote>
<blockquote class="blockquote">
<p>eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</p>
</blockquote>
</section>
</section>
<section id="plot-eukaryote-cell-concentration-over-time." class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="plot-eukaryote-cell-concentration-over-time."><span class="header-section-number">2.2</span> Plot eukaryote cell concentration over time.</h2>
<p>Include plot over time. #### Figure S4</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS4.svg")</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, NameOrder, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_CATEGORY, <span class="at">fill =</span> NameOrder, </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment_rep), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> NameOrder, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</p>
</blockquote>
</section>
<section id="plot-t0-only-counts-for-cellsml-plot" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="plot-t0-only-counts-for-cellsml-plot"><span class="header-section-number">2.3</span> Plot T0 only counts for cells/ml plot</h2>
<p>For Figure 1a</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">shape =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cfacet_grid(. ~ SiteOrder, scales = "free") +</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>euk_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Last saved - April 13, 2023</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(counts_cellsml_all, counts_cellsml_avg, counts_occur, <span class="at">file =</span> <span class="st">"output-data/MCR-cellcount-dfs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="bacteria-archaea-cell-counts" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Bacteria &amp; archaea cell counts</h1>
<p>DAPI slide counts from prokaryotes from same sites. Import and compare.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CELLML),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CELLML),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cells-per-ml-prok" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="cells-per-ml-prok"><span class="header-section-number">3.1</span> Cells per ml (prok)</h2>
<p>Visualize counts from proks. Get summary of prok counts, and incorporate into plot</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># insitu_proks$Name</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Name <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group_by(type) %&gt;% </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(MEAN),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(MEAN),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(MEAN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'type'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   type [2]
  type     Site       mean    min     max
  &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 non-vent Piccard  31645. 11860.  51429.
2 non-vent VD       27184. 16478.  37890.
3 vent     Piccard 109713. 53878. 238586.
4 vent     VD       40907.  8816. 111430.</code></pre>
</div>
</div>
<p>Factor site names, etc.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordered by temperature</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"MustardStand"</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Rav2"</span>, <span class="st">"OMT"</span>,<span class="st">"Bartizan"</span>,<span class="st">"ArrowLoop"</span>, <span class="st">"Rav1"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Quakeplume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"SouthofHotChimlet"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"SouthofLungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"ShrimpGulley"</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"HotChimlet1"</span>), </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>,<span class="st">"Mustard Stand"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Ravelin #2"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Ravelin #1"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                                          </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Quakeplume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"South of Hot Chimlet"</span>, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"South of LungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"Hot Chimlet #1"</span>))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>site_fill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># names(site_color) &lt;- site_fullname</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">color =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>prok_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="euk-and-prok-counts" class="level3">
<h3 class="anchored" data-anchor-id="euk-and-prok-counts">Euk and prok counts</h3>
<p>Combined eukaryote and prokaryote cell counts ## Figure 1a-b</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>euk_prok_ab <span class="ot">&lt;-</span> (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>euk_prok_ab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combine-with-previous-mcr-cell-counts" class="level3">
<h3 class="anchored" data-anchor-id="combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</h3>
<p>Compare <em>in situ</em> prokaryote cell counts from 2020 to previous years</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Re-import 2020 data to compare.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot by year.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(counts_cellsml_avg)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>prok_tojoin <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MEAN), <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MIN), <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MAX), <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"PROK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, <span class="at">PROK_ml =</span> MEAN_SIG, PROK_MinMax, <span class="at">PROK_sem =</span> SEM)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># prok_tojoin</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compile-table-with-euk-and-prok-counts" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="compile-table-with-euk-and-prok-counts"><span class="header-section-number">3.2</span> Compile table with euk and prok counts</h2>
<p>Part of Table 1.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(MEAN, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(MIN, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(MAX, <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"EUK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, SITE_TYPE, Experiment, Experiment_rep, VARIABLE, <span class="at">EUK_ml =</span> MEAN_SIG, EUK_MinMax, <span class="at">EUK_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prok_tojoin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Site, Name)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="co"># add to this later for Table 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Site           Name         SITE_TYPE               Experiment
1  Piccard    LotsOShrimp Piccard-Shipboard    LotsOShrimp-Shipboard
2  Piccard          Plume Piccard-Shipboard          Plume-Shipboard
3  Piccard Shrimpocalypse Piccard-Shipboard Shrimpocalypse-Shipboard
4  Piccard Shrimpocalypse       Piccard-IGT       Shrimpocalypse-IGT
5  Piccard Shrimpocalypse       Piccard-IGT       Shrimpocalypse-IGT
6       VD            BSW      VD-Shipboard            BSW-Shipboard
7       VD   MustardStand      VD-Shipboard   MustardStand-Shipboard
8       VD            OMT            VD-IGT                  OMT-IGT
9       VD          Plume      VD-Shipboard          Plume-Shipboard
10      VD           Rav2      VD-Shipboard           Rav2-Shipboard
11      VD           Rav2            VD-IGT                 Rav2-IGT
12      VD           Rav2            VD-IGT                 Rav2-IGT
13      VD     ShrimpHole      VD-Shipboard     ShrimpHole-Shipboard
14      VD            X18      VD-Shipboard            X18-Shipboard
             Experiment_rep VARIABLE  EUK_ml    EUK_MinMax    EUK_sem PROK_ml
1     LotsOShrimp-Shipboard  eukCONC 230.910 230.9 / 230.9         NA   53878
2           Plume-Shipboard  eukCONC  79.301   55.98 / 112  16.819081   51429
3  Shrimpocalypse-Shipboard  eukCONC 454.820 454.8 / 454.8         NA  238590
4       Shrimpocalypse-IGT3  eukCONC 384.840 384.8 / 384.8         NA  238590
5       Shrimpocalypse-IGT7  eukCONC 524.790 524.8 / 524.8         NA  238590
6             BSW-Shipboard  eukCONC  91.838 69.97 / 113.7  21.866127   37890
7    MustardStand-Shipboard  eukCONC 259.770 230.9 / 288.6  28.863287   56677
8                  OMT-IGT4  eukCONC 349.860 349.9 / 349.9         NA      NA
9           Plume-Shipboard  eukCONC 157.770 55.98 / 284.4  67.098589   16478
10           Rav2-Shipboard  eukCONC 409.330 335.9 / 482.8  73.470185      NA
11                Rav2-IGT4  eukCONC 944.620 944.6 / 944.6         NA      NA
12                Rav2-IGT5  eukCONC 629.740 629.7 / 629.7         NA      NA
13     ShrimpHole-Shipboard  eukCONC 385.720 377.8 / 393.6   7.871806   41983
14            X18-Shipboard  eukCONC 314.870 209.9 / 419.8 104.957407  111430
       PROK_MinMax  PROK_sem
1    26240 / 90260 13727.191
2    46810 / 56050  4618.126
3  108700 / 322000 65792.588
4  108700 / 322000 65792.588
5  108700 / 322000 65792.588
6    18470 / 56470  8608.427
7    42400 / 70950 14274.207
8             &lt;NA&gt;        NA
9    13850 / 19100  2623.935
10            &lt;NA&gt;        NA
11            &lt;NA&gt;        NA
12            &lt;NA&gt;        NA
13   38830 / 45130  3148.722
14 108500 / 114400  2973.793</code></pre>
</div>
</div>
</section>
</section>
<section id="estimate-grazing-effect" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Estimate grazing effect</h1>
<p>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  counts_cellsml_all
  counts_cellsml_avg
  counts_occur</code></pre>
</div>
</div>
<section id="determine-flp-per-euk-cell" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="determine-flp-per-euk-cell"><span class="header-section-number">4.1</span> Determine FLP per euk cell</h2>
<p>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <code>counts_occur</code> data frame from above.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>optional gut check of data table modification</em></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Isolate counts that are &gt;0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_flp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               SAMPLE    EXPID EXP_TYPE IGT_REP   SizeFrac total_FLP
1 Piccard-LotsOShrimp  T0-Rep3      Bag     Bag  nano_size         3
2 Piccard-LotsOShrimp T15-Rep3      Bag     Bag micro_size         1
3 Piccard-LotsOShrimp T15-Rep3      Bag     Bag  nano_size         3
4 Piccard-LotsOShrimp T20-Rep3      Bag     Bag  nano_size         2
5       Piccard-Plume  T0-Rep1      Bag     Bag micro_size         2
6       Piccard-Plume  T0-Rep1      Bag     Bag  nano_size         4
  total_euks_wflp
1               2
2               1
3               2
4               1
5               1
6               3</code></pre>
</div>
</div>
<p>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</p>
<p>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</p>
<blockquote class="blockquote">
<p>Below code repeats process and compiles with other FLP/euk cell data.</p>
</blockquote>
<p>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculate-flp-per-euk-cell-calculation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="calculate-flp-per-euk-cell-calculation"><span class="header-section-number">4.2</span> Calculate FLP per euk cell calculation</h2>
<p>First need to import and compile with metadata to get exact timing of experiments.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add metadata.</p>
<section id="consider-igt-replicates." class="level3">
<h3 class="anchored" data-anchor-id="consider-igt-replicates.">Consider IGT replicates.</h3>
<p>IGT_#_ denotes a separate IGT experiment. Due to bottle effects and the need to look at how replicate experiments compared, lets keep these separate. For IGT experiments labeled “b”, this means the OTHER HALF of the filter was counted or re-counted as a way to confirm my euk counting was precise.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, use this to include them as replicates</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) %&gt;%</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    SAMPLE    Site          Experiment           Name    EXPID
1      Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp  T0-Rep3
2      Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T15-Rep3
3      Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T20-Rep3
4      Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T40-Rep3
5            Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep1
6            Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep2
7            Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep3
8            Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep1
9            Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep2
10           Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep3
11           Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep1
12           Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep2
13           Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep3
14           Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep1
15           Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep2
16           Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep3
17           Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep1
18           Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep2
19           Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep3
20  Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T0-IGT3
21  Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse  T0-Rep3
22  Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T1-IGT3
23  Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T10-Rep3
24  Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T15-Rep3
25  Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T2-IGT3
26  Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T20-Rep3
27  Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T3-IGT3
28  Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T40-Rep3
29                  VD-BSW      VD             BSW-Bag            BSW  T0-Rep1
30                  VD-BSW      VD             BSW-Bag            BSW  T0-Rep2
31                  VD-BSW      VD             BSW-Bag            BSW T10-Rep2
32                  VD-BSW      VD             BSW-Bag            BSW T10-Rep3
33                  VD-BSW      VD             BSW-Bag            BSW T15-Rep1
34                  VD-BSW      VD             BSW-Bag            BSW T15-Rep2
35                  VD-BSW      VD             BSW-Bag            BSW T15-Rep3
36                  VD-BSW      VD             BSW-Bag            BSW T20-Rep1
37                  VD-BSW      VD             BSW-Bag            BSW T20-Rep2
38                  VD-BSW      VD             BSW-Bag            BSW T20-Rep3
39                  VD-BSW      VD             BSW-Bag            BSW T40-Rep1
40                  VD-BSW      VD             BSW-Bag            BSW T40-Rep2
41                  VD-BSW      VD             BSW-Bag            BSW T40-Rep3
42         VD-MustardStand      VD    MustardStand-Bag   MustardStand  T0-Rep1
43         VD-MustardStand      VD    MustardStand-Bag   MustardStand  T0-Rep2
44         VD-MustardStand      VD    MustardStand-Bag   MustardStand T10-Rep1
45         VD-MustardStand      VD    MustardStand-Bag   MustardStand T20-Rep2
46         VD-MustardStand      VD    MustardStand-Bag   MustardStand T40-Rep1
47         VD-MustardStand      VD    MustardStand-Bag   MustardStand T40-Rep2
48                  VD-OMT      VD            OMT-IGT4            OMT  T0-IGT4
49                  VD-OMT      VD            OMT-IGT4            OMT T0-IGT4b
50                  VD-OMT      VD            OMT-IGT4            OMT  T1-IGT4
51                  VD-OMT      VD            OMT-IGT4            OMT T1-IGT4b
52                  VD-OMT      VD            OMT-IGT4            OMT  T2-IGT4
53                  VD-OMT      VD            OMT-IGT4            OMT T2-IGT4b
54                  VD-OMT      VD            OMT-IGT4            OMT  T3-IGT4
55                  VD-OMT      VD            OMT-IGT4            OMT T3-IGT4b
56                VD-Plume      VD           Plume-Bag          Plume  T0-Rep1
57                VD-Plume      VD           Plume-Bag          Plume  T0-Rep2
58                VD-Plume      VD           Plume-Bag          Plume  T0-Rep3
59                VD-Plume      VD           Plume-Bag          Plume T10-Rep1
60                VD-Plume      VD           Plume-Bag          Plume T10-Rep2
61                VD-Plume      VD           Plume-Bag          Plume T10-Rep3
62                VD-Plume      VD           Plume-Bag          Plume T15-Rep1
63                VD-Plume      VD           Plume-Bag          Plume T15-Rep2
64                VD-Plume      VD           Plume-Bag          Plume T15-Rep3
65                VD-Plume      VD           Plume-Bag          Plume T20-Rep1
66                VD-Plume      VD           Plume-Bag          Plume T20-Rep2
67                VD-Plume      VD           Plume-Bag          Plume T20-Rep3
68                VD-Plume      VD           Plume-Bag          Plume T40-Rep1
69                VD-Plume      VD           Plume-Bag          Plume T40-Rep2
70                VD-Plume      VD           Plume-Bag          Plume T40-Rep3
71                 VD-Rav2      VD           Rav2-IGT4           Rav2  T0-IGT4
72                 VD-Rav2      VD           Rav2-IGT4           Rav2 T0-IGT4b
73                 VD-Rav2      VD           Rav2-IGT5           Rav2  T0-IGT5
74                 VD-Rav2      VD           Rav2-IGT5           Rav2 T0-IGT5b
75                 VD-Rav2      VD            Rav2-Bag           Rav2  T0-Rep1
76                 VD-Rav2      VD            Rav2-Bag           Rav2  T0-Rep2
77                 VD-Rav2      VD           Rav2-IGT4           Rav2  T1-IGT4
78                 VD-Rav2      VD           Rav2-IGT5           Rav2  T1-IGT5
79                 VD-Rav2      VD            Rav2-Bag           Rav2 T10-Rep1
80                 VD-Rav2      VD            Rav2-Bag           Rav2 T10-Rep2
81                 VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep1
82                 VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep2
83                 VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep3
84                 VD-Rav2      VD           Rav2-IGT4           Rav2  T2-IGT4
85                 VD-Rav2      VD           Rav2-IGT4           Rav2 T2-IGT4b
86                 VD-Rav2      VD           Rav2-IGT5           Rav2  T2-IGT5
87                 VD-Rav2      VD            Rav2-Bag           Rav2 T20-Rep1
88                 VD-Rav2      VD            Rav2-Bag           Rav2 T20-Rep2
89                 VD-Rav2      VD           Rav2-IGT4           Rav2  T3-IGT4
90                 VD-Rav2      VD           Rav2-IGT4           Rav2 T3-IGT4b
91                 VD-Rav2      VD           Rav2-IGT5           Rav2  T3-IGT5
92                 VD-Rav2      VD           Rav2-IGT5           Rav2 T3-IGT5b
93                 VD-Rav2      VD            Rav2-Bag           Rav2 T40-Rep1
94                 VD-Rav2      VD            Rav2-Bag           Rav2 T40-Rep2
95           VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole  T0-Rep1
96           VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole  T0-Rep2
97           VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T10-Rep1
98           VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T10-Rep2
99           VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T15-Rep1
100          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T15-Rep2
101          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T20-Rep1
102          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T20-Rep2
103          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T40-Rep1
104          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T40-Rep2
105                 VD-X18      VD             X18-Bag            X18  T0-Rep1
106                 VD-X18      VD             X18-Bag            X18  T0-Rep2
107                 VD-X18      VD             X18-Bag            X18 T15-Rep1
108                 VD-X18      VD             X18-Bag            X18 T15-Rep2
109                 VD-X18      VD             X18-Bag            X18 T20-Rep1
110                 VD-X18      VD             X18-Bag            X18 T20-Rep2
111                 VD-X18      VD             X18-Bag            X18 T40-Rep1
112                 VD-X18      VD             X18-Bag            X18 T40-Rep2
113    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp  T0-Rep3
114    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp  T0-Rep3
115    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T15-Rep3
116    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T15-Rep3
117    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T20-Rep3
118    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T20-Rep3
119    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T40-Rep3
120    Piccard-LotsOShrimp Piccard     LotsOShrimp-Bag    LotsOShrimp T40-Rep3
121          Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep1
122          Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep1
123          Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep2
124          Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep2
125          Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep3
126          Piccard-Plume Piccard           Plume-Bag          Plume  T0-Rep3
127          Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep1
128          Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep1
129          Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep2
130          Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep2
131          Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep3
132          Piccard-Plume Piccard           Plume-Bag          Plume T10-Rep3
133          Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep1
134          Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep1
135          Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep2
136          Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep2
137          Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep3
138          Piccard-Plume Piccard           Plume-Bag          Plume T15-Rep3
139          Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep1
140          Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep1
141          Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep2
142          Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep2
143          Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep3
144          Piccard-Plume Piccard           Plume-Bag          Plume T20-Rep3
145          Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep1
146          Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep1
147          Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep2
148          Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep2
149          Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep3
150          Piccard-Plume Piccard           Plume-Bag          Plume T40-Rep3
151 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T0-IGT3
152 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T0-IGT3
153 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse  T0-Rep3
154 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse  T0-Rep3
155 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T1-IGT3
156 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T1-IGT3
157 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T10-Rep3
158 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T10-Rep3
159 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T15-Rep3
160 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T15-Rep3
161 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T2-IGT3
162 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T2-IGT3
163 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T20-Rep3
164 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T20-Rep3
165 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T3-IGT3
166 Piccard-Shrimpocalypse Piccard Shrimpocalypse-IGT3 Shrimpocalypse  T3-IGT3
167 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T40-Rep3
168 Piccard-Shrimpocalypse Piccard  Shrimpocalypse-Bag Shrimpocalypse T40-Rep3
169                 VD-BSW      VD             BSW-Bag            BSW  T0-Rep1
170                 VD-BSW      VD             BSW-Bag            BSW  T0-Rep1
171                 VD-BSW      VD             BSW-Bag            BSW  T0-Rep2
172                 VD-BSW      VD             BSW-Bag            BSW  T0-Rep2
173                 VD-BSW      VD             BSW-Bag            BSW T10-Rep2
174                 VD-BSW      VD             BSW-Bag            BSW T10-Rep2
175                 VD-BSW      VD             BSW-Bag            BSW T10-Rep3
176                 VD-BSW      VD             BSW-Bag            BSW T10-Rep3
177                 VD-BSW      VD             BSW-Bag            BSW T15-Rep1
178                 VD-BSW      VD             BSW-Bag            BSW T15-Rep1
179                 VD-BSW      VD             BSW-Bag            BSW T15-Rep2
180                 VD-BSW      VD             BSW-Bag            BSW T15-Rep2
181                 VD-BSW      VD             BSW-Bag            BSW T15-Rep3
182                 VD-BSW      VD             BSW-Bag            BSW T15-Rep3
183                 VD-BSW      VD             BSW-Bag            BSW T20-Rep1
184                 VD-BSW      VD             BSW-Bag            BSW T20-Rep1
185                 VD-BSW      VD             BSW-Bag            BSW T20-Rep2
186                 VD-BSW      VD             BSW-Bag            BSW T20-Rep2
187                 VD-BSW      VD             BSW-Bag            BSW T20-Rep3
188                 VD-BSW      VD             BSW-Bag            BSW T20-Rep3
189                 VD-BSW      VD             BSW-Bag            BSW T40-Rep1
190                 VD-BSW      VD             BSW-Bag            BSW T40-Rep1
191                 VD-BSW      VD             BSW-Bag            BSW T40-Rep2
192                 VD-BSW      VD             BSW-Bag            BSW T40-Rep2
193                 VD-BSW      VD             BSW-Bag            BSW T40-Rep3
194                 VD-BSW      VD             BSW-Bag            BSW T40-Rep3
195        VD-MustardStand      VD    MustardStand-Bag   MustardStand  T0-Rep1
196        VD-MustardStand      VD    MustardStand-Bag   MustardStand  T0-Rep1
197        VD-MustardStand      VD    MustardStand-Bag   MustardStand  T0-Rep2
198        VD-MustardStand      VD    MustardStand-Bag   MustardStand  T0-Rep2
199        VD-MustardStand      VD    MustardStand-Bag   MustardStand T10-Rep1
200        VD-MustardStand      VD    MustardStand-Bag   MustardStand T10-Rep1
201        VD-MustardStand      VD    MustardStand-Bag   MustardStand T20-Rep2
202        VD-MustardStand      VD    MustardStand-Bag   MustardStand T20-Rep2
203        VD-MustardStand      VD    MustardStand-Bag   MustardStand T40-Rep1
204        VD-MustardStand      VD    MustardStand-Bag   MustardStand T40-Rep1
205        VD-MustardStand      VD    MustardStand-Bag   MustardStand T40-Rep2
206        VD-MustardStand      VD    MustardStand-Bag   MustardStand T40-Rep2
207                 VD-OMT      VD            OMT-IGT4            OMT  T0-IGT4
208                 VD-OMT      VD            OMT-IGT4            OMT  T0-IGT4
209                 VD-OMT      VD            OMT-IGT4            OMT T0-IGT4b
210                 VD-OMT      VD            OMT-IGT4            OMT T0-IGT4b
211                 VD-OMT      VD            OMT-IGT4            OMT  T1-IGT4
212                 VD-OMT      VD            OMT-IGT4            OMT  T1-IGT4
213                 VD-OMT      VD            OMT-IGT4            OMT T1-IGT4b
214                 VD-OMT      VD            OMT-IGT4            OMT T1-IGT4b
215                 VD-OMT      VD            OMT-IGT4            OMT  T2-IGT4
216                 VD-OMT      VD            OMT-IGT4            OMT  T2-IGT4
217                 VD-OMT      VD            OMT-IGT4            OMT T2-IGT4b
218                 VD-OMT      VD            OMT-IGT4            OMT T2-IGT4b
219                 VD-OMT      VD            OMT-IGT4            OMT  T3-IGT4
220                 VD-OMT      VD            OMT-IGT4            OMT  T3-IGT4
221                 VD-OMT      VD            OMT-IGT4            OMT T3-IGT4b
222                 VD-OMT      VD            OMT-IGT4            OMT T3-IGT4b
223               VD-Plume      VD           Plume-Bag          Plume  T0-Rep1
224               VD-Plume      VD           Plume-Bag          Plume  T0-Rep1
225               VD-Plume      VD           Plume-Bag          Plume  T0-Rep2
226               VD-Plume      VD           Plume-Bag          Plume  T0-Rep2
227               VD-Plume      VD           Plume-Bag          Plume  T0-Rep3
228               VD-Plume      VD           Plume-Bag          Plume  T0-Rep3
229               VD-Plume      VD           Plume-Bag          Plume T10-Rep1
230               VD-Plume      VD           Plume-Bag          Plume T10-Rep1
231               VD-Plume      VD           Plume-Bag          Plume T10-Rep2
232               VD-Plume      VD           Plume-Bag          Plume T10-Rep2
233               VD-Plume      VD           Plume-Bag          Plume T10-Rep3
234               VD-Plume      VD           Plume-Bag          Plume T10-Rep3
235               VD-Plume      VD           Plume-Bag          Plume T15-Rep1
236               VD-Plume      VD           Plume-Bag          Plume T15-Rep1
237               VD-Plume      VD           Plume-Bag          Plume T15-Rep2
238               VD-Plume      VD           Plume-Bag          Plume T15-Rep2
239               VD-Plume      VD           Plume-Bag          Plume T15-Rep3
240               VD-Plume      VD           Plume-Bag          Plume T15-Rep3
241               VD-Plume      VD           Plume-Bag          Plume T20-Rep1
242               VD-Plume      VD           Plume-Bag          Plume T20-Rep1
243               VD-Plume      VD           Plume-Bag          Plume T20-Rep2
244               VD-Plume      VD           Plume-Bag          Plume T20-Rep2
245               VD-Plume      VD           Plume-Bag          Plume T20-Rep3
246               VD-Plume      VD           Plume-Bag          Plume T20-Rep3
247               VD-Plume      VD           Plume-Bag          Plume T40-Rep1
248               VD-Plume      VD           Plume-Bag          Plume T40-Rep1
249               VD-Plume      VD           Plume-Bag          Plume T40-Rep2
250               VD-Plume      VD           Plume-Bag          Plume T40-Rep2
251               VD-Plume      VD           Plume-Bag          Plume T40-Rep3
252               VD-Plume      VD           Plume-Bag          Plume T40-Rep3
253                VD-Rav2      VD           Rav2-IGT4           Rav2  T0-IGT4
254                VD-Rav2      VD           Rav2-IGT4           Rav2  T0-IGT4
255                VD-Rav2      VD           Rav2-IGT4           Rav2 T0-IGT4b
256                VD-Rav2      VD           Rav2-IGT4           Rav2 T0-IGT4b
257                VD-Rav2      VD           Rav2-IGT5           Rav2  T0-IGT5
258                VD-Rav2      VD           Rav2-IGT5           Rav2  T0-IGT5
259                VD-Rav2      VD           Rav2-IGT5           Rav2 T0-IGT5b
260                VD-Rav2      VD           Rav2-IGT5           Rav2 T0-IGT5b
261                VD-Rav2      VD            Rav2-Bag           Rav2  T0-Rep1
262                VD-Rav2      VD            Rav2-Bag           Rav2  T0-Rep1
263                VD-Rav2      VD            Rav2-Bag           Rav2  T0-Rep2
264                VD-Rav2      VD            Rav2-Bag           Rav2  T0-Rep2
265                VD-Rav2      VD           Rav2-IGT4           Rav2  T1-IGT4
266                VD-Rav2      VD           Rav2-IGT4           Rav2  T1-IGT4
267                VD-Rav2      VD           Rav2-IGT5           Rav2  T1-IGT5
268                VD-Rav2      VD           Rav2-IGT5           Rav2  T1-IGT5
269                VD-Rav2      VD            Rav2-Bag           Rav2 T10-Rep1
270                VD-Rav2      VD            Rav2-Bag           Rav2 T10-Rep1
271                VD-Rav2      VD            Rav2-Bag           Rav2 T10-Rep2
272                VD-Rav2      VD            Rav2-Bag           Rav2 T10-Rep2
273                VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep1
274                VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep1
275                VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep2
276                VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep2
277                VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep3
278                VD-Rav2      VD            Rav2-Bag           Rav2 T15-Rep3
279                VD-Rav2      VD           Rav2-IGT4           Rav2  T2-IGT4
280                VD-Rav2      VD           Rav2-IGT4           Rav2  T2-IGT4
281                VD-Rav2      VD           Rav2-IGT4           Rav2 T2-IGT4b
282                VD-Rav2      VD           Rav2-IGT4           Rav2 T2-IGT4b
283                VD-Rav2      VD           Rav2-IGT5           Rav2  T2-IGT5
284                VD-Rav2      VD           Rav2-IGT5           Rav2  T2-IGT5
285                VD-Rav2      VD            Rav2-Bag           Rav2 T20-Rep1
286                VD-Rav2      VD            Rav2-Bag           Rav2 T20-Rep1
287                VD-Rav2      VD            Rav2-Bag           Rav2 T20-Rep2
288                VD-Rav2      VD            Rav2-Bag           Rav2 T20-Rep2
289                VD-Rav2      VD           Rav2-IGT4           Rav2  T3-IGT4
290                VD-Rav2      VD           Rav2-IGT4           Rav2  T3-IGT4
291                VD-Rav2      VD           Rav2-IGT4           Rav2 T3-IGT4b
292                VD-Rav2      VD           Rav2-IGT4           Rav2 T3-IGT4b
293                VD-Rav2      VD           Rav2-IGT5           Rav2  T3-IGT5
294                VD-Rav2      VD           Rav2-IGT5           Rav2  T3-IGT5
295                VD-Rav2      VD           Rav2-IGT5           Rav2 T3-IGT5b
296                VD-Rav2      VD           Rav2-IGT5           Rav2 T3-IGT5b
297                VD-Rav2      VD            Rav2-Bag           Rav2 T40-Rep1
298                VD-Rav2      VD            Rav2-Bag           Rav2 T40-Rep1
299                VD-Rav2      VD            Rav2-Bag           Rav2 T40-Rep2
300                VD-Rav2      VD            Rav2-Bag           Rav2 T40-Rep2
301          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole  T0-Rep1
302          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole  T0-Rep1
303          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole  T0-Rep2
304          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole  T0-Rep2
305          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T10-Rep1
306          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T10-Rep1
307          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T10-Rep2
308          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T10-Rep2
309          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T15-Rep1
310          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T15-Rep1
311          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T15-Rep2
312          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T15-Rep2
313          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T20-Rep1
314          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T20-Rep1
315          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T20-Rep2
316          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T20-Rep2
317          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T40-Rep1
318          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T40-Rep1
319          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T40-Rep2
320          VD-ShrimpHole      VD      ShrimpHole-Bag     ShrimpHole T40-Rep2
321                 VD-X18      VD             X18-Bag            X18  T0-Rep1
322                 VD-X18      VD             X18-Bag            X18  T0-Rep1
323                 VD-X18      VD             X18-Bag            X18  T0-Rep2
324                 VD-X18      VD             X18-Bag            X18  T0-Rep2
325                 VD-X18      VD             X18-Bag            X18 T15-Rep1
326                 VD-X18      VD             X18-Bag            X18 T15-Rep1
327                 VD-X18      VD             X18-Bag            X18 T15-Rep2
328                 VD-X18      VD             X18-Bag            X18 T15-Rep2
329                 VD-X18      VD             X18-Bag            X18 T20-Rep1
330                 VD-X18      VD             X18-Bag            X18 T20-Rep1
331                 VD-X18      VD             X18-Bag            X18 T20-Rep2
332                 VD-X18      VD             X18-Bag            X18 T20-Rep2
333                 VD-X18      VD             X18-Bag            X18 T40-Rep1
334                 VD-X18      VD             X18-Bag            X18 T40-Rep1
335                 VD-X18      VD             X18-Bag            X18 T40-Rep2
336                 VD-X18      VD             X18-Bag            X18 T40-Rep2
    TimePoint Replicate_ID  REP EXP_TYPE IGT_REP total_euks_noFLP total_FLP
1          T0         Rep3  Bag      Bag     Bag                9         3
2         T15         Rep3  Bag      Bag     Bag                8         4
3         T20         Rep3  Bag      Bag     Bag                9         2
4         T40         Rep3  Bag      Bag     Bag                5         0
5          T0         Rep1  Bag      Bag     Bag                6         6
6          T0         Rep2  Bag      Bag     Bag                5         5
7          T0         Rep3  Bag      Bag     Bag               11         8
8         T10         Rep1  Bag      Bag     Bag                8         6
9         T10         Rep2  Bag      Bag     Bag                2         3
10        T10         Rep3  Bag      Bag     Bag                9        12
11        T15         Rep1  Bag      Bag     Bag               10         8
12        T15         Rep2  Bag      Bag     Bag                1        11
13        T15         Rep3  Bag      Bag     Bag                5        19
14        T20         Rep1  Bag      Bag     Bag                5         5
15        T20         Rep2  Bag      Bag     Bag                3         4
16        T20         Rep3  Bag      Bag     Bag                7         9
17        T40         Rep1  Bag      Bag     Bag                5        11
18        T40         Rep2  Bag      Bag     Bag                1         2
19        T40         Rep3  Bag      Bag     Bag                7         4
20         T0         IGT3 IGT3      IGT    IGT3               10         1
21         T0         Rep3  Bag      Bag     Bag                9         9
22         T1         IGT3 IGT3      IGT    IGT3                9         1
23        T10         Rep3  Bag      Bag     Bag               10         6
24        T15         Rep3  Bag      Bag     Bag                8         8
25         T2         IGT3 IGT3      IGT    IGT3                5         6
26        T20         Rep3  Bag      Bag     Bag                1        13
27         T3         IGT3 IGT3      IGT    IGT3                6         3
28        T40         Rep3  Bag      Bag     Bag                2         5
29         T0         Rep1  Bag      Bag     Bag               12         1
30         T0         Rep2  Bag      Bag     Bag                9         1
31        T10         Rep2  Bag      Bag     Bag               16        15
32        T10         Rep3  Bag      Bag     Bag                7        13
33        T15         Rep1  Bag      Bag     Bag               10         8
34        T15         Rep2  Bag      Bag     Bag               14         5
35        T15         Rep3  Bag      Bag     Bag                7         0
36        T20         Rep1  Bag      Bag     Bag               12         2
37        T20         Rep2  Bag      Bag     Bag               14        20
38        T20         Rep3  Bag      Bag     Bag                9         2
39        T40         Rep1  Bag      Bag     Bag               11         3
40        T40         Rep2  Bag      Bag     Bag               11         8
41        T40         Rep3  Bag      Bag     Bag               11         8
42         T0         Rep1  Bag      Bag     Bag                8         6
43         T0         Rep2  Bag      Bag     Bag                8         6
44        T10         Rep1  Bag      Bag     Bag                8         5
45        T20         Rep2  Bag      Bag     Bag                2         1
46        T40         Rep1  Bag      Bag     Bag                7         2
47        T40         Rep2  Bag      Bag     Bag               10         5
48         T0         IGT4 IGT4      IGT    IGT4                8         3
49         T0        IGT4b IGT4      IGT   IGT4b               14         4
50         T1         IGT4 IGT4      IGT    IGT4                9         2
51         T1        IGT4b IGT4      IGT   IGT4b                6         4
52         T2         IGT4 IGT4      IGT    IGT4                9         5
53         T2        IGT4b IGT4      IGT   IGT4b                4         7
54         T3         IGT4 IGT4      IGT    IGT4                5        14
55         T3        IGT4b IGT4      IGT   IGT4b                7        46
56         T0         Rep1  Bag      Bag     Bag               35        17
57         T0         Rep2  Bag      Bag     Bag               16         6
58         T0         Rep3  Bag      Bag     Bag                5         7
59        T10         Rep1  Bag      Bag     Bag               13         8
60        T10         Rep2  Bag      Bag     Bag               14         8
61        T10         Rep3  Bag      Bag     Bag               11        14
62        T15         Rep1  Bag      Bag     Bag               10        11
63        T15         Rep2  Bag      Bag     Bag               12         4
64        T15         Rep3  Bag      Bag     Bag               14         5
65        T20         Rep1  Bag      Bag     Bag               16         6
66        T20         Rep2  Bag      Bag     Bag               10        11
67        T20         Rep3  Bag      Bag     Bag               13        12
68        T40         Rep1  Bag      Bag     Bag               19         9
69        T40         Rep2  Bag      Bag     Bag               12        17
70        T40         Rep3  Bag      Bag     Bag                6        13
71         T0         IGT4 IGT4      IGT    IGT4               25         2
72         T0        IGT4b IGT4      IGT   IGT4b               15         3
73         T0         IGT5 IGT5      IGT    IGT5               15         8
74         T0        IGT5b IGT5      IGT   IGT5b                9         1
75         T0         Rep1  Bag      Bag     Bag               11        16
76         T0         Rep2  Bag      Bag     Bag               19         6
77         T1         IGT4 IGT4      IGT    IGT4               13         5
78         T1         IGT5 IGT5      IGT    IGT5               14         5
79        T10         Rep1  Bag      Bag     Bag                5        17
80        T10         Rep2  Bag      Bag     Bag               15         4
81        T15         Rep1  Bag      Bag     Bag                9        19
82        T15         Rep2  Bag      Bag     Bag               18        11
83        T15         Rep3  Bag      Bag     Bag                2        11
84         T2         IGT4 IGT4      IGT    IGT4               10         8
85         T2        IGT4b IGT4      IGT   IGT4b               15         8
86         T2         IGT5 IGT5      IGT    IGT5               11         6
87        T20         Rep1  Bag      Bag     Bag                7        38
88        T20         Rep2  Bag      Bag     Bag               16         5
89         T3         IGT4 IGT4      IGT    IGT4               19         8
90         T3        IGT4b IGT4      IGT   IGT4b               16         4
91         T3         IGT5 IGT5      IGT    IGT5                8         3
92         T3        IGT5b IGT5      IGT   IGT5b                5         7
93        T40         Rep1  Bag      Bag     Bag               17        25
94        T40         Rep2  Bag      Bag     Bag               17        14
95         T0         Rep1  Bag      Bag     Bag                8        18
96         T0         Rep2  Bag      Bag     Bag                8        29
97        T10         Rep1  Bag      Bag     Bag               11         4
98        T10         Rep2  Bag      Bag     Bag               12        12
99        T15         Rep1  Bag      Bag     Bag                8         9
100       T15         Rep2  Bag      Bag     Bag                8        14
101       T20         Rep1  Bag      Bag     Bag                4         1
102       T20         Rep2  Bag      Bag     Bag               10         6
103       T40         Rep1  Bag      Bag     Bag                7         5
104       T40         Rep2  Bag      Bag     Bag                2        13
105        T0         Rep1  Bag      Bag     Bag               10         0
106        T0         Rep2  Bag      Bag     Bag               15         9
107       T15         Rep1  Bag      Bag     Bag               14         2
108       T15         Rep2  Bag      Bag     Bag               14        19
109       T20         Rep1  Bag      Bag     Bag                7        11
110       T20         Rep2  Bag      Bag     Bag               15        13
111       T40         Rep1  Bag      Bag     Bag               10         3
112       T40         Rep2  Bag      Bag     Bag               13         6
113        T0         Rep3  Bag      Bag     Bag                0         0
114        T0         Rep3  Bag      Bag     Bag                9         3
115       T15         Rep3  Bag      Bag     Bag                1         1
116       T15         Rep3  Bag      Bag     Bag                7         3
117       T20         Rep3  Bag      Bag     Bag                0         0
118       T20         Rep3  Bag      Bag     Bag                9         2
119       T40         Rep3  Bag      Bag     Bag                0         0
120       T40         Rep3  Bag      Bag     Bag                5         0
121        T0         Rep1  Bag      Bag     Bag                0         2
122        T0         Rep1  Bag      Bag     Bag                6         4
123        T0         Rep2  Bag      Bag     Bag                0         3
124        T0         Rep2  Bag      Bag     Bag                5         2
125        T0         Rep3  Bag      Bag     Bag                1         0
126        T0         Rep3  Bag      Bag     Bag               10         8
127       T10         Rep1  Bag      Bag     Bag                0         0
128       T10         Rep1  Bag      Bag     Bag                8         6
129       T10         Rep2  Bag      Bag     Bag                0         0
130       T10         Rep2  Bag      Bag     Bag                2         3
131       T10         Rep3  Bag      Bag     Bag                1         3
132       T10         Rep3  Bag      Bag     Bag                8         9
133       T15         Rep1  Bag      Bag     Bag                0         1
134       T15         Rep1  Bag      Bag     Bag               10         7
135       T15         Rep2  Bag      Bag     Bag                0         4
136       T15         Rep2  Bag      Bag     Bag                1         7
137       T15         Rep3  Bag      Bag     Bag                0         8
138       T15         Rep3  Bag      Bag     Bag                5        11
139       T20         Rep1  Bag      Bag     Bag                0         1
140       T20         Rep1  Bag      Bag     Bag                5         4
141       T20         Rep2  Bag      Bag     Bag                0         2
142       T20         Rep2  Bag      Bag     Bag                3         2
143       T20         Rep3  Bag      Bag     Bag                1         0
144       T20         Rep3  Bag      Bag     Bag                6         9
145       T40         Rep1  Bag      Bag     Bag                0         0
146       T40         Rep1  Bag      Bag     Bag                5        11
147       T40         Rep2  Bag      Bag     Bag                0         0
148       T40         Rep2  Bag      Bag     Bag                1         2
149       T40         Rep3  Bag      Bag     Bag                1         0
150       T40         Rep3  Bag      Bag     Bag                6         4
151        T0         IGT3 IGT3      IGT    IGT3                0         0
152        T0         IGT3 IGT3      IGT    IGT3               10         1
153        T0         Rep3  Bag      Bag     Bag                1         0
154        T0         Rep3  Bag      Bag     Bag                8         9
155        T1         IGT3 IGT3      IGT    IGT3                2         0
156        T1         IGT3 IGT3      IGT    IGT3                7         1
157       T10         Rep3  Bag      Bag     Bag                0         1
158       T10         Rep3  Bag      Bag     Bag               10         5
159       T15         Rep3  Bag      Bag     Bag                0         5
160       T15         Rep3  Bag      Bag     Bag                8         3
161        T2         IGT3 IGT3      IGT    IGT3                1         1
162        T2         IGT3 IGT3      IGT    IGT3                4         5
163       T20         Rep3  Bag      Bag     Bag                0         2
164       T20         Rep3  Bag      Bag     Bag                1        11
165        T3         IGT3 IGT3      IGT    IGT3                0         2
166        T3         IGT3 IGT3      IGT    IGT3                6         1
167       T40         Rep3  Bag      Bag     Bag                1         0
168       T40         Rep3  Bag      Bag     Bag                1         5
169        T0         Rep1  Bag      Bag     Bag                0         0
170        T0         Rep1  Bag      Bag     Bag               12         1
171        T0         Rep2  Bag      Bag     Bag                0         0
172        T0         Rep2  Bag      Bag     Bag                9         1
173       T10         Rep2  Bag      Bag     Bag                2         4
174       T10         Rep2  Bag      Bag     Bag               14        11
175       T10         Rep3  Bag      Bag     Bag                1         3
176       T10         Rep3  Bag      Bag     Bag                6        10
177       T15         Rep1  Bag      Bag     Bag                0         2
178       T15         Rep1  Bag      Bag     Bag               10         6
179       T15         Rep2  Bag      Bag     Bag                1         1
180       T15         Rep2  Bag      Bag     Bag               13         4
181       T15         Rep3  Bag      Bag     Bag                0         0
182       T15         Rep3  Bag      Bag     Bag                7         0
183       T20         Rep1  Bag      Bag     Bag                1         0
184       T20         Rep1  Bag      Bag     Bag               11         2
185       T20         Rep2  Bag      Bag     Bag                4         5
186       T20         Rep2  Bag      Bag     Bag               10        15
187       T20         Rep3  Bag      Bag     Bag                1         2
188       T20         Rep3  Bag      Bag     Bag                8         0
189       T40         Rep1  Bag      Bag     Bag                1         2
190       T40         Rep1  Bag      Bag     Bag               10         1
191       T40         Rep2  Bag      Bag     Bag                3         3
192       T40         Rep2  Bag      Bag     Bag                8         5
193       T40         Rep3  Bag      Bag     Bag                2         0
194       T40         Rep3  Bag      Bag     Bag                9         8
195        T0         Rep1  Bag      Bag     Bag                0         0
196        T0         Rep1  Bag      Bag     Bag                8         6
197        T0         Rep2  Bag      Bag     Bag                0         0
198        T0         Rep2  Bag      Bag     Bag                8         6
199       T10         Rep1  Bag      Bag     Bag                0         0
200       T10         Rep1  Bag      Bag     Bag                8         5
201       T20         Rep2  Bag      Bag     Bag                0         0
202       T20         Rep2  Bag      Bag     Bag                2         1
203       T40         Rep1  Bag      Bag     Bag                1         0
204       T40         Rep1  Bag      Bag     Bag                6         2
205       T40         Rep2  Bag      Bag     Bag                0         0
206       T40         Rep2  Bag      Bag     Bag               10         5
207        T0         IGT4 IGT4      IGT    IGT4                1         1
208        T0         IGT4 IGT4      IGT    IGT4                7         2
209        T0        IGT4b IGT4      IGT   IGT4b                4         0
210        T0        IGT4b IGT4      IGT   IGT4b               10         4
211        T1         IGT4 IGT4      IGT    IGT4                0         0
212        T1         IGT4 IGT4      IGT    IGT4                9         2
213        T1        IGT4b IGT4      IGT   IGT4b                0         0
214        T1        IGT4b IGT4      IGT   IGT4b                6         4
215        T2         IGT4 IGT4      IGT    IGT4                0         0
216        T2         IGT4 IGT4      IGT    IGT4                9         5
217        T2        IGT4b IGT4      IGT   IGT4b                0         6
218        T2        IGT4b IGT4      IGT   IGT4b                4         1
219        T3         IGT4 IGT4      IGT    IGT4                0         0
220        T3         IGT4 IGT4      IGT    IGT4                5        14
221        T3        IGT4b IGT4      IGT   IGT4b                1        16
222        T3        IGT4b IGT4      IGT   IGT4b                6        30
223        T0         Rep1  Bag      Bag     Bag                4         8
224        T0         Rep1  Bag      Bag     Bag               31         9
225        T0         Rep2  Bag      Bag     Bag                1         4
226        T0         Rep2  Bag      Bag     Bag               15         2
227        T0         Rep3  Bag      Bag     Bag                2         0
228        T0         Rep3  Bag      Bag     Bag                3         7
229       T10         Rep1  Bag      Bag     Bag                0         1
230       T10         Rep1  Bag      Bag     Bag               13         7
231       T10         Rep2  Bag      Bag     Bag                0         4
232       T10         Rep2  Bag      Bag     Bag               14         4
233       T10         Rep3  Bag      Bag     Bag                1         2
234       T10         Rep3  Bag      Bag     Bag               10        12
235       T15         Rep1  Bag      Bag     Bag                3         0
236       T15         Rep1  Bag      Bag     Bag                7        11
237       T15         Rep2  Bag      Bag     Bag                0         0
238       T15         Rep2  Bag      Bag     Bag               12         4
239       T15         Rep3  Bag      Bag     Bag                2         2
240       T15         Rep3  Bag      Bag     Bag               12         3
241       T20         Rep1  Bag      Bag     Bag                1         0
242       T20         Rep1  Bag      Bag     Bag               15         6
243       T20         Rep2  Bag      Bag     Bag                0         5
244       T20         Rep2  Bag      Bag     Bag               10         6
245       T20         Rep3  Bag      Bag     Bag                1         0
246       T20         Rep3  Bag      Bag     Bag               12        12
247       T40         Rep1  Bag      Bag     Bag                9         8
248       T40         Rep1  Bag      Bag     Bag               10         1
249       T40         Rep2  Bag      Bag     Bag                0         0
250       T40         Rep2  Bag      Bag     Bag               12        17
251       T40         Rep3  Bag      Bag     Bag                0         4
252       T40         Rep3  Bag      Bag     Bag                6         9
253        T0         IGT4 IGT4      IGT    IGT4                0         0
254        T0         IGT4 IGT4      IGT    IGT4               25         2
255        T0        IGT4b IGT4      IGT   IGT4b                1         0
256        T0        IGT4b IGT4      IGT   IGT4b               14         3
257        T0         IGT5 IGT5      IGT    IGT5                1         4
258        T0         IGT5 IGT5      IGT    IGT5               14         4
259        T0        IGT5b IGT5      IGT   IGT5b                1         0
260        T0        IGT5b IGT5      IGT   IGT5b                8         1
261        T0         Rep1  Bag      Bag     Bag                0         0
262        T0         Rep1  Bag      Bag     Bag               11        16
263        T0         Rep2  Bag      Bag     Bag                1         0
264        T0         Rep2  Bag      Bag     Bag               18         6
265        T1         IGT4 IGT4      IGT    IGT4                0         0
266        T1         IGT4 IGT4      IGT    IGT4               13         5
267        T1         IGT5 IGT5      IGT    IGT5                0         0
268        T1         IGT5 IGT5      IGT    IGT5               14         5
269       T10         Rep1  Bag      Bag     Bag                1         0
270       T10         Rep1  Bag      Bag     Bag                4        17
271       T10         Rep2  Bag      Bag     Bag                0         0
272       T10         Rep2  Bag      Bag     Bag               15         4
273       T15         Rep1  Bag      Bag     Bag                0         0
274       T15         Rep1  Bag      Bag     Bag                9        19
275       T15         Rep2  Bag      Bag     Bag                0         4
276       T15         Rep2  Bag      Bag     Bag               18         7
277       T15         Rep3  Bag      Bag     Bag                1         5
278       T15         Rep3  Bag      Bag     Bag                1         6
279        T2         IGT4 IGT4      IGT    IGT4                0         1
280        T2         IGT4 IGT4      IGT    IGT4               10         7
281        T2        IGT4b IGT4      IGT   IGT4b                1         4
282        T2        IGT4b IGT4      IGT   IGT4b               14         4
283        T2         IGT5 IGT5      IGT    IGT5                0         0
284        T2         IGT5 IGT5      IGT    IGT5               11         6
285       T20         Rep1  Bag      Bag     Bag                0         9
286       T20         Rep1  Bag      Bag     Bag                7        29
287       T20         Rep2  Bag      Bag     Bag                0         0
288       T20         Rep2  Bag      Bag     Bag               16         5
289        T3         IGT4 IGT4      IGT    IGT4                0         0
290        T3         IGT4 IGT4      IGT    IGT4               19         8
291        T3        IGT4b IGT4      IGT   IGT4b                0         0
292        T3        IGT4b IGT4      IGT   IGT4b               16         4
293        T3         IGT5 IGT5      IGT    IGT5                0         0
294        T3         IGT5 IGT5      IGT    IGT5                8         3
295        T3        IGT5b IGT5      IGT   IGT5b                2         2
296        T3        IGT5b IGT5      IGT   IGT5b                3         5
297       T40         Rep1  Bag      Bag     Bag                0         0
298       T40         Rep1  Bag      Bag     Bag               17        25
299       T40         Rep2  Bag      Bag     Bag                0         0
300       T40         Rep2  Bag      Bag     Bag               17        14
301        T0         Rep1  Bag      Bag     Bag                2         2
302        T0         Rep1  Bag      Bag     Bag                6        16
303        T0         Rep2  Bag      Bag     Bag                0         7
304        T0         Rep2  Bag      Bag     Bag                8        22
305       T10         Rep1  Bag      Bag     Bag                3         0
306       T10         Rep1  Bag      Bag     Bag                8         4
307       T10         Rep2  Bag      Bag     Bag                2         0
308       T10         Rep2  Bag      Bag     Bag               10        12
309       T15         Rep1  Bag      Bag     Bag                1         1
310       T15         Rep1  Bag      Bag     Bag                7         8
311       T15         Rep2  Bag      Bag     Bag                5         0
312       T15         Rep2  Bag      Bag     Bag                3        14
313       T20         Rep1  Bag      Bag     Bag                0         0
314       T20         Rep1  Bag      Bag     Bag                4         1
315       T20         Rep2  Bag      Bag     Bag                2         0
316       T20         Rep2  Bag      Bag     Bag                8         6
317       T40         Rep1  Bag      Bag     Bag                0         0
318       T40         Rep1  Bag      Bag     Bag                7         5
319       T40         Rep2  Bag      Bag     Bag                1         0
320       T40         Rep2  Bag      Bag     Bag                1        13
321        T0         Rep1  Bag      Bag     Bag                1         0
322        T0         Rep1  Bag      Bag     Bag                9         0
323        T0         Rep2  Bag      Bag     Bag                1         4
324        T0         Rep2  Bag      Bag     Bag               14         5
325       T15         Rep1  Bag      Bag     Bag                1         0
326       T15         Rep1  Bag      Bag     Bag               13         2
327       T15         Rep2  Bag      Bag     Bag                0         4
328       T15         Rep2  Bag      Bag     Bag               14        15
329       T20         Rep1  Bag      Bag     Bag                1         4
330       T20         Rep1  Bag      Bag     Bag                6         7
331       T20         Rep2  Bag      Bag     Bag                1         4
332       T20         Rep2  Bag      Bag     Bag               14         9
333       T40         Rep1  Bag      Bag     Bag                0         0
334       T40         Rep1  Bag      Bag     Bag               10         3
335       T40         Rep2  Bag      Bag     Bag                0         2
336       T40         Rep2  Bag      Bag     Bag               13         4
    total_euks_wflp   SizeFrac Minutes SiteOrigin FLUID_ORIGIN CRUISE_SAMPLE
1                 2 total_euks       0       Vent      J2-1241          LV24
2                 3 total_euks      15       Vent      J2-1241          LV24
3                 1 total_euks      20       Vent      J2-1241          LV24
4                 0 total_euks      40       Vent      J2-1241          LV24
5                 4 total_euks       0      Plume       CTD004     Niskin 10
6                 3 total_euks       0      Plume       CTD004     Niskin 10
7                 5 total_euks       0      Plume       CTD004     Niskin 10
8                 5 total_euks      10      Plume       CTD004     Niskin 10
9                 2 total_euks      10      Plume       CTD004     Niskin 10
10                5 total_euks      10      Plume       CTD004     Niskin 10
11                4 total_euks      15      Plume       CTD004     Niskin 10
12                5 total_euks      15      Plume       CTD004     Niskin 10
13                6 total_euks      15      Plume       CTD004     Niskin 10
14                4 total_euks      20      Plume       CTD004     Niskin 10
15                3 total_euks      20      Plume       CTD004     Niskin 10
16                5 total_euks      20      Plume       CTD004     Niskin 10
17                4 total_euks      40      Plume       CTD004     Niskin 10
18                1 total_euks      40      Plume       CTD004     Niskin 10
19                3 total_euks      40      Plume       CTD004     Niskin 10
20                1 total_euks       0       Vent      J2-1240          IGT3
21                4 total_euks       0       Vent      J2-1240          LV13
22                1 total_euks      15       Vent      J2-1240          IGT3
23                4 total_euks      10       Vent      J2-1240          LV13
24                2 total_euks      14       Vent      J2-1240          LV13
25                6 total_euks      25       Vent      J2-1240          IGT3
26                5 total_euks      22       Vent      J2-1240          LV13
27                2 total_euks      45       Vent      J2-1240          IGT3
28                3 total_euks      42       Vent      J2-1240          LV13
29                1 total_euks       0 Background       CTD002  Niskins 8-10
30                1 total_euks       0 Background       CTD002  Niskins 8-10
31                7 total_euks      10 Background       CTD002  Niskins 8-10
32                7 total_euks      10 Background       CTD002  Niskins 8-10
33                4 total_euks      15 Background       CTD002  Niskins 8-10
34                4 total_euks      15 Background       CTD002  Niskins 8-10
35                0 total_euks      15 Background       CTD002  Niskins 8-10
36                2 total_euks      20 Background       CTD002  Niskins 8-10
37                7 total_euks      20 Background       CTD002  Niskins 8-10
38                1 total_euks      20 Background       CTD002  Niskins 8-10
39                3 total_euks      40 Background       CTD002  Niskins 8-10
40                6 total_euks      40 Background       CTD002  Niskins 8-10
41                4 total_euks      40 Background       CTD002  Niskins 8-10
42                3 total_euks       0       Vent      J2-1243          LV17
43                3 total_euks       0       Vent      J2-1243          LV17
44                2 total_euks      10       Vent      J2-1243          LV17
45                1 total_euks      20       Vent      J2-1243          LV17
46                1 total_euks      40       Vent      J2-1243          LV17
47                2 total_euks      40       Vent      J2-1243          LV17
48                2 total_euks       0       Vent      J2-1238          IGT4
49                3 total_euks       0       Vent      J2-1238          IGT4
50                2 total_euks       7       Vent      J2-1238          IGT4
51                3 total_euks       7       Vent      J2-1238          IGT4
52                5 total_euks      25       Vent      J2-1238          IGT4
53                4 total_euks      25       Vent      J2-1238          IGT4
54                9 total_euks      47       Vent      J2-1238          IGT4
55               12 total_euks      47       Vent      J2-1238          IGT4
56                7 total_euks       0      Plume       CTD001      Niskin 2
57                3 total_euks       0      Plume       CTD001      Niskin 2
58                3 total_euks       0      Plume       CTD001      Niskin 2
59                6 total_euks      10      Plume       CTD001      Niskin 2
60                5 total_euks      10      Plume       CTD001      Niskin 2
61                7 total_euks      10      Plume       CTD001      Niskin 2
62                7 total_euks      15      Plume       CTD001      Niskin 2
63                3 total_euks      15      Plume       CTD001      Niskin 2
64                3 total_euks      15      Plume       CTD001      Niskin 2
65                4 total_euks      25      Plume       CTD001      Niskin 2
66                4 total_euks      25      Plume       CTD001      Niskin 2
67                5 total_euks      25      Plume       CTD001      Niskin 2
68                5 total_euks      57      Plume       CTD001      Niskin 2
69                9 total_euks      57      Plume       CTD001      Niskin 2
70                5 total_euks      57      Plume       CTD001      Niskin 2
71                2 total_euks       0       Vent      J2-1244          IGT4
72                1 total_euks       0       Vent      J2-1244          IGT4
73                3 total_euks       0       Vent      J2-1244          IGT5
74                1 total_euks       0       Vent      J2-1244          IGT5
75                5 total_euks       0       Vent      J2-1238         LV13a
76                4 total_euks       0       Vent      J2-1238         LV13a
77                4 total_euks      12       Vent      J2-1244          IGT4
78                4 total_euks      35       Vent      J2-1244          IGT5
79                5 total_euks      10       Vent      J2-1238         LV13a
80                3 total_euks      10       Vent      J2-1238         LV13a
81                7 total_euks      15       Vent      J2-1238         LV13a
82                7 total_euks      15       Vent      J2-1238         LV13a
83                3 total_euks      15       Vent      J2-1238         LV13a
84                6 total_euks      20       Vent      J2-1244          IGT4
85                6 total_euks      20       Vent      J2-1244          IGT4
86                5 total_euks      40       Vent      J2-1244          IGT5
87                9 total_euks      21       Vent      J2-1238         LV13a
88                4 total_euks      21       Vent      J2-1238         LV13a
89                3 total_euks      46       Vent      J2-1244          IGT4
90                3 total_euks      46       Vent      J2-1244          IGT4
91                2 total_euks      53       Vent      J2-1244          IGT5
92                5 total_euks      53       Vent      J2-1244          IGT5
93                9 total_euks      40       Vent      J2-1238         LV13a
94                3 total_euks      40       Vent      J2-1238         LV13a
95                7 total_euks       0       Vent      J2-1244          LV13
96               10 total_euks       0       Vent      J2-1244          LV13
97                2 total_euks      10       Vent      J2-1244          LV13
98                4 total_euks      10       Vent      J2-1244          LV13
99                5 total_euks      15       Vent      J2-1244          LV13
100               5 total_euks      15       Vent      J2-1244          LV13
101               1 total_euks      20       Vent      J2-1244          LV13
102               2 total_euks      20       Vent      J2-1244          LV13
103               4 total_euks      40       Vent      J2-1244          LV13
104               5 total_euks      40       Vent      J2-1244          LV13
105               0 total_euks       0       Vent      J2-1235   LV23 &amp; Bio5
106               5 total_euks       0       Vent      J2-1235   LV23 &amp; Bio5
107               1 total_euks      15       Vent      J2-1235   LV23 &amp; Bio5
108              11 total_euks      15       Vent      J2-1235   LV23 &amp; Bio5
109               6 total_euks      20       Vent      J2-1235   LV23 &amp; Bio5
110               6 total_euks      20       Vent      J2-1235   LV23 &amp; Bio5
111               2 total_euks      40       Vent      J2-1235   LV23 &amp; Bio5
112               4 total_euks      40       Vent      J2-1235   LV23 &amp; Bio5
113               0 micro_size       0       Vent      J2-1241          LV24
114               2  nano_size       0       Vent      J2-1241          LV24
115               1 micro_size      15       Vent      J2-1241          LV24
116               2  nano_size      15       Vent      J2-1241          LV24
117               0 micro_size      20       Vent      J2-1241          LV24
118               1  nano_size      20       Vent      J2-1241          LV24
119               0 micro_size      40       Vent      J2-1241          LV24
120               0  nano_size      40       Vent      J2-1241          LV24
121               1 micro_size       0      Plume       CTD004     Niskin 10
122               3  nano_size       0      Plume       CTD004     Niskin 10
123               2 micro_size       0      Plume       CTD004     Niskin 10
124               1  nano_size       0      Plume       CTD004     Niskin 10
125               0 micro_size       0      Plume       CTD004     Niskin 10
126               5  nano_size       0      Plume       CTD004     Niskin 10
127               0 micro_size      10      Plume       CTD004     Niskin 10
128               5  nano_size      10      Plume       CTD004     Niskin 10
129               0 micro_size      10      Plume       CTD004     Niskin 10
130               2  nano_size      10      Plume       CTD004     Niskin 10
131               1 micro_size      10      Plume       CTD004     Niskin 10
132               4  nano_size      10      Plume       CTD004     Niskin 10
133               1 micro_size      15      Plume       CTD004     Niskin 10
134               3  nano_size      15      Plume       CTD004     Niskin 10
135               1 micro_size      15      Plume       CTD004     Niskin 10
136               4  nano_size      15      Plume       CTD004     Niskin 10
137               2 micro_size      15      Plume       CTD004     Niskin 10
138               4  nano_size      15      Plume       CTD004     Niskin 10
139               1 micro_size      20      Plume       CTD004     Niskin 10
140               3  nano_size      20      Plume       CTD004     Niskin 10
141               1 micro_size      20      Plume       CTD004     Niskin 10
142               2  nano_size      20      Plume       CTD004     Niskin 10
143               0 micro_size      20      Plume       CTD004     Niskin 10
144               5  nano_size      20      Plume       CTD004     Niskin 10
145               0 micro_size      40      Plume       CTD004     Niskin 10
146               4  nano_size      40      Plume       CTD004     Niskin 10
147               0 micro_size      40      Plume       CTD004     Niskin 10
148               1  nano_size      40      Plume       CTD004     Niskin 10
149               0 micro_size      40      Plume       CTD004     Niskin 10
150               3  nano_size      40      Plume       CTD004     Niskin 10
151               0 micro_size       0       Vent      J2-1240          IGT3
152               1  nano_size       0       Vent      J2-1240          IGT3
153               0 micro_size       0       Vent      J2-1240          LV13
154               4  nano_size       0       Vent      J2-1240          LV13
155               0 micro_size      15       Vent      J2-1240          IGT3
156               1  nano_size      15       Vent      J2-1240          IGT3
157               1 micro_size      10       Vent      J2-1240          LV13
158               3  nano_size      10       Vent      J2-1240          LV13
159               1 micro_size      14       Vent      J2-1240          LV13
160               1  nano_size      14       Vent      J2-1240          LV13
161               1 micro_size      25       Vent      J2-1240          IGT3
162               5  nano_size      25       Vent      J2-1240          IGT3
163               1 micro_size      22       Vent      J2-1240          LV13
164               4  nano_size      22       Vent      J2-1240          LV13
165               1 micro_size      45       Vent      J2-1240          IGT3
166               1  nano_size      45       Vent      J2-1240          IGT3
167               0 micro_size      42       Vent      J2-1240          LV13
168               3  nano_size      42       Vent      J2-1240          LV13
169               0 micro_size       0 Background       CTD002  Niskins 8-10
170               1  nano_size       0 Background       CTD002  Niskins 8-10
171               0 micro_size       0 Background       CTD002  Niskins 8-10
172               1  nano_size       0 Background       CTD002  Niskins 8-10
173               2 micro_size      10 Background       CTD002  Niskins 8-10
174               5  nano_size      10 Background       CTD002  Niskins 8-10
175               1 micro_size      10 Background       CTD002  Niskins 8-10
176               6  nano_size      10 Background       CTD002  Niskins 8-10
177               1 micro_size      15 Background       CTD002  Niskins 8-10
178               3  nano_size      15 Background       CTD002  Niskins 8-10
179               1 micro_size      15 Background       CTD002  Niskins 8-10
180               3  nano_size      15 Background       CTD002  Niskins 8-10
181               0 micro_size      15 Background       CTD002  Niskins 8-10
182               0  nano_size      15 Background       CTD002  Niskins 8-10
183               0 micro_size      20 Background       CTD002  Niskins 8-10
184               2  nano_size      20 Background       CTD002  Niskins 8-10
185               1 micro_size      20 Background       CTD002  Niskins 8-10
186               6  nano_size      20 Background       CTD002  Niskins 8-10
187               1 micro_size      20 Background       CTD002  Niskins 8-10
188               0  nano_size      20 Background       CTD002  Niskins 8-10
189               2 micro_size      40 Background       CTD002  Niskins 8-10
190               1  nano_size      40 Background       CTD002  Niskins 8-10
191               2 micro_size      40 Background       CTD002  Niskins 8-10
192               4  nano_size      40 Background       CTD002  Niskins 8-10
193               0 micro_size      40 Background       CTD002  Niskins 8-10
194               4  nano_size      40 Background       CTD002  Niskins 8-10
195               0 micro_size       0       Vent      J2-1243          LV17
196               3  nano_size       0       Vent      J2-1243          LV17
197               0 micro_size       0       Vent      J2-1243          LV17
198               3  nano_size       0       Vent      J2-1243          LV17
199               0 micro_size      10       Vent      J2-1243          LV17
200               2  nano_size      10       Vent      J2-1243          LV17
201               0 micro_size      20       Vent      J2-1243          LV17
202               1  nano_size      20       Vent      J2-1243          LV17
203               0 micro_size      40       Vent      J2-1243          LV17
204               1  nano_size      40       Vent      J2-1243          LV17
205               0 micro_size      40       Vent      J2-1243          LV17
206               2  nano_size      40       Vent      J2-1243          LV17
207               1 micro_size       0       Vent      J2-1238          IGT4
208               1  nano_size       0       Vent      J2-1238          IGT4
209               0 micro_size       0       Vent      J2-1238          IGT4
210               3  nano_size       0       Vent      J2-1238          IGT4
211               0 micro_size       7       Vent      J2-1238          IGT4
212               2  nano_size       7       Vent      J2-1238          IGT4
213               0 micro_size       7       Vent      J2-1238          IGT4
214               3  nano_size       7       Vent      J2-1238          IGT4
215               0 micro_size      25       Vent      J2-1238          IGT4
216               5  nano_size      25       Vent      J2-1238          IGT4
217               3 micro_size      25       Vent      J2-1238          IGT4
218               1  nano_size      25       Vent      J2-1238          IGT4
219               0 micro_size      47       Vent      J2-1238          IGT4
220               9  nano_size      47       Vent      J2-1238          IGT4
221               4 micro_size      47       Vent      J2-1238          IGT4
222               8  nano_size      47       Vent      J2-1238          IGT4
223               2 micro_size       0      Plume       CTD001      Niskin 2
224               5  nano_size       0      Plume       CTD001      Niskin 2
225               1 micro_size       0      Plume       CTD001      Niskin 2
226               2  nano_size       0      Plume       CTD001      Niskin 2
227               0 micro_size       0      Plume       CTD001      Niskin 2
228               3  nano_size       0      Plume       CTD001      Niskin 2
229               1 micro_size      10      Plume       CTD001      Niskin 2
230               5  nano_size      10      Plume       CTD001      Niskin 2
231               2 micro_size      10      Plume       CTD001      Niskin 2
232               3  nano_size      10      Plume       CTD001      Niskin 2
233               1 micro_size      10      Plume       CTD001      Niskin 2
234               6  nano_size      10      Plume       CTD001      Niskin 2
235               0 micro_size      15      Plume       CTD001      Niskin 2
236               7  nano_size      15      Plume       CTD001      Niskin 2
237               0 micro_size      15      Plume       CTD001      Niskin 2
238               3  nano_size      15      Plume       CTD001      Niskin 2
239               1 micro_size      15      Plume       CTD001      Niskin 2
240               2  nano_size      15      Plume       CTD001      Niskin 2
241               0 micro_size      25      Plume       CTD001      Niskin 2
242               4  nano_size      25      Plume       CTD001      Niskin 2
243               2 micro_size      25      Plume       CTD001      Niskin 2
244               2  nano_size      25      Plume       CTD001      Niskin 2
245               0 micro_size      25      Plume       CTD001      Niskin 2
246               5  nano_size      25      Plume       CTD001      Niskin 2
247               4 micro_size      57      Plume       CTD001      Niskin 2
248               1  nano_size      57      Plume       CTD001      Niskin 2
249               0 micro_size      57      Plume       CTD001      Niskin 2
250               9  nano_size      57      Plume       CTD001      Niskin 2
251               1 micro_size      57      Plume       CTD001      Niskin 2
252               4  nano_size      57      Plume       CTD001      Niskin 2
253               0 micro_size       0       Vent      J2-1244          IGT4
254               2  nano_size       0       Vent      J2-1244          IGT4
255               0 micro_size       0       Vent      J2-1244          IGT4
256               1  nano_size       0       Vent      J2-1244          IGT4
257               1 micro_size       0       Vent      J2-1244          IGT5
258               2  nano_size       0       Vent      J2-1244          IGT5
259               0 micro_size       0       Vent      J2-1244          IGT5
260               1  nano_size       0       Vent      J2-1244          IGT5
261               0 micro_size       0       Vent      J2-1238         LV13a
262               5  nano_size       0       Vent      J2-1238         LV13a
263               0 micro_size       0       Vent      J2-1238         LV13a
264               4  nano_size       0       Vent      J2-1238         LV13a
265               0 micro_size      12       Vent      J2-1244          IGT4
266               4  nano_size      12       Vent      J2-1244          IGT4
267               0 micro_size      35       Vent      J2-1244          IGT5
268               4  nano_size      35       Vent      J2-1244          IGT5
269               0 micro_size      10       Vent      J2-1238         LV13a
270               5  nano_size      10       Vent      J2-1238         LV13a
271               0 micro_size      10       Vent      J2-1238         LV13a
272               3  nano_size      10       Vent      J2-1238         LV13a
273               0 micro_size      15       Vent      J2-1238         LV13a
274               7  nano_size      15       Vent      J2-1238         LV13a
275               1 micro_size      15       Vent      J2-1238         LV13a
276               6  nano_size      15       Vent      J2-1238         LV13a
277               1 micro_size      15       Vent      J2-1238         LV13a
278               2  nano_size      15       Vent      J2-1238         LV13a
279               1 micro_size      20       Vent      J2-1244          IGT4
280               5  nano_size      20       Vent      J2-1244          IGT4
281               3 micro_size      20       Vent      J2-1244          IGT4
282               3  nano_size      20       Vent      J2-1244          IGT4
283               0 micro_size      40       Vent      J2-1244          IGT5
284               5  nano_size      40       Vent      J2-1244          IGT5
285               1 micro_size      21       Vent      J2-1238         LV13a
286               8  nano_size      21       Vent      J2-1238         LV13a
287               0 micro_size      21       Vent      J2-1238         LV13a
288               4  nano_size      21       Vent      J2-1238         LV13a
289               0 micro_size      46       Vent      J2-1244          IGT4
290               3  nano_size      46       Vent      J2-1244          IGT4
291               0 micro_size      46       Vent      J2-1244          IGT4
292               3  nano_size      46       Vent      J2-1244          IGT4
293               0 micro_size      53       Vent      J2-1244          IGT5
294               2  nano_size      53       Vent      J2-1244          IGT5
295               1 micro_size      53       Vent      J2-1244          IGT5
296               4  nano_size      53       Vent      J2-1244          IGT5
297               0 micro_size      40       Vent      J2-1238         LV13a
298               9  nano_size      40       Vent      J2-1238         LV13a
299               0 micro_size      40       Vent      J2-1238         LV13a
300               3  nano_size      40       Vent      J2-1238         LV13a
301               1 micro_size       0       Vent      J2-1244          LV13
302               6  nano_size       0       Vent      J2-1244          LV13
303               1 micro_size       0       Vent      J2-1244          LV13
304               9  nano_size       0       Vent      J2-1244          LV13
305               0 micro_size      10       Vent      J2-1244          LV13
306               2  nano_size      10       Vent      J2-1244          LV13
307               0 micro_size      10       Vent      J2-1244          LV13
308               4  nano_size      10       Vent      J2-1244          LV13
309               1 micro_size      15       Vent      J2-1244          LV13
310               4  nano_size      15       Vent      J2-1244          LV13
311               0 micro_size      15       Vent      J2-1244          LV13
312               5  nano_size      15       Vent      J2-1244          LV13
313               0 micro_size      20       Vent      J2-1244          LV13
314               1  nano_size      20       Vent      J2-1244          LV13
315               0 micro_size      20       Vent      J2-1244          LV13
316               2  nano_size      20       Vent      J2-1244          LV13
317               0 micro_size      40       Vent      J2-1244          LV13
318               4  nano_size      40       Vent      J2-1244          LV13
319               0 micro_size      40       Vent      J2-1244          LV13
320               5  nano_size      40       Vent      J2-1244          LV13
321               0 micro_size       0       Vent      J2-1235   LV23 &amp; Bio5
322               0  nano_size       0       Vent      J2-1235   LV23 &amp; Bio5
323               2 micro_size       0       Vent      J2-1235   LV23 &amp; Bio5
324               3  nano_size       0       Vent      J2-1235   LV23 &amp; Bio5
325               0 micro_size      15       Vent      J2-1235   LV23 &amp; Bio5
326               1  nano_size      15       Vent      J2-1235   LV23 &amp; Bio5
327               2 micro_size      15       Vent      J2-1235   LV23 &amp; Bio5
328               9  nano_size      15       Vent      J2-1235   LV23 &amp; Bio5
329               2 micro_size      20       Vent      J2-1235   LV23 &amp; Bio5
330               4  nano_size      20       Vent      J2-1235   LV23 &amp; Bio5
331               1 micro_size      20       Vent      J2-1235   LV23 &amp; Bio5
332               5  nano_size      20       Vent      J2-1235   LV23 &amp; Bio5
333               0 micro_size      40       Vent      J2-1235   LV23 &amp; Bio5
334               2  nano_size      40       Vent      J2-1235   LV23 &amp; Bio5
335               1 micro_size      40       Vent      J2-1235   LV23 &amp; Bio5
336               3  nano_size      40       Vent      J2-1235   LV23 &amp; Bio5
    EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL  FLPperEuk
1          3    1.50         2      0.2 0.27272727
2          3    1.50         2      0.2 0.36363636
3          3    1.50         2      0.2 0.20000000
4          3    1.50         2      0.2 0.00000000
5          3    2.00         2      0.5 0.60000000
6          3    2.00         2      0.5 0.62500000
7          3    2.00         2      0.5 0.50000000
8          3    2.00         2      0.5 0.46153846
9          3    2.00         2      0.5 0.75000000
10         3    2.00         2      0.5 0.85714286
11         3    2.00         2      0.5 0.57142857
12         3    2.00         2      0.5 1.83333333
13         3    2.00         2      0.5 1.72727273
14         3    2.00         2      0.5 0.55555556
15         3    2.00         2      0.5 0.66666667
16         3    2.00         2      0.5 0.75000000
17         3    2.00         2      0.5 1.22222222
18         3    2.00         2      0.5 1.00000000
19         3    2.00         2      0.5 0.40000000
20         1    0.15        NA       NA 0.09090909
21         3    1.50         2      0.2 0.69230769
22         1    0.15        NA       NA 0.10000000
23         3    1.50         2      0.2 0.42857143
24         3    1.50         2      0.2 0.80000000
25         1    0.15        NA       NA 0.54545455
26         3    1.50         2      0.2 2.16666667
27         1    0.15        NA       NA 0.37500000
28         3    1.50         2      0.2 1.00000000
29         3    2.00         2      0.5 0.07692308
30         3    2.00         2      0.5 0.10000000
31         3    2.00         2      0.5 0.65217391
32         3    2.00         2      0.5 0.92857143
33         3    2.00         2      0.5 0.57142857
34         3    2.00         2      0.5 0.27777778
35         3    2.00         2      0.5 0.00000000
36         3    2.00         2      0.5 0.14285714
37         3    2.00         2      0.5 0.95238095
38         3    2.00         2      0.5 0.20000000
39         3    2.00         2      0.5 0.21428571
40         3    2.00         2      0.5 0.47058824
41         3    2.00         2      0.5 0.53333333
42         2    1.50         2      0.2 0.54545455
43         2    1.50         2      0.2 0.54545455
44         2    1.50         2      0.2 0.50000000
45         2    1.50         2      0.2 0.33333333
46         2    1.50         2      0.2 0.25000000
47         2    1.50         2      0.2 0.41666667
48         1    0.15        NA       NA 0.30000000
49         1    0.15        NA       NA 0.23529412
50         1    0.15        NA       NA 0.18181818
51         1    0.15        NA       NA 0.44444444
52         1    0.15        NA       NA 0.35714286
53         1    0.15        NA       NA 0.87500000
54         1    0.15        NA       NA 1.00000000
55         1    0.15        NA       NA 2.42105263
56         3    2.00         2      1.0 0.40476190
57         3    2.00         2      1.0 0.31578947
58         3    2.00         2      1.0 0.87500000
59         3    2.00         2      1.0 0.42105263
60         3    2.00         2      1.0 0.42105263
61         3    2.00         2      1.0 0.77777778
62         3    2.00         2      1.0 0.64705882
63         3    2.00         2      1.0 0.26666667
64         3    2.00         2      1.0 0.29411765
65         3    2.00         2      1.0 0.30000000
66         3    2.00         2      1.0 0.78571429
67         3    2.00         2      1.0 0.66666667
68         3    2.00         2      1.0 0.37500000
69         3    2.00         2      1.0 0.80952381
70         3    2.00         2      1.0 1.18181818
71         1    0.15        NA       NA 0.07407407
72         1    0.15        NA       NA 0.18750000
73         1    0.15        NA       NA 0.44444444
74         1    0.15        NA       NA 0.10000000
75         3    1.50         2      0.5 1.00000000
76         3    1.50         2      0.5 0.26086957
77         1    0.15        NA       NA 0.29411765
78         1    0.15        NA       NA 0.27777778
79         3    1.50         2      0.5 1.70000000
80         3    1.50         2      0.5 0.22222222
81         3    1.50         2      0.5 1.18750000
82         3    1.50         2      0.5 0.44000000
83         3    1.50         2      0.5 2.20000000
84         1    0.15        NA       NA 0.50000000
85         1    0.15        NA       NA 0.38095238
86         1    0.15        NA       NA 0.37500000
87         3    1.50         2      0.5 2.37500000
88         3    1.50         2      0.5 0.25000000
89         1    0.15        NA       NA 0.36363636
90         1    0.15        NA       NA 0.21052632
91         1    0.15        NA       NA 0.30000000
92         1    0.15        NA       NA 0.70000000
93         3    1.50         2      0.5 0.96153846
94         3    1.50         2      0.5 0.70000000
95         2    1.50         2      0.2 1.20000000
96         2    1.50         2      0.2 1.61111111
97         2    1.50         2      0.2 0.30769231
98         2    1.50         2      0.2 0.75000000
99         2    1.50         2      0.2 0.69230769
100        2    1.50         2      0.2 1.07692308
101        2    1.50         2      0.2 0.20000000
102        2    1.50         2      0.2 0.50000000
103        2    1.50         2      0.2 0.45454545
104        2    1.50         2      0.2 1.85714286
105        2    1.50         2      0.5 0.00000000
106        2    1.50         2      0.5 0.45000000
107        2    1.50         2      0.5 0.13333333
108        2    1.50         2      0.5 0.76000000
109        2    1.50         2      0.5 0.84615385
110        2    1.50         2      0.5 0.61904762
111        2    1.50         2      0.5 0.25000000
112        2    1.50         2      0.5 0.35294118
113        3    1.50         2      0.2        NaN
114        3    1.50         2      0.2 0.27272727
115        3    1.50         2      0.2 0.50000000
116        3    1.50         2      0.2 0.33333333
117        3    1.50         2      0.2        NaN
118        3    1.50         2      0.2 0.20000000
119        3    1.50         2      0.2        NaN
120        3    1.50         2      0.2 0.00000000
121        3    2.00         2      0.5 2.00000000
122        3    2.00         2      0.5 0.44444444
123        3    2.00         2      0.5 1.50000000
124        3    2.00         2      0.5 0.33333333
125        3    2.00         2      0.5 0.00000000
126        3    2.00         2      0.5 0.53333333
127        3    2.00         2      0.5        NaN
128        3    2.00         2      0.5 0.46153846
129        3    2.00         2      0.5        NaN
130        3    2.00         2      0.5 0.75000000
131        3    2.00         2      0.5 1.50000000
132        3    2.00         2      0.5 0.75000000
133        3    2.00         2      0.5 1.00000000
134        3    2.00         2      0.5 0.53846154
135        3    2.00         2      0.5 4.00000000
136        3    2.00         2      0.5 1.40000000
137        3    2.00         2      0.5 4.00000000
138        3    2.00         2      0.5 1.22222222
139        3    2.00         2      0.5 1.00000000
140        3    2.00         2      0.5 0.50000000
141        3    2.00         2      0.5 2.00000000
142        3    2.00         2      0.5 0.40000000
143        3    2.00         2      0.5 0.00000000
144        3    2.00         2      0.5 0.81818182
145        3    2.00         2      0.5        NaN
146        3    2.00         2      0.5 1.22222222
147        3    2.00         2      0.5        NaN
148        3    2.00         2      0.5 1.00000000
149        3    2.00         2      0.5 0.00000000
150        3    2.00         2      0.5 0.44444444
151        1    0.15        NA       NA        NaN
152        1    0.15        NA       NA 0.09090909
153        3    1.50         2      0.2 0.00000000
154        3    1.50         2      0.2 0.75000000
155        1    0.15        NA       NA 0.00000000
156        1    0.15        NA       NA 0.12500000
157        3    1.50         2      0.2 1.00000000
158        3    1.50         2      0.2 0.38461538
159        3    1.50         2      0.2 5.00000000
160        3    1.50         2      0.2 0.33333333
161        1    0.15        NA       NA 0.50000000
162        1    0.15        NA       NA 0.55555556
163        3    1.50         2      0.2 2.00000000
164        3    1.50         2      0.2 2.20000000
165        1    0.15        NA       NA 2.00000000
166        1    0.15        NA       NA 0.14285714
167        3    1.50         2      0.2 0.00000000
168        3    1.50         2      0.2 1.25000000
169        3    2.00         2      0.5        NaN
170        3    2.00         2      0.5 0.07692308
171        3    2.00         2      0.5        NaN
172        3    2.00         2      0.5 0.10000000
173        3    2.00         2      0.5 1.00000000
174        3    2.00         2      0.5 0.57894737
175        3    2.00         2      0.5 1.50000000
176        3    2.00         2      0.5 0.83333333
177        3    2.00         2      0.5 2.00000000
178        3    2.00         2      0.5 0.46153846
179        3    2.00         2      0.5 0.50000000
180        3    2.00         2      0.5 0.25000000
181        3    2.00         2      0.5        NaN
182        3    2.00         2      0.5 0.00000000
183        3    2.00         2      0.5 0.00000000
184        3    2.00         2      0.5 0.15384615
185        3    2.00         2      0.5 1.00000000
186        3    2.00         2      0.5 0.93750000
187        3    2.00         2      0.5 1.00000000
188        3    2.00         2      0.5 0.00000000
189        3    2.00         2      0.5 0.66666667
190        3    2.00         2      0.5 0.09090909
191        3    2.00         2      0.5 0.60000000
192        3    2.00         2      0.5 0.41666667
193        3    2.00         2      0.5 0.00000000
194        3    2.00         2      0.5 0.61538462
195        2    1.50         2      0.2        NaN
196        2    1.50         2      0.2 0.54545455
197        2    1.50         2      0.2        NaN
198        2    1.50         2      0.2 0.54545455
199        2    1.50         2      0.2        NaN
200        2    1.50         2      0.2 0.50000000
201        2    1.50         2      0.2        NaN
202        2    1.50         2      0.2 0.33333333
203        2    1.50         2      0.2 0.00000000
204        2    1.50         2      0.2 0.28571429
205        2    1.50         2      0.2        NaN
206        2    1.50         2      0.2 0.41666667
207        1    0.15        NA       NA 0.50000000
208        1    0.15        NA       NA 0.25000000
209        1    0.15        NA       NA 0.00000000
210        1    0.15        NA       NA 0.30769231
211        1    0.15        NA       NA        NaN
212        1    0.15        NA       NA 0.18181818
213        1    0.15        NA       NA        NaN
214        1    0.15        NA       NA 0.44444444
215        1    0.15        NA       NA        NaN
216        1    0.15        NA       NA 0.35714286
217        1    0.15        NA       NA 2.00000000
218        1    0.15        NA       NA 0.20000000
219        1    0.15        NA       NA        NaN
220        1    0.15        NA       NA 1.00000000
221        1    0.15        NA       NA 3.20000000
222        1    0.15        NA       NA 2.14285714
223        3    2.00         2      1.0 1.33333333
224        3    2.00         2      1.0 0.25000000
225        3    2.00         2      1.0 2.00000000
226        3    2.00         2      1.0 0.11764706
227        3    2.00         2      1.0 0.00000000
228        3    2.00         2      1.0 1.16666667
229        3    2.00         2      1.0 1.00000000
230        3    2.00         2      1.0 0.38888889
231        3    2.00         2      1.0 2.00000000
232        3    2.00         2      1.0 0.23529412
233        3    2.00         2      1.0 1.00000000
234        3    2.00         2      1.0 0.75000000
235        3    2.00         2      1.0 0.00000000
236        3    2.00         2      1.0 0.78571429
237        3    2.00         2      1.0        NaN
238        3    2.00         2      1.0 0.26666667
239        3    2.00         2      1.0 0.66666667
240        3    2.00         2      1.0 0.21428571
241        3    2.00         2      1.0 0.00000000
242        3    2.00         2      1.0 0.31578947
243        3    2.00         2      1.0 2.50000000
244        3    2.00         2      1.0 0.50000000
245        3    2.00         2      1.0 0.00000000
246        3    2.00         2      1.0 0.70588235
247        3    2.00         2      1.0 0.61538462
248        3    2.00         2      1.0 0.09090909
249        3    2.00         2      1.0        NaN
250        3    2.00         2      1.0 0.80952381
251        3    2.00         2      1.0 4.00000000
252        3    2.00         2      1.0 0.90000000
253        1    0.15        NA       NA        NaN
254        1    0.15        NA       NA 0.07407407
255        1    0.15        NA       NA 0.00000000
256        1    0.15        NA       NA 0.20000000
257        1    0.15        NA       NA 2.00000000
258        1    0.15        NA       NA 0.25000000
259        1    0.15        NA       NA 0.00000000
260        1    0.15        NA       NA 0.11111111
261        3    1.50         2      0.5        NaN
262        3    1.50         2      0.5 1.00000000
263        3    1.50         2      0.5 0.00000000
264        3    1.50         2      0.5 0.27272727
265        1    0.15        NA       NA        NaN
266        1    0.15        NA       NA 0.29411765
267        1    0.15        NA       NA        NaN
268        1    0.15        NA       NA 0.27777778
269        3    1.50         2      0.5 0.00000000
270        3    1.50         2      0.5 1.88888889
271        3    1.50         2      0.5        NaN
272        3    1.50         2      0.5 0.22222222
273        3    1.50         2      0.5        NaN
274        3    1.50         2      0.5 1.18750000
275        3    1.50         2      0.5 4.00000000
276        3    1.50         2      0.5 0.29166667
277        3    1.50         2      0.5 2.50000000
278        3    1.50         2      0.5 2.00000000
279        1    0.15        NA       NA 1.00000000
280        1    0.15        NA       NA 0.46666667
281        1    0.15        NA       NA 1.00000000
282        1    0.15        NA       NA 0.23529412
283        1    0.15        NA       NA        NaN
284        1    0.15        NA       NA 0.37500000
285        3    1.50         2      0.5 9.00000000
286        3    1.50         2      0.5 1.93333333
287        3    1.50         2      0.5        NaN
288        3    1.50         2      0.5 0.25000000
289        1    0.15        NA       NA        NaN
290        1    0.15        NA       NA 0.36363636
291        1    0.15        NA       NA        NaN
292        1    0.15        NA       NA 0.21052632
293        1    0.15        NA       NA        NaN
294        1    0.15        NA       NA 0.30000000
295        1    0.15        NA       NA 0.66666667
296        1    0.15        NA       NA 0.71428571
297        3    1.50         2      0.5        NaN
298        3    1.50         2      0.5 0.96153846
299        3    1.50         2      0.5        NaN
300        3    1.50         2      0.5 0.70000000
301        2    1.50         2      0.2 0.66666667
302        2    1.50         2      0.2 1.33333333
303        2    1.50         2      0.2 7.00000000
304        2    1.50         2      0.2 1.29411765
305        2    1.50         2      0.2 0.00000000
306        2    1.50         2      0.2 0.40000000
307        2    1.50         2      0.2 0.00000000
308        2    1.50         2      0.2 0.85714286
309        2    1.50         2      0.2 0.50000000
310        2    1.50         2      0.2 0.72727273
311        2    1.50         2      0.2 0.00000000
312        2    1.50         2      0.2 1.75000000
313        2    1.50         2      0.2        NaN
314        2    1.50         2      0.2 0.20000000
315        2    1.50         2      0.2 0.00000000
316        2    1.50         2      0.2 0.60000000
317        2    1.50         2      0.2        NaN
318        2    1.50         2      0.2 0.45454545
319        2    1.50         2      0.2 0.00000000
320        2    1.50         2      0.2 2.16666667
321        2    1.50         2      0.5 0.00000000
322        2    1.50         2      0.5 0.00000000
323        2    1.50         2      0.5 1.33333333
324        2    1.50         2      0.5 0.29411765
325        2    1.50         2      0.5 0.00000000
326        2    1.50         2      0.5 0.14285714
327        2    1.50         2      0.5 2.00000000
328        2    1.50         2      0.5 0.65217391
329        2    1.50         2      0.5 1.33333333
330        2    1.50         2      0.5 0.70000000
331        2    1.50         2      0.5 2.00000000
332        2    1.50         2      0.5 0.47368421
333        2    1.50         2      0.5        NaN
334        2    1.50         2      0.5 0.25000000
335        2    1.50         2      0.5 2.00000000
336        2    1.50         2      0.5 0.25000000</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>COLS: Timepoint, Minutes = time point label, actual incubated minutes</p>
</blockquote>
<blockquote class="blockquote">
<p>COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</p>
</blockquote>
</section>
</section>
<section id="calculate-linear-regression-to-obtain-slope" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="calculate-linear-regression-to-obtain-slope"><span class="header-section-number">4.3</span> Calculate linear regression to obtain slope</h2>
<p>Use <code>lm()</code> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</p>
<p>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) %&gt;% </span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"IGT_REP"</span>,</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) %&gt;% </span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</p>
</blockquote>
<p>Apply to all data to obtain slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`
Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p><em>gut check</em> linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <code>nest()</code> capability of tidyverse. Below, one experiment is subset to check the value.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-linear-regression-trend" class="level3">
<h3 class="anchored" data-anchor-id="plot-linear-regression-trend">Plot linear regression trend</h3>
<p>Plot all shipboard experiments with estimated slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Filter out IGT samples for now</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder, <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(21, 21, 21, 21)) +</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_fill_manual(values = c("white", "#264653", "white", "#E76F51")) +</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_color_manual(values = c("#264653", "#264653", "#E76F51", "#E76F51")) +</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Report r.squared</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>shipboardregression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</p>
</section>
</section>
<section id="remove-igt-tf-time-points." class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="remove-igt-tf-time-points."><span class="header-section-number">4.4</span> Remove IGT Tf time points.</h2>
<p>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"b"</span>, Replicate_ID)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`
Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated grazing effect.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>igtregression <span class="ot">&lt;-</span> igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>igtregression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Results are more consistent across experiments when we remove Tf from the IGT experiments</p>
</blockquote>
<section id="figure-s3" class="level4">
<h4 class="anchored" data-anchor-id="figure-s3">Figure S3</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS3.svg", h = 12, w = 7)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="sc">+</span> igtregression <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="repeat-but-include-technical-replicates" class="level3">
<h3 class="anchored" data-anchor-id="repeat-but-include-technical-replicates">Repeat, but include technical replicates</h3>
<p>Assess technical replicates for supplemental.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf_wb <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!grepl("b", Replicate_ID)) %&gt;% </span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(EXP_TYPE = IGT_REP) %&gt;% </span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> Replicate_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, Replicate_ID, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>REP, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf_wb) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`
Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated grazing effect.</p>
<section id="figure-s8" class="level4">
<h4 class="anchored" data-anchor-id="figure-s8">Figure S8</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS8.svg")</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only isolate IGT 4s, where the technical replicates were done</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"IGT4"</span>, IGT_REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Name, IGT_REP, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="compile-and-save-grazing-experiment-results" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="compile-and-save-grazing-experiment-results"><span class="header-section-number">4.5</span> Compile and save grazing experiment results</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="sc">%&gt;%</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrigin, SiteOrder, NameOrder, Experiment, SizeFrac, r.squared, INTERCEPT, SLOPE) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SiteOrigin SiteOrder      NameOrder          Experiment   SizeFrac
1        Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag total_euks
2       Plume   Piccard          Plume           Plume-Bag total_euks
3        Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag total_euks
4  Background  Von Damm     Background             BSW-Bag total_euks
5        Vent  Von Damm  Mustard Stand    MustardStand-Bag total_euks
6       Plume  Von Damm          Plume           Plume-Bag total_euks
7        Vent  Von Damm     Ravelin #2            Rav2-Bag total_euks
8        Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag total_euks
9        Vent  Von Damm           X-18             X18-Bag total_euks
10       Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag micro_size
11       Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag  nano_size
12      Plume   Piccard          Plume           Plume-Bag micro_size
13      Plume   Piccard          Plume           Plume-Bag  nano_size
14       Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag micro_size
15       Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag  nano_size
16 Background  Von Damm     Background             BSW-Bag micro_size
17 Background  Von Damm     Background             BSW-Bag  nano_size
18       Vent  Von Damm  Mustard Stand    MustardStand-Bag micro_size
19       Vent  Von Damm  Mustard Stand    MustardStand-Bag  nano_size
20      Plume  Von Damm          Plume           Plume-Bag micro_size
21      Plume  Von Damm          Plume           Plume-Bag  nano_size
22       Vent  Von Damm     Ravelin #2            Rav2-Bag micro_size
23       Vent  Von Damm     Ravelin #2            Rav2-Bag  nano_size
24       Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag micro_size
25       Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag  nano_size
26       Vent  Von Damm           X-18             X18-Bag micro_size
27       Vent  Von Damm           X-18             X18-Bag  nano_size
28       Vent   Piccard Shrimpocalypse Shrimpocalypse-IGT3 total_euks
29       Vent  Von Damm   Old Man Tree            OMT-IGT4 total_euks
30       Vent  Von Damm     Ravelin #2           Rav2-IGT4 total_euks
31       Vent  Von Damm     Ravelin #2           Rav2-IGT5 total_euks
     r.squared   INTERCEPT        SLOPE
1  0.660252577  0.35170021 -0.007605829
2  0.028109981  0.74350881  0.005362856
3  0.134500775  0.74142021  0.015686872
4  0.016339803  0.33810711  0.002958889
5  0.679501856  0.53165317 -0.005445545
6  0.152459998  0.45659816  0.005274231
7  0.003588551  0.96801815  0.003470217
8  0.002436342  0.89841555 -0.001967253
9  0.007917377  0.39372646  0.001744429
10 0.000000000  0.50000000           NA
11 0.723950257  0.34152209 -0.007467037
12 0.031027392  1.84477124 -0.021241830
13 0.134388231  0.56572102  0.009146535
14 0.016488447  1.89710611 -0.016881029
15 0.219942841  0.57936763  0.022967165
16 0.289513467  1.45183824 -0.027181373
17 0.015152403  0.29347056  0.002856863
18 0.000000000  0.00000000           NA
19 0.679997859  0.52917792 -0.004985856
20 0.098467998  0.78410898  0.019766939
21 0.019373495  0.45137023  0.002263909
22 0.696359782 -1.71474878  0.394651540
23 0.001444937  0.93924980  0.002011385
24 0.233424455  2.28754579 -0.092124542
25 0.002819273  0.93709575  0.002424242
26 0.302757291  0.67091295  0.036093418
27 0.018916716  0.30417816  0.002196051
28 0.661389551  0.02153110  0.016794258
29 0.294853437  0.23949718  0.003764672
30 0.990856592  0.06472882  0.021062665
31 0.550820859  0.43701267 -0.002850877</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="check-flp-control-experiments" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Check FLP control experiments</h1>
<p>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 17 rows [33, 34, 35, 36, 37,
38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49].</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TimePoint', 'Stain', 'Site'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<section id="bag-grazing-experiment-controls" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="bag-grazing-experiment-controls"><span class="header-section-number">5.1</span> Bag grazing experiment controls</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>bag_ctrls <span class="ot">&lt;-</span> dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>bag_ctrls</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="igt-experiment-controls" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="igt-experiment-controls"><span class="header-section-number">5.2</span> IGT experiment controls</h2>
<p>Repeat for IGT experiments.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>igt_ctrl_plot <span class="ot">&lt;-</span> dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>igt_ctrl_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<section id="figure-s5" class="level5">
<h5 class="anchored" data-anchor-id="figure-s5">Figure S5</h5>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS5_1.svg", w = 7, h = 7)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>bag_ctrls <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS5_2.svg", w = 4, h = 3)</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>(igt_ctrl_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="generate-complete-table-with-grazing-rates-and-values" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Generate complete table with grazing rates and values</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, IGT_REP, Site, Name, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, IGT_REP, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, SiteOrder, NameOrder, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume-Shipboard"</span>,</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background-Shipboard"</span>,</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Shipboard"</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">LABEL_REPS =</span> <span class="fu">case_when</span>(</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, LABEL_REPS, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'FLUID_ORIGIN', 'CRUISE_SAMPLE',
'IGT_REP', 'EXP_TYPE', 'EXP_REPS', 'EXP_VOL', 'CTRL_REPS', 'CTRL_VOL', 'Site',
'Name', 'SiteOrder', 'NameOrder'. You can override using the `.groups`
argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="co"># view complete table of grazing rate results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   SAMPLE FLUID_ORIGIN CRUISE_SAMPLE IGT_REP EXP_TYPE EXP_REPS
1     Piccard-LotsOShrimp      J2-1241          LV24     Bag      Bag        3
2           Piccard-Plume       CTD004     Niskin 10     Bag      Bag        3
3  Piccard-Shrimpocalypse      J2-1240          IGT3    IGT3      IGT        1
4  Piccard-Shrimpocalypse      J2-1240          LV13     Bag      Bag        3
5                  VD-BSW       CTD002  Niskins 8-10     Bag      Bag        3
6         VD-MustardStand      J2-1243          LV17     Bag      Bag        2
7                  VD-OMT      J2-1238          IGT4    IGT4      IGT        1
8                VD-Plume       CTD001      Niskin 2     Bag      Bag        3
9                 VD-Rav2      J2-1238         LV13a     Bag      Bag        3
10                VD-Rav2      J2-1244          IGT4    IGT4      IGT        1
11                VD-Rav2      J2-1244          IGT5    IGT5      IGT        1
12          VD-ShrimpHole      J2-1244          LV13     Bag      Bag        2
13                 VD-X18      J2-1235   LV23 &amp; Bio5     Bag      Bag        2
   EXP_VOL CTRL_REPS CTRL_VOL    Site           Experiment_rep           Name
1     1.50         2      0.2 Piccard    LotsOShrimp-Shipboard    LotsOShrimp
2     2.00         2      0.5 Piccard          Plume-Shipboard          Plume
3     0.15        NA       NA Piccard      Shrimpocalypse-IGT3 Shrimpocalypse
4     1.50         2      0.2 Piccard Shrimpocalypse-Shipboard Shrimpocalypse
5     2.00         2      0.5      VD            BSW-Shipboard            BSW
6     1.50         2      0.2      VD   MustardStand-Shipboard   MustardStand
7     0.15        NA       NA      VD                 OMT-IGT4            OMT
8     2.00         2      1.0      VD          Plume-Shipboard          Plume
9     1.50         2      0.5      VD           Rav2-Shipboard           Rav2
10    0.15        NA       NA      VD                Rav2-IGT4           Rav2
11    0.15        NA       NA      VD                Rav2-IGT5           Rav2
12    1.50         2      0.2      VD     ShrimpHole-Shipboard     ShrimpHole
13    1.50         2      0.5      VD            X18-Shipboard            X18
   SiteOrder      NameOrder         RATE        TimePoints  GRAZE_RATE
1    Piccard Lots 'O Shrimp -0.007605829     0, 15, 20, 40 0.000000000
2    Piccard          Plume  0.005362856 0, 10, 15, 20, 40 0.005362856
3    Piccard Shrimpocalypse  0.016794258         0, 15, 25 0.016794258
4    Piccard Shrimpocalypse  0.015686872 0, 10, 14, 22, 42 0.015686872
5   Von Damm     Background  0.002958889 0, 10, 15, 20, 40 0.002958889
6   Von Damm  Mustard Stand -0.005445545     0, 10, 20, 40 0.000000000
7   Von Damm   Old Man Tree  0.003764672          0, 7, 25 0.003764672
8   Von Damm          Plume  0.005274231 0, 10, 15, 25, 57 0.005274231
9   Von Damm     Ravelin #2  0.003470217 0, 10, 15, 21, 40 0.003470217
10  Von Damm     Ravelin #2  0.021062665         0, 12, 20 0.021062665
11  Von Damm     Ravelin #2 -0.002850877         0, 35, 40 0.000000000
12  Von Damm    Shrimp Hole -0.001967253 0, 10, 15, 20, 40 0.000000000
13  Von Damm           X-18  0.001744429     0, 15, 20, 40 0.001744429
              type LABEL_REPS
1   Vent-Shipboard  Shipboard
2  Plume-Shipboard  Shipboard
3         Vent-IGT       IGT3
4   Vent-Shipboard  Shipboard
5   Vent-Shipboard  Shipboard
6   Vent-Shipboard  Shipboard
7         Vent-IGT       IGT4
8  Plume-Shipboard  Shipboard
9   Vent-Shipboard  Shipboard
10        Vent-IGT       IGT4
11        Vent-IGT       IGT5
12  Vent-Shipboard  Shipboard
13  Vent-Shipboard  Shipboard</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Experiment_rep'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
# Groups:   Experiment_rep [12]
   Experiment_rep           Site    mean_rate min_rate     max
   &lt;chr&gt;                    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 BSW-Shipboard            VD        0.00296  0.00296 0.00296
 2 LotsOShrimp-Shipboard    Piccard   0        0       0      
 3 MustardStand-Shipboard   VD        0        0       0      
 4 OMT-IGT4                 VD        0.00376  0.00376 0.00376
 5 Plume-Shipboard          Piccard   0.00536  0.00536 0.00536
 6 Plume-Shipboard          VD        0.00527  0.00527 0.00527
 7 Rav2-IGT4                VD        0.0211   0.0211  0.0211 
 8 Rav2-IGT5                VD        0        0       0      
 9 Rav2-Shipboard           VD        0.00347  0.00347 0.00347
10 ShrimpHole-Shipboard     VD        0        0       0      
11 Shrimpocalypse-IGT3      Piccard   0.0168   0.0168  0.0168 
12 Shrimpocalypse-Shipboard Piccard   0.0157   0.0157  0.0157 
13 X18-Shipboard            VD        0.00174  0.00174 0.00174</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(Site, TYPE) %&gt;% </span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(TYPE) %&gt;%</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPE, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TYPE'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   TYPE [2]
  TYPE     EXP_TYPE mean_rate min_rate     max
  &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 non-vent Bag        0.00532  0.00527 0.00536
2 vent     Bag        0.00341  0       0.0157 
3 vent     IGT        0.0104   0       0.0211 </code></pre>
</div>
</div>
<p>Amend table with estimated FLP concentration</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_ml =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>, <span class="sc">-</span>FLP_conc) <span class="sc">%&gt;%</span> </span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Introduce factors in table for visualizations</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>FIELDORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>VENTORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-flpgrazer-minute" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="plot-flpgrazer-minute"><span class="header-section-number">6.1</span> Plot FLP/grazer /minute</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, FIELD, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> VENTORDER, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELDORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="table-1" class="level3">
<h3 class="anchored" data-anchor-id="table-1">Table 1</h3>
<p>Create table with all base experiment results. Including, grazing rate derived from slope (and corrected), number of experiments, replicates, and prok and euk counts.</p>
<p>For IGT experiments, or experiments where in situ prok counts were not obtained, the average in situ prok count was used.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_grazerate_wflp)</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View(euk_prok_counts)</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Experiment_rep, FIELD, Name, SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, RATE, <span class="at">RATE_minute =</span> GRAZE_RATE, FLP_ml, TimePoints, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span> </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(euk_prok_counts, <span class="fu">join_by</span>(Experiment_rep <span class="sc">==</span> Experiment_rep, Name <span class="sc">==</span> Name, FIELD <span class="sc">==</span> Site)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(PROK_ml), avg_insitu, PROK_ml))</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp_wprok_weuk</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co"># names(table_grazerate_wflp_wprok_weuk)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Description of variables above:</p>
<ul>
<li>FIELD - vent location</li>
<li>NAME - name of vent site, or plume/background</li>
<li>EXP - experiment type, bag or IGT</li>
<li>SAMPLE - vent site</li>
<li>RATE_minute = GRAZE_RATE - FLPs per grazer per minute (SLOPE of best fitline)</li>
<li>FLP_ml - FLP concentration at T0</li>
<li>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</li>
<li>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</li>
</ul>
</section>
</section>
</section>
<section id="grazing-rate-calculations" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Grazing rate calculations</h1>
<p>Based on Unrein et al.&nbsp;2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_minute <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explanation of units for table with calculated values.</p>
<ul>
<li><p>RATE_min &amp; RATE_hr = Grazing rate as ‘FLPs per grazer per minute’ and per hour</p></li>
<li><p>CLEARANCE_RATE = ml or nL per grazer per hour</p></li>
<li><p>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</p></li>
<li><p>GRAZING EFFECT = bacteria per ml per hour</p></li>
<li><p>Bacterial turnover rate = % per day</p></li>
</ul>
<section id="gt-table-options" class="level3">
<h3 class="anchored" data-anchor-id="gt-table-options">gt table options</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bkgd &lt;- c("Background", "Plume")</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gt)</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Table 1 and S1 - grazing experiment information only</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># April 18, 2023</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Table 1</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, EUK_ml, EUK_MinMax, PROK_ml, PROK_MinMax, GRAZING_EFFECT_hr, RATE_minute, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # ## Table S2</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE,</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                      TimePoints, starts_with("EXP"), starts_with("CTRL"), EUK_ml, EUK_MinMax, EUK_sem, PROK_ml, PROK_MinMax, PROK_sem, FLP_ml, GRAZE_RATE_DAY, Slope = RATE, RATE_minute, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/tableS2-grazing-exp-list.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="carbon-biomass-for-eukaryotes" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Carbon biomass for eukaryotes</h1>
<p>References for estimating biovolume <em>Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al.&nbsp;(2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782–792.</em></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="c-factor-based-on-biovolume" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="c-factor-based-on-biovolume"><span class="header-section-number">8.1</span> C factor based on biovolume</h2>
<ol type="1">
<li>Calculate biovolume based on observed/imaged cells</li>
</ol>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate biovolume, then apply carbon by biomass estimate for protists derived from biovolume.</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># h = largest cell dimension "height"</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># d = largest cross-section of h</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIOVOLUME =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> h)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_dino =</span> (<span class="fl">0.760</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.819</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_nodiatom =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.939</span>))) <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># biov_calc</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(c(80, 360))</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co"># no diatom is what Pernice used.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Use <code>pgC_cell_MD_nodiatom</code> moving forward.</p>
<ol start="2" type="1">
<li>Get a summary pg per cell for vent and background samples. This is derived from biovolume estimates.</li>
</ol>
</section>
<section id="table-s4-biomass-summaries" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="table-s4-biomass-summaries"><span class="header-section-number">8.2</span> Table S4 biomass summaries</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>c_factor_biov <span class="ot">&lt;-</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  biov_calc <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>EXP, <span class="sc">-</span>h, <span class="sc">-</span>d) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(BIOVOLUME, <span class="fu">starts_with</span>(<span class="st">"pgC_"</span>)), <span class="at">names_to =</span> <span class="st">"VARIABLES"</span>, <span class="at">values_to =</span> <span class="st">"VALUES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW, VARIABLES) <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(VALUES),</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(VALUES),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VENT_BSW, <span class="at">values_from =</span> <span class="fu">c</span>(mean, max,min), <span class="at">names_sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'VENT_BSW'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(c_factor_biov)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>Assign a C conversion factor for background and within vents based on biovolume</li>
</ol>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pg C per cell (pgC_cell)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_BSW</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_vent</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_BSW</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_vent</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_BSW</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_vent</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 109.1574</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 414.8068</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Combine with count table to estimate total standing stock in carbon</li>
</ol>
<p>Isolate at T0 all the euk cells per ml counts. Then add in the mean, min/max for the pg C per cell, based on the vent vs non-vent.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># counts_cellsml_avg</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pg C per ml = (cells per ml)*(pg C per)</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Apply the non-vent and vent pg C per cell value to total cells per ml</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent,</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_min =</span> <span class="fu">case_when</span>(</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_min,</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_min</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_max =</span> <span class="fu">case_when</span>(</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_max,</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_max</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Site           Experiment_rep           Name TimePoint EXP_TYPE   IGT_REP
1  Piccard    LotsOShrimp-Shipboard    LotsOShrimp        T0      Bag Shipboard
2  Piccard          Plume-Shipboard          Plume        T0      Bag Shipboard
3  Piccard Shrimpocalypse-Shipboard Shrimpocalypse        T0      Bag Shipboard
4  Piccard      Shrimpocalypse-IGT3 Shrimpocalypse        T0      IGT      IGT3
5  Piccard      Shrimpocalypse-IGT7 Shrimpocalypse        T0      IGT      IGT7
6       VD            BSW-Shipboard            BSW        T0      Bag Shipboard
7       VD   MustardStand-Shipboard   MustardStand        T0      Bag Shipboard
8       VD                 OMT-IGT4            OMT        T0      IGT      IGT4
9       VD                OMT-IGT4b            OMT        T0      IGT     IGT4b
10      VD          Plume-Shipboard          Plume        T0      Bag Shipboard
11      VD           Rav2-Shipboard           Rav2        T0      Bag Shipboard
12      VD                Rav2-IGT4           Rav2        T0      IGT      IGT4
13      VD               Rav2-IGT4b           Rav2        T0      IGT     IGT4b
14      VD                Rav2-IGT5           Rav2        T0      IGT      IGT5
15      VD               Rav2-IGT5b           Rav2        T0      IGT     IGT5b
16      VD     ShrimpHole-Shipboard     ShrimpHole        T0      Bag Shipboard
17      VD            X18-Shipboard            X18        T0      Bag Shipboard
   VARIABLE      MEAN        VAR        SD        SEM       MIN      MAX
1   eukCONC 230.90630         NA        NA         NA 230.90630 230.9063
2   eukCONC  79.30115   848.6444  29.13150  16.819081  55.97728 111.9546
3   eukCONC 454.81543         NA        NA         NA 454.81543 454.8154
4   eukCONC 384.84383         NA        NA         NA 384.84383 384.8438
5   eukCONC 524.78704         NA        NA         NA 524.78704 524.7870
6   eukCONC  91.83773   956.2550  30.92337  21.866127  69.97160 113.7039
7   eukCONC 259.76958  1666.1787  40.81885  28.863287 230.90630 288.6329
8   eukCONC 349.85802         NA        NA         NA 349.85802 349.8580
9   eukCONC 594.75864         NA        NA         NA 594.75864 594.7586
10  eukCONC 157.77468 13506.6620 116.21817  67.098589  55.97728 284.4007
11  eukCONC 409.33389 10795.7362 103.90253  73.470185 335.86370 482.8041
12  eukCONC 944.61667         NA        NA         NA 944.61667 944.6167
13  eukCONC 559.77284         NA        NA         NA 559.77284 559.7728
14  eukCONC 629.74444         NA        NA         NA 629.74444 629.7444
15  eukCONC 349.85802         NA        NA         NA 349.85802 349.8580
16  eukCONC 385.71847   123.9306  11.13241   7.871806 377.84667 393.5903
17  eukCONC 314.87222 22032.1147 148.43219 104.957407 209.91481 419.8296
   SAMPLE_TYPE_BIN pgC_ml_mean pgC_ml_min pgC_ml_max
1             Vent   95781.500  1216.6456  296465.66
2         Non-vent    8656.305  2241.3730   20432.20
3             Vent  188660.531  2396.4232  583947.52
4             Vent  159635.834  2027.7427  494109.44
5             Vent  217685.228  2765.1037  673785.60
6             Vent   38094.915   483.8932  117912.48
7             Vent  107754.188  1368.7263  333523.87
8             Vent  145123.485  1843.4025  449190.40
9             Vent  246709.925  3133.7842  763623.68
10        Non-vent   17222.270  4459.3540   40651.15
11            Vent  169794.478  2156.7809  525552.77
12            Vent  391833.410  4977.1867 1212814.08
13            Vent  232197.576  2949.4440  718704.64
14            Vent  261222.273  3318.1245  808542.72
15            Vent  145123.485  1843.4025  449190.40
16            Vent  159998.642  2032.3512  495232.42
17            Vent  130611.137  1659.0622  404271.36</code></pre>
</div>
</div>
<p>Table reports the total pg of carbon per ml when we consider the whole eukaryote community (based on cell count).</p>
<p>Report in pg of C per ml.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pgC_ml_mean))) <span class="sc">+</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (pgC_ml_min), <span class="at">ymax =</span> (pgC_ml_max))) <span class="sc">+</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - derived from biovolume"</span>)</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>by_biovol_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="c-biomass-based-on-size-fraction" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="c-biomass-based-on-size-fraction"><span class="header-section-number">8.3</span> C biomass based on size fraction</h2>
<p>Derived from Caron et al.&nbsp;1995</p>
<ol type="1">
<li>Assign by size class</li>
</ol>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>c_n <span class="ot">&lt;-</span> <span class="fl">2.6</span> <span class="co"># pg C per cell</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>c_m <span class="ot">&lt;-</span> <span class="dv">138</span> <span class="co"># pg C per cell</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample_tmp <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">!=</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> <span class="co"># isolate micro vs. nano</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_cell =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> c_m,</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> c_n</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiply mean cells per ml of micro and nano by pg C for each size fraction:</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_ml_TMP =</span> MEAN <span class="sc">*</span> pg_C_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Take the average of the micro and nano for each experiment.</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml_TMP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Experiment_rep', 'Site', 'Name',
'TimePoint', 'EXP_TYPE', 'IGT_REP', 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate total euk for each experiment by adding.</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add across micro and nano to get total</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pg_C_ml =</span> <span class="fu">sum</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">VARIABLE =</span> <span class="st">"totaleuk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Experiment_rep', 'Site', 'Name',
'TimePoint', 'EXP_TYPE', 'IGT_REP'. You can override using the `.groups`
argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp2, pgC_ml_sizefrac_bysample_tmp)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51 × 9
# Groups:   Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP [17]
   Experiment_rep Site  Name  TimePoint EXP_TYPE IGT_REP SAMPLE_TYPE_BIN pg_C_ml
   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
 1 BSW-Shipboard  VD    BSW   T0        Bag      Shipbo… Vent               239.
 2 LotsOShrimp-S… Picc… Lots… T0        Bag      Shipbo… Vent               600.
 3 MustardStand-… VD    Must… T0        Bag      Shipbo… Vent               675.
 4 OMT-IGT4       VD    OMT   T0        IGT      IGT4    Vent             10384.
 5 OMT-IGT4b      VD    OMT   T0        IGT      IGT4b   Vent             20495.
 6 Plume-Shipboa… Picc… Plume T0        Bag      Shipbo… Non-vent          1469.
 7 Plume-Shipboa… VD    Plume T0        Bag      Shipbo… Non-vent          3507.
 8 Rav2-IGT4      VD    Rav2  T0        IGT      IGT4    Vent              2456.
 9 Rav2-IGT4b     VD    Rav2  T0        IGT      IGT4b   Vent              6192.
10 Rav2-IGT5      VD    Rav2  T0        IGT      IGT5    Vent             11111.
# ℹ 41 more rows
# ℹ 1 more variable: VARIABLE &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
  SAMPLE_TYPE_BIN VARIABLE  MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 Non-vent        microCONC        2222.       3156.       1287.
2 Non-vent        nanoCONC          266.        351.        182.
3 Non-vent        totaleuk         2488.       3507.       1469.
4 Vent            microCONC        5126.      19312.          0 
5 Vent            nanoCONC         1028.       2456.        239.
6 Vent            totaleuk         6153.      20495.        239.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pgC_ml_sizefrac_bysample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
# Groups:   Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP [6]
  Experiment_rep  Site  Name  TimePoint EXP_TYPE IGT_REP SAMPLE_TYPE_BIN pg_C_ml
  &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
1 BSW-Shipboard   VD    BSW   T0        Bag      Shipbo… Vent               239.
2 LotsOShrimp-Sh… Picc… Lots… T0        Bag      Shipbo… Vent               600.
3 MustardStand-S… VD    Must… T0        Bag      Shipbo… Vent               675.
4 OMT-IGT4        VD    OMT   T0        IGT      IGT4    Vent             10384.
5 OMT-IGT4b       VD    OMT   T0        IGT      IGT4b   Vent             20495.
6 Plume-Shipboard Picc… Plume T0        Bag      Shipbo… Non-vent          1469.
# ℹ 1 more variable: VARIABLE &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>by_sizefrac_plot <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pg_C_ml))) <span class="sc">+</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> VARIABLE)) <span class="sc">+</span> </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_linerange(aes(ymin = (pgC_ml_min/1000), ymax = (pgC_ml_max/1000))) +</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - based on size fraction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Combined supplementary plot showing two routes of determining total biomass.</p>
</section>
<section id="figure-s2" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="figure-s2"><span class="header-section-number">8.4</span> Figure S2</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS2.svg", h = 8, w = 7)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="sc">+</span> by_sizefrac_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-total-carbon-biomass---euks" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="compare-total-carbon-biomass---euks"><span class="header-section-number">8.5</span> Compare total carbon biomass - euks</h2>
<p>Compilation table of carbon biomass values for microeukaryotes by sample type and vent field</p>
<section id="table-s4" class="level3">
<h3 class="anchored" data-anchor-id="table-s4">Table S4</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass derived from biovolume, by vent field (vent only)</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>table4_cbiomass_total <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, EXP_TYPE, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, SAMPLE_TYPE_BIN, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'VARIABLE', 'Site', 'EXP_TYPE'. You can
override using the `.groups` argument.
`summarise()` has grouped output by 'VARIABLE', 'Site', 'SAMPLE_TYPE_BIN'. You
can override using the `.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table4_cbiomass_total</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(table4_cbiomass_total, file = "output-data/tableS4-cbiomass.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compare-biovolumes-from-literature-to-measured-in-this-study" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="compare-biovolumes-from-literature-to-measured-in-this-study"><span class="header-section-number">8.6</span> Compare biovolumes from literature to measured in this study</h2>
<p>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10^7 µm^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</p>
<p>Import the heterotroph species volume and carbon content to compare to my measured values. Compare to md-lessard (Supplementary)</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># biov</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, <span class="at">Volume =</span> BIOVOLUME, <span class="at">pgC_cell =</span> pgC_cell_MD_nodiatom)) <span class="sc">%&gt;%</span> </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>carbon_compare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</p>
</section>
</section>
<section id="carbon-biomass-for-prokaryotes" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Carbon biomass for prokaryotes</h1>
<p>Now, report estimated carbon per cell for bacteria.</p>
<p>Units: fg C per cell.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>bac_carbon_Mor_fg <span class="ot">&lt;-</span> (<span class="dv">86</span>) </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co">#From Derived from Morono et al. 2011 </span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>bac_carbon_Lof_fg <span class="ot">&lt;-</span> (<span class="dv">173</span>) </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Derived from McNichol et al. 2018; LOFERER-KROBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fg C per cell</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>bac_carbon_mean <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>bac_carbon_min <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>bac_carbon_max <span class="ot">&lt;-</span> <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Import main table with all estimates of cells</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs &lt;- read_delim(file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>RATE_min units = FLPs per grazer per minute Clearance rate _ml = ml per grazer per hour</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE,  <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, RATE_minute) <span class="sc">%&gt;%</span> </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in calcs by fg C per cell.</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimates of carbon pool of microbes per ml. </span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MOR_fgC_ml =</span> bac_carbon_Mor_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">LOF_fgC_ml =</span> bac_carbon_Lof_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">MEAN_fgC_ml =</span> bac_carbon_mean <span class="sc">*</span> PROK_ml,</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_fgC_ml =</span> bac_carbon_max <span class="sc">*</span> PROK_ml,</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_fgC_ml =</span> bac_carbon_min <span class="sc">*</span> PROK_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"fgC_ml"</span>), <span class="at">names_to =</span> <span class="st">"prokC_category"</span>, <span class="at">values_to =</span> <span class="st">"fgC_ml"</span>)</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get summary of prokaryotic biomass</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, prokC_category) <span class="sc">%&gt;%</span> </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 fg == 0.001 pg</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to pg C per ml</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pgC_ml =</span> <span class="fu">mean</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_pgC_ml =</span> <span class="fu">min</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_pgC_ml =</span> <span class="fu">max</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
   SAMPLE_TYPE_BIN prokC_category mean_pgC_ml min_pgC_ml max_pgC_ml
   &lt;chr&gt;           &lt;chr&gt;                &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Non-vent        LOF_fgC_ml           6101.      2851.      8897.
 2 Non-vent        MAX_fgC_ml            705.       330.      1029.
 3 Non-vent        MEAN_fgC_ml           529.       247.       771.
 4 Non-vent        MIN_fgC_ml            353.       165.       514.
 5 Non-vent        MOR_fgC_ml           3033.      1417.      4423.
 6 Vent            LOF_fgC_ml          19884.      7263.     41276.
 7 Vent            MAX_fgC_ml           2299.       840.      4772.
 8 Vent            MEAN_fgC_ml          1724.       630.      3579.
 9 Vent            MIN_fgC_ml           1149.       420.      2386.
10 Vent            MOR_fgC_ml           9885.      3611.     20519.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="incorporate-carbon-biomass-of-prey-and-grazing-rate" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="incorporate-carbon-biomass-of-prey-and-grazing-rate"><span class="header-section-number">9.1</span> Incorporate carbon biomass of prey and grazing rate</h2>
<p>Clearance rate is mL per grazer per hour (Table S3). Grazing effect is prokaryotes ml-1 hr-1 (Table S3).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon consumed based on clearance rate</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="ot">&lt;-</span> est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use only value from Morono et al., convert to pg C per cell.</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prokC_category <span class="sc">==</span> <span class="st">"MOR_fgC_ml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_carbon_Mor_pg =</span> (bac_carbon_Mor_fg <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE, PROK_ml, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, bac_carbon_Mor_pg, fgC_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clearance rate * fg of prok == pg C per grazer per hr</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bac_carbon_Mor_pg * grazing effect == pg C per ml per hr</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_pergrazer_CLEARANCE =</span> (fgC_ml<span class="sc">*</span><span class="fl">0.001</span>) <span class="sc">*</span> CLEARANCE_RATE_ml,</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_perml_perhr =</span> bac_carbon_Mor_pg <span class="sc">*</span> GRAZING_EFFECT_hr)</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>carbon_consumed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 11
   SiteOrder NameOrder      FLUID_ORIGIN CRUISE_SAMPLE PROK_ml GRAZING_EFFECT_hr
   &lt;fct&gt;     &lt;fct&gt;          &lt;chr&gt;        &lt;chr&gt;           &lt;dbl&gt;             &lt;dbl&gt;
 1 Piccard   Lots 'O Shrimp J2-1241      LV24           53878                0  
 2 Piccard   Plume          CTD004       Niskin 10      51429               44.3
 3 Piccard   Shrimpocalypse J2-1240      LV13          238590             6007. 
 4 Von Damm  Background     CTD002       Niskins 8-10   37890              127. 
 5 Von Damm  Mustard Stand  J2-1243      LV17           56677                0  
 6 Von Damm  Plume          CTD001       Niskin 2       16478               24.0
 7 Von Damm  Ravelin #2     J2-1238      LV13a          71147.             117. 
 8 Von Damm  Shrimp Hole    J2-1244      LV13           41983                0  
 9 Von Damm  X-18           J2-1235      LV23 &amp; Bio5   111430             1166. 
10 Piccard   Shrimpocalypse J2-1240      IGT3          238590            17285. 
11 Von Damm  Old Man Tree   J2-1238      IGT4           71147.            1050. 
12 Von Damm  Ravelin #2     J2-1244      IGT4           71147.           15867. 
13 Von Damm  Ravelin #2     J2-1244      IGT5           71147.               0  
14 &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;         &lt;NA&gt;          238590               NA  
# ℹ 5 more variables: CLEARANCE_RATE_ml &lt;dbl&gt;, bac_carbon_Mor_pg &lt;dbl&gt;,
#   fgC_ml &lt;dbl&gt;, pgC_pergrazer_CLEARANCE &lt;dbl&gt;, pgC_perml_perhr &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="environmental-parameters---mcr" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Environmental parameters - MCR</h1>
<p>Import from Hu et al.&nbsp;(<em>Molecular Ecology</em>).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"num"</span>, <span class="st">"loc"</span>, <span class="st">"loc2"</span>, <span class="st">"fluid_origin"</span>, <span class="st">"name"</span>, <span class="st">"FLUID_ORIGIN"</span>, <span class="st">"else"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE,FLUID_ORIGIN, <span class="fu">everything</span>(), <span class="sc">-</span>num, <span class="sc">-</span>loc, <span class="sc">-</span>loc2, <span class="sc">-</span>fluid_origin, <span class="sc">-</span>name, <span class="sc">-</span><span class="st">`</span><span class="at">else</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 7 pieces. Additional pieces discarded in 16 rows [2, 3, 4, 5, 6, 7, 8,
9, 10, 11, 12, 13, 14, 15, 16, 17].</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 7 pieces. Missing pieces filled with `NA` in 1 rows [1].</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate supplementary table.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc, <span class="fu">everything</span>())</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis-of-grazing-rate-results" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Analysis of grazing rate results</h1>
<p>Re-import table from output table with all grazing values</p>
<p>Format and factor values to plot, and prioritize these values:</p>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
<li>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</li>
</ul>
<p>Report grazing rates</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_biov_bysample)</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_sizefrac_bysample)</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Saved April 29, 2023</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(table_grazerate_wflp_wprok_weuk, table_wcalcs, pgC_ml_biov_bysample, pgC_ml_sizefrac_bysample, carbon_consumed, <span class="at">file =</span> <span class="st">"output-data/processed-dfs-mcr-grazing.RData"</span>)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/processed-dfs-mcr-grazing.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot grazing rates</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figure-1-compilation" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Figure 1 compilation</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig1.svg", w = 10, h = 8)</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  (grazing_min_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.02</span>))) <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  (grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="960"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="grazing-rate-vs.-cells-ml" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="grazing-rate-vs.-cells-ml"><span class="header-section-number">12.1</span> Grazing rate vs.&nbsp;cells ml</h2>
<p>Combine metadata from environment with grazing rate results.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify fluid origin to match metadata and results</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>mod_metadata <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID"</span>, <span class="st">"HOG"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID2"</span>, <span class="st">"excess"</span>), <span class="at">sep =</span> <span class="st">"J2"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(excess, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID3"</span>, <span class="st">"hogexcess"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLUID_ORIGIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    FLUID2 <span class="sc">==</span> <span class="st">"CTD003"</span> <span class="sc">~</span> <span class="st">"CTD001"</span>, <span class="co">#Correction for plume VD</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(FLUID3) <span class="sc">~</span> FLUID2,</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"J2-"</span>, FLUID3, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FLUID, <span class="sc">-</span>FLUID2, <span class="sc">-</span>FLUID3, <span class="sc">-</span>HOG, <span class="sc">-</span>excess, <span class="sc">-</span>hogexcess) <span class="sc">%&gt;%</span> </span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">case_when</span>(</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>    VENT <span class="sc">==</span> <span class="st">"OldManTree"</span> <span class="sc">~</span> <span class="st">"OMT"</span>,</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> VENT</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Missing pieces filled with `NA` in 4 rows [1, 2, 6, 7].
Expected 2 pieces. Missing pieces filled with `NA` in 4 rows [1, 2, 6, 7].</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(table_wcalcs$Name)</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mod_metadata</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="co"># setdiff(mod_metadata$FLUID_ORIGIN, table_wcalcs$FLUID_ORIGIN)</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, Name, Experiment_rep, FLUID_ORIGIN, RATE_minute, <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mod_metadata, <span class="fu">join_by</span>(Name <span class="sc">==</span> Name, FLUID_ORIGIN <span class="sc">==</span> FLUID_ORIGIN))</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(grazing_wenv)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_metadata)</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, </span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(shape = EXP_TYPE), size = 4, stroke = 2) +</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>euk_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_errorbarh()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, </span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(1, 19)) +</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Microbial prey cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a>prok_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_errorbarh()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="figure-2-compilation" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Figure 2 compilation</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2.svg", h = 10, w = 7)</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>(euk_temp <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> prok_temp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_errorbarh()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_errorbarh()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="comparison-with-gorda-ridge" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Comparison with Gorda Ridge</h1>
<p>Import data from Gorda Ridge</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combine-gr-and-mcr-data" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="combine-gr-and-mcr-data"><span class="header-section-number">14.1</span> Combine GR and MCR data</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span> </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover)) <span class="sc">%&gt;%</span> </span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(NAME, SAMPLE)`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., temps): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 1 of `x` matches multiple rows in `y`.
ℹ Row 5 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-combined-results" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="plot-combined-results"><span class="header-section-number">14.2</span> Plot combined results</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPERIMENTTYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    EXP <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EXPERIMENTTYPE, FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE)) <span class="sc">+</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE),</span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#addd8e"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_fill_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("#E76F51", "#264653")) +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add Gorda Ridge comparison to supplementary?</p>
<section id="figure-s7" class="level4">
<h4 class="anchored" data-anchor-id="figure-s7">Figure S7</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7.svg", h = 4, w = 6)</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="576"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-undetected-grazing-rate" class="level3">
<h3 class="anchored" data-anchor-id="remove-undetected-grazing-rate">Remove undetected grazing rate</h3>
<p>Repeat grazing rate plot, but removed undetectable</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="plot-variables-as-a-factor-of-grazing-rate." class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="plot-variables-as-a-factor-of-grazing-rate."><span class="header-section-number">14.3</span> Plot variables as a factor of grazing rate.</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grazing_wenv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  SiteOrder           Name           Experiment_rep FLUID_ORIGIN RATE_minute
1   Piccard    LotsOShrimp    LotsOShrimp-Shipboard      J2-1241 0.000000000
2   Piccard          Plume          Plume-Shipboard       CTD004 0.005362856
3   Piccard Shrimpocalypse Shrimpocalypse-Shipboard      J2-1240 0.015686872
4  Von Damm            BSW            BSW-Shipboard       CTD002 0.002958889
5  Von Damm   MustardStand   MustardStand-Shipboard      J2-1243 0.000000000
6  Von Damm          Plume          Plume-Shipboard       CTD001 0.005274231
   EUK_ml    EUK_MinMax  EUK_sem PROK_ml     PROK_MinMax  PROK_sem
1 230.910 230.9 / 230.9       NA   53878   26240 / 90260 13727.191
2  79.301   55.98 / 112 16.81908   51429   46810 / 56050  4618.126
3 454.820 454.8 / 454.8       NA  238590 108700 / 322000 65792.588
4  91.838 69.97 / 113.7 21.86613   37890   18470 / 56470  8608.427
5 259.770 230.9 / 288.6 28.86329   56677   42400 / 70950 14274.207
6 157.770 55.98 / 284.4 67.09859   16478   13850 / 19100  2623.935
  GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1           0.00000                    NA                    NA
2          44.25910              34.87211              53.64608
3        6006.91224                    NA                    NA
4         127.06552              96.81191             157.31912
5           0.00000               0.00000               0.00000
6          24.02568              13.80771              34.24365
  GRAZING_EFFECT_day                                              SEQ_SAMPLE
1             0.0000    78_MCR_Piccard_HOG_LotsOShrimp_J21241HOG14_0_Jun2021
2          1062.2184               74_MCR_Piccard_CTD_Plume_CTD004_5_Jun2021
3        144165.8939 77_MCR_Piccard_HOG_Shrimpocalypse_J21240HOG14_0_Jun2021
4          3049.5724                 63_MCR_VonDamm_CTD_BSW_CTD002_0_Jun2021
5             0.0000   69_MCR_VonDamm_HOG_MustardStand_J21243HOG14_5_Jun2021
6           576.6163               65_MCR_VonDamm_CTD_Plume_CTD003_0_Jun2021
            VENT           COORDINATES SAMPLETYPE DEPTH YEAR    temp   pH
1    LotsOShrimp 18.546789, -81.718356       Vent  4967 2020  36.000 5.92
2          Plume 18.546767, -81.718200      Plume  4944 2020   4.460   NA
3 Shrimpocalypse 18.546674, -81.717806       Vent  4945 2020  85.000 5.11
4            BSW 18.374183, -81.781533 Background  2400 2020   4.181   NA
5   MustardStand 18.375130, -81.797488       Vent  2374 2020 108.000 5.63
6          Plume 18.377600, -81.799317      Plume  1979 2020   4.208   NA
  percseawater   mg    h2  h2s        ch4   ProkConc Sample_actual Type
1         94.9 51.0 22700   NA   11.46432  53878.136                HOG
2           NA   NA         NA         NA   51429.13                CTD
3         81.7 43.9     0   NA   27.53484  238585.68                HOG
4        100.0   NA         NA         NA 34705.9161                CTD
5         36.2 19.4  9800 1.79 1819.96080      56677                HOG
6           NA   NA         NA         NA  16478.313                CTD
     FIELD ref_num    SITE Sample_or_Control SAMPLEID
1  Piccard      61 Piccard            Sample         
2  Piccard      58 Piccard            Sample         
3  Piccard      60 Piccard            Sample         
4 Von Damm      84 VonDamm            Sample         
5 Von Damm      94 VonDamm            Sample         
6 Von Damm      91 VonDamm            Sample         </code></pre>
</div>
</div>
<section id="figure-s6" class="level5">
<h5 class="anchored" data-anchor-id="figure-s6">Figure S6</h5>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6.svg", h = 8, w = 10)</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EUK_ml =</span> <span class="fu">as.character</span>(EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">as.character</span>(PROK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.character</span>(temp),</span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pH =</span> <span class="fu">as.character</span>(pH),</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">mg =</span> <span class="fu">as.character</span>(mg),</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">h2 =</span> <span class="fu">as.character</span>(h2),</span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">ch4 =</span> <span class="fu">as.character</span>(ch4),</span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">percseawater =</span> <span class="fu">as.character</span>(percseawater)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE_TYPE, SiteOrder, EXP_TYPE, Experiment_rep, GRAZING_EFFECT_hr, EUK_ml, PROK_ml, temp, DEPTH, pH, percseawater, mg, h2, ch4) <span class="sc">%&gt;%</span> </span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> EUK_ml<span class="sc">:</span>ch4, <span class="at">values_to =</span> <span class="st">"VALUES"</span>, <span class="at">values_ptypes =</span> <span class="fu">list</span>(<span class="at">VALUES =</span> <span class="fu">character</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VALUES =</span> <span class="fu">as.numeric</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> VALUES, </span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb187-27"><a href="#cb187-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb187-28"><a href="#cb187-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb187-29"><a href="#cb187-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb187-30"><a href="#cb187-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb187-31"><a href="#cb187-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-32"><a href="#cb187-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb187-33"><a href="#cb187-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb187-34"><a href="#cb187-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb187-35"><a href="#cb187-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb187-36"><a href="#cb187-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb187-37"><a href="#cb187-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb187-38"><a href="#cb187-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb187-39"><a href="#cb187-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb187-40"><a href="#cb187-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="960"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="linear-regression-tidy-models" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Linear regression &amp; tidy models</h1>
<p>Use tidymodels to perform linear regression.</p>
<section id="mcr-and-gr-data-as-input" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="mcr-and-gr-data-as-input"><span class="header-section-number">15.1</span> MCR and GR data as input</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD           NAME                 SAMPLE EXP   PROK_ml    EUK_ml
1 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
2 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
3 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
4 Von Damm          Plume               VD-Plume Bag  16478.31 157.77468
5  Piccard          Plume          Piccard-Plume Bag  51429.13  79.30115
6  Piccard Shrimpocalypse Piccard-Shrimpocalypse Bag 238585.68 454.81543
  GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1         127.06388              96.81058             157.31719
2         127.06388              96.81058             157.31719
3         127.06388              96.81058             157.31719
4          24.02685              13.80868              34.24501
5          44.25930              34.87229              53.64630
6        6006.74315                    NA                    NA
  BAC_TURNOVER_PERC Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1          8.048465        4.181 NA NA  NA NA  NA  Background
2          8.048465        4.100 NA NA  NA NA  NA  Background
3          8.048465        4.000 NA NA  NA NA  NA  Background
4          3.499414        4.230 NA NA  NA NA  NA  Background
5          2.065411        4.722 NA NA  NA NA  NA  Background
6         60.423507       90.000 NA NA  NA NA  NA        Vent</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;%</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS,</span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>regression_results <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(RATE, PARAMS)`
Joining with `by = join_by(RATE, PARAMS)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>regression_results <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;%</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 16 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Temperature (C)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$y
"Cells " ~ mL^-1 ~ hr^-1

$x
[1] "Temperature (C)"

attr(,"class")
[1] "labels"</code></pre>
</div>
</div>
</section>
<section id="mcr-only" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="mcr-only"><span class="header-section-number">15.2</span> MCR only</h2>
<p>repeat MCR only</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-20"><a href="#cb202-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb202-21"><a href="#cb202-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb202-22"><a href="#cb202-22" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb202-23"><a href="#cb202-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb202-24"><a href="#cb202-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb202-25"><a href="#cb202-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(RATE, PARAMS)`
Joining with `by = join_by(RATE, PARAMS)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_mcr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mcr-vent-sites-only" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="mcr-vent-sites-only"><span class="header-section-number">15.3</span> MCR vent sites only</h2>
<p>Repeat with only vent sites &amp; remove undetected grazing.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$GRAZING_EFFECT_hr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Background"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Plume"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb211-23"><a href="#cb211-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb211-24"><a href="#cb211-24" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb211-25"><a href="#cb211-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb211-26"><a href="#cb211-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb211-27"><a href="#cb211-27" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(RATE, PARAMS)`
Joining with `by = join_by(RATE, PARAMS)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_vent)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="sc">%&gt;%</span> </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Regression thoughts</em>: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</p>
<p>Bacterial abundance typically increases with temperature (White et al.&nbsp;1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</p>
<p>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature… in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD           NAME                 SAMPLE EXP   PROK_ml    EUK_ml
1 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
2 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
3 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
4 Von Damm          Plume               VD-Plume Bag  16478.31 157.77468
5  Piccard          Plume          Piccard-Plume Bag  51429.13  79.30115
6  Piccard Shrimpocalypse Piccard-Shrimpocalypse Bag 238585.68 454.81543
  GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1         127.06388              96.81058             157.31719
2         127.06388              96.81058             157.31719
3         127.06388              96.81058             157.31719
4          24.02685              13.80868              34.24501
5          44.25930              34.87229              53.64630
6        6006.74315                    NA                    NA
  BAC_TURNOVER_PERC Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1          8.048465        4.181 NA NA  NA NA  NA  Background
2          8.048465        4.100 NA NA  NA NA  NA  Background
3          8.048465        4.000 NA NA  NA NA  NA  Background
4          3.499414        4.230 NA NA  NA NA  NA  Background
5          2.065411        4.722 NA NA  NA NA  NA  Background
6         60.423507       90.000 NA NA  NA NA  NA        Vent</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(allvent_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Function to plot results by two parameters.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-temperature-by-eukprok-and-then-euk-and-prok" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="header-section-number">15.4</span> Plot temperature by euk:prok and then euk and prok</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-temperature-by-grazing-rate" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="plot-temperature-by-grazing-rate"><span class="header-section-number">15.5</span> Plot temperature by grazing rate</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FIELD"                 "NAME"                  "SAMPLE"               
 [4] "EXP"                   "PROK_ml"               "EUK_ml"               
 [7] "GRAZING_EFFECT_hr"     "GRAZING_EFFECT_hr_min" "GRAZING_EFFECT_hr_max"
[10] "BAC_TURNOVER_PERC"     "Highest.Temp"          "pH"                   
[13] "Mg"                    "H2S"                   "H2"                   
[16] "CH4"                   "SAMPLE_TYPE"           "PROK_EUK_RATIO"       </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, EUK_ml, "ugC_L_perday", "Euk cells per ml") + scale_y_log10()</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="carbon-biomass-investigation" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Carbon biomass investigation</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co"># carbon_density &lt;- crossing(fgC_cell = seq(86, 300, by = 1), </span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                              GRAZING_EFFECT_hr = seq(min(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   max(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   length.out = 215))  %&gt;%</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;%</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_lines &lt;- select(all_vents, GRAZING_EFFECT_hr, FIELD) %&gt;% </span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;% </span></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   crossing(fgC_cell = seq(86, 300, by = 20)) %&gt;%</span></span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(carbon_density, aes(x = fgC_cell, y = GRAZING_EFFECT_hr)) +</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_raster(aes(fill = ugC_L_perday)) +</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_gradientn(colors = c("#fef0d9", "#b30000"), name = bquote("ug C"~L^-1 ~day^-1)) +</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(expand = c(0,0)) +</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(expand = c(0,0)) +</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black"),</span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         rect = element_rect(fill = "transparent"),</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill = "transparent", color = NA)) +</span></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = bquote("Cells "~mL^-1 ~consumed ~hr^-1), x = bquote("fg C"~cell^-1)) +</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = samples_lines,</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a><span class="co">#             aes(x = 87,</span></span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a><span class="co">#             y = GRAZING_EFFECT_hr, shape = FIELD), size = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eukaryote biomass comparison with measured vs.&nbsp;literature</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata &lt;- env_params %&gt;% </span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(SAMPLETYPE != "Incubation") %&gt;%</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(VENT != "Quakeplume") %&gt;% </span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, starts_with("PROK_"), starts_with("EUK_"), starts_with("GRAZING_EFFECT_hr"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata %&gt;% </span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Euk_biomass_Hu)) %&gt;% </span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Euk_biomass_Hu_fg = Euk_biomass_Hu * 1000000000,</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          Euk_biomass_lit_fg = Euk_biomass_lit * 1000000000) %&gt;% </span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = VENT)) +</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_Hu_fg), color = "black", fill = "darkgreen", shape = 21, size = 4) +</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_lit), color = "black", fill = "lightgreen", shape = 21, size = 4) +</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black")) +</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(SAMPLETYPE ~ ., space = "free", scales = "free") +</span></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "fg C of eukaryote population", y = "")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="prediction-of-mcr-data-with-parameters" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Prediction of MCR data with parameters</h1>
<p>Best model to estimate community grazing rate in Vaque et al.&nbsp;considered FLP uptake and similar experiments (in contrast to disappearance experiments).</p>
<p>From Vaque et al.&nbsp;1994 paper equation (1):</p>
<p>See Figure 6</p>
<blockquote class="blockquote">
<p>log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</p>
</blockquote>
<p><em>GT</em> = grazing rate (cells ml-1 hr-1) <em>HNF</em> = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) <em>BAC</em> = prokaryote abundance (cells ml-1)</p>
<p>Start with non-zero grazing rate values, etc. Where… <em>GT</em> == Grazing effect hr <em>HNF</em> == Euk_ml <em>BAC</em> == PROK_ml <em>T</em> == highest temp</p>
<p>We only have these for MCR data.. can include GR for the “predicting euk_ml”</p>
<p>Function to use above formula and estimate</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb233-35"><a href="#cb233-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb233-36"><a href="#cb233-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb233-37"><a href="#cb233-37" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb233-38"><a href="#cb233-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb233-39"><a href="#cb233-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb233-40"><a href="#cb233-40" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb233-41"><a href="#cb233-41" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb233-42"><a href="#cb233-42" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0), "Mid-Cayman Rise only, no undetected")</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)), <span class="st">"Mid-Cayman Rise only, no undetected, vents only"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-109-2.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-111-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-112-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="session" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Session</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.1.2 broom_1.0.4     cowplot_1.1.1   lubridate_1.9.2
 [5] forcats_1.0.0   stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1    
 [9] readr_2.1.4     tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2  
[13] tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] gtable_0.3.3       jsonlite_1.8.5     compiler_4.3.0     tidyselect_1.2.0  
 [5] scales_1.2.1       yaml_2.3.7         fastmap_1.1.1      R6_2.5.1          
 [9] labeling_0.4.2     generics_0.1.3     knitr_1.43         backports_1.4.1   
[13] htmlwidgets_1.6.2  munsell_0.5.0      RColorBrewer_1.1-3 pillar_1.9.0      
[17] tzdb_0.4.0         rlang_1.1.1        utf8_1.2.3         stringi_1.7.12    
[21] xfun_0.39          timechange_0.2.0   cli_3.6.1          withr_2.5.0       
[25] magrittr_2.0.3     digest_0.6.31      grid_4.3.0         rstudioapi_0.14   
[29] hms_1.1.3          lifecycle_1.0.3    vctrs_0.6.2        evaluate_0.21     
[33] glue_1.6.2         farver_2.1.1       fansi_1.0.4        colorspace_2.1-0  
[37] rmarkdown_2.22     tools_4.3.0        pkgconfig_2.0.3    htmltools_0.5.5   </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb264" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Protistan grazing analysis"</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 2</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Import &amp; format data</span></span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set up working R environment</span></span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-28"><a href="#cb264-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-29"><a href="#cb264-29" aria-hidden="true" tabindex="-1"></a>Set color schematic</span>
<span id="cb264-30"><a href="#cb264-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-33"><a href="#cb264-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-34"><a href="#cb264-34" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_ids &lt;- c("BSW","Plume", "Shrimpocalypse", "LotsOShrimp", "X18", "OMT", "Rav2", "MustardStand", "ShrimpHole")</span></span>
<span id="cb264-35"><a href="#cb264-35" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_fullname &lt;- c("Background","Plume", "Shrimpocalypse", "Lots 'O Shrimp", "X-18", "Old Man Tree", "Ravelin #2", "Mustard Stand", "Shrimp Hole")</span></span>
<span id="cb264-36"><a href="#cb264-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by temperature</span></span>
<span id="cb264-37"><a href="#cb264-37" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb264-38"><a href="#cb264-38" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb264-39"><a href="#cb264-39" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb264-40"><a href="#cb264-40" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb264-41"><a href="#cb264-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-42"><a href="#cb264-42" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-43"><a href="#cb264-43" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-44"><a href="#cb264-44" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb264-45"><a href="#cb264-45" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb264-46"><a href="#cb264-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-47"><a href="#cb264-47" aria-hidden="true" tabindex="-1"></a>whole_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>,<span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb264-48"><a href="#cb264-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-49"><a href="#cb264-49" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#eae2b7"</span>, <span class="st">"#5f0f40"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#941b0c"</span>, <span class="st">"#577590"</span>)</span>
<span id="cb264-50"><a href="#cb264-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-51"><a href="#cb264-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-52"><a href="#cb264-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import raw count data</span></span>
<span id="cb264-53"><a href="#cb264-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-54"><a href="#cb264-54" aria-hidden="true" tabindex="-1"></a>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</span>
<span id="cb264-55"><a href="#cb264-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-58"><a href="#cb264-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-59"><a href="#cb264-59" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb264-60"><a href="#cb264-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb264-61"><a href="#cb264-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb264-62"><a href="#cb264-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb264-63"><a href="#cb264-63" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span>
<span id="cb264-64"><a href="#cb264-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-65"><a href="#cb264-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-66"><a href="#cb264-66" aria-hidden="true" tabindex="-1"></a>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more 'R' friendly.</span>
<span id="cb264-67"><a href="#cb264-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-70"><a href="#cb264-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-71"><a href="#cb264-71" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb264-72"><a href="#cb264-72" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span>
<span id="cb264-73"><a href="#cb264-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-74"><a href="#cb264-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-75"><a href="#cb264-75" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</span></span>
<span id="cb264-76"><a href="#cb264-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-77"><a href="#cb264-77" aria-hidden="true" tabindex="-1"></a>Parse raw microscopy count data.</span>
<span id="cb264-78"><a href="#cb264-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-81"><a href="#cb264-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-82"><a href="#cb264-82" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb264-83"><a href="#cb264-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb264-84"><a href="#cb264-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-85"><a href="#cb264-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb264-86"><a href="#cb264-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb264-87"><a href="#cb264-87" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb264-88"><a href="#cb264-88" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb264-89"><a href="#cb264-89" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb264-90"><a href="#cb264-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb264-91"><a href="#cb264-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb264-92"><a href="#cb264-92" aria-hidden="true" tabindex="-1"></a>      data.frame</span>
<span id="cb264-93"><a href="#cb264-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-94"><a href="#cb264-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-95"><a href="#cb264-95" aria-hidden="true" tabindex="-1"></a><span class="fu"># Calculate cells per ml (euk)</span></span>
<span id="cb264-96"><a href="#cb264-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-97"><a href="#cb264-97" aria-hidden="true" tabindex="-1"></a>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionally, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to <span class="sc">\&gt;</span>20um and nano is <span class="sc">\&lt;</span>20um. All counts were done at 100x magnification, confirm this: <span class="in">`unique(counts_occur$MAG)`</span>.</span>
<span id="cb264-98"><a href="#cb264-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-99"><a href="#cb264-99" aria-hidden="true" tabindex="-1"></a>Calculate cell concentration (cells/ml).</span>
<span id="cb264-100"><a href="#cb264-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-103"><a href="#cb264-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-104"><a href="#cb264-104" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb264-105"><a href="#cb264-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb264-106"><a href="#cb264-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb264-107"><a href="#cb264-107" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb264-108"><a href="#cb264-108" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb264-109"><a href="#cb264-109" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb264-110"><a href="#cb264-110" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb264-111"><a href="#cb264-111" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb264-112"><a href="#cb264-112" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb264-113"><a href="#cb264-113" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb264-114"><a href="#cb264-114" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb264-115"><a href="#cb264-115" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb264-116"><a href="#cb264-116" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-117"><a href="#cb264-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb264-118"><a href="#cb264-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb264-119"><a href="#cb264-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb264-120"><a href="#cb264-120" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb264-121"><a href="#cb264-121" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb264-122"><a href="#cb264-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb264-123"><a href="#cb264-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-124"><a href="#cb264-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-125"><a href="#cb264-125" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-126"><a href="#cb264-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-127"><a href="#cb264-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-128"><a href="#cb264-128" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</span></span>
<span id="cb264-129"><a href="#cb264-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-130"><a href="#cb264-130" aria-hidden="true" tabindex="-1"></a>Average cells/ml across replicates, pivot to long format</span>
<span id="cb264-131"><a href="#cb264-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-134"><a href="#cb264-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-135"><a href="#cb264-135" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb264-136"><a href="#cb264-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb264-137"><a href="#cb264-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-138"><a href="#cb264-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-139"><a href="#cb264-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb264-140"><a href="#cb264-140" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb264-141"><a href="#cb264-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-142"><a href="#cb264-142" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb264-143"><a href="#cb264-143" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-144"><a href="#cb264-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb264-145"><a href="#cb264-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-146"><a href="#cb264-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb264-147"><a href="#cb264-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb264-148"><a href="#cb264-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb264-149"><a href="#cb264-149" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb264-150"><a href="#cb264-150" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb264-151"><a href="#cb264-151" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb264-152"><a href="#cb264-152" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb264-153"><a href="#cb264-153" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb264-154"><a href="#cb264-154" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-155"><a href="#cb264-155" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-156"><a href="#cb264-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-157"><a href="#cb264-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-158"><a href="#cb264-158" aria-hidden="true" tabindex="-1"></a>NOTES on calculations:</span>
<span id="cb264-159"><a href="#cb264-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-160"><a href="#cb264-160" aria-hidden="true" tabindex="-1"></a>*VAR* = takes the sum of the squares of each value's deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</span>
<span id="cb264-161"><a href="#cb264-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-162"><a href="#cb264-162" aria-hidden="true" tabindex="-1"></a>*SD* = standard deviation of all values</span>
<span id="cb264-163"><a href="#cb264-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-164"><a href="#cb264-164" aria-hidden="true" tabindex="-1"></a>*SEM* = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</span>
<span id="cb264-165"><a href="#cb264-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-166"><a href="#cb264-166" aria-hidden="true" tabindex="-1"></a>Save output file</span>
<span id="cb264-167"><a href="#cb264-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-170"><a href="#cb264-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-171"><a href="#cb264-171" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span>
<span id="cb264-172"><a href="#cb264-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-173"><a href="#cb264-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-174"><a href="#cb264-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-175"><a href="#cb264-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-176"><a href="#cb264-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot eukaryote cells per ml for all time points</span></span>
<span id="cb264-177"><a href="#cb264-177" aria-hidden="true" tabindex="-1"></a>The average euk cells per ml value was taken when TRUE replicates were conducted and we observed a cell count.</span>
<span id="cb264-178"><a href="#cb264-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-179"><a href="#cb264-179" aria-hidden="true" tabindex="-1"></a>Plot all euk cell counts for supplement</span>
<span id="cb264-182"><a href="#cb264-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-183"><a href="#cb264-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by temperature</span></span>
<span id="cb264-184"><a href="#cb264-184" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb264-185"><a href="#cb264-185" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb264-186"><a href="#cb264-186" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb264-187"><a href="#cb264-187" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb264-188"><a href="#cb264-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-189"><a href="#cb264-189" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-190"><a href="#cb264-190" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-191"><a href="#cb264-191" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_avg)</span></span>
<span id="cb264-192"><a href="#cb264-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-193"><a href="#cb264-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-194"><a href="#cb264-194" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure S1</span></span>
<span id="cb264-197"><a href="#cb264-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-198"><a href="#cb264-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb264-199"><a href="#cb264-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb264-200"><a href="#cb264-200" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS1.svg")</span></span>
<span id="cb264-201"><a href="#cb264-201" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb264-202"><a href="#cb264-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-203"><a href="#cb264-203" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-204"><a href="#cb264-204" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb264-205"><a href="#cb264-205" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-206"><a href="#cb264-206" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb264-207"><a href="#cb264-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-208"><a href="#cb264-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-209"><a href="#cb264-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot with outline vs. solid circle</span></span>
<span id="cb264-210"><a href="#cb264-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">group =</span> NameOrder,</span>
<span id="cb264-211"><a href="#cb264-211" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb264-212"><a href="#cb264-212" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">color =</span> VARIABLE,</span>
<span id="cb264-213"><a href="#cb264-213" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb264-214"><a href="#cb264-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE, <span class="at">color =</span> VARIABLE,</span>
<span id="cb264-215"><a href="#cb264-215" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb264-216"><a href="#cb264-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb264-217"><a href="#cb264-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-218"><a href="#cb264-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb264-219"><a href="#cb264-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb264-220"><a href="#cb264-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb264-221"><a href="#cb264-221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-222"><a href="#cb264-222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-223"><a href="#cb264-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb264-224"><a href="#cb264-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb264-225"><a href="#cb264-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-226"><a href="#cb264-226" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb264-227"><a href="#cb264-227" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb264-228"><a href="#cb264-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-229"><a href="#cb264-229" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb264-230"><a href="#cb264-230" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-231"><a href="#cb264-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-232"><a href="#cb264-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-233"><a href="#cb264-233" aria-hidden="true" tabindex="-1"></a>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. \~300 cells/ml in background and plume compared to \~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</span>
<span id="cb264-234"><a href="#cb264-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-235"><a href="#cb264-235" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 </span><span class="sc">\*</span><span class="at"> interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</span></span>
<span id="cb264-236"><a href="#cb264-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-237"><a href="#cb264-237" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</span></span>
<span id="cb264-238"><a href="#cb264-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-239"><a href="#cb264-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-240"><a href="#cb264-240" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot eukaryote cell concentration over time.</span></span>
<span id="cb264-241"><a href="#cb264-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-242"><a href="#cb264-242" aria-hidden="true" tabindex="-1"></a>Include plot over time.</span>
<span id="cb264-243"><a href="#cb264-243" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S4</span></span>
<span id="cb264-246"><a href="#cb264-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-247"><a href="#cb264-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb264-248"><a href="#cb264-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb264-249"><a href="#cb264-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb264-250"><a href="#cb264-250" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS4.svg")</span></span>
<span id="cb264-251"><a href="#cb264-251" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb264-252"><a href="#cb264-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-253"><a href="#cb264-253" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-254"><a href="#cb264-254" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb264-255"><a href="#cb264-255" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-256"><a href="#cb264-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-257"><a href="#cb264-257" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-258"><a href="#cb264-258" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-259"><a href="#cb264-259" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-260"><a href="#cb264-260" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb264-261"><a href="#cb264-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-262"><a href="#cb264-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-263"><a href="#cb264-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-264"><a href="#cb264-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-265"><a href="#cb264-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, NameOrder, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-266"><a href="#cb264-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_CATEGORY, <span class="at">fill =</span> NameOrder, </span>
<span id="cb264-267"><a href="#cb264-267" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb264-268"><a href="#cb264-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment_rep), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-269"><a href="#cb264-269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb264-270"><a href="#cb264-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb264-271"><a href="#cb264-271" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> NameOrder, </span>
<span id="cb264-272"><a href="#cb264-272" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb264-273"><a href="#cb264-273" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-274"><a href="#cb264-274" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb264-275"><a href="#cb264-275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb264-276"><a href="#cb264-276" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-277"><a href="#cb264-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-278"><a href="#cb264-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-279"><a href="#cb264-279" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-280"><a href="#cb264-280" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb264-281"><a href="#cb264-281" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb264-282"><a href="#cb264-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb264-283"><a href="#cb264-283" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-284"><a href="#cb264-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-285"><a href="#cb264-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-286"><a href="#cb264-286" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</span></span>
<span id="cb264-287"><a href="#cb264-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-288"><a href="#cb264-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot T0 only counts for cells/ml plot</span></span>
<span id="cb264-289"><a href="#cb264-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-290"><a href="#cb264-290" aria-hidden="true" tabindex="-1"></a>For Figure 1a</span>
<span id="cb264-293"><a href="#cb264-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-294"><a href="#cb264-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb264-295"><a href="#cb264-295" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb264-296"><a href="#cb264-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-297"><a href="#cb264-297" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-298"><a href="#cb264-298" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb264-299"><a href="#cb264-299" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-300"><a href="#cb264-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-301"><a href="#cb264-301" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-302"><a href="#cb264-302" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-303"><a href="#cb264-303" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-304"><a href="#cb264-304" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb264-305"><a href="#cb264-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-306"><a href="#cb264-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-307"><a href="#cb264-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-308"><a href="#cb264-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-309"><a href="#cb264-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb264-310"><a href="#cb264-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-311"><a href="#cb264-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-312"><a href="#cb264-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-313"><a href="#cb264-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">shape =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb264-314"><a href="#cb264-314" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-315"><a href="#cb264-315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-316"><a href="#cb264-316" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb264-317"><a href="#cb264-317" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb264-318"><a href="#cb264-318" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-319"><a href="#cb264-319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-320"><a href="#cb264-320" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-321"><a href="#cb264-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-322"><a href="#cb264-322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-323"><a href="#cb264-323" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cfacet_grid(. ~ SiteOrder, scales = "free") +</span></span>
<span id="cb264-324"><a href="#cb264-324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-325"><a href="#cb264-325" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-326"><a href="#cb264-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-327"><a href="#cb264-327" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-328"><a href="#cb264-328" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-329"><a href="#cb264-329" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb264-330"><a href="#cb264-330" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-331"><a href="#cb264-331" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-332"><a href="#cb264-332" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-333"><a href="#cb264-333" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-334"><a href="#cb264-334" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb264-335"><a href="#cb264-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-336"><a href="#cb264-336" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb264-337"><a href="#cb264-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-338"><a href="#cb264-338" aria-hidden="true" tabindex="-1"></a>euk_plot</span>
<span id="cb264-339"><a href="#cb264-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-340"><a href="#cb264-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-343"><a href="#cb264-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-344"><a href="#cb264-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Last saved - April 13, 2023</span></span>
<span id="cb264-345"><a href="#cb264-345" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(counts_cellsml_all, counts_cellsml_avg, counts_occur, <span class="at">file =</span> <span class="st">"output-data/MCR-cellcount-dfs"</span>)</span>
<span id="cb264-346"><a href="#cb264-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-347"><a href="#cb264-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-348"><a href="#cb264-348" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bacteria &amp; archaea cell counts</span></span>
<span id="cb264-349"><a href="#cb264-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-350"><a href="#cb264-350" aria-hidden="true" tabindex="-1"></a>DAPI slide counts from prokaryotes from same sites. Import and compare.</span>
<span id="cb264-351"><a href="#cb264-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-354"><a href="#cb264-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-355"><a href="#cb264-355" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb264-356"><a href="#cb264-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-357"><a href="#cb264-357" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb264-358"><a href="#cb264-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-359"><a href="#cb264-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-360"><a href="#cb264-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb264-361"><a href="#cb264-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb264-362"><a href="#cb264-362" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb264-363"><a href="#cb264-363" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb264-364"><a href="#cb264-364" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CELLML),</span>
<span id="cb264-365"><a href="#cb264-365" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CELLML),</span>
<span id="cb264-366"><a href="#cb264-366" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-367"><a href="#cb264-367" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-368"><a href="#cb264-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-369"><a href="#cb264-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-370"><a href="#cb264-370" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cells per ml (prok)</span></span>
<span id="cb264-371"><a href="#cb264-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-372"><a href="#cb264-372" aria-hidden="true" tabindex="-1"></a>Visualize counts from proks. Get summary of prok counts, and incorporate into plot</span>
<span id="cb264-373"><a href="#cb264-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-376"><a href="#cb264-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-377"><a href="#cb264-377" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb264-378"><a href="#cb264-378" aria-hidden="true" tabindex="-1"></a><span class="co"># insitu_proks$Name</span></span>
<span id="cb264-379"><a href="#cb264-379" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Name <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-380"><a href="#cb264-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-381"><a href="#cb264-381" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb264-382"><a href="#cb264-382" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb264-383"><a href="#cb264-383" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb264-384"><a href="#cb264-384" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-385"><a href="#cb264-385" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group_by(type) %&gt;% </span></span>
<span id="cb264-386"><a href="#cb264-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb264-387"><a href="#cb264-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(MEAN),</span>
<span id="cb264-388"><a href="#cb264-388" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(MEAN),</span>
<span id="cb264-389"><a href="#cb264-389" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(MEAN))</span>
<span id="cb264-390"><a href="#cb264-390" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb264-391"><a href="#cb264-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-392"><a href="#cb264-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-393"><a href="#cb264-393" aria-hidden="true" tabindex="-1"></a>Factor site names, etc.</span>
<span id="cb264-394"><a href="#cb264-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-397"><a href="#cb264-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-398"><a href="#cb264-398" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordered by temperature</span></span>
<span id="cb264-399"><a href="#cb264-399" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>,</span>
<span id="cb264-400"><a href="#cb264-400" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"MustardStand"</span>, </span>
<span id="cb264-401"><a href="#cb264-401" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Rav2"</span>, <span class="st">"OMT"</span>,<span class="st">"Bartizan"</span>,<span class="st">"ArrowLoop"</span>, <span class="st">"Rav1"</span>,</span>
<span id="cb264-402"><a href="#cb264-402" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Quakeplume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"SouthofHotChimlet"</span>,</span>
<span id="cb264-403"><a href="#cb264-403" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"SouthofLungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"ShrimpGulley"</span>, </span>
<span id="cb264-404"><a href="#cb264-404" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"HotChimlet1"</span>), </span>
<span id="cb264-405"><a href="#cb264-405" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, </span>
<span id="cb264-406"><a href="#cb264-406" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>,<span class="st">"Mustard Stand"</span>,</span>
<span id="cb264-407"><a href="#cb264-407" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Ravelin #2"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Ravelin #1"</span>,</span>
<span id="cb264-408"><a href="#cb264-408" aria-hidden="true" tabindex="-1"></a>                                          </span>
<span id="cb264-409"><a href="#cb264-409" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Quakeplume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"South of Hot Chimlet"</span>, </span>
<span id="cb264-410"><a href="#cb264-410" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"South of LungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"Hot Chimlet #1"</span>))</span>
<span id="cb264-411"><a href="#cb264-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-412"><a href="#cb264-412" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-413"><a href="#cb264-413" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-414"><a href="#cb264-414" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb264-415"><a href="#cb264-415" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb264-416"><a href="#cb264-416" aria-hidden="true" tabindex="-1"></a>site_fill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb264-417"><a href="#cb264-417" aria-hidden="true" tabindex="-1"></a><span class="co"># names(site_color) &lt;- site_fullname</span></span>
<span id="cb264-418"><a href="#cb264-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-419"><a href="#cb264-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-422"><a href="#cb264-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-423"><a href="#cb264-423" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb264-424"><a href="#cb264-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb264-425"><a href="#cb264-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order,</span>
<span id="cb264-426"><a href="#cb264-426" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">color =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-427"><a href="#cb264-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-428"><a href="#cb264-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb264-429"><a href="#cb264-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb264-430"><a href="#cb264-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb264-431"><a href="#cb264-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-432"><a href="#cb264-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-433"><a href="#cb264-433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-434"><a href="#cb264-434" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-435"><a href="#cb264-435" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-436"><a href="#cb264-436" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb264-437"><a href="#cb264-437" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-438"><a href="#cb264-438" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-439"><a href="#cb264-439" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-440"><a href="#cb264-440" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-441"><a href="#cb264-441" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb264-442"><a href="#cb264-442" aria-hidden="true" tabindex="-1"></a>prok_plot</span>
<span id="cb264-443"><a href="#cb264-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-444"><a href="#cb264-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-445"><a href="#cb264-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Euk and prok counts</span></span>
<span id="cb264-446"><a href="#cb264-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-447"><a href="#cb264-447" aria-hidden="true" tabindex="-1"></a>Combined eukaryote and prokaryote cell counts</span>
<span id="cb264-448"><a href="#cb264-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure 1a-b</span></span>
<span id="cb264-451"><a href="#cb264-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-452"><a href="#cb264-452" aria-hidden="true" tabindex="-1"></a>euk_prok_ab <span class="ot">&lt;-</span> (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb264-453"><a href="#cb264-453" aria-hidden="true" tabindex="-1"></a>euk_prok_ab</span>
<span id="cb264-454"><a href="#cb264-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-455"><a href="#cb264-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-456"><a href="#cb264-456" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combine with previous MCR cell counts</span></span>
<span id="cb264-457"><a href="#cb264-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-458"><a href="#cb264-458" aria-hidden="true" tabindex="-1"></a>Compare *in situ* prokaryote cell counts from 2020 to previous years</span>
<span id="cb264-459"><a href="#cb264-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-462"><a href="#cb264-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-463"><a href="#cb264-463" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb264-464"><a href="#cb264-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-465"><a href="#cb264-465" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb264-466"><a href="#cb264-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-467"><a href="#cb264-467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb264-468"><a href="#cb264-468" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb264-469"><a href="#cb264-469" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-470"><a href="#cb264-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb264-471"><a href="#cb264-471" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb264-472"><a href="#cb264-472" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb264-473"><a href="#cb264-473" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb264-474"><a href="#cb264-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-475"><a href="#cb264-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span>
<span id="cb264-476"><a href="#cb264-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-477"><a href="#cb264-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-478"><a href="#cb264-478" aria-hidden="true" tabindex="-1"></a>Re-import 2020 data to compare.</span>
<span id="cb264-479"><a href="#cb264-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-482"><a href="#cb264-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-483"><a href="#cb264-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb264-484"><a href="#cb264-484" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb264-485"><a href="#cb264-485" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb264-486"><a href="#cb264-486" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb264-487"><a href="#cb264-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-488"><a href="#cb264-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-489"><a href="#cb264-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb264-490"><a href="#cb264-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-491"><a href="#cb264-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-492"><a href="#cb264-492" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb264-493"><a href="#cb264-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-494"><a href="#cb264-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-495"><a href="#cb264-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-496"><a href="#cb264-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-497"><a href="#cb264-497" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-498"><a href="#cb264-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-499"><a href="#cb264-499" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb264-500"><a href="#cb264-500" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb264-501"><a href="#cb264-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-502"><a href="#cb264-502" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb264-503"><a href="#cb264-503" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb264-504"><a href="#cb264-504" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb264-505"><a href="#cb264-505" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span>
<span id="cb264-506"><a href="#cb264-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-507"><a href="#cb264-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-508"><a href="#cb264-508" aria-hidden="true" tabindex="-1"></a>Plot by year.</span>
<span id="cb264-509"><a href="#cb264-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-512"><a href="#cb264-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-513"><a href="#cb264-513" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb264-514"><a href="#cb264-514" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb264-515"><a href="#cb264-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-516"><a href="#cb264-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb264-517"><a href="#cb264-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb264-518"><a href="#cb264-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-519"><a href="#cb264-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-520"><a href="#cb264-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb264-521"><a href="#cb264-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb264-522"><a href="#cb264-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-523"><a href="#cb264-523" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-524"><a href="#cb264-524" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb264-525"><a href="#cb264-525" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-526"><a href="#cb264-526" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb264-527"><a href="#cb264-527" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-528"><a href="#cb264-528" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb264-529"><a href="#cb264-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb264-530"><a href="#cb264-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span>
<span id="cb264-531"><a href="#cb264-531" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-532"><a href="#cb264-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-535"><a href="#cb264-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-536"><a href="#cb264-536" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb264-537"><a href="#cb264-537" aria-hidden="true" tabindex="-1"></a><span class="co"># names(counts_cellsml_avg)</span></span>
<span id="cb264-538"><a href="#cb264-538" aria-hidden="true" tabindex="-1"></a>prok_tojoin <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb264-539"><a href="#cb264-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MEAN), <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb264-540"><a href="#cb264-540" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MIN), <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb264-541"><a href="#cb264-541" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MAX), <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-542"><a href="#cb264-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"PROK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-543"><a href="#cb264-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, <span class="at">PROK_ml =</span> MEAN_SIG, PROK_MinMax, <span class="at">PROK_sem =</span> SEM)</span>
<span id="cb264-544"><a href="#cb264-544" aria-hidden="true" tabindex="-1"></a><span class="co"># prok_tojoin</span></span>
<span id="cb264-545"><a href="#cb264-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-546"><a href="#cb264-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-547"><a href="#cb264-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-548"><a href="#cb264-548" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile table with euk and prok counts</span></span>
<span id="cb264-549"><a href="#cb264-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-550"><a href="#cb264-550" aria-hidden="true" tabindex="-1"></a>Part of Table 1.</span>
<span id="cb264-553"><a href="#cb264-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-554"><a href="#cb264-554" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb264-555"><a href="#cb264-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-556"><a href="#cb264-556" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-557"><a href="#cb264-557" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb264-558"><a href="#cb264-558" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-559"><a href="#cb264-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-560"><a href="#cb264-560" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-561"><a href="#cb264-561" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-562"><a href="#cb264-562" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-563"><a href="#cb264-563" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb264-564"><a href="#cb264-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-565"><a href="#cb264-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-566"><a href="#cb264-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-567"><a href="#cb264-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-568"><a href="#cb264-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb264-569"><a href="#cb264-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-570"><a href="#cb264-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-571"><a href="#cb264-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-572"><a href="#cb264-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(MEAN, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb264-573"><a href="#cb264-573" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(MIN, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb264-574"><a href="#cb264-574" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(MAX, <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-575"><a href="#cb264-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"EUK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-576"><a href="#cb264-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, SITE_TYPE, Experiment, Experiment_rep, VARIABLE, <span class="at">EUK_ml =</span> MEAN_SIG, EUK_MinMax, <span class="at">EUK_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb264-577"><a href="#cb264-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prok_tojoin)</span>
<span id="cb264-578"><a href="#cb264-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-579"><a href="#cb264-579" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="co"># add to this later for Table 1</span></span>
<span id="cb264-580"><a href="#cb264-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-581"><a href="#cb264-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-582"><a href="#cb264-582" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimate grazing effect</span></span>
<span id="cb264-583"><a href="#cb264-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-584"><a href="#cb264-584" aria-hidden="true" tabindex="-1"></a>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</span>
<span id="cb264-585"><a href="#cb264-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-588"><a href="#cb264-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-589"><a href="#cb264-589" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb264-590"><a href="#cb264-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-591"><a href="#cb264-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-592"><a href="#cb264-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## Determine FLP per euk cell</span></span>
<span id="cb264-593"><a href="#cb264-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-594"><a href="#cb264-594" aria-hidden="true" tabindex="-1"></a>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <span class="in">`counts_occur`</span> data frame from above.</span>
<span id="cb264-595"><a href="#cb264-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-598"><a href="#cb264-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-599"><a href="#cb264-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb264-600"><a href="#cb264-600" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb264-601"><a href="#cb264-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-602"><a href="#cb264-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-603"><a href="#cb264-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb264-604"><a href="#cb264-604" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb264-605"><a href="#cb264-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-606"><a href="#cb264-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-607"><a href="#cb264-607" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb264-608"><a href="#cb264-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-609"><a href="#cb264-609" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-610"><a href="#cb264-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-611"><a href="#cb264-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-612"><a href="#cb264-612" aria-hidden="true" tabindex="-1"></a>*optional gut check of data table modification*</span>
<span id="cb264-613"><a href="#cb264-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-616"><a href="#cb264-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-617"><a href="#cb264-617" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb264-618"><a href="#cb264-618" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb264-619"><a href="#cb264-619" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb264-620"><a href="#cb264-620" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb264-621"><a href="#cb264-621" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb264-622"><a href="#cb264-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-623"><a href="#cb264-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-624"><a href="#cb264-624" aria-hidden="true" tabindex="-1"></a>Isolate counts that are <span class="sc">\&gt;</span>0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</span>
<span id="cb264-625"><a href="#cb264-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-628"><a href="#cb264-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-629"><a href="#cb264-629" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb264-630"><a href="#cb264-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb264-631"><a href="#cb264-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-632"><a href="#cb264-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-633"><a href="#cb264-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-634"><a href="#cb264-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-635"><a href="#cb264-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-636"><a href="#cb264-636" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-637"><a href="#cb264-637" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb264-638"><a href="#cb264-638" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb264-639"><a href="#cb264-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-640"><a href="#cb264-640" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb264-641"><a href="#cb264-641" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-642"><a href="#cb264-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-643"><a href="#cb264-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb264-644"><a href="#cb264-644" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb264-645"><a href="#cb264-645" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-646"><a href="#cb264-646" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-647"><a href="#cb264-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-648"><a href="#cb264-648" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_flp)</span>
<span id="cb264-649"><a href="#cb264-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-650"><a href="#cb264-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-651"><a href="#cb264-651" aria-hidden="true" tabindex="-1"></a>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</span>
<span id="cb264-652"><a href="#cb264-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-653"><a href="#cb264-653" aria-hidden="true" tabindex="-1"></a>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</span>
<span id="cb264-654"><a href="#cb264-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-655"><a href="#cb264-655" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Below code repeats process and compiles with other FLP/euk cell data.</span></span>
<span id="cb264-656"><a href="#cb264-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-657"><a href="#cb264-657" aria-hidden="true" tabindex="-1"></a>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</span>
<span id="cb264-658"><a href="#cb264-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-661"><a href="#cb264-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-662"><a href="#cb264-662" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb264-663"><a href="#cb264-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb264-664"><a href="#cb264-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-665"><a href="#cb264-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb264-666"><a href="#cb264-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb264-667"><a href="#cb264-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-668"><a href="#cb264-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-669"><a href="#cb264-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-670"><a href="#cb264-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-671"><a href="#cb264-671" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-672"><a href="#cb264-672" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb264-673"><a href="#cb264-673" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb264-674"><a href="#cb264-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-675"><a href="#cb264-675" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb264-676"><a href="#cb264-676" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-677"><a href="#cb264-677" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb264-678"><a href="#cb264-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-679"><a href="#cb264-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb264-680"><a href="#cb264-680" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-681"><a href="#cb264-681" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb264-682"><a href="#cb264-682" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb264-683"><a href="#cb264-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb264-684"><a href="#cb264-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb264-685"><a href="#cb264-685" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-686"><a href="#cb264-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-687"><a href="#cb264-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-688"><a href="#cb264-688" aria-hidden="true" tabindex="-1"></a>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</span>
<span id="cb264-689"><a href="#cb264-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-692"><a href="#cb264-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-693"><a href="#cb264-693" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb264-694"><a href="#cb264-694" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb264-695"><a href="#cb264-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb264-696"><a href="#cb264-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb264-697"><a href="#cb264-697" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb264-698"><a href="#cb264-698" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb264-699"><a href="#cb264-699" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-700"><a href="#cb264-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb264-701"><a href="#cb264-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb264-702"><a href="#cb264-702" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-703"><a href="#cb264-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-704"><a href="#cb264-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-705"><a href="#cb264-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate FLP per euk cell calculation</span></span>
<span id="cb264-706"><a href="#cb264-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-707"><a href="#cb264-707" aria-hidden="true" tabindex="-1"></a>First need to import and compile with metadata to get exact timing of experiments.</span>
<span id="cb264-708"><a href="#cb264-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-711"><a href="#cb264-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-712"><a href="#cb264-712" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb264-713"><a href="#cb264-713" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span>
<span id="cb264-714"><a href="#cb264-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-715"><a href="#cb264-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-716"><a href="#cb264-716" aria-hidden="true" tabindex="-1"></a>Add metadata. </span>
<span id="cb264-717"><a href="#cb264-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-718"><a href="#cb264-718" aria-hidden="true" tabindex="-1"></a><span class="fu">### Consider IGT replicates.</span></span>
<span id="cb264-719"><a href="#cb264-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-720"><a href="#cb264-720" aria-hidden="true" tabindex="-1"></a>IGT_#_ denotes a separate IGT experiment. Due to bottle effects and the need to look at how replicate experiments compared, lets keep these separate.</span>
<span id="cb264-721"><a href="#cb264-721" aria-hidden="true" tabindex="-1"></a>For IGT experiments labeled "b", this means the OTHER HALF of the filter was counted or re-counted as a way to confirm my euk counting was precise. </span>
<span id="cb264-722"><a href="#cb264-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-725"><a href="#cb264-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-726"><a href="#cb264-726" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb264-727"><a href="#cb264-727" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb264-728"><a href="#cb264-728" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, use this to include them as replicates</span></span>
<span id="cb264-729"><a href="#cb264-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-730"><a href="#cb264-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb264-731"><a href="#cb264-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb264-732"><a href="#cb264-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb264-733"><a href="#cb264-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-734"><a href="#cb264-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-735"><a href="#cb264-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-736"><a href="#cb264-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-737"><a href="#cb264-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-738"><a href="#cb264-738" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb264-739"><a href="#cb264-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-740"><a href="#cb264-740" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb264-741"><a href="#cb264-741" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) %&gt;%</span></span>
<span id="cb264-742"><a href="#cb264-742" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb264-743"><a href="#cb264-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb264-744"><a href="#cb264-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-745"><a href="#cb264-745" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-746"><a href="#cb264-746" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all</span>
<span id="cb264-747"><a href="#cb264-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-748"><a href="#cb264-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-749"><a href="#cb264-749" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; COLS: Timepoint, Minutes = time point label, actual incubated minutes</span></span>
<span id="cb264-750"><a href="#cb264-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-751"><a href="#cb264-751" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</span></span>
<span id="cb264-752"><a href="#cb264-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-753"><a href="#cb264-753" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate linear regression to obtain slope</span></span>
<span id="cb264-754"><a href="#cb264-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-755"><a href="#cb264-755" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`lm()`</span> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</span>
<span id="cb264-756"><a href="#cb264-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-757"><a href="#cb264-757" aria-hidden="true" tabindex="-1"></a>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</span>
<span id="cb264-758"><a href="#cb264-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-761"><a href="#cb264-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-762"><a href="#cb264-762" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb264-763"><a href="#cb264-763" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb264-764"><a href="#cb264-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-765"><a href="#cb264-765" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb264-766"><a href="#cb264-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-767"><a href="#cb264-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-768"><a href="#cb264-768" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb264-769"><a href="#cb264-769" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb264-770"><a href="#cb264-770" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb264-771"><a href="#cb264-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb264-772"><a href="#cb264-772" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-773"><a href="#cb264-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb264-774"><a href="#cb264-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb264-775"><a href="#cb264-775" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) %&gt;% </span></span>
<span id="cb264-776"><a href="#cb264-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb264-777"><a href="#cb264-777" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-778"><a href="#cb264-778" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb264-779"><a href="#cb264-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb264-780"><a href="#cb264-780" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"IGT_REP"</span>,</span>
<span id="cb264-781"><a href="#cb264-781" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb264-782"><a href="#cb264-782" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb264-783"><a href="#cb264-783" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb264-784"><a href="#cb264-784" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb264-785"><a href="#cb264-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-786"><a href="#cb264-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb264-787"><a href="#cb264-787" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb264-788"><a href="#cb264-788" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb264-789"><a href="#cb264-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb264-790"><a href="#cb264-790" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-791"><a href="#cb264-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb264-792"><a href="#cb264-792" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb264-793"><a href="#cb264-793" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) %&gt;% </span></span>
<span id="cb264-794"><a href="#cb264-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb264-795"><a href="#cb264-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb264-796"><a href="#cb264-796" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-797"><a href="#cb264-797" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb264-798"><a href="#cb264-798" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb264-799"><a href="#cb264-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb264-800"><a href="#cb264-800" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-801"><a href="#cb264-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-802"><a href="#cb264-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-803"><a href="#cb264-803" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</span></span>
<span id="cb264-804"><a href="#cb264-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-805"><a href="#cb264-805" aria-hidden="true" tabindex="-1"></a>Apply to all data to obtain slope.</span>
<span id="cb264-806"><a href="#cb264-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-809"><a href="#cb264-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-810"><a href="#cb264-810" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span>
<span id="cb264-811"><a href="#cb264-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-812"><a href="#cb264-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-813"><a href="#cb264-813" aria-hidden="true" tabindex="-1"></a>*gut check* linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <span class="in">`nest()`</span> capability of tidyverse. Below, one experiment is subset to check the value.</span>
<span id="cb264-814"><a href="#cb264-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-817"><a href="#cb264-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-818"><a href="#cb264-818" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb264-819"><a href="#cb264-819" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb264-820"><a href="#cb264-820" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb264-821"><a href="#cb264-821" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb264-822"><a href="#cb264-822" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb264-823"><a href="#cb264-823" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb264-824"><a href="#cb264-824" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb264-825"><a href="#cb264-825" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb264-826"><a href="#cb264-826" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb264-827"><a href="#cb264-827" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span>
<span id="cb264-828"><a href="#cb264-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-829"><a href="#cb264-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-830"><a href="#cb264-830" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot linear regression trend</span></span>
<span id="cb264-831"><a href="#cb264-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-832"><a href="#cb264-832" aria-hidden="true" tabindex="-1"></a>Plot all shipboard experiments with estimated slope.</span>
<span id="cb264-833"><a href="#cb264-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-834"><a href="#cb264-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=5.5, fig.width=6}</span></span>
<span id="cb264-835"><a href="#cb264-835" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb264-836"><a href="#cb264-836" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb264-837"><a href="#cb264-837" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb264-838"><a href="#cb264-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-839"><a href="#cb264-839" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-840"><a href="#cb264-840" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb264-841"><a href="#cb264-841" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-842"><a href="#cb264-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-843"><a href="#cb264-843" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-844"><a href="#cb264-844" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-845"><a href="#cb264-845" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-846"><a href="#cb264-846" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb264-847"><a href="#cb264-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-848"><a href="#cb264-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-849"><a href="#cb264-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-850"><a href="#cb264-850" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Filter out IGT samples for now</span></span>
<span id="cb264-851"><a href="#cb264-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-852"><a href="#cb264-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-853"><a href="#cb264-853" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, </span>
<span id="cb264-854"><a href="#cb264-854" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder, <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb264-855"><a href="#cb264-855" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-856"><a href="#cb264-856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb264-857"><a href="#cb264-857" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb264-858"><a href="#cb264-858" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb264-859"><a href="#cb264-859" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-860"><a href="#cb264-860" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb264-861"><a href="#cb264-861" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb264-862"><a href="#cb264-862" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(21, 21, 21, 21)) +</span></span>
<span id="cb264-863"><a href="#cb264-863" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_fill_manual(values = c("white", "#264653", "white", "#E76F51")) +</span></span>
<span id="cb264-864"><a href="#cb264-864" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_color_manual(values = c("#264653", "#264653", "#E76F51", "#E76F51")) +</span></span>
<span id="cb264-865"><a href="#cb264-865" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb264-866"><a href="#cb264-866" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb264-867"><a href="#cb264-867" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Report r.squared</span></span>
<span id="cb264-868"><a href="#cb264-868" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb264-869"><a href="#cb264-869" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-870"><a href="#cb264-870" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb264-871"><a href="#cb264-871" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-872"><a href="#cb264-872" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb264-873"><a href="#cb264-873" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-874"><a href="#cb264-874" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb264-875"><a href="#cb264-875" aria-hidden="true" tabindex="-1"></a>shipboardregression</span>
<span id="cb264-876"><a href="#cb264-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-877"><a href="#cb264-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-878"><a href="#cb264-878" aria-hidden="true" tabindex="-1"></a>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</span>
<span id="cb264-879"><a href="#cb264-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-880"><a href="#cb264-880" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remove IGT Tf time points.</span></span>
<span id="cb264-881"><a href="#cb264-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-882"><a href="#cb264-882" aria-hidden="true" tabindex="-1"></a>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</span>
<span id="cb264-883"><a href="#cb264-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-886"><a href="#cb264-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-887"><a href="#cb264-887" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb264-888"><a href="#cb264-888" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb264-889"><a href="#cb264-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-890"><a href="#cb264-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-891"><a href="#cb264-891" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb264-892"><a href="#cb264-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"b"</span>, Replicate_ID)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-893"><a href="#cb264-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-894"><a href="#cb264-894" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-895"><a href="#cb264-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-896"><a href="#cb264-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb264-897"><a href="#cb264-897" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span>
<span id="cb264-898"><a href="#cb264-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-899"><a href="#cb264-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-900"><a href="#cb264-900" aria-hidden="true" tabindex="-1"></a>Plot IGT grazing experiments with newly calculated grazing effect.</span>
<span id="cb264-901"><a href="#cb264-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-904"><a href="#cb264-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-905"><a href="#cb264-905" aria-hidden="true" tabindex="-1"></a>igtregression <span class="ot">&lt;-</span> igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb264-906"><a href="#cb264-906" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb264-907"><a href="#cb264-907" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb264-908"><a href="#cb264-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb264-909"><a href="#cb264-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-910"><a href="#cb264-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb264-911"><a href="#cb264-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-912"><a href="#cb264-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb264-913"><a href="#cb264-913" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb264-914"><a href="#cb264-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-915"><a href="#cb264-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb264-916"><a href="#cb264-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb264-917"><a href="#cb264-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb264-918"><a href="#cb264-918" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb264-919"><a href="#cb264-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb264-920"><a href="#cb264-920" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-921"><a href="#cb264-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb264-922"><a href="#cb264-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-923"><a href="#cb264-923" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb264-924"><a href="#cb264-924" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-925"><a href="#cb264-925" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb264-926"><a href="#cb264-926" aria-hidden="true" tabindex="-1"></a>igtregression</span>
<span id="cb264-927"><a href="#cb264-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-928"><a href="#cb264-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-929"><a href="#cb264-929" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Results are more consistent across experiments when we remove Tf from the IGT experiments</span></span>
<span id="cb264-930"><a href="#cb264-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-931"><a href="#cb264-931" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S3</span></span>
<span id="cb264-932"><a href="#cb264-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=12, fig.width=7}</span></span>
<span id="cb264-933"><a href="#cb264-933" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS3.svg", h = 12, w = 7)</span></span>
<span id="cb264-934"><a href="#cb264-934" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="sc">+</span> igtregression <span class="sc">+</span></span>
<span id="cb264-935"><a href="#cb264-935" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb264-936"><a href="#cb264-936" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-937"><a href="#cb264-937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-938"><a href="#cb264-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-939"><a href="#cb264-939" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repeat, but include technical replicates</span></span>
<span id="cb264-940"><a href="#cb264-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-941"><a href="#cb264-941" aria-hidden="true" tabindex="-1"></a>Assess technical replicates for supplemental.</span>
<span id="cb264-942"><a href="#cb264-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-945"><a href="#cb264-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-946"><a href="#cb264-946" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf_wb <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb264-947"><a href="#cb264-947" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb264-948"><a href="#cb264-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-949"><a href="#cb264-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-950"><a href="#cb264-950" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb264-951"><a href="#cb264-951" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!grepl("b", Replicate_ID)) %&gt;% </span></span>
<span id="cb264-952"><a href="#cb264-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-953"><a href="#cb264-953" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(EXP_TYPE = IGT_REP) %&gt;% </span></span>
<span id="cb264-954"><a href="#cb264-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> Replicate_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb264-955"><a href="#cb264-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, Replicate_ID, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-956"><a href="#cb264-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>REP, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb264-957"><a href="#cb264-957" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-958"><a href="#cb264-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-959"><a href="#cb264-959" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb264-960"><a href="#cb264-960" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf_wb) <span class="co"># Recalculate</span></span>
<span id="cb264-961"><a href="#cb264-961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-962"><a href="#cb264-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-963"><a href="#cb264-963" aria-hidden="true" tabindex="-1"></a>Plot IGT grazing experiments with newly calculated grazing effect.</span>
<span id="cb264-964"><a href="#cb264-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-965"><a href="#cb264-965" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S8</span></span>
<span id="cb264-968"><a href="#cb264-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-969"><a href="#cb264-969" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS8.svg")</span></span>
<span id="cb264-970"><a href="#cb264-970" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="sc">%&gt;%</span> </span>
<span id="cb264-971"><a href="#cb264-971" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb264-972"><a href="#cb264-972" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb264-973"><a href="#cb264-973" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only isolate IGT 4s, where the technical replicates were done</span></span>
<span id="cb264-974"><a href="#cb264-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"IGT4"</span>, IGT_REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-975"><a href="#cb264-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb264-976"><a href="#cb264-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Name, IGT_REP, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-977"><a href="#cb264-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb264-978"><a href="#cb264-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-979"><a href="#cb264-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb264-980"><a href="#cb264-980" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb264-981"><a href="#cb264-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-982"><a href="#cb264-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb264-983"><a href="#cb264-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb264-984"><a href="#cb264-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb264-985"><a href="#cb264-985" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb264-986"><a href="#cb264-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb264-987"><a href="#cb264-987" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-988"><a href="#cb264-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb264-989"><a href="#cb264-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-990"><a href="#cb264-990" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb264-991"><a href="#cb264-991" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-992"><a href="#cb264-992" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb264-993"><a href="#cb264-993" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb264-994"><a href="#cb264-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-995"><a href="#cb264-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-996"><a href="#cb264-996" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile and save grazing experiment results</span></span>
<span id="cb264-997"><a href="#cb264-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1000"><a href="#cb264-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1001"><a href="#cb264-1001" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb264-1002"><a href="#cb264-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1003"><a href="#cb264-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1004"><a href="#cb264-1004" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-1005"><a href="#cb264-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1006"><a href="#cb264-1006" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb264-1007"><a href="#cb264-1007" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb264-1008"><a href="#cb264-1008" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb264-1009"><a href="#cb264-1009" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb264-1010"><a href="#cb264-1010" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb264-1011"><a href="#cb264-1011" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-1012"><a href="#cb264-1012" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-1013"><a href="#cb264-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb264-1014"><a href="#cb264-1014" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb264-1015"><a href="#cb264-1015" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb264-1016"><a href="#cb264-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1017"><a href="#cb264-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb264-1018"><a href="#cb264-1018" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="sc">%&gt;%</span></span>
<span id="cb264-1019"><a href="#cb264-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrigin, SiteOrder, NameOrder, Experiment, SizeFrac, r.squared, INTERCEPT, SLOPE) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb264-1020"><a href="#cb264-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span>
<span id="cb264-1021"><a href="#cb264-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1022"><a href="#cb264-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1023"><a href="#cb264-1023" aria-hidden="true" tabindex="-1"></a><span class="fu"># Check FLP control experiments</span></span>
<span id="cb264-1024"><a href="#cb264-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1025"><a href="#cb264-1025" aria-hidden="true" tabindex="-1"></a>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</span>
<span id="cb264-1026"><a href="#cb264-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1029"><a href="#cb264-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1030"><a href="#cb264-1030" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb264-1031"><a href="#cb264-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb264-1032"><a href="#cb264-1032" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb264-1033"><a href="#cb264-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1034"><a href="#cb264-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1035"><a href="#cb264-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1036"><a href="#cb264-1036" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-1037"><a href="#cb264-1037" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb264-1038"><a href="#cb264-1038" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb264-1039"><a href="#cb264-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1040"><a href="#cb264-1040" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb264-1041"><a href="#cb264-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1042"><a href="#cb264-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1043"><a href="#cb264-1043" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-1044"><a href="#cb264-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1045"><a href="#cb264-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1046"><a href="#cb264-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bag grazing experiment controls</span></span>
<span id="cb264-1047"><a href="#cb264-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1048"><a href="#cb264-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=7, fig.width=7}</span></span>
<span id="cb264-1049"><a href="#cb264-1049" aria-hidden="true" tabindex="-1"></a>bag_ctrls <span class="ot">&lt;-</span> dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb264-1050"><a href="#cb264-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1051"><a href="#cb264-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb264-1052"><a href="#cb264-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb264-1053"><a href="#cb264-1053" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb264-1054"><a href="#cb264-1054" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-1055"><a href="#cb264-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb264-1056"><a href="#cb264-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-1057"><a href="#cb264-1057" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb264-1058"><a href="#cb264-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb264-1059"><a href="#cb264-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-1060"><a href="#cb264-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-1061"><a href="#cb264-1061" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1062"><a href="#cb264-1062" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb264-1063"><a href="#cb264-1063" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb264-1064"><a href="#cb264-1064" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb264-1065"><a href="#cb264-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb264-1066"><a href="#cb264-1066" aria-hidden="true" tabindex="-1"></a>bag_ctrls</span>
<span id="cb264-1067"><a href="#cb264-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1068"><a href="#cb264-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1069"><a href="#cb264-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">## IGT experiment controls</span></span>
<span id="cb264-1070"><a href="#cb264-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1071"><a href="#cb264-1071" aria-hidden="true" tabindex="-1"></a>Repeat for IGT experiments.</span>
<span id="cb264-1072"><a href="#cb264-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1073"><a href="#cb264-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=4, fig.height=3}</span></span>
<span id="cb264-1074"><a href="#cb264-1074" aria-hidden="true" tabindex="-1"></a>igt_ctrl_plot <span class="ot">&lt;-</span> dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb264-1075"><a href="#cb264-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1076"><a href="#cb264-1076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb264-1077"><a href="#cb264-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb264-1078"><a href="#cb264-1078" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb264-1079"><a href="#cb264-1079" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-1080"><a href="#cb264-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb264-1081"><a href="#cb264-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-1082"><a href="#cb264-1082" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb264-1083"><a href="#cb264-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb264-1084"><a href="#cb264-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb264-1085"><a href="#cb264-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-1086"><a href="#cb264-1086" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1087"><a href="#cb264-1087" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb264-1088"><a href="#cb264-1088" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb264-1089"><a href="#cb264-1089" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb264-1090"><a href="#cb264-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb264-1091"><a href="#cb264-1091" aria-hidden="true" tabindex="-1"></a>igt_ctrl_plot</span>
<span id="cb264-1092"><a href="#cb264-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1093"><a href="#cb264-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1094"><a href="#cb264-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure S5</span></span>
<span id="cb264-1097"><a href="#cb264-1097" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1098"><a href="#cb264-1098" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS5_1.svg", w = 7, h = 7)</span></span>
<span id="cb264-1099"><a href="#cb264-1099" aria-hidden="true" tabindex="-1"></a>bag_ctrls <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb264-1100"><a href="#cb264-1100" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-1101"><a href="#cb264-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1102"><a href="#cb264-1102" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS5_2.svg", w = 4, h = 3)</span></span>
<span id="cb264-1103"><a href="#cb264-1103" aria-hidden="true" tabindex="-1"></a>(igt_ctrl_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>))</span>
<span id="cb264-1104"><a href="#cb264-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-1105"><a href="#cb264-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1106"><a href="#cb264-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1107"><a href="#cb264-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1108"><a href="#cb264-1108" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate complete table with grazing rates and values</span></span>
<span id="cb264-1109"><a href="#cb264-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1112"><a href="#cb264-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1113"><a href="#cb264-1113" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb264-1114"><a href="#cb264-1114" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb264-1115"><a href="#cb264-1115" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb264-1116"><a href="#cb264-1116" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb264-1117"><a href="#cb264-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1118"><a href="#cb264-1118" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb264-1119"><a href="#cb264-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1120"><a href="#cb264-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, IGT_REP, Site, Name, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1121"><a href="#cb264-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-1122"><a href="#cb264-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, IGT_REP, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, SiteOrder, NameOrder, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1123"><a href="#cb264-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1124"><a href="#cb264-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb264-1125"><a href="#cb264-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1126"><a href="#cb264-1126" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb264-1127"><a href="#cb264-1127" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb264-1128"><a href="#cb264-1128" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb264-1129"><a href="#cb264-1129" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1130"><a href="#cb264-1130" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume-Shipboard"</span>,</span>
<span id="cb264-1131"><a href="#cb264-1131" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background-Shipboard"</span>,</span>
<span id="cb264-1132"><a href="#cb264-1132" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb264-1133"><a href="#cb264-1133" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Shipboard"</span></span>
<span id="cb264-1134"><a href="#cb264-1134" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb264-1135"><a href="#cb264-1135" aria-hidden="true" tabindex="-1"></a>  <span class="at">LABEL_REPS =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1136"><a href="#cb264-1136" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-1137"><a href="#cb264-1137" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-1138"><a href="#cb264-1138" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb264-1139"><a href="#cb264-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, LABEL_REPS, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1140"><a href="#cb264-1140" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-1141"><a href="#cb264-1141" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="co"># view complete table of grazing rate results</span></span>
<span id="cb264-1142"><a href="#cb264-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1143"><a href="#cb264-1143" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb264-1144"><a href="#cb264-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1145"><a href="#cb264-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb264-1146"><a href="#cb264-1146" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb264-1147"><a href="#cb264-1147" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span>
<span id="cb264-1148"><a href="#cb264-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1149"><a href="#cb264-1149" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb264-1150"><a href="#cb264-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1151"><a href="#cb264-1151" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb264-1152"><a href="#cb264-1152" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb264-1153"><a href="#cb264-1153" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb264-1154"><a href="#cb264-1154" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1155"><a href="#cb264-1155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(Site, TYPE) %&gt;% </span></span>
<span id="cb264-1156"><a href="#cb264-1156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(TYPE) %&gt;%</span></span>
<span id="cb264-1157"><a href="#cb264-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPE, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1158"><a href="#cb264-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb264-1159"><a href="#cb264-1159" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb264-1160"><a href="#cb264-1160" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span>
<span id="cb264-1161"><a href="#cb264-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1162"><a href="#cb264-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1163"><a href="#cb264-1163" aria-hidden="true" tabindex="-1"></a>Amend table with estimated FLP concentration</span>
<span id="cb264-1164"><a href="#cb264-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1167"><a href="#cb264-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1168"><a href="#cb264-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb264-1169"><a href="#cb264-1169" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb264-1170"><a href="#cb264-1170" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb264-1171"><a href="#cb264-1171" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb264-1172"><a href="#cb264-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-1173"><a href="#cb264-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-1174"><a href="#cb264-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb264-1175"><a href="#cb264-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1176"><a href="#cb264-1176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1177"><a href="#cb264-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_ml =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1178"><a href="#cb264-1178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>, <span class="sc">-</span>FLP_conc) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1179"><a href="#cb264-1179" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-1180"><a href="#cb264-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1181"><a href="#cb264-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1182"><a href="#cb264-1182" aria-hidden="true" tabindex="-1"></a>Introduce factors in table for visualizations</span>
<span id="cb264-1183"><a href="#cb264-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1186"><a href="#cb264-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1187"><a href="#cb264-1187" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb264-1188"><a href="#cb264-1188" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb264-1189"><a href="#cb264-1189" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb264-1190"><a href="#cb264-1190" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb264-1191"><a href="#cb264-1191" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb264-1192"><a href="#cb264-1192" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb264-1193"><a href="#cb264-1193" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-1194"><a href="#cb264-1194" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-1195"><a href="#cb264-1195" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb264-1196"><a href="#cb264-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb264-1197"><a href="#cb264-1197" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>FIELDORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb264-1198"><a href="#cb264-1198" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>VENTORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb264-1199"><a href="#cb264-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1200"><a href="#cb264-1200" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp</span></span>
<span id="cb264-1201"><a href="#cb264-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1202"><a href="#cb264-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1203"><a href="#cb264-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot FLP/grazer /minute</span></span>
<span id="cb264-1204"><a href="#cb264-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1207"><a href="#cb264-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1208"><a href="#cb264-1208" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb264-1209"><a href="#cb264-1209" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb264-1210"><a href="#cb264-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1211"><a href="#cb264-1211" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-1212"><a href="#cb264-1212" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb264-1213"><a href="#cb264-1213" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1214"><a href="#cb264-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1215"><a href="#cb264-1215" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-1216"><a href="#cb264-1216" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-1217"><a href="#cb264-1217" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1218"><a href="#cb264-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, FIELD, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-1219"><a href="#cb264-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> VENTORDER, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb264-1220"><a href="#cb264-1220" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-1221"><a href="#cb264-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb264-1222"><a href="#cb264-1222" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb264-1223"><a href="#cb264-1223" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb264-1224"><a href="#cb264-1224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-1225"><a href="#cb264-1225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-1226"><a href="#cb264-1226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-1227"><a href="#cb264-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELDORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-1228"><a href="#cb264-1228" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb264-1229"><a href="#cb264-1229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-1230"><a href="#cb264-1230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1231"><a href="#cb264-1231" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-1232"><a href="#cb264-1232" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-1233"><a href="#cb264-1233" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb264-1234"><a href="#cb264-1234" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-1235"><a href="#cb264-1235" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-1236"><a href="#cb264-1236" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-1237"><a href="#cb264-1237" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-1238"><a href="#cb264-1238" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1239"><a href="#cb264-1239" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb264-1240"><a href="#cb264-1240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb264-1241"><a href="#cb264-1241" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-1242"><a href="#cb264-1242" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span>
<span id="cb264-1243"><a href="#cb264-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1244"><a href="#cb264-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1245"><a href="#cb264-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1246"><a href="#cb264-1246" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1</span></span>
<span id="cb264-1247"><a href="#cb264-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1248"><a href="#cb264-1248" aria-hidden="true" tabindex="-1"></a>Create table with all base experiment results. Including, grazing rate derived from slope (and corrected), number of experiments, replicates, and prok and euk counts.</span>
<span id="cb264-1249"><a href="#cb264-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1250"><a href="#cb264-1250" aria-hidden="true" tabindex="-1"></a>For IGT experiments, or experiments where in situ prok counts were not obtained, the average in situ prok count was used. </span>
<span id="cb264-1253"><a href="#cb264-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1254"><a href="#cb264-1254" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb264-1255"><a href="#cb264-1255" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb264-1256"><a href="#cb264-1256" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb264-1257"><a href="#cb264-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1258"><a href="#cb264-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_grazerate_wflp)</span></span>
<span id="cb264-1259"><a href="#cb264-1259" aria-hidden="true" tabindex="-1"></a><span class="co"># View(euk_prok_counts)</span></span>
<span id="cb264-1260"><a href="#cb264-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1261"><a href="#cb264-1261" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb264-1262"><a href="#cb264-1262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Experiment_rep, FIELD, Name, SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, RATE, <span class="at">RATE_minute =</span> GRAZE_RATE, FLP_ml, TimePoints, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1263"><a href="#cb264-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(euk_prok_counts, <span class="fu">join_by</span>(Experiment_rep <span class="sc">==</span> Experiment_rep, Name <span class="sc">==</span> Name, FIELD <span class="sc">==</span> Site)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1264"><a href="#cb264-1264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(PROK_ml), avg_insitu, PROK_ml))</span>
<span id="cb264-1265"><a href="#cb264-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1266"><a href="#cb264-1266" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp_wprok_weuk</span></span>
<span id="cb264-1267"><a href="#cb264-1267" aria-hidden="true" tabindex="-1"></a><span class="co"># names(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb264-1268"><a href="#cb264-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1269"><a href="#cb264-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1270"><a href="#cb264-1270" aria-hidden="true" tabindex="-1"></a>Description of variables above:</span>
<span id="cb264-1271"><a href="#cb264-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1272"><a href="#cb264-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FIELD - vent location</span>
<span id="cb264-1273"><a href="#cb264-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NAME - name of vent site, or plume/background</span>
<span id="cb264-1274"><a href="#cb264-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>EXP - experiment type, bag or IGT</span>
<span id="cb264-1275"><a href="#cb264-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SAMPLE - vent site</span>
<span id="cb264-1276"><a href="#cb264-1276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_minute = GRAZE_RATE - FLPs per grazer per minute (SLOPE of best fitline)</span>
<span id="cb264-1277"><a href="#cb264-1277" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FLP_ml - FLP concentration at T0</span>
<span id="cb264-1278"><a href="#cb264-1278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</span>
<span id="cb264-1279"><a href="#cb264-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</span>
<span id="cb264-1280"><a href="#cb264-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1281"><a href="#cb264-1281" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grazing rate calculations</span></span>
<span id="cb264-1282"><a href="#cb264-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1283"><a href="#cb264-1283" aria-hidden="true" tabindex="-1"></a>Based on Unrein et al. 2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</span>
<span id="cb264-1284"><a href="#cb264-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1287"><a href="#cb264-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1288"><a href="#cb264-1288" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb264-1289"><a href="#cb264-1289" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb264-1290"><a href="#cb264-1290" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb264-1291"><a href="#cb264-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_minute <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb264-1292"><a href="#cb264-1292" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb264-1293"><a href="#cb264-1293" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb264-1294"><a href="#cb264-1294" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb264-1295"><a href="#cb264-1295" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb264-1296"><a href="#cb264-1296" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb264-1297"><a href="#cb264-1297" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb264-1298"><a href="#cb264-1298" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb264-1299"><a href="#cb264-1299" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb264-1300"><a href="#cb264-1300" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb264-1301"><a href="#cb264-1301" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb264-1302"><a href="#cb264-1302" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb264-1303"><a href="#cb264-1303" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb264-1304"><a href="#cb264-1304" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb264-1305"><a href="#cb264-1305" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb264-1306"><a href="#cb264-1306" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb264-1307"><a href="#cb264-1307" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb264-1308"><a href="#cb264-1308" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb264-1309"><a href="#cb264-1309" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb264-1310"><a href="#cb264-1310" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb264-1311"><a href="#cb264-1311" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb264-1312"><a href="#cb264-1312" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1313"><a href="#cb264-1313" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-1314"><a href="#cb264-1314" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span>
<span id="cb264-1315"><a href="#cb264-1315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1316"><a href="#cb264-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1317"><a href="#cb264-1317" aria-hidden="true" tabindex="-1"></a>Explanation of units for table with calculated values.</span>
<span id="cb264-1318"><a href="#cb264-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1319"><a href="#cb264-1319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_min &amp; RATE_hr = Grazing rate as 'FLPs per grazer per minute' and per hour</span>
<span id="cb264-1320"><a href="#cb264-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1321"><a href="#cb264-1321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CLEARANCE_RATE = ml or nL per grazer per hour</span>
<span id="cb264-1322"><a href="#cb264-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1323"><a href="#cb264-1323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</span>
<span id="cb264-1324"><a href="#cb264-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1325"><a href="#cb264-1325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GRAZING EFFECT = bacteria per ml per hour</span>
<span id="cb264-1326"><a href="#cb264-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1327"><a href="#cb264-1327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bacterial turnover rate = % per day</span>
<span id="cb264-1328"><a href="#cb264-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1329"><a href="#cb264-1329" aria-hidden="true" tabindex="-1"></a><span class="fu">### gt table options</span></span>
<span id="cb264-1330"><a href="#cb264-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1333"><a href="#cb264-1333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1334"><a href="#cb264-1334" aria-hidden="true" tabindex="-1"></a><span class="co"># bkgd &lt;- c("Background", "Plume")</span></span>
<span id="cb264-1335"><a href="#cb264-1335" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb264-1336"><a href="#cb264-1336" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gt)</span></span>
<span id="cb264-1337"><a href="#cb264-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb264-1338"><a href="#cb264-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb264-1339"><a href="#cb264-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb264-1340"><a href="#cb264-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb264-1341"><a href="#cb264-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb264-1342"><a href="#cb264-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb264-1343"><a href="#cb264-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb264-1344"><a href="#cb264-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb264-1345"><a href="#cb264-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb264-1346"><a href="#cb264-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb264-1347"><a href="#cb264-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb264-1348"><a href="#cb264-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1349"><a href="#cb264-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1350"><a href="#cb264-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1351"><a href="#cb264-1351" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1352"><a href="#cb264-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb264-1353"><a href="#cb264-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1354"><a href="#cb264-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1355"><a href="#cb264-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1356"><a href="#cb264-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1357"><a href="#cb264-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1358"><a href="#cb264-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1359"><a href="#cb264-1359" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1360"><a href="#cb264-1360" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1361"><a href="#cb264-1361" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1362"><a href="#cb264-1362" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1363"><a href="#cb264-1363" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1364"><a href="#cb264-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb264-1365"><a href="#cb264-1365" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb264-1366"><a href="#cb264-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1367"><a href="#cb264-1367" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb264-1368"><a href="#cb264-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb264-1369"><a href="#cb264-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb264-1370"><a href="#cb264-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb264-1371"><a href="#cb264-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb264-1372"><a href="#cb264-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb264-1373"><a href="#cb264-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1374"><a href="#cb264-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb264-1375"><a href="#cb264-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb264-1376"><a href="#cb264-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb264-1377"><a href="#cb264-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1378"><a href="#cb264-1378" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb264-1379"><a href="#cb264-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb264-1380"><a href="#cb264-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb264-1381"><a href="#cb264-1381" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1382"><a href="#cb264-1382" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb264-1383"><a href="#cb264-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb264-1384"><a href="#cb264-1384" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb264-1385"><a href="#cb264-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1386"><a href="#cb264-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb264-1387"><a href="#cb264-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb264-1388"><a href="#cb264-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb264-1389"><a href="#cb264-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1390"><a href="#cb264-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb264-1391"><a href="#cb264-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb264-1392"><a href="#cb264-1392" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb264-1393"><a href="#cb264-1393" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb264-1394"><a href="#cb264-1394" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb264-1395"><a href="#cb264-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb264-1396"><a href="#cb264-1396" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb264-1397"><a href="#cb264-1397" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb264-1398"><a href="#cb264-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb264-1399"><a href="#cb264-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb264-1400"><a href="#cb264-1400" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb264-1401"><a href="#cb264-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb264-1402"><a href="#cb264-1402" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span>
<span id="cb264-1403"><a href="#cb264-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1404"><a href="#cb264-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1405"><a href="#cb264-1405" aria-hidden="true" tabindex="-1"></a>Table 1 and S1 - grazing experiment information only</span>
<span id="cb264-1408"><a href="#cb264-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1409"><a href="#cb264-1409" aria-hidden="true" tabindex="-1"></a><span class="co"># April 18, 2023</span></span>
<span id="cb264-1410"><a href="#cb264-1410" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Table 1</span></span>
<span id="cb264-1411"><a href="#cb264-1411" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb264-1412"><a href="#cb264-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, EUK_ml, EUK_MinMax, PROK_ml, PROK_MinMax, GRAZING_EFFECT_hr, RATE_minute, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb264-1413"><a href="#cb264-1413" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb264-1414"><a href="#cb264-1414" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb264-1415"><a href="#cb264-1415" aria-hidden="true" tabindex="-1"></a><span class="co"># # ## Table S2</span></span>
<span id="cb264-1416"><a href="#cb264-1416" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb264-1417"><a href="#cb264-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE,</span></span>
<span id="cb264-1418"><a href="#cb264-1418" aria-hidden="true" tabindex="-1"></a><span class="co">#                      TimePoints, starts_with("EXP"), starts_with("CTRL"), EUK_ml, EUK_MinMax, EUK_sem, PROK_ml, PROK_MinMax, PROK_sem, FLP_ml, GRAZE_RATE_DAY, Slope = RATE, RATE_minute, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb264-1419"><a href="#cb264-1419" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/tableS2-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb264-1420"><a href="#cb264-1420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1421"><a href="#cb264-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1422"><a href="#cb264-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1423"><a href="#cb264-1423" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass for eukaryotes</span></span>
<span id="cb264-1424"><a href="#cb264-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1425"><a href="#cb264-1425" aria-hidden="true" tabindex="-1"></a>References for estimating biovolume *Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al. (2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782--792.*</span>
<span id="cb264-1426"><a href="#cb264-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1429"><a href="#cb264-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1430"><a href="#cb264-1430" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb264-1431"><a href="#cb264-1431" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb264-1432"><a href="#cb264-1432" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span>
<span id="cb264-1433"><a href="#cb264-1433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1434"><a href="#cb264-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1435"><a href="#cb264-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">## C factor based on biovolume</span></span>
<span id="cb264-1436"><a href="#cb264-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1437"><a href="#cb264-1437" aria-hidden="true" tabindex="-1"></a>(1) Calculate biovolume based on observed/imaged cells</span>
<span id="cb264-1438"><a href="#cb264-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1441"><a href="#cb264-1441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1442"><a href="#cb264-1442" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate biovolume, then apply carbon by biomass estimate for protists derived from biovolume.</span></span>
<span id="cb264-1443"><a href="#cb264-1443" aria-hidden="true" tabindex="-1"></a><span class="co"># h = largest cell dimension "height"</span></span>
<span id="cb264-1444"><a href="#cb264-1444" aria-hidden="true" tabindex="-1"></a><span class="co"># d = largest cross-section of h</span></span>
<span id="cb264-1445"><a href="#cb264-1445" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb264-1446"><a href="#cb264-1446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIOVOLUME =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> h)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb264-1447"><a href="#cb264-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_dino =</span> (<span class="fl">0.760</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.819</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb264-1448"><a href="#cb264-1448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_nodiatom =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.939</span>))) <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb264-1449"><a href="#cb264-1449" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb264-1450"><a href="#cb264-1450" aria-hidden="true" tabindex="-1"></a><span class="co"># biov_calc</span></span>
<span id="cb264-1451"><a href="#cb264-1451" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(c(80, 360))</span></span>
<span id="cb264-1452"><a href="#cb264-1452" aria-hidden="true" tabindex="-1"></a><span class="co"># no diatom is what Pernice used.</span></span>
<span id="cb264-1453"><a href="#cb264-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1454"><a href="#cb264-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1455"><a href="#cb264-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1456"><a href="#cb264-1456" aria-hidden="true" tabindex="-1"></a>Use ```pgC_cell_MD_nodiatom``` moving forward.</span>
<span id="cb264-1457"><a href="#cb264-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1458"><a href="#cb264-1458" aria-hidden="true" tabindex="-1"></a>(2) Get a summary pg per cell for vent and background samples. This is derived from biovolume estimates.</span>
<span id="cb264-1459"><a href="#cb264-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1460"><a href="#cb264-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table S4 biomass summaries</span></span>
<span id="cb264-1463"><a href="#cb264-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1464"><a href="#cb264-1464" aria-hidden="true" tabindex="-1"></a>c_factor_biov <span class="ot">&lt;-</span> </span>
<span id="cb264-1465"><a href="#cb264-1465" aria-hidden="true" tabindex="-1"></a>  biov_calc <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>EXP, <span class="sc">-</span>h, <span class="sc">-</span>d) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1466"><a href="#cb264-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(BIOVOLUME, <span class="fu">starts_with</span>(<span class="st">"pgC_"</span>)), <span class="at">names_to =</span> <span class="st">"VARIABLES"</span>, <span class="at">values_to =</span> <span class="st">"VALUES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1467"><a href="#cb264-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW, VARIABLES) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1468"><a href="#cb264-1468" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(VALUES),</span>
<span id="cb264-1469"><a href="#cb264-1469" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(VALUES),</span>
<span id="cb264-1470"><a href="#cb264-1470" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1471"><a href="#cb264-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VENT_BSW, <span class="at">values_from =</span> <span class="fu">c</span>(mean, max,min), <span class="at">names_sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb264-1472"><a href="#cb264-1472" aria-hidden="true" tabindex="-1"></a><span class="co"># View(c_factor_biov)</span></span>
<span id="cb264-1473"><a href="#cb264-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1474"><a href="#cb264-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1475"><a href="#cb264-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1476"><a href="#cb264-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1477"><a href="#cb264-1477" aria-hidden="true" tabindex="-1"></a>(3) Assign a C conversion factor for background and within vents based on biovolume</span>
<span id="cb264-1478"><a href="#cb264-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1481"><a href="#cb264-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1482"><a href="#cb264-1482" aria-hidden="true" tabindex="-1"></a><span class="co"># pg C per cell (pgC_cell)</span></span>
<span id="cb264-1483"><a href="#cb264-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1484"><a href="#cb264-1484" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_BSW</span>
<span id="cb264-1485"><a href="#cb264-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1486"><a href="#cb264-1486" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_vent</span>
<span id="cb264-1487"><a href="#cb264-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1488"><a href="#cb264-1488" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_BSW</span>
<span id="cb264-1489"><a href="#cb264-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1490"><a href="#cb264-1490" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_vent</span>
<span id="cb264-1491"><a href="#cb264-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1492"><a href="#cb264-1492" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_BSW</span>
<span id="cb264-1493"><a href="#cb264-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1494"><a href="#cb264-1494" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_vent</span>
<span id="cb264-1495"><a href="#cb264-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1496"><a href="#cb264-1496" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW</span>
<span id="cb264-1497"><a href="#cb264-1497" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent</span>
<span id="cb264-1498"><a href="#cb264-1498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1499"><a href="#cb264-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1500"><a href="#cb264-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1501"><a href="#cb264-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1502"><a href="#cb264-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1503"><a href="#cb264-1503" aria-hidden="true" tabindex="-1"></a>(4) Combine with count table to estimate total standing stock in carbon</span>
<span id="cb264-1504"><a href="#cb264-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1505"><a href="#cb264-1505" aria-hidden="true" tabindex="-1"></a>Isolate at T0 all the euk cells per ml counts. Then add in the mean, min/max for the pg C per cell, based on the vent vs non-vent.</span>
<span id="cb264-1506"><a href="#cb264-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1509"><a href="#cb264-1509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1510"><a href="#cb264-1510" aria-hidden="true" tabindex="-1"></a><span class="co"># counts_cellsml_avg</span></span>
<span id="cb264-1511"><a href="#cb264-1511" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb264-1512"><a href="#cb264-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-1513"><a href="#cb264-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1514"><a href="#cb264-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1515"><a href="#cb264-1515" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1516"><a href="#cb264-1516" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1517"><a href="#cb264-1517" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb264-1518"><a href="#cb264-1518" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1519"><a href="#cb264-1519" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pg C per ml = (cells per ml)*(pg C per)</span></span>
<span id="cb264-1520"><a href="#cb264-1520" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Apply the non-vent and vent pg C per cell value to total cells per ml</span></span>
<span id="cb264-1521"><a href="#cb264-1521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1522"><a href="#cb264-1522" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW,</span>
<span id="cb264-1523"><a href="#cb264-1523" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent,</span>
<span id="cb264-1524"><a href="#cb264-1524" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1525"><a href="#cb264-1525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_min =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1526"><a href="#cb264-1526" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_min,</span>
<span id="cb264-1527"><a href="#cb264-1527" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_min</span>
<span id="cb264-1528"><a href="#cb264-1528" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1529"><a href="#cb264-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_max =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1530"><a href="#cb264-1530" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_max,</span>
<span id="cb264-1531"><a href="#cb264-1531" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_max</span>
<span id="cb264-1532"><a href="#cb264-1532" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1533"><a href="#cb264-1533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1534"><a href="#cb264-1534" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-1535"><a href="#cb264-1535" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-1536"><a href="#cb264-1536" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1537"><a href="#cb264-1537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span>
<span id="cb264-1538"><a href="#cb264-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1539"><a href="#cb264-1539" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample</span>
<span id="cb264-1540"><a href="#cb264-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1541"><a href="#cb264-1541" aria-hidden="true" tabindex="-1"></a>Table reports the total pg of carbon per ml when we consider the whole eukaryote community (based on cell count).</span>
<span id="cb264-1542"><a href="#cb264-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1543"><a href="#cb264-1543" aria-hidden="true" tabindex="-1"></a>Report in pg of C per ml. </span>
<span id="cb264-1544"><a href="#cb264-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1547"><a href="#cb264-1547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1548"><a href="#cb264-1548" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb264-1549"><a href="#cb264-1549" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb264-1550"><a href="#cb264-1550" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb264-1551"><a href="#cb264-1551" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb264-1552"><a href="#cb264-1552" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-1553"><a href="#cb264-1553" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-1554"><a href="#cb264-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1555"><a href="#cb264-1555" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb264-1556"><a href="#cb264-1556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1557"><a href="#cb264-1557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1558"><a href="#cb264-1558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pgC_ml_mean))) <span class="sc">+</span></span>
<span id="cb264-1559"><a href="#cb264-1559" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb264-1560"><a href="#cb264-1560" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (pgC_ml_min), <span class="at">ymax =</span> (pgC_ml_max))) <span class="sc">+</span></span>
<span id="cb264-1561"><a href="#cb264-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-1562"><a href="#cb264-1562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb264-1563"><a href="#cb264-1563" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-1564"><a href="#cb264-1564" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1565"><a href="#cb264-1565" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-1566"><a href="#cb264-1566" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-1567"><a href="#cb264-1567" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb264-1568"><a href="#cb264-1568" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-1569"><a href="#cb264-1569" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-1570"><a href="#cb264-1570" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-1571"><a href="#cb264-1571" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-1572"><a href="#cb264-1572" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb264-1573"><a href="#cb264-1573" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb264-1574"><a href="#cb264-1574" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb264-1575"><a href="#cb264-1575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-1576"><a href="#cb264-1576" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - derived from biovolume"</span>)</span>
<span id="cb264-1577"><a href="#cb264-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1578"><a href="#cb264-1578" aria-hidden="true" tabindex="-1"></a>by_biovol_plot</span>
<span id="cb264-1579"><a href="#cb264-1579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1580"><a href="#cb264-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1581"><a href="#cb264-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1582"><a href="#cb264-1582" aria-hidden="true" tabindex="-1"></a><span class="fu">## C biomass based on size fraction</span></span>
<span id="cb264-1583"><a href="#cb264-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1584"><a href="#cb264-1584" aria-hidden="true" tabindex="-1"></a>Derived from Caron et al. 1995</span>
<span id="cb264-1585"><a href="#cb264-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1586"><a href="#cb264-1586" aria-hidden="true" tabindex="-1"></a>(1) Assign by size class</span>
<span id="cb264-1587"><a href="#cb264-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1590"><a href="#cb264-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1591"><a href="#cb264-1591" aria-hidden="true" tabindex="-1"></a>c_n <span class="ot">&lt;-</span> <span class="fl">2.6</span> <span class="co"># pg C per cell</span></span>
<span id="cb264-1592"><a href="#cb264-1592" aria-hidden="true" tabindex="-1"></a>c_m <span class="ot">&lt;-</span> <span class="dv">138</span> <span class="co"># pg C per cell</span></span>
<span id="cb264-1593"><a href="#cb264-1593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1594"><a href="#cb264-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1597"><a href="#cb264-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1598"><a href="#cb264-1598" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample_tmp <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb264-1599"><a href="#cb264-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1600"><a href="#cb264-1600" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-1601"><a href="#cb264-1601" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb264-1602"><a href="#cb264-1602" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1603"><a href="#cb264-1603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1604"><a href="#cb264-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-1605"><a href="#cb264-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">!=</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> <span class="co"># isolate micro vs. nano</span></span>
<span id="cb264-1606"><a href="#cb264-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1607"><a href="#cb264-1607" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1608"><a href="#cb264-1608" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1609"><a href="#cb264-1609" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb264-1610"><a href="#cb264-1610" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1611"><a href="#cb264-1611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_cell =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1612"><a href="#cb264-1612" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> c_m,</span>
<span id="cb264-1613"><a href="#cb264-1613" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> c_n</span>
<span id="cb264-1614"><a href="#cb264-1614" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1615"><a href="#cb264-1615" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiply mean cells per ml of micro and nano by pg C for each size fraction:</span></span>
<span id="cb264-1616"><a href="#cb264-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_ml_TMP =</span> MEAN <span class="sc">*</span> pg_C_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1617"><a href="#cb264-1617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1618"><a href="#cb264-1618" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Take the average of the micro and nano for each experiment.</span></span>
<span id="cb264-1619"><a href="#cb264-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml_TMP))</span>
<span id="cb264-1620"><a href="#cb264-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1621"><a href="#cb264-1621" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate total euk for each experiment by adding.</span></span>
<span id="cb264-1622"><a href="#cb264-1622" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb264-1623"><a href="#cb264-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1624"><a href="#cb264-1624" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add across micro and nano to get total</span></span>
<span id="cb264-1625"><a href="#cb264-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pg_C_ml =</span> <span class="fu">sum</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1626"><a href="#cb264-1626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">VARIABLE =</span> <span class="st">"totaleuk"</span>)</span>
<span id="cb264-1627"><a href="#cb264-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1628"><a href="#cb264-1628" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp2, pgC_ml_sizefrac_bysample_tmp)</span>
<span id="cb264-1629"><a href="#cb264-1629" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample</span>
<span id="cb264-1630"><a href="#cb264-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1631"><a href="#cb264-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1634"><a href="#cb264-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1635"><a href="#cb264-1635" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb264-1636"><a href="#cb264-1636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1637"><a href="#cb264-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb264-1638"><a href="#cb264-1638" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb264-1639"><a href="#cb264-1639" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml))</span>
<span id="cb264-1640"><a href="#cb264-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1641"><a href="#cb264-1641" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pgC_ml_sizefrac_bysample)</span>
<span id="cb264-1642"><a href="#cb264-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1643"><a href="#cb264-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1646"><a href="#cb264-1646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1647"><a href="#cb264-1647" aria-hidden="true" tabindex="-1"></a>by_sizefrac_plot <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb264-1648"><a href="#cb264-1648" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1649"><a href="#cb264-1649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1650"><a href="#cb264-1650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pg_C_ml))) <span class="sc">+</span></span>
<span id="cb264-1651"><a href="#cb264-1651" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> VARIABLE)) <span class="sc">+</span> </span>
<span id="cb264-1652"><a href="#cb264-1652" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_linerange(aes(ymin = (pgC_ml_min/1000), ymax = (pgC_ml_max/1000))) +</span></span>
<span id="cb264-1653"><a href="#cb264-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-1654"><a href="#cb264-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb264-1655"><a href="#cb264-1655" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-1656"><a href="#cb264-1656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1657"><a href="#cb264-1657" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-1658"><a href="#cb264-1658" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-1659"><a href="#cb264-1659" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb264-1660"><a href="#cb264-1660" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-1661"><a href="#cb264-1661" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-1662"><a href="#cb264-1662" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-1663"><a href="#cb264-1663" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-1664"><a href="#cb264-1664" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb264-1665"><a href="#cb264-1665" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb264-1666"><a href="#cb264-1666" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb264-1667"><a href="#cb264-1667" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-1668"><a href="#cb264-1668" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - based on size fraction"</span>)</span>
<span id="cb264-1669"><a href="#cb264-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1670"><a href="#cb264-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1671"><a href="#cb264-1671" aria-hidden="true" tabindex="-1"></a>Combined supplementary plot showing two routes of determining total biomass.</span>
<span id="cb264-1672"><a href="#cb264-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1673"><a href="#cb264-1673" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure S2</span></span>
<span id="cb264-1674"><a href="#cb264-1674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=7}</span></span>
<span id="cb264-1675"><a href="#cb264-1675" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS2.svg", h = 8, w = 7)</span></span>
<span id="cb264-1676"><a href="#cb264-1676" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="sc">+</span> by_sizefrac_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-1677"><a href="#cb264-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb264-1678"><a href="#cb264-1678" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-1679"><a href="#cb264-1679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1680"><a href="#cb264-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1681"><a href="#cb264-1681" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare total carbon biomass - euks</span></span>
<span id="cb264-1682"><a href="#cb264-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1683"><a href="#cb264-1683" aria-hidden="true" tabindex="-1"></a>Compilation table of carbon biomass values for microeukaryotes by sample type and vent field</span>
<span id="cb264-1684"><a href="#cb264-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1685"><a href="#cb264-1685" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table S4</span></span>
<span id="cb264-1686"><a href="#cb264-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1689"><a href="#cb264-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1690"><a href="#cb264-1690" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass derived from biovolume, by vent field (vent only)</span></span>
<span id="cb264-1691"><a href="#cb264-1691" aria-hidden="true" tabindex="-1"></a>table4_cbiomass_total <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb264-1692"><a href="#cb264-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, EXP_TYPE, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1693"><a href="#cb264-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb264-1694"><a href="#cb264-1694" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb264-1695"><a href="#cb264-1695" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1696"><a href="#cb264-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1697"><a href="#cb264-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb264-1698"><a href="#cb264-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, SAMPLE_TYPE_BIN, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1699"><a href="#cb264-1699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb264-1700"><a href="#cb264-1700" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb264-1701"><a href="#cb264-1701" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1702"><a href="#cb264-1702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span>
<span id="cb264-1703"><a href="#cb264-1703" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb264-1704"><a href="#cb264-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1705"><a href="#cb264-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># table4_cbiomass_total</span></span>
<span id="cb264-1706"><a href="#cb264-1706" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(table4_cbiomass_total, file = "output-data/tableS4-cbiomass.csv")</span></span>
<span id="cb264-1707"><a href="#cb264-1707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1708"><a href="#cb264-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1709"><a href="#cb264-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1710"><a href="#cb264-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1711"><a href="#cb264-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare biovolumes from literature to measured in this study</span></span>
<span id="cb264-1712"><a href="#cb264-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1713"><a href="#cb264-1713" aria-hidden="true" tabindex="-1"></a>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10\^7 µm\^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</span>
<span id="cb264-1714"><a href="#cb264-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1715"><a href="#cb264-1715" aria-hidden="true" tabindex="-1"></a>Import the heterotroph species volume and carbon content to compare to my measured values. Compare to md-lessard (Supplementary)</span>
<span id="cb264-1716"><a href="#cb264-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1719"><a href="#cb264-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1720"><a href="#cb264-1720" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb264-1721"><a href="#cb264-1721" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb264-1722"><a href="#cb264-1722" aria-hidden="true" tabindex="-1"></a><span class="co"># biov</span></span>
<span id="cb264-1723"><a href="#cb264-1723" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb264-1724"><a href="#cb264-1724" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb264-1725"><a href="#cb264-1725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1726"><a href="#cb264-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1727"><a href="#cb264-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, <span class="at">Volume =</span> BIOVOLUME, <span class="at">pgC_cell =</span> pgC_cell_MD_nodiatom)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1728"><a href="#cb264-1728" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb264-1729"><a href="#cb264-1729" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-1730"><a href="#cb264-1730" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb264-1731"><a href="#cb264-1731" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb264-1732"><a href="#cb264-1732" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb264-1733"><a href="#cb264-1733" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb264-1734"><a href="#cb264-1734" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1735"><a href="#cb264-1735" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb264-1736"><a href="#cb264-1736" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb264-1737"><a href="#cb264-1737" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb264-1738"><a href="#cb264-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1739"><a href="#cb264-1739" aria-hidden="true" tabindex="-1"></a>carbon_compare</span>
<span id="cb264-1740"><a href="#cb264-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1741"><a href="#cb264-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1742"><a href="#cb264-1742" aria-hidden="true" tabindex="-1"></a>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</span>
<span id="cb264-1743"><a href="#cb264-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1744"><a href="#cb264-1744" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass for prokaryotes</span></span>
<span id="cb264-1745"><a href="#cb264-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1746"><a href="#cb264-1746" aria-hidden="true" tabindex="-1"></a>Now, report estimated carbon per cell for bacteria.</span>
<span id="cb264-1747"><a href="#cb264-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1748"><a href="#cb264-1748" aria-hidden="true" tabindex="-1"></a>Units: fg C per cell.</span>
<span id="cb264-1749"><a href="#cb264-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1750"><a href="#cb264-1750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Incorporate prokaryote carbon estimates}</span></span>
<span id="cb264-1751"><a href="#cb264-1751" aria-hidden="true" tabindex="-1"></a>bac_carbon_Mor_fg <span class="ot">&lt;-</span> (<span class="dv">86</span>) </span>
<span id="cb264-1752"><a href="#cb264-1752" aria-hidden="true" tabindex="-1"></a><span class="co">#From Derived from Morono et al. 2011 </span></span>
<span id="cb264-1753"><a href="#cb264-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1754"><a href="#cb264-1754" aria-hidden="true" tabindex="-1"></a>bac_carbon_Lof_fg <span class="ot">&lt;-</span> (<span class="dv">173</span>) </span>
<span id="cb264-1755"><a href="#cb264-1755" aria-hidden="true" tabindex="-1"></a><span class="co"># Derived from McNichol et al. 2018; LOFERER-KROBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb264-1756"><a href="#cb264-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1757"><a href="#cb264-1757" aria-hidden="true" tabindex="-1"></a><span class="co"># fg C per cell</span></span>
<span id="cb264-1758"><a href="#cb264-1758" aria-hidden="true" tabindex="-1"></a>bac_carbon_mean <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb264-1759"><a href="#cb264-1759" aria-hidden="true" tabindex="-1"></a>bac_carbon_min <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb264-1760"><a href="#cb264-1760" aria-hidden="true" tabindex="-1"></a>bac_carbon_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb264-1761"><a href="#cb264-1761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1762"><a href="#cb264-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1763"><a href="#cb264-1763" aria-hidden="true" tabindex="-1"></a>Import main table with all estimates of cells</span>
<span id="cb264-1764"><a href="#cb264-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1767"><a href="#cb264-1767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1768"><a href="#cb264-1768" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs &lt;- read_delim(file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb264-1769"><a href="#cb264-1769" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb264-1770"><a href="#cb264-1770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1771"><a href="#cb264-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1772"><a href="#cb264-1772" aria-hidden="true" tabindex="-1"></a>RATE_min units = FLPs per grazer per minute Clearance rate <span class="sc">\_</span>ml = ml per grazer per hour</span>
<span id="cb264-1773"><a href="#cb264-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1776"><a href="#cb264-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1777"><a href="#cb264-1777" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb264-1778"><a href="#cb264-1778" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb264-1779"><a href="#cb264-1779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE,  <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, RATE_minute) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1780"><a href="#cb264-1780" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in calcs by fg C per cell.</span></span>
<span id="cb264-1781"><a href="#cb264-1781" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimates of carbon pool of microbes per ml. </span></span>
<span id="cb264-1782"><a href="#cb264-1782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MOR_fgC_ml =</span> bac_carbon_Mor_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb264-1783"><a href="#cb264-1783" aria-hidden="true" tabindex="-1"></a>         <span class="at">LOF_fgC_ml =</span> bac_carbon_Lof_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb264-1784"><a href="#cb264-1784" aria-hidden="true" tabindex="-1"></a>         <span class="at">MEAN_fgC_ml =</span> bac_carbon_mean <span class="sc">*</span> PROK_ml,</span>
<span id="cb264-1785"><a href="#cb264-1785" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_fgC_ml =</span> bac_carbon_max <span class="sc">*</span> PROK_ml,</span>
<span id="cb264-1786"><a href="#cb264-1786" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_fgC_ml =</span> bac_carbon_min <span class="sc">*</span> PROK_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1787"><a href="#cb264-1787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"fgC_ml"</span>), <span class="at">names_to =</span> <span class="st">"prokC_category"</span>, <span class="at">values_to =</span> <span class="st">"fgC_ml"</span>)</span>
<span id="cb264-1788"><a href="#cb264-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1789"><a href="#cb264-1789" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span>
<span id="cb264-1790"><a href="#cb264-1790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1791"><a href="#cb264-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1792"><a href="#cb264-1792" aria-hidden="true" tabindex="-1"></a>Get summary of prokaryotic biomass</span>
<span id="cb264-1793"><a href="#cb264-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1796"><a href="#cb264-1796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1797"><a href="#cb264-1797" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb264-1798"><a href="#cb264-1798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1799"><a href="#cb264-1799" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1800"><a href="#cb264-1800" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1801"><a href="#cb264-1801" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb264-1802"><a href="#cb264-1802" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb264-1803"><a href="#cb264-1803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, prokC_category) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1804"><a href="#cb264-1804" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 fg == 0.001 pg</span></span>
<span id="cb264-1805"><a href="#cb264-1805" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to pg C per ml</span></span>
<span id="cb264-1806"><a href="#cb264-1806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pgC_ml =</span> <span class="fu">mean</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb264-1807"><a href="#cb264-1807" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_pgC_ml =</span> <span class="fu">min</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb264-1808"><a href="#cb264-1808" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_pgC_ml =</span> <span class="fu">max</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>))) </span>
<span id="cb264-1809"><a href="#cb264-1809" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span>
<span id="cb264-1810"><a href="#cb264-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1811"><a href="#cb264-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1812"><a href="#cb264-1812" aria-hidden="true" tabindex="-1"></a><span class="fu">## Incorporate carbon biomass of prey and grazing rate</span></span>
<span id="cb264-1813"><a href="#cb264-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1814"><a href="#cb264-1814" aria-hidden="true" tabindex="-1"></a>Clearance rate is mL per grazer per hour (Table S3).</span>
<span id="cb264-1815"><a href="#cb264-1815" aria-hidden="true" tabindex="-1"></a>Grazing effect is prokaryotes ml-1 hr-1 (Table S3).</span>
<span id="cb264-1818"><a href="#cb264-1818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1819"><a href="#cb264-1819" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon consumed based on clearance rate</span></span>
<span id="cb264-1820"><a href="#cb264-1820" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="ot">&lt;-</span> est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb264-1821"><a href="#cb264-1821" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use only value from Morono et al., convert to pg C per cell.</span></span>
<span id="cb264-1822"><a href="#cb264-1822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prokC_category <span class="sc">==</span> <span class="st">"MOR_fgC_ml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1823"><a href="#cb264-1823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_carbon_Mor_pg =</span> (bac_carbon_Mor_fg <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1824"><a href="#cb264-1824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE, PROK_ml, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, bac_carbon_Mor_pg, fgC_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1825"><a href="#cb264-1825" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clearance rate * fg of prok == pg C per grazer per hr</span></span>
<span id="cb264-1826"><a href="#cb264-1826" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bac_carbon_Mor_pg * grazing effect == pg C per ml per hr</span></span>
<span id="cb264-1827"><a href="#cb264-1827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_pergrazer_CLEARANCE =</span> (fgC_ml<span class="sc">*</span><span class="fl">0.001</span>) <span class="sc">*</span> CLEARANCE_RATE_ml,</span>
<span id="cb264-1828"><a href="#cb264-1828" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_perml_perhr =</span> bac_carbon_Mor_pg <span class="sc">*</span> GRAZING_EFFECT_hr)</span>
<span id="cb264-1829"><a href="#cb264-1829" aria-hidden="true" tabindex="-1"></a>carbon_consumed</span>
<span id="cb264-1830"><a href="#cb264-1830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1831"><a href="#cb264-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1832"><a href="#cb264-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1833"><a href="#cb264-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1834"><a href="#cb264-1834" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environmental parameters - MCR</span></span>
<span id="cb264-1835"><a href="#cb264-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1836"><a href="#cb264-1836" aria-hidden="true" tabindex="-1"></a>Import from Hu et al. (*Molecular Ecology*).</span>
<span id="cb264-1837"><a href="#cb264-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1840"><a href="#cb264-1840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1841"><a href="#cb264-1841" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb264-1842"><a href="#cb264-1842" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb264-1843"><a href="#cb264-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1844"><a href="#cb264-1844" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb264-1845"><a href="#cb264-1845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1846"><a href="#cb264-1846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb264-1847"><a href="#cb264-1847" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb264-1848"><a href="#cb264-1848" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1849"><a href="#cb264-1849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1850"><a href="#cb264-1850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"num"</span>, <span class="st">"loc"</span>, <span class="st">"loc2"</span>, <span class="st">"fluid_origin"</span>, <span class="st">"name"</span>, <span class="st">"FLUID_ORIGIN"</span>, <span class="st">"else"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1851"><a href="#cb264-1851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE,FLUID_ORIGIN, <span class="fu">everything</span>(), <span class="sc">-</span>num, <span class="sc">-</span>loc, <span class="sc">-</span>loc2, <span class="sc">-</span>fluid_origin, <span class="sc">-</span>name, <span class="sc">-</span><span class="st">`</span><span class="at">else</span><span class="st">`</span>)</span>
<span id="cb264-1852"><a href="#cb264-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1853"><a href="#cb264-1853" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb264-1854"><a href="#cb264-1854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1855"><a href="#cb264-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1856"><a href="#cb264-1856" aria-hidden="true" tabindex="-1"></a>Generate supplementary table.</span>
<span id="cb264-1857"><a href="#cb264-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1860"><a href="#cb264-1860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1861"><a href="#cb264-1861" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb264-1862"><a href="#cb264-1862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc, <span class="fu">everything</span>())</span>
<span id="cb264-1863"><a href="#cb264-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1864"><a href="#cb264-1864" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb264-1865"><a href="#cb264-1865" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span>
<span id="cb264-1866"><a href="#cb264-1866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1867"><a href="#cb264-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1868"><a href="#cb264-1868" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis of grazing rate results</span></span>
<span id="cb264-1869"><a href="#cb264-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1870"><a href="#cb264-1870" aria-hidden="true" tabindex="-1"></a>Re-import table from output table with all grazing values</span>
<span id="cb264-1871"><a href="#cb264-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1872"><a href="#cb264-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1873"><a href="#cb264-1873" aria-hidden="true" tabindex="-1"></a>Format and factor values to plot, and prioritize these values:</span>
<span id="cb264-1874"><a href="#cb264-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1875"><a href="#cb264-1875" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing rate column == FLP per minute consumed</span>
<span id="cb264-1876"><a href="#cb264-1876" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing effect hr == cells per ml per hr</span>
<span id="cb264-1877"><a href="#cb264-1877" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</span>
<span id="cb264-1878"><a href="#cb264-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1879"><a href="#cb264-1879" aria-hidden="true" tabindex="-1"></a>Report grazing rates</span>
<span id="cb264-1882"><a href="#cb264-1882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1883"><a href="#cb264-1883" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb264-1884"><a href="#cb264-1884" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb264-1885"><a href="#cb264-1885" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_biov_bysample)</span></span>
<span id="cb264-1886"><a href="#cb264-1886" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_sizefrac_bysample)</span></span>
<span id="cb264-1887"><a href="#cb264-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1888"><a href="#cb264-1888" aria-hidden="true" tabindex="-1"></a><span class="co"># Saved April 29, 2023</span></span>
<span id="cb264-1889"><a href="#cb264-1889" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(table_grazerate_wflp_wprok_weuk, table_wcalcs, pgC_ml_biov_bysample, pgC_ml_sizefrac_bysample, carbon_consumed, <span class="at">file =</span> <span class="st">"output-data/processed-dfs-mcr-grazing.RData"</span>)</span>
<span id="cb264-1890"><a href="#cb264-1890" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/processed-dfs-mcr-grazing.RData"</span>)</span>
<span id="cb264-1891"><a href="#cb264-1891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1892"><a href="#cb264-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1893"><a href="#cb264-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1894"><a href="#cb264-1894" aria-hidden="true" tabindex="-1"></a>Plot grazing rates</span>
<span id="cb264-1897"><a href="#cb264-1897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1898"><a href="#cb264-1898" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb264-1899"><a href="#cb264-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1900"><a href="#cb264-1900" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1901"><a href="#cb264-1901" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb264-1902"><a href="#cb264-1902" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb264-1903"><a href="#cb264-1903" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb264-1904"><a href="#cb264-1904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1905"><a href="#cb264-1905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1906"><a href="#cb264-1906" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb264-1907"><a href="#cb264-1907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1908"><a href="#cb264-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb264-1909"><a href="#cb264-1909" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1910"><a href="#cb264-1910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb264-1911"><a href="#cb264-1911" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-1912"><a href="#cb264-1912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb264-1913"><a href="#cb264-1913" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb264-1914"><a href="#cb264-1914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb264-1915"><a href="#cb264-1915" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb264-1916"><a href="#cb264-1916" aria-hidden="true" tabindex="-1"></a>               <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb264-1917"><a href="#cb264-1917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-1918"><a href="#cb264-1918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-1919"><a href="#cb264-1919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-1920"><a href="#cb264-1920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-1921"><a href="#cb264-1921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-1922"><a href="#cb264-1922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1923"><a href="#cb264-1923" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-1924"><a href="#cb264-1924" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-1925"><a href="#cb264-1925" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb264-1926"><a href="#cb264-1926" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-1927"><a href="#cb264-1927" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-1928"><a href="#cb264-1928" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-1929"><a href="#cb264-1929" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-1930"><a href="#cb264-1930" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-1931"><a href="#cb264-1931" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb264-1932"><a href="#cb264-1932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb264-1933"><a href="#cb264-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1934"><a href="#cb264-1934" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb264-1935"><a href="#cb264-1935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1938"><a href="#cb264-1938" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1939"><a href="#cb264-1939" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>))</span>
<span id="cb264-1940"><a href="#cb264-1940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1941"><a href="#cb264-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1942"><a href="#cb264-1942" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 1 compilation</span></span>
<span id="cb264-1943"><a href="#cb264-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1944"><a href="#cb264-1944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=10}</span></span>
<span id="cb264-1945"><a href="#cb264-1945" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig1.svg", w = 10, h = 8)</span></span>
<span id="cb264-1946"><a href="#cb264-1946" aria-hidden="true" tabindex="-1"></a>  (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb264-1947"><a href="#cb264-1947" aria-hidden="true" tabindex="-1"></a>  (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb264-1948"><a href="#cb264-1948" aria-hidden="true" tabindex="-1"></a>  (grazing_min_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.02</span>))) <span class="sc">+</span></span>
<span id="cb264-1949"><a href="#cb264-1949" aria-hidden="true" tabindex="-1"></a>  (grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-1950"><a href="#cb264-1950" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb264-1951"><a href="#cb264-1951" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-1952"><a href="#cb264-1952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1953"><a href="#cb264-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1954"><a href="#cb264-1954" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grazing rate vs. cells ml</span></span>
<span id="cb264-1955"><a href="#cb264-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1956"><a href="#cb264-1956" aria-hidden="true" tabindex="-1"></a>Combine metadata from environment with grazing rate results.</span>
<span id="cb264-1959"><a href="#cb264-1959" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1960"><a href="#cb264-1960" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb264-1961"><a href="#cb264-1961" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb264-1962"><a href="#cb264-1962" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify fluid origin to match metadata and results</span></span>
<span id="cb264-1963"><a href="#cb264-1963" aria-hidden="true" tabindex="-1"></a>mod_metadata <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb264-1964"><a href="#cb264-1964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-1965"><a href="#cb264-1965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1966"><a href="#cb264-1966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID"</span>, <span class="st">"HOG"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1967"><a href="#cb264-1967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID2"</span>, <span class="st">"excess"</span>), <span class="at">sep =</span> <span class="st">"J2"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1968"><a href="#cb264-1968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(excess, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID3"</span>, <span class="st">"hogexcess"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1969"><a href="#cb264-1969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLUID_ORIGIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1970"><a href="#cb264-1970" aria-hidden="true" tabindex="-1"></a>    FLUID2 <span class="sc">==</span> <span class="st">"CTD003"</span> <span class="sc">~</span> <span class="st">"CTD001"</span>, <span class="co">#Correction for plume VD</span></span>
<span id="cb264-1971"><a href="#cb264-1971" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(FLUID3) <span class="sc">~</span> FLUID2,</span>
<span id="cb264-1972"><a href="#cb264-1972" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"J2-"</span>, FLUID3, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb264-1973"><a href="#cb264-1973" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1974"><a href="#cb264-1974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FLUID, <span class="sc">-</span>FLUID2, <span class="sc">-</span>FLUID3, <span class="sc">-</span>HOG, <span class="sc">-</span>excess, <span class="sc">-</span>hogexcess) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1975"><a href="#cb264-1975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1976"><a href="#cb264-1976" aria-hidden="true" tabindex="-1"></a>    VENT <span class="sc">==</span> <span class="st">"OldManTree"</span> <span class="sc">~</span> <span class="st">"OMT"</span>,</span>
<span id="cb264-1977"><a href="#cb264-1977" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> VENT</span>
<span id="cb264-1978"><a href="#cb264-1978" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb264-1979"><a href="#cb264-1979" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(table_wcalcs$Name)</span></span>
<span id="cb264-1980"><a href="#cb264-1980" aria-hidden="true" tabindex="-1"></a><span class="co"># mod_metadata</span></span>
<span id="cb264-1981"><a href="#cb264-1981" aria-hidden="true" tabindex="-1"></a><span class="co"># setdiff(mod_metadata$FLUID_ORIGIN, table_wcalcs$FLUID_ORIGIN)</span></span>
<span id="cb264-1982"><a href="#cb264-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1983"><a href="#cb264-1983" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb264-1984"><a href="#cb264-1984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, Name, Experiment_rep, FLUID_ORIGIN, RATE_minute, <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-1985"><a href="#cb264-1985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mod_metadata, <span class="fu">join_by</span>(Name <span class="sc">==</span> Name, FLUID_ORIGIN <span class="sc">==</span> FLUID_ORIGIN))</span>
<span id="cb264-1986"><a href="#cb264-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1987"><a href="#cb264-1987" aria-hidden="true" tabindex="-1"></a><span class="co"># View(grazing_wenv)</span></span>
<span id="cb264-1988"><a href="#cb264-1988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-1989"><a href="#cb264-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1990"><a href="#cb264-1990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-1993"><a href="#cb264-1993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-1994"><a href="#cb264-1994" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_metadata)</span></span>
<span id="cb264-1995"><a href="#cb264-1995" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb264-1996"><a href="#cb264-1996" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-1997"><a href="#cb264-1997" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-1998"><a href="#cb264-1998" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-1999"><a href="#cb264-1999" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb264-2000"><a href="#cb264-2000" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2001"><a href="#cb264-2001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2002"><a href="#cb264-2002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2003"><a href="#cb264-2003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, </span>
<span id="cb264-2004"><a href="#cb264-2004" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-2005"><a href="#cb264-2005" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb264-2006"><a href="#cb264-2006" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb264-2007"><a href="#cb264-2007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-2008"><a href="#cb264-2008" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-2009"><a href="#cb264-2009" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(shape = EXP_TYPE), size = 4, stroke = 2) +</span></span>
<span id="cb264-2010"><a href="#cb264-2010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-2011"><a href="#cb264-2011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb264-2012"><a href="#cb264-2012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb264-2013"><a href="#cb264-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb264-2014"><a href="#cb264-2014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb264-2015"><a href="#cb264-2015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb264-2016"><a href="#cb264-2016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-2017"><a href="#cb264-2017" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb264-2018"><a href="#cb264-2018" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb264-2019"><a href="#cb264-2019" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb264-2020"><a href="#cb264-2020" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb264-2021"><a href="#cb264-2021" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2022"><a href="#cb264-2022" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-2023"><a href="#cb264-2023" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb264-2024"><a href="#cb264-2024" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-2025"><a href="#cb264-2025" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-2026"><a href="#cb264-2026" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-2027"><a href="#cb264-2027" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb264-2028"><a href="#cb264-2028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-2029"><a href="#cb264-2029" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb264-2030"><a href="#cb264-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2031"><a href="#cb264-2031" aria-hidden="true" tabindex="-1"></a>euk_temp</span>
<span id="cb264-2032"><a href="#cb264-2032" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2033"><a href="#cb264-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2036"><a href="#cb264-2036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2037"><a href="#cb264-2037" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb264-2038"><a href="#cb264-2038" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2039"><a href="#cb264-2039" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-2040"><a href="#cb264-2040" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-2041"><a href="#cb264-2041" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb264-2042"><a href="#cb264-2042" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2043"><a href="#cb264-2043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2044"><a href="#cb264-2044" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2045"><a href="#cb264-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, </span>
<span id="cb264-2046"><a href="#cb264-2046" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-2047"><a href="#cb264-2047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-2048"><a href="#cb264-2048" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-2049"><a href="#cb264-2049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-2050"><a href="#cb264-2050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb264-2051"><a href="#cb264-2051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb264-2052"><a href="#cb264-2052" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(1, 19)) +</span></span>
<span id="cb264-2053"><a href="#cb264-2053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb264-2054"><a href="#cb264-2054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb264-2055"><a href="#cb264-2055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb264-2056"><a href="#cb264-2056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-2057"><a href="#cb264-2057" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb264-2058"><a href="#cb264-2058" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb264-2059"><a href="#cb264-2059" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb264-2060"><a href="#cb264-2060" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb264-2061"><a href="#cb264-2061" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2062"><a href="#cb264-2062" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-2063"><a href="#cb264-2063" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb264-2064"><a href="#cb264-2064" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-2065"><a href="#cb264-2065" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-2066"><a href="#cb264-2066" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-2067"><a href="#cb264-2067" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb264-2068"><a href="#cb264-2068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Microbial prey cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-2069"><a href="#cb264-2069" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb264-2070"><a href="#cb264-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2071"><a href="#cb264-2071" aria-hidden="true" tabindex="-1"></a>prok_temp</span>
<span id="cb264-2072"><a href="#cb264-2072" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2073"><a href="#cb264-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2074"><a href="#cb264-2074" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 2 compilation</span></span>
<span id="cb264-2075"><a href="#cb264-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2076"><a href="#cb264-2076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=7}</span></span>
<span id="cb264-2077"><a href="#cb264-2077" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2.svg", h = 10, w = 7)</span></span>
<span id="cb264-2078"><a href="#cb264-2078" aria-hidden="true" tabindex="-1"></a>(euk_temp <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> prok_temp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb264-2079"><a href="#cb264-2079" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-2080"><a href="#cb264-2080" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2081"><a href="#cb264-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2082"><a href="#cb264-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2083"><a href="#cb264-2083" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison with Gorda Ridge</span></span>
<span id="cb264-2084"><a href="#cb264-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2085"><a href="#cb264-2085" aria-hidden="true" tabindex="-1"></a>Import data from Gorda Ridge</span>
<span id="cb264-2086"><a href="#cb264-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2089"><a href="#cb264-2089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2090"><a href="#cb264-2090" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb264-2091"><a href="#cb264-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2092"><a href="#cb264-2092" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb264-2093"><a href="#cb264-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2094"><a href="#cb264-2094" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb264-2095"><a href="#cb264-2095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2096"><a href="#cb264-2096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2097"><a href="#cb264-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combine GR and MCR data</span></span>
<span id="cb264-2098"><a href="#cb264-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2101"><a href="#cb264-2101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2102"><a href="#cb264-2102" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb264-2103"><a href="#cb264-2103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-2104"><a href="#cb264-2104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2105"><a href="#cb264-2105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb264-2106"><a href="#cb264-2106" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2107"><a href="#cb264-2107" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2108"><a href="#cb264-2108" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2109"><a href="#cb264-2109" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2110"><a href="#cb264-2110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2111"><a href="#cb264-2111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-2112"><a href="#cb264-2112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb264-2113"><a href="#cb264-2113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb264-2114"><a href="#cb264-2114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb264-2115"><a href="#cb264-2115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb264-2116"><a href="#cb264-2116" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb264-2117"><a href="#cb264-2117" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb264-2118"><a href="#cb264-2118" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb264-2119"><a href="#cb264-2119" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb264-2120"><a href="#cb264-2120" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span>
<span id="cb264-2121"><a href="#cb264-2121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2122"><a href="#cb264-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2123"><a href="#cb264-2123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot combined results</span></span>
<span id="cb264-2124"><a href="#cb264-2124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2127"><a href="#cb264-2127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2128"><a href="#cb264-2128" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb264-2129"><a href="#cb264-2129" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2130"><a href="#cb264-2130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPERIMENTTYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-2131"><a href="#cb264-2131" aria-hidden="true" tabindex="-1"></a>    EXP <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-2132"><a href="#cb264-2132" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb264-2133"><a href="#cb264-2133" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2134"><a href="#cb264-2134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EXPERIMENTTYPE, FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2135"><a href="#cb264-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-2136"><a href="#cb264-2136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE)) <span class="sc">+</span></span>
<span id="cb264-2137"><a href="#cb264-2137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb264-2138"><a href="#cb264-2138" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-2139"><a href="#cb264-2139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE),</span>
<span id="cb264-2140"><a href="#cb264-2140" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb264-2141"><a href="#cb264-2141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb264-2142"><a href="#cb264-2142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#addd8e"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-2143"><a href="#cb264-2143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-2144"><a href="#cb264-2144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-2145"><a href="#cb264-2145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2146"><a href="#cb264-2146" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-2147"><a href="#cb264-2147" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-2148"><a href="#cb264-2148" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb264-2149"><a href="#cb264-2149" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-2150"><a href="#cb264-2150" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-2151"><a href="#cb264-2151" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-2152"><a href="#cb264-2152" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-2153"><a href="#cb264-2153" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2154"><a href="#cb264-2154" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb264-2155"><a href="#cb264-2155" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb264-2156"><a href="#cb264-2156" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb264-2157"><a href="#cb264-2157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb264-2158"><a href="#cb264-2158" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb264-2159"><a href="#cb264-2159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb264-2160"><a href="#cb264-2160" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb264-2161"><a href="#cb264-2161" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_fill_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb264-2162"><a href="#cb264-2162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb264-2163"><a href="#cb264-2163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2164"><a href="#cb264-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2165"><a href="#cb264-2165" aria-hidden="true" tabindex="-1"></a>Add Gorda Ridge comparison to supplementary?</span>
<span id="cb264-2166"><a href="#cb264-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2167"><a href="#cb264-2167" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S7</span></span>
<span id="cb264-2168"><a href="#cb264-2168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=6}</span></span>
<span id="cb264-2169"><a href="#cb264-2169" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates</span></span>
<span id="cb264-2170"><a href="#cb264-2170" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7.svg", h = 4, w = 6)</span></span>
<span id="cb264-2171"><a href="#cb264-2171" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb264-2172"><a href="#cb264-2172" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-2173"><a href="#cb264-2173" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span>
<span id="cb264-2174"><a href="#cb264-2174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2175"><a href="#cb264-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2176"><a href="#cb264-2176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove undetected grazing rate</span></span>
<span id="cb264-2177"><a href="#cb264-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2178"><a href="#cb264-2178" aria-hidden="true" tabindex="-1"></a>Repeat grazing rate plot, but removed undetectable</span>
<span id="cb264-2179"><a href="#cb264-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2182"><a href="#cb264-2182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2183"><a href="#cb264-2183" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb264-2184"><a href="#cb264-2184" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2185"><a href="#cb264-2185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2186"><a href="#cb264-2186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2187"><a href="#cb264-2187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-2188"><a href="#cb264-2188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-2189"><a href="#cb264-2189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb264-2190"><a href="#cb264-2190" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb264-2191"><a href="#cb264-2191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb264-2192"><a href="#cb264-2192" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb264-2193"><a href="#cb264-2193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb264-2194"><a href="#cb264-2194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb264-2195"><a href="#cb264-2195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-2196"><a href="#cb264-2196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-2197"><a href="#cb264-2197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2198"><a href="#cb264-2198" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb264-2199"><a href="#cb264-2199" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-2200"><a href="#cb264-2200" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb264-2201"><a href="#cb264-2201" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb264-2202"><a href="#cb264-2202" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb264-2203"><a href="#cb264-2203" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb264-2204"><a href="#cb264-2204" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-2205"><a href="#cb264-2205" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2206"><a href="#cb264-2206" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb264-2207"><a href="#cb264-2207" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb264-2208"><a href="#cb264-2208" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb264-2209"><a href="#cb264-2209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb264-2210"><a href="#cb264-2210" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb264-2211"><a href="#cb264-2211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb264-2212"><a href="#cb264-2212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2213"><a href="#cb264-2213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2214"><a href="#cb264-2214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=7}</span></span>
<span id="cb264-2215"><a href="#cb264-2215" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb264-2216"><a href="#cb264-2216" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb264-2217"><a href="#cb264-2217" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-2218"><a href="#cb264-2218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2219"><a href="#cb264-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2220"><a href="#cb264-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2221"><a href="#cb264-2221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot variables as a factor of grazing rate.</span></span>
<span id="cb264-2222"><a href="#cb264-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2225"><a href="#cb264-2225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2226"><a href="#cb264-2226" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grazing_wenv)</span>
<span id="cb264-2227"><a href="#cb264-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2228"><a href="#cb264-2228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2229"><a href="#cb264-2229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2230"><a href="#cb264-2230" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure S6</span></span>
<span id="cb264-2231"><a href="#cb264-2231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=10}</span></span>
<span id="cb264-2232"><a href="#cb264-2232" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6.svg", h = 8, w = 10)</span></span>
<span id="cb264-2233"><a href="#cb264-2233" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb264-2234"><a href="#cb264-2234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2235"><a href="#cb264-2235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb264-2236"><a href="#cb264-2236" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb264-2237"><a href="#cb264-2237" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb264-2238"><a href="#cb264-2238" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2239"><a href="#cb264-2239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2240"><a href="#cb264-2240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2241"><a href="#cb264-2241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EUK_ml =</span> <span class="fu">as.character</span>(EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2242"><a href="#cb264-2242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">as.character</span>(PROK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb264-2243"><a href="#cb264-2243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.character</span>(temp),</span>
<span id="cb264-2244"><a href="#cb264-2244" aria-hidden="true" tabindex="-1"></a>         <span class="at">pH =</span> <span class="fu">as.character</span>(pH),</span>
<span id="cb264-2245"><a href="#cb264-2245" aria-hidden="true" tabindex="-1"></a>         <span class="at">mg =</span> <span class="fu">as.character</span>(mg),</span>
<span id="cb264-2246"><a href="#cb264-2246" aria-hidden="true" tabindex="-1"></a>         <span class="at">h2 =</span> <span class="fu">as.character</span>(h2),</span>
<span id="cb264-2247"><a href="#cb264-2247" aria-hidden="true" tabindex="-1"></a>         <span class="at">ch4 =</span> <span class="fu">as.character</span>(ch4),</span>
<span id="cb264-2248"><a href="#cb264-2248" aria-hidden="true" tabindex="-1"></a>         <span class="at">percseawater =</span> <span class="fu">as.character</span>(percseawater)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2249"><a href="#cb264-2249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE_TYPE, SiteOrder, EXP_TYPE, Experiment_rep, GRAZING_EFFECT_hr, EUK_ml, PROK_ml, temp, DEPTH, pH, percseawater, mg, h2, ch4) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2250"><a href="#cb264-2250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> EUK_ml<span class="sc">:</span>ch4, <span class="at">values_to =</span> <span class="st">"VALUES"</span>, <span class="at">values_ptypes =</span> <span class="fu">list</span>(<span class="at">VALUES =</span> <span class="fu">character</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2251"><a href="#cb264-2251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VALUES =</span> <span class="fu">as.numeric</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2252"><a href="#cb264-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-2253"><a href="#cb264-2253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> VALUES, </span>
<span id="cb264-2254"><a href="#cb264-2254" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb264-2255"><a href="#cb264-2255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-2256"><a href="#cb264-2256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb264-2257"><a href="#cb264-2257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb264-2258"><a href="#cb264-2258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb264-2259"><a href="#cb264-2259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb264-2260"><a href="#cb264-2260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-2261"><a href="#cb264-2261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb264-2262"><a href="#cb264-2262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-2263"><a href="#cb264-2263" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2264"><a href="#cb264-2264" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb264-2265"><a href="#cb264-2265" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb264-2266"><a href="#cb264-2266" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-2267"><a href="#cb264-2267" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb264-2268"><a href="#cb264-2268" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb264-2269"><a href="#cb264-2269" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb264-2270"><a href="#cb264-2270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb264-2271"><a href="#cb264-2271" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb264-2272"><a href="#cb264-2272" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb264-2273"><a href="#cb264-2273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2274"><a href="#cb264-2274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2275"><a href="#cb264-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2276"><a href="#cb264-2276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2277"><a href="#cb264-2277" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear regression &amp; tidy models</span></span>
<span id="cb264-2278"><a href="#cb264-2278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2279"><a href="#cb264-2279" aria-hidden="true" tabindex="-1"></a>Use tidymodels to perform linear regression.</span>
<span id="cb264-2280"><a href="#cb264-2280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2281"><a href="#cb264-2281" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR and GR data as input</span></span>
<span id="cb264-2282"><a href="#cb264-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2285"><a href="#cb264-2285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2286"><a href="#cb264-2286" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb264-2287"><a href="#cb264-2287" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb264-2288"><a href="#cb264-2288" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb264-2289"><a href="#cb264-2289" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb264-2290"><a href="#cb264-2290" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span></span>
<span id="cb264-2291"><a href="#cb264-2291" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;%</span></span>
<span id="cb264-2292"><a href="#cb264-2292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span></span>
<span id="cb264-2293"><a href="#cb264-2293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span></span>
<span id="cb264-2294"><a href="#cb264-2294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb264-2295"><a href="#cb264-2295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-2296"><a href="#cb264-2296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-2297"><a href="#cb264-2297" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2298"><a href="#cb264-2298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2299"><a href="#cb264-2299" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb264-2300"><a href="#cb264-2300" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb264-2301"><a href="#cb264-2301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb264-2302"><a href="#cb264-2302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb264-2303"><a href="#cb264-2303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb264-2304"><a href="#cb264-2304" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb264-2305"><a href="#cb264-2305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb264-2306"><a href="#cb264-2306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS,</span>
<span id="cb264-2307"><a href="#cb264-2307" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb264-2308"><a href="#cb264-2308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb264-2309"><a href="#cb264-2309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb264-2310"><a href="#cb264-2310" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2311"><a href="#cb264-2311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2312"><a href="#cb264-2312" aria-hidden="true" tabindex="-1"></a>regression_results <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb264-2313"><a href="#cb264-2313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb264-2314"><a href="#cb264-2314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb264-2315"><a href="#cb264-2315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb264-2316"><a href="#cb264-2316" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span></span>
<span id="cb264-2317"><a href="#cb264-2317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span></span>
<span id="cb264-2318"><a href="#cb264-2318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb264-2319"><a href="#cb264-2319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb264-2320"><a href="#cb264-2320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb264-2321"><a href="#cb264-2321" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2322"><a href="#cb264-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2323"><a href="#cb264-2323" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span>
<span id="cb264-2324"><a href="#cb264-2324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2325"><a href="#cb264-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2326"><a href="#cb264-2326" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb264-2327"><a href="#cb264-2327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2328"><a href="#cb264-2328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb264-2329"><a href="#cb264-2329" aria-hidden="true" tabindex="-1"></a>regression_results <span class="sc">%&gt;%</span></span>
<span id="cb264-2330"><a href="#cb264-2330" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb264-2331"><a href="#cb264-2331" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;%</span></span>
<span id="cb264-2332"><a href="#cb264-2332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2333"><a href="#cb264-2333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb264-2334"><a href="#cb264-2334" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2335"><a href="#cb264-2335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb264-2336"><a href="#cb264-2336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb264-2337"><a href="#cb264-2337" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb264-2338"><a href="#cb264-2338" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb264-2339"><a href="#cb264-2339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb264-2340"><a href="#cb264-2340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb264-2341"><a href="#cb264-2341" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2342"><a href="#cb264-2342" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb264-2343"><a href="#cb264-2343" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-2344"><a href="#cb264-2344" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-2345"><a href="#cb264-2345" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb264-2346"><a href="#cb264-2346" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Temperature (C)"</span>)</span>
<span id="cb264-2347"><a href="#cb264-2347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2348"><a href="#cb264-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2349"><a href="#cb264-2349" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR only</span></span>
<span id="cb264-2350"><a href="#cb264-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2351"><a href="#cb264-2351" aria-hidden="true" tabindex="-1"></a>repeat MCR only</span>
<span id="cb264-2352"><a href="#cb264-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2355"><a href="#cb264-2355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2356"><a href="#cb264-2356" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb264-2357"><a href="#cb264-2357" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb264-2358"><a href="#cb264-2358" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb264-2359"><a href="#cb264-2359" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2360"><a href="#cb264-2360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2361"><a href="#cb264-2361" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb264-2362"><a href="#cb264-2362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2363"><a href="#cb264-2363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2364"><a href="#cb264-2364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2365"><a href="#cb264-2365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2366"><a href="#cb264-2366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2367"><a href="#cb264-2367" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2368"><a href="#cb264-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2369"><a href="#cb264-2369" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb264-2370"><a href="#cb264-2370" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb264-2371"><a href="#cb264-2371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2372"><a href="#cb264-2372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2373"><a href="#cb264-2373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb264-2374"><a href="#cb264-2374" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2375"><a href="#cb264-2375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2376"><a href="#cb264-2376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb264-2377"><a href="#cb264-2377" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2378"><a href="#cb264-2378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2379"><a href="#cb264-2379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb264-2380"><a href="#cb264-2380" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2381"><a href="#cb264-2381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2382"><a href="#cb264-2382" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb264-2383"><a href="#cb264-2383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2384"><a href="#cb264-2384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2385"><a href="#cb264-2385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb264-2386"><a href="#cb264-2386" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2387"><a href="#cb264-2387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2388"><a href="#cb264-2388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2389"><a href="#cb264-2389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb264-2390"><a href="#cb264-2390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb264-2391"><a href="#cb264-2391" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2392"><a href="#cb264-2392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2393"><a href="#cb264-2393" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_mcr)</span></span>
<span id="cb264-2394"><a href="#cb264-2394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2395"><a href="#cb264-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2396"><a href="#cb264-2396" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb264-2397"><a href="#cb264-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2398"><a href="#cb264-2398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb264-2399"><a href="#cb264-2399" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="sc">%&gt;%</span> </span>
<span id="cb264-2400"><a href="#cb264-2400" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb264-2401"><a href="#cb264-2401" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb264-2402"><a href="#cb264-2402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2403"><a href="#cb264-2403" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb264-2404"><a href="#cb264-2404" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2405"><a href="#cb264-2405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb264-2406"><a href="#cb264-2406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb264-2407"><a href="#cb264-2407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb264-2408"><a href="#cb264-2408" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb264-2409"><a href="#cb264-2409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb264-2410"><a href="#cb264-2410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb264-2411"><a href="#cb264-2411" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2412"><a href="#cb264-2412" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb264-2413"><a href="#cb264-2413" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-2414"><a href="#cb264-2414" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-2415"><a href="#cb264-2415" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb264-2416"><a href="#cb264-2416" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb264-2417"><a href="#cb264-2417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2418"><a href="#cb264-2418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2419"><a href="#cb264-2419" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR vent sites only</span></span>
<span id="cb264-2420"><a href="#cb264-2420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2421"><a href="#cb264-2421" aria-hidden="true" tabindex="-1"></a>Repeat with only vent sites &amp; remove undetected grazing.</span>
<span id="cb264-2422"><a href="#cb264-2422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2425"><a href="#cb264-2425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2426"><a href="#cb264-2426" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb264-2427"><a href="#cb264-2427" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb264-2428"><a href="#cb264-2428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2429"><a href="#cb264-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2432"><a href="#cb264-2432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2433"><a href="#cb264-2433" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb264-2434"><a href="#cb264-2434" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb264-2435"><a href="#cb264-2435" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb264-2436"><a href="#cb264-2436" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2437"><a href="#cb264-2437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2438"><a href="#cb264-2438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Background"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Plume"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2439"><a href="#cb264-2439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2440"><a href="#cb264-2440" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb264-2441"><a href="#cb264-2441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2442"><a href="#cb264-2442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2443"><a href="#cb264-2443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2444"><a href="#cb264-2444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2445"><a href="#cb264-2445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2446"><a href="#cb264-2446" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2447"><a href="#cb264-2447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2448"><a href="#cb264-2448" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb264-2449"><a href="#cb264-2449" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb264-2450"><a href="#cb264-2450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2451"><a href="#cb264-2451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2452"><a href="#cb264-2452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb264-2453"><a href="#cb264-2453" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2454"><a href="#cb264-2454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2455"><a href="#cb264-2455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb264-2456"><a href="#cb264-2456" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2457"><a href="#cb264-2457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2458"><a href="#cb264-2458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb264-2459"><a href="#cb264-2459" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2460"><a href="#cb264-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2461"><a href="#cb264-2461" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb264-2462"><a href="#cb264-2462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2463"><a href="#cb264-2463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2464"><a href="#cb264-2464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb264-2465"><a href="#cb264-2465" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2466"><a href="#cb264-2466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2467"><a href="#cb264-2467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2468"><a href="#cb264-2468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb264-2469"><a href="#cb264-2469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb264-2470"><a href="#cb264-2470" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb264-2471"><a href="#cb264-2471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2472"><a href="#cb264-2472" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_vent)</span></span>
<span id="cb264-2473"><a href="#cb264-2473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2474"><a href="#cb264-2474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2475"><a href="#cb264-2475" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb264-2476"><a href="#cb264-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2477"><a href="#cb264-2477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb264-2478"><a href="#cb264-2478" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="sc">%&gt;%</span> </span>
<span id="cb264-2479"><a href="#cb264-2479" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb264-2480"><a href="#cb264-2480" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb264-2481"><a href="#cb264-2481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2482"><a href="#cb264-2482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb264-2483"><a href="#cb264-2483" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2484"><a href="#cb264-2484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb264-2485"><a href="#cb264-2485" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb264-2486"><a href="#cb264-2486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb264-2487"><a href="#cb264-2487" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb264-2488"><a href="#cb264-2488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb264-2489"><a href="#cb264-2489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb264-2490"><a href="#cb264-2490" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-2491"><a href="#cb264-2491" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb264-2492"><a href="#cb264-2492" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-2493"><a href="#cb264-2493" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb264-2494"><a href="#cb264-2494" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb264-2495"><a href="#cb264-2495" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb264-2496"><a href="#cb264-2496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2497"><a href="#cb264-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2498"><a href="#cb264-2498" aria-hidden="true" tabindex="-1"></a>*Regression thoughts*: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</span>
<span id="cb264-2499"><a href="#cb264-2499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2500"><a href="#cb264-2500" aria-hidden="true" tabindex="-1"></a>Bacterial abundance typically increases with temperature (White et al. 1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</span>
<span id="cb264-2501"><a href="#cb264-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2502"><a href="#cb264-2502" aria-hidden="true" tabindex="-1"></a>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature... in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</span>
<span id="cb264-2503"><a href="#cb264-2503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2506"><a href="#cb264-2506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2507"><a href="#cb264-2507" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb264-2508"><a href="#cb264-2508" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2509"><a href="#cb264-2509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb264-2510"><a href="#cb264-2510" aria-hidden="true" tabindex="-1"></a><span class="co"># head(allvent_data)</span></span>
<span id="cb264-2511"><a href="#cb264-2511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2512"><a href="#cb264-2512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2513"><a href="#cb264-2513" aria-hidden="true" tabindex="-1"></a>Function to plot results by two parameters.</span>
<span id="cb264-2514"><a href="#cb264-2514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2517"><a href="#cb264-2517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2518"><a href="#cb264-2518" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb264-2519"><a href="#cb264-2519" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb264-2520"><a href="#cb264-2520" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb264-2521"><a href="#cb264-2521" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb264-2522"><a href="#cb264-2522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2523"><a href="#cb264-2523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-2524"><a href="#cb264-2524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb264-2525"><a href="#cb264-2525" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-2526"><a href="#cb264-2526" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2527"><a href="#cb264-2527" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-2528"><a href="#cb264-2528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb264-2529"><a href="#cb264-2529" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-2530"><a href="#cb264-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2531"><a href="#cb264-2531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2532"><a href="#cb264-2532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2533"><a href="#cb264-2533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by euk:prok and then euk and prok</span></span>
<span id="cb264-2534"><a href="#cb264-2534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2537"><a href="#cb264-2537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2538"><a href="#cb264-2538" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span>
<span id="cb264-2539"><a href="#cb264-2539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2540"><a href="#cb264-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2541"><a href="#cb264-2541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by grazing rate</span></span>
<span id="cb264-2542"><a href="#cb264-2542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2545"><a href="#cb264-2545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2546"><a href="#cb264-2546" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span>
<span id="cb264-2547"><a href="#cb264-2547" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb264-2548"><a href="#cb264-2548" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, EUK_ml, "ugC_L_perday", "Euk cells per ml") + scale_y_log10()</span></span>
<span id="cb264-2549"><a href="#cb264-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2550"><a href="#cb264-2550" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span>
<span id="cb264-2551"><a href="#cb264-2551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2552"><a href="#cb264-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2553"><a href="#cb264-2553" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass investigation</span></span>
<span id="cb264-2554"><a href="#cb264-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2557"><a href="#cb264-2557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2558"><a href="#cb264-2558" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb264-2559"><a href="#cb264-2559" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span>
<span id="cb264-2560"><a href="#cb264-2560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2561"><a href="#cb264-2561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2562"><a href="#cb264-2562" aria-hidden="true" tabindex="-1"></a>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</span>
<span id="cb264-2563"><a href="#cb264-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2566"><a href="#cb264-2566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2567"><a href="#cb264-2567" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb264-2568"><a href="#cb264-2568" aria-hidden="true" tabindex="-1"></a><span class="co"># carbon_density &lt;- crossing(fgC_cell = seq(86, 300, by = 1), </span></span>
<span id="cb264-2569"><a href="#cb264-2569" aria-hidden="true" tabindex="-1"></a><span class="co">#                              GRAZING_EFFECT_hr = seq(min(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb264-2570"><a href="#cb264-2570" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   max(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb264-2571"><a href="#cb264-2571" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   length.out = 215))  %&gt;%</span></span>
<span id="cb264-2572"><a href="#cb264-2572" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb264-2573"><a href="#cb264-2573" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb264-2574"><a href="#cb264-2574" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;%</span></span>
<span id="cb264-2575"><a href="#cb264-2575" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb264-2576"><a href="#cb264-2576" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb264-2577"><a href="#cb264-2577" aria-hidden="true" tabindex="-1"></a><span class="co"># # unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb264-2578"><a href="#cb264-2578" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb264-2579"><a href="#cb264-2579" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_lines &lt;- select(all_vents, GRAZING_EFFECT_hr, FIELD) %&gt;% </span></span>
<span id="cb264-2580"><a href="#cb264-2580" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;% </span></span>
<span id="cb264-2581"><a href="#cb264-2581" aria-hidden="true" tabindex="-1"></a><span class="co">#   crossing(fgC_cell = seq(86, 300, by = 20)) %&gt;%</span></span>
<span id="cb264-2582"><a href="#cb264-2582" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb264-2583"><a href="#cb264-2583" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb264-2584"><a href="#cb264-2584" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb264-2585"><a href="#cb264-2585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2586"><a href="#cb264-2586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2589"><a href="#cb264-2589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2590"><a href="#cb264-2590" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(carbon_density, aes(x = fgC_cell, y = GRAZING_EFFECT_hr)) +</span></span>
<span id="cb264-2591"><a href="#cb264-2591" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_raster(aes(fill = ugC_L_perday)) +</span></span>
<span id="cb264-2592"><a href="#cb264-2592" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_gradientn(colors = c("#fef0d9", "#b30000"), name = bquote("ug C"~L^-1 ~day^-1)) +</span></span>
<span id="cb264-2593"><a href="#cb264-2593" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb264-2594"><a href="#cb264-2594" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(expand = c(0,0)) +</span></span>
<span id="cb264-2595"><a href="#cb264-2595" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(expand = c(0,0)) +</span></span>
<span id="cb264-2596"><a href="#cb264-2596" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb264-2597"><a href="#cb264-2597" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black"),</span></span>
<span id="cb264-2598"><a href="#cb264-2598" aria-hidden="true" tabindex="-1"></a><span class="co">#         rect = element_rect(fill = "transparent"),</span></span>
<span id="cb264-2599"><a href="#cb264-2599" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb264-2600"><a href="#cb264-2600" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill = "transparent", color = NA)) +</span></span>
<span id="cb264-2601"><a href="#cb264-2601" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = bquote("Cells "~mL^-1 ~consumed ~hr^-1), x = bquote("fg C"~cell^-1)) +</span></span>
<span id="cb264-2602"><a href="#cb264-2602" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = samples_lines,</span></span>
<span id="cb264-2603"><a href="#cb264-2603" aria-hidden="true" tabindex="-1"></a><span class="co">#             aes(x = 87,</span></span>
<span id="cb264-2604"><a href="#cb264-2604" aria-hidden="true" tabindex="-1"></a><span class="co">#             y = GRAZING_EFFECT_hr, shape = FIELD), size = 1)</span></span>
<span id="cb264-2605"><a href="#cb264-2605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2606"><a href="#cb264-2606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2607"><a href="#cb264-2607" aria-hidden="true" tabindex="-1"></a>Eukaryote biomass comparison with measured vs. literature</span>
<span id="cb264-2608"><a href="#cb264-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2611"><a href="#cb264-2611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2612"><a href="#cb264-2612" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb264-2613"><a href="#cb264-2613" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata &lt;- env_params %&gt;% </span></span>
<span id="cb264-2614"><a href="#cb264-2614" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(SAMPLETYPE != "Incubation") %&gt;%</span></span>
<span id="cb264-2615"><a href="#cb264-2615" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(VENT != "Quakeplume") %&gt;% </span></span>
<span id="cb264-2616"><a href="#cb264-2616" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, starts_with("PROK_"), starts_with("EUK_"), starts_with("GRAZING_EFFECT_hr"))</span></span>
<span id="cb264-2617"><a href="#cb264-2617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2618"><a href="#cb264-2618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2619"><a href="#cb264-2619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=5}</span></span>
<span id="cb264-2620"><a href="#cb264-2620" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb264-2621"><a href="#cb264-2621" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata %&gt;% </span></span>
<span id="cb264-2622"><a href="#cb264-2622" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Euk_biomass_Hu)) %&gt;% </span></span>
<span id="cb264-2623"><a href="#cb264-2623" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Euk_biomass_Hu_fg = Euk_biomass_Hu * 1000000000,</span></span>
<span id="cb264-2624"><a href="#cb264-2624" aria-hidden="true" tabindex="-1"></a><span class="co">#          Euk_biomass_lit_fg = Euk_biomass_lit * 1000000000) %&gt;% </span></span>
<span id="cb264-2625"><a href="#cb264-2625" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = VENT)) +</span></span>
<span id="cb264-2626"><a href="#cb264-2626" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_Hu_fg), color = "black", fill = "darkgreen", shape = 21, size = 4) +</span></span>
<span id="cb264-2627"><a href="#cb264-2627" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_lit), color = "black", fill = "lightgreen", shape = 21, size = 4) +</span></span>
<span id="cb264-2628"><a href="#cb264-2628" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb264-2629"><a href="#cb264-2629" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb264-2630"><a href="#cb264-2630" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black")) +</span></span>
<span id="cb264-2631"><a href="#cb264-2631" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(SAMPLETYPE ~ ., space = "free", scales = "free") +</span></span>
<span id="cb264-2632"><a href="#cb264-2632" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "fg C of eukaryote population", y = "")</span></span>
<span id="cb264-2633"><a href="#cb264-2633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2634"><a href="#cb264-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2635"><a href="#cb264-2635" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction of MCR data with parameters</span></span>
<span id="cb264-2636"><a href="#cb264-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2637"><a href="#cb264-2637" aria-hidden="true" tabindex="-1"></a>Best model to estimate community grazing rate in Vaque et al. considered FLP uptake and similar experiments (in contrast to disappearance experiments).</span>
<span id="cb264-2638"><a href="#cb264-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2639"><a href="#cb264-2639" aria-hidden="true" tabindex="-1"></a>From Vaque et al. 1994 paper equation (1):</span>
<span id="cb264-2640"><a href="#cb264-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2641"><a href="#cb264-2641" aria-hidden="true" tabindex="-1"></a>See Figure 6</span>
<span id="cb264-2642"><a href="#cb264-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2643"><a href="#cb264-2643" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</span></span>
<span id="cb264-2644"><a href="#cb264-2644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2645"><a href="#cb264-2645" aria-hidden="true" tabindex="-1"></a>*GT* = grazing rate (cells ml-1 hr-1) *HNF* = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) *BAC* = prokaryote abundance (cells ml-1)</span>
<span id="cb264-2646"><a href="#cb264-2646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2647"><a href="#cb264-2647" aria-hidden="true" tabindex="-1"></a>Start with non-zero grazing rate values, etc. Where... *GT* == Grazing effect hr *HNF* == Euk_ml *BAC* == PROK_ml *T* == highest temp</span>
<span id="cb264-2648"><a href="#cb264-2648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2649"><a href="#cb264-2649" aria-hidden="true" tabindex="-1"></a>We only have these for MCR data.. can include GR for the "predicting euk_ml"</span>
<span id="cb264-2650"><a href="#cb264-2650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2651"><a href="#cb264-2651" aria-hidden="true" tabindex="-1"></a>Function to use above formula and estimate</span>
<span id="cb264-2652"><a href="#cb264-2652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2655"><a href="#cb264-2655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2656"><a href="#cb264-2656" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb264-2657"><a href="#cb264-2657" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb264-2658"><a href="#cb264-2658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2659"><a href="#cb264-2659" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2660"><a href="#cb264-2660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2661"><a href="#cb264-2661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2662"><a href="#cb264-2662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-2663"><a href="#cb264-2663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb264-2664"><a href="#cb264-2664" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb264-2665"><a href="#cb264-2665" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb264-2666"><a href="#cb264-2666" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb264-2667"><a href="#cb264-2667" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb264-2668"><a href="#cb264-2668" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2669"><a href="#cb264-2669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb264-2670"><a href="#cb264-2670" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2671"><a href="#cb264-2671" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2672"><a href="#cb264-2672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb264-2673"><a href="#cb264-2673" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2674"><a href="#cb264-2674" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2675"><a href="#cb264-2675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb264-2676"><a href="#cb264-2676" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2677"><a href="#cb264-2677" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2678"><a href="#cb264-2678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb264-2679"><a href="#cb264-2679" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2680"><a href="#cb264-2680" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2681"><a href="#cb264-2681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb264-2682"><a href="#cb264-2682" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2683"><a href="#cb264-2683" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2684"><a href="#cb264-2684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb264-2685"><a href="#cb264-2685" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2686"><a href="#cb264-2686" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2687"><a href="#cb264-2687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb264-2688"><a href="#cb264-2688" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2689"><a href="#cb264-2689" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb264-2690"><a href="#cb264-2690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb264-2691"><a href="#cb264-2691" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-2692"><a href="#cb264-2692" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb264-2693"><a href="#cb264-2693" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb264-2694"><a href="#cb264-2694" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb264-2695"><a href="#cb264-2695" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb264-2696"><a href="#cb264-2696" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb264-2697"><a href="#cb264-2697" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span>
<span id="cb264-2698"><a href="#cb264-2698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2699"><a href="#cb264-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2700"><a href="#cb264-2700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=, fig.height=6, fig.width=12}</span></span>
<span id="cb264-2701"><a href="#cb264-2701" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span>
<span id="cb264-2702"><a href="#cb264-2702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2703"><a href="#cb264-2703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2704"><a href="#cb264-2704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb264-2705"><a href="#cb264-2705" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb264-2706"><a href="#cb264-2706" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb264-2707"><a href="#cb264-2707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2708"><a href="#cb264-2708" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb264-2709"><a href="#cb264-2709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2710"><a href="#cb264-2710" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0), "Mid-Cayman Rise only, no undetected")</span></span>
<span id="cb264-2711"><a href="#cb264-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2712"><a href="#cb264-2712" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)), <span class="st">"Mid-Cayman Rise only, no undetected, vents only"</span>)</span>
<span id="cb264-2713"><a href="#cb264-2713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2714"><a href="#cb264-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2715"><a href="#cb264-2715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb264-2716"><a href="#cb264-2716" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb264-2717"><a href="#cb264-2717" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb264-2718"><a href="#cb264-2718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2719"><a href="#cb264-2719" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span>
<span id="cb264-2720"><a href="#cb264-2720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2721"><a href="#cb264-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2722"><a href="#cb264-2722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb264-2723"><a href="#cb264-2723" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb264-2724"><a href="#cb264-2724" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2725"><a href="#cb264-2725" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2726"><a href="#cb264-2726" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2727"><a href="#cb264-2727" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb264-2728"><a href="#cb264-2728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2729"><a href="#cb264-2729" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2730"><a href="#cb264-2730" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2731"><a href="#cb264-2731" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb264-2732"><a href="#cb264-2732" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb264-2733"><a href="#cb264-2733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2734"><a href="#cb264-2734" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb264-2735"><a href="#cb264-2735" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb264-2736"><a href="#cb264-2736" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb264-2737"><a href="#cb264-2737" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb264-2738"><a href="#cb264-2738" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span>
<span id="cb264-2739"><a href="#cb264-2739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2740"><a href="#cb264-2740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2743"><a href="#cb264-2743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2744"><a href="#cb264-2744" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span>
<span id="cb264-2745"><a href="#cb264-2745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2746"><a href="#cb264-2746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2747"><a href="#cb264-2747" aria-hidden="true" tabindex="-1"></a>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</span>
<span id="cb264-2748"><a href="#cb264-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2749"><a href="#cb264-2749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb264-2750"><a href="#cb264-2750" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2751"><a href="#cb264-2751" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb264-2752"><a href="#cb264-2752" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span>
<span id="cb264-2753"><a href="#cb264-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2754"><a href="#cb264-2754" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2755"><a href="#cb264-2755" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb264-2756"><a href="#cb264-2756" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span>
<span id="cb264-2757"><a href="#cb264-2757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2758"><a href="#cb264-2758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2759"><a href="#cb264-2759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb264-2760"><a href="#cb264-2760" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2761"><a href="#cb264-2761" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-2762"><a href="#cb264-2762" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span>
<span id="cb264-2763"><a href="#cb264-2763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2764"><a href="#cb264-2764" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb264-2765"><a href="#cb264-2765" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb264-2766"><a href="#cb264-2766" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span>
<span id="cb264-2767"><a href="#cb264-2767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb264-2768"><a href="#cb264-2768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2769"><a href="#cb264-2769" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session</span></span>
<span id="cb264-2770"><a href="#cb264-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-2773"><a href="#cb264-2773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb264-2774"><a href="#cb264-2774" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb264-2775"><a href="#cb264-2775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>