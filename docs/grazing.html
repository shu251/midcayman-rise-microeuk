<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mid-Cayman Rise analysis - Protistan grazing analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Mid-Cayman Rise analysis</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./grazing.html" aria-current="page">Grazing analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./asv-analysis.html">Sequence analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sequence-qc.html">Sequence QC &amp; import</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-format-data" id="toc-import-format-data" class="nav-link active" data-scroll-target="#import-format-data"><span class="toc-section-number">1</span>  Import &amp; format data</a>
  <ul class="collapse">
  <li><a href="#set-up-working-r-environment" id="toc-set-up-working-r-environment" class="nav-link" data-scroll-target="#set-up-working-r-environment"><span class="toc-section-number">1.1</span>  Set up working R environment</a></li>
  <li><a href="#import-raw-count-data" id="toc-import-raw-count-data" class="nav-link" data-scroll-target="#import-raw-count-data"><span class="toc-section-number">1.2</span>  Import raw count data</a></li>
  </ul></li>
  <li><a href="#calculate-cells-per-ml-euk" id="toc-calculate-cells-per-ml-euk" class="nav-link" data-scroll-target="#calculate-cells-per-ml-euk"><span class="toc-section-number">2</span>  Calculate cells per ml (euk)</a>
  <ul class="collapse">
  <li><a href="#plot-eukaryote-cells-per-ml" id="toc-plot-eukaryote-cells-per-ml" class="nav-link" data-scroll-target="#plot-eukaryote-cells-per-ml"><span class="toc-section-number">2.1</span>  Plot eukaryote cells per ml</a></li>
  <li><a href="#isolate-t0-only-counts-for-cellsml-plot" id="toc-isolate-t0-only-counts-for-cellsml-plot" class="nav-link" data-scroll-target="#isolate-t0-only-counts-for-cellsml-plot"><span class="toc-section-number">2.2</span>  Isolate T0 only counts for cells/ml plot</a></li>
  </ul></li>
  <li><a href="#bacteria-archaea-cell-counts" id="toc-bacteria-archaea-cell-counts" class="nav-link" data-scroll-target="#bacteria-archaea-cell-counts"><span class="toc-section-number">3</span>  Bacteria &amp; archaea cell counts</a>
  <ul class="collapse">
  <li><a href="#cells-per-ml-prok" id="toc-cells-per-ml-prok" class="nav-link" data-scroll-target="#cells-per-ml-prok"><span class="toc-section-number">3.1</span>  Cells per ml (prok)</a>
  <ul class="collapse">
  <li><a href="#euk-and-prok-counts" id="toc-euk-and-prok-counts" class="nav-link" data-scroll-target="#euk-and-prok-counts">Euk and prok counts</a></li>
  <li><a href="#combine-with-previous-mcr-cell-counts" id="toc-combine-with-previous-mcr-cell-counts" class="nav-link" data-scroll-target="#combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimate-grazing-effect" id="toc-estimate-grazing-effect" class="nav-link" data-scroll-target="#estimate-grazing-effect"><span class="toc-section-number">4</span>  Estimate grazing effect</a>
  <ul class="collapse">
  <li><a href="#determine-flp-per-euk-cell" id="toc-determine-flp-per-euk-cell" class="nav-link" data-scroll-target="#determine-flp-per-euk-cell"><span class="toc-section-number">4.1</span>  Determine FLP per euk cell</a></li>
  <li><a href="#calculate-flp-per-euk-cell-calculation" id="toc-calculate-flp-per-euk-cell-calculation" class="nav-link" data-scroll-target="#calculate-flp-per-euk-cell-calculation"><span class="toc-section-number">4.2</span>  Calculate FLP per euk cell calculation</a></li>
  <li><a href="#calculate-linear-regression-to-obtain-slope" id="toc-calculate-linear-regression-to-obtain-slope" class="nav-link" data-scroll-target="#calculate-linear-regression-to-obtain-slope"><span class="toc-section-number">4.3</span>  Calculate linear regression to obtain slope</a>
  <ul class="collapse">
  <li><a href="#plot-linear-regression-trend" id="toc-plot-linear-regression-trend" class="nav-link" data-scroll-target="#plot-linear-regression-trend">Plot linear regression trend</a></li>
  </ul></li>
  <li><a href="#remove-igt-tf-time-points." id="toc-remove-igt-tf-time-points." class="nav-link" data-scroll-target="#remove-igt-tf-time-points."><span class="toc-section-number">4.4</span>  Remove IGT Tf time points.</a></li>
  <li><a href="#compile-and-save-grazing-experiment-results" id="toc-compile-and-save-grazing-experiment-results" class="nav-link" data-scroll-target="#compile-and-save-grazing-experiment-results"><span class="toc-section-number">4.5</span>  Compile and save grazing experiment results</a></li>
  </ul></li>
  <li><a href="#check-flp-control-experiments" id="toc-check-flp-control-experiments" class="nav-link" data-scroll-target="#check-flp-control-experiments"><span class="toc-section-number">5</span>  Check FLP control experiments</a>
  <ul class="collapse">
  <li><a href="#bag-grazing-experiment-controls" id="toc-bag-grazing-experiment-controls" class="nav-link" data-scroll-target="#bag-grazing-experiment-controls"><span class="toc-section-number">5.1</span>  Bag grazing experiment controls</a></li>
  <li><a href="#igt-experiment-controls" id="toc-igt-experiment-controls" class="nav-link" data-scroll-target="#igt-experiment-controls"><span class="toc-section-number">5.2</span>  IGT experiment controls</a></li>
  </ul></li>
  <li><a href="#generate-complete-table-with-grazing-rates-and-values" id="toc-generate-complete-table-with-grazing-rates-and-values" class="nav-link" data-scroll-target="#generate-complete-table-with-grazing-rates-and-values"><span class="toc-section-number">6</span>  Generate complete table with grazing rates and values</a>
  <ul class="collapse">
  <li><a href="#plot-flpgrazer-minute" id="toc-plot-flpgrazer-minute" class="nav-link" data-scroll-target="#plot-flpgrazer-minute"><span class="toc-section-number">6.1</span>  Plot FLP/grazer /minute</a></li>
  </ul></li>
  <li><a href="#grazing-rate-calculations" id="toc-grazing-rate-calculations" class="nav-link" data-scroll-target="#grazing-rate-calculations"><span class="toc-section-number">7</span>  Grazing rate calculations</a>
  <ul class="collapse">
  <li><a href="#gt-table-options" id="toc-gt-table-options" class="nav-link" data-scroll-target="#gt-table-options">gt table options</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-for-eukaryotes" id="toc-carbon-biomass-for-eukaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-eukaryotes"><span class="toc-section-number">8</span>  Carbon biomass for eukaryotes</a>
  <ul class="collapse">
  <li><a href="#c-factor-based-on-biovolume" id="toc-c-factor-based-on-biovolume" class="nav-link" data-scroll-target="#c-factor-based-on-biovolume"><span class="toc-section-number">8.1</span>  C factor based on biovolume</a></li>
  <li><a href="#c-biomass-based-on-size-fraction" id="toc-c-biomass-based-on-size-fraction" class="nav-link" data-scroll-target="#c-biomass-based-on-size-fraction"><span class="toc-section-number">8.2</span>  C biomass based on size fraction</a></li>
  <li><a href="#compare-total-carbon-biomass---euks" id="toc-compare-total-carbon-biomass---euks" class="nav-link" data-scroll-target="#compare-total-carbon-biomass---euks"><span class="toc-section-number">8.3</span>  Compare total carbon biomass - euks</a></li>
  <li><a href="#compare-biovolumes-from-literature-to-measured-in-this-study" id="toc-compare-biovolumes-from-literature-to-measured-in-this-study" class="nav-link" data-scroll-target="#compare-biovolumes-from-literature-to-measured-in-this-study"><span class="toc-section-number">8.4</span>  Compare biovolumes from literature to measured in this study</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-for-prokaryotes" id="toc-carbon-biomass-for-prokaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-prokaryotes"><span class="toc-section-number">9</span>  Carbon biomass for prokaryotes</a>
  <ul class="collapse">
  <li><a href="#incorporate-carbon-biomass-of-prey-and-grazing-rate" id="toc-incorporate-carbon-biomass-of-prey-and-grazing-rate" class="nav-link" data-scroll-target="#incorporate-carbon-biomass-of-prey-and-grazing-rate"><span class="toc-section-number">9.1</span>  Incorporate carbon biomass of prey and grazing rate</a></li>
  </ul></li>
  <li><a href="#compare-with-axial-euk-cell-count" id="toc-compare-with-axial-euk-cell-count" class="nav-link" data-scroll-target="#compare-with-axial-euk-cell-count"><span class="toc-section-number">10</span>  Compare with Axial euk cell count</a></li>
  <li><a href="#environmental-parameters---mcr" id="toc-environmental-parameters---mcr" class="nav-link" data-scroll-target="#environmental-parameters---mcr"><span class="toc-section-number">11</span>  Environmental parameters - MCR</a></li>
  <li><a href="#analysis-of-grazing-rate-results" id="toc-analysis-of-grazing-rate-results" class="nav-link" data-scroll-target="#analysis-of-grazing-rate-results"><span class="toc-section-number">12</span>  Analysis of grazing rate results</a>
  <ul class="collapse">
  <li><a href="#function-to-plot-grazing-results" id="toc-function-to-plot-grazing-results" class="nav-link" data-scroll-target="#function-to-plot-grazing-results"><span class="toc-section-number">12.1</span>  Function to plot grazing results</a></li>
  </ul></li>
  <li><a href="#figure-1-compilation" id="toc-figure-1-compilation" class="nav-link" data-scroll-target="#figure-1-compilation"><span class="toc-section-number">13</span>  Figure 1 compilation</a>
  <ul class="collapse">
  <li><a href="#grazing-rate-vs.-cells-ml" id="toc-grazing-rate-vs.-cells-ml" class="nav-link" data-scroll-target="#grazing-rate-vs.-cells-ml"><span class="toc-section-number">13.1</span>  Grazing rate vs.&nbsp;cells ml</a></li>
  </ul></li>
  <li><a href="#figure-2-compilation" id="toc-figure-2-compilation" class="nav-link" data-scroll-target="#figure-2-compilation"><span class="toc-section-number">14</span>  Figure 2 compilation</a></li>
  <li><a href="#comparison-with-gorda-ridge" id="toc-comparison-with-gorda-ridge" class="nav-link" data-scroll-target="#comparison-with-gorda-ridge"><span class="toc-section-number">15</span>  Comparison with Gorda Ridge</a>
  <ul class="collapse">
  <li><a href="#combine-gr-and-mcr-data" id="toc-combine-gr-and-mcr-data" class="nav-link" data-scroll-target="#combine-gr-and-mcr-data"><span class="toc-section-number">15.1</span>  Combine GR and MCR data</a></li>
  <li><a href="#plot-combined-results" id="toc-plot-combined-results" class="nav-link" data-scroll-target="#plot-combined-results"><span class="toc-section-number">15.2</span>  Plot combined results</a>
  <ul class="collapse">
  <li><a href="#remove-undetected-grazing-rate" id="toc-remove-undetected-grazing-rate" class="nav-link" data-scroll-target="#remove-undetected-grazing-rate">Remove undetected grazing rate</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-regression-tidy-models" id="toc-linear-regression-tidy-models" class="nav-link" data-scroll-target="#linear-regression-tidy-models"><span class="toc-section-number">16</span>  Linear regression &amp; tidy models</a>
  <ul class="collapse">
  <li><a href="#mcr-and-gr-data-as-input" id="toc-mcr-and-gr-data-as-input" class="nav-link" data-scroll-target="#mcr-and-gr-data-as-input"><span class="toc-section-number">16.1</span>  MCR and GR data as input</a></li>
  <li><a href="#mcr-only" id="toc-mcr-only" class="nav-link" data-scroll-target="#mcr-only"><span class="toc-section-number">16.2</span>  MCR only</a></li>
  <li><a href="#mcr-vent-sites-only" id="toc-mcr-vent-sites-only" class="nav-link" data-scroll-target="#mcr-vent-sites-only"><span class="toc-section-number">16.3</span>  MCR vent sites only</a></li>
  <li><a href="#plot-temperature-by-eukprok-and-then-euk-and-prok" id="toc-plot-temperature-by-eukprok-and-then-euk-and-prok" class="nav-link" data-scroll-target="#plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="toc-section-number">16.4</span>  Plot temperature by euk:prok and then euk and prok</a></li>
  <li><a href="#plot-temperature-by-grazing-rate" id="toc-plot-temperature-by-grazing-rate" class="nav-link" data-scroll-target="#plot-temperature-by-grazing-rate"><span class="toc-section-number">16.5</span>  Plot temperature by grazing rate</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-investigation" id="toc-carbon-biomass-investigation" class="nav-link" data-scroll-target="#carbon-biomass-investigation"><span class="toc-section-number">17</span>  Carbon biomass investigation</a></li>
  <li><a href="#prediction-of-mcr-data-with-parameters" id="toc-prediction-of-mcr-data-with-parameters" class="nav-link" data-scroll-target="#prediction-of-mcr-data-with-parameters"><span class="toc-section-number">18</span>  Prediction of MCR data with parameters</a></li>
  <li><a href="#session" id="toc-session" class="nav-link" data-scroll-target="#session"><span class="toc-section-number">19</span>  Session</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Protistan grazing analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="import-format-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Import &amp; format data</h1>
<p>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</p>
<section id="set-up-working-r-environment" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="set-up-working-r-environment"><span class="header-section-number">1.1</span> Set up working R environment</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Set color schematic</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>whole_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>,<span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#eae2b7"</span>, <span class="st">"#5f0f40"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#941b0c"</span>, <span class="st">"#577590"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-raw-count-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="import-raw-count-data"><span class="header-section-number">1.2</span> Import raw count data</h2>
<p>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more ‘R’ friendly.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DATE"         "SAMPLE"       "EXPID"        "VOL"          "MAG"         
 [6] "FOV"          "nanoNoFLP"    "microNoFLP"   "nanoFLP"      "microFLP"    
[11] "NOTES"        "DateCompiled"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</p>
</blockquote>
<p>Parse raw microscopy count data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calculate-cells-per-ml-euk" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Calculate cells per ml (euk)</h1>
<p>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionaly, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to &gt;20um and nano is &lt;20um. All counts were done at 100x magnification, confirm this: <code>unique(counts_occur$MAG)</code>.</p>
<p>Calculate cell concentration (cells/ml).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</p>
</blockquote>
<p>Average cells/ml across replicates, pivot to long format</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOTES on calculations:</p>
<p><em>VAR</em> = takes the sum of the squares of each value’s deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</p>
<p><em>SD</em> = standard deviation of all values</p>
<p><em>SEM</em> = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</p>
<p>Save output file</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Reformat to parse experiment information type</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format and add column that reports IGT vs bag experiment</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, <span class="fu">ends_with</span>(<span class="st">"CONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Factor cell count data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(plot_euk_conc<span class="sc">$</span>Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LotsOShrimp"    "Plume"          "Shrimpocalypse" "BSW"           
[5] "MustardStand"   "OMT"            "Rav2"           "ShrimpHole"    
[9] "X18"           </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-eukaryote-cells-per-ml" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="plot-eukaryote-cells-per-ml"><span class="header-section-number">2.1</span> Plot eukaryote cells per ml</h2>
<p><a href="#fig-boxplot-all">Figure&nbsp;1</a> reports all eukaryote cells per ml counts from all grazing assay counts..</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>conc_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_conc, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">y =</span> CONCENTRATION, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">group =</span> NameOrder,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not color by time point</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(limits = c(10,1000), expand = c(0, 0)) +</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>conc_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing non-finite values (stat_boxplot).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplot-all" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="grazing_files/figure-html/fig-boxplot-all-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. ~300 cells/ml in background and plume compared to ~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</p>
<blockquote class="blockquote">
<p>Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 * interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</p>
</blockquote>
<blockquote class="blockquote">
<p>eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</p>
</blockquote>
<p>Plot eukaryote cell concentration over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (MEAN + SD), ymin = (MEAN - SD)), width = 0.2) +</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">21</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</p>
</blockquote>
</section>
<section id="isolate-t0-only-counts-for-cellsml-plot" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="isolate-t0-only-counts-for-cellsml-plot"><span class="header-section-number">2.2</span> Isolate T0 only counts for cells/ml plot</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="ot">&lt;-</span> plot_euk_conc <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TimePoint == "T0" &amp; (VARIABLE == "eukCONC")) %&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteOrder, NameOrder, TimePoint, EXP_TYPE, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_conc =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM_conc =</span> (<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SiteOrder, NameOrder, EXP_TYPE, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plot_euk_format</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   EXPERIMENT SiteOrder      NameOrder TimePoint EXP_TYPE
1     Von Damm_Background_Bag  Von Damm     Background        T0      Bag
2     Von Damm_Background_Bag  Von Damm     Background        T0      Bag
3     Von Damm_Background_Bag  Von Damm     Background        T0      Bag
4          Von Damm_Plume_Bag  Von Damm          Plume        T0      Bag
5          Von Damm_Plume_Bag  Von Damm          Plume        T0      Bag
6          Von Damm_Plume_Bag  Von Damm          Plume        T0      Bag
7           Von Damm_X-18_Bag  Von Damm           X-18        T0      Bag
8           Von Damm_X-18_Bag  Von Damm           X-18        T0      Bag
9           Von Damm_X-18_Bag  Von Damm           X-18        T0      Bag
10  Von Damm_Old Man Tree_IGT  Von Damm   Old Man Tree        T0      IGT
11  Von Damm_Old Man Tree_IGT  Von Damm   Old Man Tree        T0      IGT
12  Von Damm_Old Man Tree_IGT  Von Damm   Old Man Tree        T0      IGT
13    Von Damm_Ravelin #2_Bag  Von Damm     Ravelin #2        T0      Bag
14    Von Damm_Ravelin #2_Bag  Von Damm     Ravelin #2        T0      Bag
15    Von Damm_Ravelin #2_Bag  Von Damm     Ravelin #2        T0      Bag
16    Von Damm_Ravelin #2_IGT  Von Damm     Ravelin #2        T0      IGT
17    Von Damm_Ravelin #2_IGT  Von Damm     Ravelin #2        T0      IGT
18    Von Damm_Ravelin #2_IGT  Von Damm     Ravelin #2        T0      IGT
19 Von Damm_Mustard Stand_Bag  Von Damm  Mustard Stand        T0      Bag
20 Von Damm_Mustard Stand_Bag  Von Damm  Mustard Stand        T0      Bag
21 Von Damm_Mustard Stand_Bag  Von Damm  Mustard Stand        T0      Bag
22   Von Damm_Shrimp Hole_Bag  Von Damm    Shrimp Hole        T0      Bag
23   Von Damm_Shrimp Hole_Bag  Von Damm    Shrimp Hole        T0      Bag
24   Von Damm_Shrimp Hole_Bag  Von Damm    Shrimp Hole        T0      Bag
25          Piccard_Plume_Bag   Piccard          Plume        T0      Bag
26          Piccard_Plume_Bag   Piccard          Plume        T0      Bag
27          Piccard_Plume_Bag   Piccard          Plume        T0      Bag
28 Piccard_Shrimpocalypse_Bag   Piccard Shrimpocalypse        T0      Bag
29 Piccard_Shrimpocalypse_Bag   Piccard Shrimpocalypse        T0      Bag
30 Piccard_Shrimpocalypse_Bag   Piccard Shrimpocalypse        T0      Bag
31 Piccard_Shrimpocalypse_IGT   Piccard Shrimpocalypse        T0      IGT
32 Piccard_Shrimpocalypse_IGT   Piccard Shrimpocalypse        T0      IGT
33 Piccard_Shrimpocalypse_IGT   Piccard Shrimpocalypse        T0      IGT
34 Piccard_Lots 'O Shrimp_Bag   Piccard Lots 'O Shrimp        T0      Bag
35 Piccard_Lots 'O Shrimp_Bag   Piccard Lots 'O Shrimp        T0      Bag
36 Piccard_Lots 'O Shrimp_Bag   Piccard Lots 'O Shrimp        T0      Bag
    VARIABLE   avg_conc   SEM_conc
1    eukCONC  91.837731  21.866127
2  microCONC   0.000000   0.000000
3   nanoCONC  91.837731  21.866127
4    eukCONC 157.774683  67.098589
5  microCONC  22.872439   8.878118
6   nanoCONC 134.902245  58.794905
7    eukCONC 314.872222 104.957407
8  microCONC  41.982963  20.991481
9   nanoCONC 272.889259  83.965926
10   eukCONC 472.308333 122.450309
11 microCONC 104.957407  34.985802
12  nanoCONC 367.350926  87.464506
13   eukCONC 409.333889  73.470185
14 microCONC  10.495741  10.495741
15  nanoCONC 398.838148  62.974444
16   eukCONC 620.997994 123.177023
17 microCONC  34.985802  14.282894
18  nanoCONC 586.012191 131.196759
19   eukCONC 259.769583  28.863287
20 microCONC   0.000000   0.000000
21  nanoCONC 259.769583  28.863287
22   eukCONC 385.718472   7.871806
23 microCONC  49.854769  28.863287
24  nanoCONC 335.863704  20.991481
25   eukCONC  79.301152  16.819081
26 microCONC   9.329547   2.332387
27  nanoCONC  69.971605  18.512747
28   eukCONC 454.815432         NA
29 microCONC  34.985802         NA
30  nanoCONC 419.829630         NA
31   eukCONC 454.815432  69.971605
32 microCONC  34.985802  34.985802
33  nanoCONC 419.829630  34.985802
34   eukCONC 230.906296         NA
35 microCONC   0.000000         NA
36  nanoCONC 230.906296         NA</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plot_euk_format<span class="sc">$</span>Site_Order <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_format<span class="sc">$</span>SiteOrder, <span class="at">levels =</span> site_fullname, <span class="at">labels =</span> site_fullname)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_euk_format)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate only total euk counts</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>((plot_euk_format <span class="sc">%&gt;%</span> <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>)), <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> avg_conc, <span class="at">fill =</span> Site_Order)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (avg_conc <span class="sc">+</span> SEM_conc), <span class="at">ymin =</span> (avg_conc <span class="sc">-</span> SEM_conc)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Site_Order), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>euk_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Print table of eukaryote cell count information to include in results section summary.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  SAMPLE_TYPE MEAN_cellml  min_cellml   max_cellml     num
  &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;
1 Background  9.183773e+01 9.183773e+01 9.183773e+01     1
2 Piccard     3.801791e+02 2.309063e+02 4.548154e+02     3
3 Plume       1.185379e+02 7.930115e+01 1.577747e+02     2
4 Von Damm    4.105001e+02 2.597696e+02 6.20998e+02      6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(VARIABLE == "eukCONC") %&gt;% </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
# Groups:   SAMPLE_TYPE [4]
   SAMPLE_TYPE VARIABLE  MEAN_cellml  min_cellml   max_cellml     num
   &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;
 1 Background  eukCONC   9.183773e+01 9.183773e+01 9.183773e+01     1
 2 Background  microCONC 0e+00        0e+00        0e+00            1
 3 Background  nanoCONC  9.183773e+01 9.183773e+01 9.183773e+01     1
 4 Piccard     eukCONC   3.801791e+02 2.309063e+02 4.548154e+02     3
 5 Piccard     microCONC 2.332387e+01 0e+00        3.49858e+01      3
 6 Piccard     nanoCONC  3.568552e+02 2.309063e+02 4.198296e+02     3
 7 Plume       eukCONC   1.185379e+02 7.930115e+01 1.577747e+02     2
 8 Plume       microCONC 1.610099e+01 9.329547e+00 2.287244e+01     2
 9 Plume       nanoCONC  1.024369e+02 6.99716e+01  1.349022e+02     2
10 Von Damm    eukCONC   4.105001e+02 2.597696e+02 6.20998e+02      6
11 Von Damm    microCONC 4.037945e+01 0e+00        1.049574e+02     6
12 Von Damm    nanoCONC  3.701206e+02 2.597696e+02 5.860122e+02     6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(plot_euk_format$NameOrder)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   SAMPLE_TYPE_BIN [2]
  SAMPLE_TYPE_BIN VARIABLE  MEAN_cellml  min_cellml   max_cellml     num
  &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;
1 Non-vent        eukCONC   1.096379e+02 7.930115e+01 1.577747e+02     3
2 Non-vent        microCONC 1.0734e+01   0e+00        2.287244e+01     3
3 Non-vent        nanoCONC  9.890386e+01 6.99716e+01  1.349022e+02     3
4 Vent            eukCONC   4.003931e+02 2.309063e+02 6.20998e+02      9
5 Vent            microCONC 3.469425e+01 0e+00        1.049574e+02     9
6 Vent            nanoCONC  3.656988e+02 2.309063e+02 5.860122e+02     9</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="bacteria-archaea-cell-counts" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Bacteria &amp; archaea cell counts</h1>
<p>DAPI slide counts from prokaryotes from same sites. Import and compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cells-per-ml-prok" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="cells-per-ml-prok"><span class="header-section-number">3.1</span> Cells per ml (prok)</h2>
<p>Visualize counts</p>
<p>Summary of prok counts</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(insitu_proks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                SAMPLE    Site         Name      MEAN         SD        SEM
1          Piccard-BSW Piccard          BSW  11860.19  1632.7541  1154.5315
2  Piccard-HotChimlet1 Piccard  HotChimlet1  63184.36   296.8644   209.9148
3  Piccard-LotsOShrimp Piccard  LotsOShrimp  53878.14 27454.3826 13727.1913
4        Piccard-Plume Piccard        Plume  51429.13  6531.0163  4618.1259
5   Piccard-Quakeplume Piccard   Quakeplume  21201.40 12171.4395  8606.5074
6 Piccard-ShrimpGulley Piccard ShrimpGulley 139593.35 41264.1485 29178.1593</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># insitu_proks$Name</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Name <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group_by(type) %&gt;% </span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(MEAN),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(MEAN),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(MEAN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'type'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   type [2]
  type     Site       mean    min     max
  &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 non-vent Piccard  31645. 11860.  51429.
2 non-vent VD       27184. 16478.  37890.
3 vent     Piccard 109713. 53878. 238586.
4 vent     VD       40907.  8816. 111430.</code></pre>
</div>
</div>
<p>Factor site names, etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>, <span class="st">"HotChimlet1"</span>, <span class="st">"ShrimpGulley"</span>, <span class="st">"SouthofHotChimlet"</span>, <span class="st">"SouthofLungSnack"</span>, <span class="st">"ArrowLoop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Rav1"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>prok_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="euk-and-prok-counts" class="level3">
<h3 class="anchored" data-anchor-id="euk-and-prok-counts">Euk and prok counts</h3>
<p>Combined eukaryote and prokaryote cell counts</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>euk_prok_ab <span class="ot">&lt;-</span> euk_plot <span class="sc">+</span> (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-with-previous-mcr-cell-counts" class="level3">
<h3 class="anchored" data-anchor-id="combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</h3>
<p>Compare <em>in situ</em> prokaryote cell counts from 2020 to previous years</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Re-import 2020 data to compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot by year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="estimate-grazing-effect" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Estimate grazing effect</h1>
<p>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  counts_cellsml_all
  counts_cellsml_avg
  counts_occur</code></pre>
</div>
</div>
<section id="determine-flp-per-euk-cell" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="determine-flp-per-euk-cell"><span class="header-section-number">4.1</span> Determine FLP per euk cell</h2>
<p>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <code>counts_occur</code> data frame from above.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>optional gut check of data table modification</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Isolate counts that are &gt;0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_flp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               SAMPLE    EXPID EXP_TYPE IGT_REP   SizeFrac total_FLP
1 Piccard-LotsOShrimp  T0-Rep3      Bag     Bag  nano_size         3
2 Piccard-LotsOShrimp T15-Rep3      Bag     Bag micro_size         1
3 Piccard-LotsOShrimp T15-Rep3      Bag     Bag  nano_size         3
4 Piccard-LotsOShrimp T20-Rep3      Bag     Bag  nano_size         2
5       Piccard-Plume  T0-Rep1      Bag     Bag micro_size         2
6       Piccard-Plume  T0-Rep1      Bag     Bag  nano_size         4
  total_euks_wflp
1               2
2               1
3               2
4               1
5               1
6               3</code></pre>
</div>
</div>
<p>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</p>
<p>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</p>
<blockquote class="blockquote">
<p>Below code repeats process and compiles with other FLP/euk cell data.</p>
</blockquote>
<p>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "EXPID", "EXP_TYPE", "IGT_REP", "SizeFrac")</code></pre>
</div>
</div>
<p>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculate-flp-per-euk-cell-calculation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="calculate-flp-per-euk-cell-calculation"><span class="header-section-number">4.2</span> Calculate FLP per euk cell calculation</h2>
<p>First need to import and compile with metadata to get exact timing of experiments.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add metadata</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, include them as replicates!</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>COLS: Timepoint, Minutes = time point label, actual incubated minutes</p>
</blockquote>
<blockquote class="blockquote">
<p>COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</p>
</blockquote>
</section>
<section id="calculate-linear-regression-to-obtain-slope" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="calculate-linear-regression-to-obtain-slope"><span class="header-section-number">4.3</span> Calculate linear regression to obtain slope</h2>
<p>Use <code>lm()</code> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</p>
<p>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP, -SizeFrac) %&gt;%</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) %&gt;%</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"REP"</span>,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</p>
</blockquote>
<p>Apply to all data to obtain slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable

Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")
Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")</code></pre>
</div>
</div>
<p><em>gut check</em> linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <code>nest()</code> capability of tidyverse. Below, one experiment is subset to check the value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-linear-regression-trend" class="level3">
<h3 class="anchored" data-anchor-id="plot-linear-regression-trend">Plot linear regression trend</h3>
<p>Plot all bag experiments with estimated slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(calcs_wslope_regression<span class="sc">$</span>SITE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Piccard VD     
Levels: VD Piccard</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENT_IDS =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out IGT samples for now</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;%</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE_ORDER, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE)) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</p>
</section>
</section>
<section id="remove-igt-tf-time-points." class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="remove-igt-tf-time-points."><span class="header-section-number">4.4</span> Remove IGT Tf time points.</h2>
<p>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?
All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")
Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated grazing effect.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>results are more consistent across experiments.</p>
</blockquote>
</section>
<section id="compile-and-save-grazing-experiment-results" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="compile-and-save-grazing-experiment-results"><span class="header-section-number">4.5</span> Compile and save grazing experiment results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="sc">%&gt;%</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrigin, SiteOrder, NameOrder, Experiment, SizeFrac, r.squared, INTERCEPT, SLOPE) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SiteOrigin SiteOrder      NameOrder          Experiment   SizeFrac
1        Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag total_euks
2       Plume   Piccard          Plume           Plume-Bag total_euks
3        Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag total_euks
4  Background  Von Damm     Background             BSW-Bag total_euks
5        Vent  Von Damm  Mustard Stand    MustardStand-Bag total_euks
6       Plume  Von Damm          Plume           Plume-Bag total_euks
7        Vent  Von Damm     Ravelin #2            Rav2-Bag total_euks
8        Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag total_euks
9        Vent  Von Damm           X-18             X18-Bag total_euks
10       Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag micro_size
11       Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag  nano_size
12      Plume   Piccard          Plume           Plume-Bag micro_size
13      Plume   Piccard          Plume           Plume-Bag  nano_size
14       Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag micro_size
15       Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag  nano_size
16 Background  Von Damm     Background             BSW-Bag micro_size
17 Background  Von Damm     Background             BSW-Bag  nano_size
18       Vent  Von Damm  Mustard Stand    MustardStand-Bag micro_size
19       Vent  Von Damm  Mustard Stand    MustardStand-Bag  nano_size
20      Plume  Von Damm          Plume           Plume-Bag micro_size
21      Plume  Von Damm          Plume           Plume-Bag  nano_size
22       Vent  Von Damm     Ravelin #2            Rav2-Bag micro_size
23       Vent  Von Damm     Ravelin #2            Rav2-Bag  nano_size
24       Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag micro_size
25       Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag  nano_size
26       Vent  Von Damm           X-18             X18-Bag micro_size
27       Vent  Von Damm           X-18             X18-Bag  nano_size
28       Vent   Piccard Shrimpocalypse Shrimpocalypse-IGT3 total_euks
29       Vent  Von Damm   Old Man Tree            OMT-IGT4 total_euks
30       Vent  Von Damm     Ravelin #2           Rav2-IGT4 total_euks
31       Vent  Von Damm     Ravelin #2           Rav2-IGT5 total_euks
     r.squared  INTERCEPT        SLOPE
1  0.660252577  0.3517002 -0.007605829
2  0.028109981  0.7435088  0.005362856
3  0.134500775  0.7414202  0.015686872
4  0.016339803  0.3381071  0.002958889
5  0.679501856  0.5316532 -0.005445545
6  0.152459998  0.4565982  0.005274231
7  0.003588551  0.9680181  0.003470217
8  0.002436342  0.8984156 -0.001967253
9  0.007917377  0.3937265  0.001744429
10 0.000000000  0.5000000           NA
11 0.723950257  0.3415221 -0.007467037
12 0.031027392  1.8447712 -0.021241830
13 0.134388231  0.5657210  0.009146535
14 0.016488447  1.8971061 -0.016881029
15 0.219942841  0.5793676  0.022967165
16 0.289513467  1.4518382 -0.027181373
17 0.015152403  0.2934706  0.002856863
18 0.000000000  0.0000000           NA
19 0.679997859  0.5291779 -0.004985856
20 0.098467998  0.7841090  0.019766939
21 0.019373495  0.4513702  0.002263909
22 0.696359782 -1.7147488  0.394651540
23 0.001444937  0.9392498  0.002011385
24 0.233424455  2.2875458 -0.092124542
25 0.002819273  0.9370957  0.002424242
26 0.302757291  0.6709130  0.036093418
27 0.018916716  0.3041782  0.002196051
28 0.661389551  0.0215311  0.016794258
29 0.445940823  0.2441665  0.014510943
30 0.872857411  0.1272183  0.015395240
31 0.054430146  0.2692487  0.001603035</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(calcs_wslope_regression_update, <span class="at">file =</span> <span class="st">"output-data/estimated-slopes-grazingexp.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="check-flp-control-experiments" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Check FLP control experiments</h1>
<p>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 17 rows [33, 34, 35,
36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49].</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TimePoint', 'Stain', 'Site'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<section id="bag-grazing-experiment-controls" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="bag-grazing-experiment-controls"><span class="header-section-number">5.1</span> Bag grazing experiment controls</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="igt-experiment-controls" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="igt-experiment-controls"><span class="header-section-number">5.2</span> IGT experiment controls</h2>
<p>Repeat for IGT experiments.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="generate-complete-table-with-grazing-rates-and-values" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Generate complete table with grazing rates and values</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, <span class="at">Site=</span>SiteOrder, <span class="at">Name=</span>NameOrder, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Bag"</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'FLUID_ORIGIN', 'CRUISE_SAMPLE',
'EXP_TYPE', 'EXP_REPS', 'EXP_VOL', 'CTRL_REPS', 'CTRL_VOL', 'Site', 'Name'. You
can override using the `.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="co"># view complete table of grazing rate results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   SAMPLE FLUID_ORIGIN CRUISE_SAMPLE EXP_TYPE EXP_REPS EXP_VOL
1     Piccard-LotsOShrimp      J2-1241          LV24      Bag        3    1.50
2           Piccard-Plume       CTD004     Niskin 10      Bag        3    2.00
3  Piccard-Shrimpocalypse      J2-1240          IGT3      IGT        1    0.15
4  Piccard-Shrimpocalypse      J2-1240          LV13      Bag        3    1.50
5                  VD-BSW       CTD002  Niskins 8-10      Bag        3    2.00
6         VD-MustardStand      J2-1243          LV17      Bag        2    1.50
7                  VD-OMT      J2-1238          IGT4      IGT        1    0.15
8                VD-Plume       CTD001      Niskin 2      Bag        3    2.00
9                 VD-Rav2      J2-1238         LV13a      Bag        3    1.50
10                VD-Rav2      J2-1244          IGT4      IGT        1    0.15
11                VD-Rav2      J2-1244          IGT5      IGT        1    0.15
12          VD-ShrimpHole      J2-1244          LV13      Bag        2    1.50
13                 VD-X18      J2-1235   LV23 &amp; Bio5      Bag        2    1.50
   CTRL_REPS CTRL_VOL     Site           Name         RATE        TimePoints
1          2      0.2  Piccard Lots 'O Shrimp -0.007605829     0, 15, 20, 40
2          2      0.5  Piccard          Plume  0.005362856 0, 10, 15, 20, 40
3         NA       NA  Piccard Shrimpocalypse  0.016794258         0, 15, 25
4          2      0.2  Piccard Shrimpocalypse  0.015686872 0, 10, 14, 22, 42
5          2      0.5 Von Damm     Background  0.002958889 0, 10, 15, 20, 40
6          2      0.2 Von Damm  Mustard Stand -0.005445545     0, 10, 20, 40
7         NA       NA Von Damm   Old Man Tree  0.014510943          0, 7, 25
8          2      1.0 Von Damm          Plume  0.005274231 0, 10, 15, 25, 57
9          2      0.5 Von Damm     Ravelin #2  0.003470217 0, 10, 15, 21, 40
10        NA       NA Von Damm     Ravelin #2  0.015395240         0, 12, 20
11        NA       NA Von Damm     Ravelin #2  0.001603035         0, 35, 40
12         2      0.2 Von Damm    Shrimp Hole -0.001967253 0, 10, 15, 20, 40
13         2      0.5 Von Damm           X-18  0.001744429     0, 15, 20, 40
    GRAZE_RATE       type
1  0.000000000   Vent-Bag
2  0.005362856      Plume
3  0.016794258   Vent-IGT
4  0.015686872   Vent-Bag
5  0.002958889 Background
6  0.000000000   Vent-Bag
7  0.014510943   Vent-IGT
8  0.005274231      Plume
9  0.003470217   Vent-Bag
10 0.015395240   Vent-IGT
11 0.001603035   Vent-IGT
12 0.000000000   Vent-Bag
13 0.001744429   Vent-Bag</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXP_TYPE, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EXP_TYPE'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   EXP_TYPE [2]
  EXP_TYPE Site     mean_rate min_rate     max
  &lt;chr&gt;    &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Bag      Von Damm   0.00224  0       0.00527
2 Bag      Piccard    0.00702  0       0.0157 
3 IGT      Von Damm   0.0105   0.00160 0.0154 
4 IGT      Piccard    0.0168   0.0168  0.0168 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(Site, TYPE) %&gt;% </span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(TYPE) %&gt;%</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPE, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TYPE'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   TYPE [2]
  TYPE     EXP_TYPE mean_rate min_rate     max
  &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 non-vent Bag        0.00453  0.00296 0.00536
2 vent     Bag        0.00348  0       0.0157 
3 vent     IGT        0.0121   0.00160 0.0168 </code></pre>
</div>
</div>
<p>Amend table with estimated FLP concentration</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_conc =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Introduce factors in table for visualizations</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>FIELDORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>FIELD, <span class="at">levels =</span> site_fullname)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>VENTORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_fullname)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_grazerate_wflp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Site EXP_TYPE   FLP_conc FLUID_ORIGIN CRUISE_SAMPLE
1    Piccard-LotsOShrimp      Bag   617.1496      J2-1241          LV24
2          Piccard-Plume      Bag 29650.4676       CTD004     Niskin 10
3 Piccard-Shrimpocalypse      Bag 17003.1000      J2-1240          LV13
4                 VD-BSW      Bag  4861.8239       CTD002  Niskins 8-10
5        VD-MustardStand      Bag  6601.4929      J2-1243          LV17
6               VD-Plume      Bag 34242.3542       CTD001      Niskin 2
  EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL    FIELD           Name         RATE
1        3     1.5         2      0.2  Piccard Lots 'O Shrimp -0.007605829
2        3     2.0         2      0.5  Piccard          Plume  0.005362856
3        3     1.5         2      0.2  Piccard Shrimpocalypse  0.015686872
4        3     2.0         2      0.5 Von Damm     Background  0.002958889
5        2     1.5         2      0.2 Von Damm  Mustard Stand -0.005445545
6        3     2.0         2      1.0 Von Damm          Plume  0.005274231
         TimePoints  GRAZE_RATE       type       TYPE FIELDORDER      VENTORDER
1     0, 15, 20, 40 0.000000000   Vent-Bag   Vent-Bag    Piccard Lots 'O Shrimp
2 0, 10, 15, 20, 40 0.005362856      Plume      Plume    Piccard          Plume
3 0, 10, 14, 22, 42 0.015686872   Vent-Bag   Vent-Bag    Piccard Shrimpocalypse
4 0, 10, 15, 20, 40 0.002958889 Background Background   Von Damm     Background
5     0, 10, 20, 40 0.000000000   Vent-Bag   Vent-Bag   Von Damm  Mustard Stand
6 0, 10, 15, 25, 57 0.005274231      Plume      Plume   Von Damm          Plume</code></pre>
</div>
</div>
<section id="plot-flpgrazer-minute" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="plot-flpgrazer-minute"><span class="header-section-number">6.1</span> Plot FLP/grazer /minute</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> VENTORDER, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELDORDER)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELDORDER),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELDORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Mean FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Amend table with eukaryote and prokaryote estimated biomass.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to master table with data</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Prok_conc =</span> MEAN, <span class="at">Prok_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp) <span class="sc">%&gt;%</span> </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prok_conc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Prok_conc), avg_insitu, Prok_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "Site"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Name =</span> NameOrder, <span class="at">FIELD =</span> SiteOrder, <span class="at">euk_conc =</span> avg_conc, EXP_TYPE, <span class="at">euk_conc_sem =</span> SEM_conc) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp_wprok) <span class="sc">%&gt;%</span> </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> Name, <span class="at">EXP =</span> EXP_TYPE, <span class="at">SAMPLE =</span> Site, <span class="at">RATE_min =</span> GRAZE_RATE, <span class="at">FLP_ml =</span> FLP_conc, <span class="at">PROK_ml =</span> Prok_conc, <span class="at">PROK_sem =</span> Prok_sem, <span class="at">EUK_ml =</span> euk_conc, <span class="at">EUK_sem =</span> euk_conc_sem, TimePoints, EXP_REPS, EXP_VOL,  CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("Name", "FIELD", "EXP_TYPE")</code></pre>
</div>
</div>
<p>Description of variables above:</p>
<ul>
<li>FIELD - vent location</li>
<li>NAME - name of vent site, or plume/background</li>
<li>EXP - experiment type, bag or IGT</li>
<li>SAMPLE - vent site</li>
<li>RATE_MIN - FLPs per grazer per minute (SLOPE of best fitline)</li>
<li>FLP_ml - FLP concentration at T0</li>
<li>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</li>
<li>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</li>
</ul>
</section>
</section>
<section id="grazing-rate-calculations" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Grazing rate calculations</h1>
<p>Based on Unrein et al.&nbsp;2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_grazerate_wflp_wprok_weuk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD       NAME EXP   SAMPLE    RATE_min    FLP_ml  PROK_ml PROK_sem
1 Von Damm Background Bag   VD-BSW 0.002958889  4861.824 37889.62 8608.427
2 Von Damm Background Bag   VD-BSW 0.002958889  4861.824 37889.62 8608.427
3 Von Damm Background Bag   VD-BSW 0.002958889  4861.824 37889.62 8608.427
4 Von Damm      Plume Bag VD-Plume 0.005274231 34242.354 16478.31 2623.935
5 Von Damm      Plume Bag VD-Plume 0.005274231 34242.354 16478.31 2623.935
6 Von Damm      Plume Bag VD-Plume 0.005274231 34242.354 16478.31 2623.935
     EUK_ml   EUK_sem        TimePoints EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL
1  91.83773 21.866127 0, 10, 15, 20, 40        3       2         2      0.5
2   0.00000  0.000000 0, 10, 15, 20, 40        3       2         2      0.5
3  91.83773 21.866127 0, 10, 15, 20, 40        3       2         2      0.5
4 157.77468 67.098589 0, 10, 15, 25, 57        3       2         2      1.0
5  22.87244  8.878118 0, 10, 15, 25, 57        3       2         2      1.0
6 134.90224 58.794905 0, 10, 15, 25, 57        3       2         2      1.0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_min <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explanation of units for table with calculated values.</p>
<ul>
<li><p>RATE_min &amp; RATE_hr = Grazing rate as ‘FLPs per grazer per minute’ and per hour</p></li>
<li><p>CLEARANCE_RATE = ml or nL per grazer per hour</p></li>
<li><p>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</p></li>
<li><p>GRAZING EFFECT = bacteria per ml per hour</p></li>
<li><p>Bacterial turnover rate = % per day</p></li>
</ul>
<section id="gt-table-options" class="level3">
<h3 class="anchored" data-anchor-id="gt-table-options">gt table options</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bkgd &lt;- c("Background", "Plume")</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gt)</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb101-37"><a href="#cb101-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb101-38"><a href="#cb101-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb101-39"><a href="#cb101-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb101-40"><a href="#cb101-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-41"><a href="#cb101-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb101-42"><a href="#cb101-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb101-43"><a href="#cb101-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb101-44"><a href="#cb101-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-45"><a href="#cb101-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb101-46"><a href="#cb101-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb101-47"><a href="#cb101-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb101-48"><a href="#cb101-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-49"><a href="#cb101-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb101-50"><a href="#cb101-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb101-51"><a href="#cb101-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb101-52"><a href="#cb101-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-53"><a href="#cb101-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb101-54"><a href="#cb101-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb101-55"><a href="#cb101-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb101-56"><a href="#cb101-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-57"><a href="#cb101-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb101-58"><a href="#cb101-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb101-59"><a href="#cb101-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb101-60"><a href="#cb101-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb101-61"><a href="#cb101-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb101-62"><a href="#cb101-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb101-63"><a href="#cb101-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb101-64"><a href="#cb101-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb101-65"><a href="#cb101-65" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb101-66"><a href="#cb101-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb101-67"><a href="#cb101-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb101-68"><a href="#cb101-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb101-69"><a href="#cb101-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Table 1 and S1 - grazing experiment information only</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim((table_wcalcs %&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(FIELD, NAME, EXP, SAMPLE, TimePoints, starts_with("EXP_"), starts_with("CTRL_"), PROK_ml, PROK_sem, EUK_ml, EUK_sem, RATE_min, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC)), file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="carbon-biomass-for-eukaryotes" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Carbon biomass for eukaryotes</h1>
<p>References for estimating biovolume <em>Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al.&nbsp;(2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782–792.</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="c-factor-based-on-biovolume" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="c-factor-based-on-biovolume"><span class="header-section-number">8.1</span> C factor based on biovolume</h2>
<ol type="1">
<li>Calculate biovolume based on observed/imaged cells</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate biovolume, then apply carbon by biomass estimate for protists derived from biovolume.</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIOVOLUME =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> d)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_dino =</span> (<span class="fl">0.760</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.819</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_nodiatom =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.939</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_RANGE_min =</span> (<span class="dv">80</span> <span class="sc">*</span> BIOVOLUME)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_cell_RANGE_max =</span> (<span class="dv">360</span> <span class="sc">*</span> BIOVOLUME)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_cell_RANGE_mean =</span> (<span class="dv">220</span> <span class="sc">*</span> BIOVOLUME)<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biov_calc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  EXP VENT_BSW      h      d  BIOVOLUME pgC_cell_MD_dino pgC_cell_MD_nodiatom
1 IGT     vent 30.077 25.764 8954.44130      1310.789998          1110.242625
2 IGT     vent 89.582 10.000  523.59878       128.136679            77.195762
3 Bag      BSW 14.595  8.036  271.71800        74.878402            41.695668
4 Bag      BSW 12.480  8.982  379.41786        98.426275            57.048646
5 Bag     vent  9.218  3.120   15.90239         7.325062             2.901529
6 IGT     vent 17.255  9.986  521.40274       127.696364            76.891704
  pgC_cell_RANGE_min pgC_cell_RANGE_max pgC_cell_RANGE_mean
1         716.355304         3223.59887         1969.977086
2          41.887902          188.49556          115.191731
3          21.737440           97.81848           59.777960
4          30.353429          136.59043           83.471930
5           1.272191            5.72486            3.498526
6          41.712219          187.70499          114.708602</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># biov_calc</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(c(80, 360))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Get a summary pg per cell for vent and background samples. This is derived from biovolume estimates.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>c_factor_biov <span class="ot">&lt;-</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  biov_calc <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>EXP, <span class="sc">-</span>h, <span class="sc">-</span>d) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(BIOVOLUME, <span class="fu">starts_with</span>(<span class="st">"pgC_"</span>)), <span class="at">names_to =</span> <span class="st">"VARIABLES"</span>, <span class="at">values_to =</span> <span class="st">"VALUES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW, VARIABLES) <span class="sc">%&gt;%</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(VALUES),</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(VALUES),</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VENT_BSW, <span class="at">values_from =</span> <span class="fu">c</span>(mean, max,min), <span class="at">names_sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'VENT_BSW'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(c_factor_biov)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>Assign a C conversion factor for background and within vents based on biovolume</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_BSW</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_vent</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_BSW</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_vent</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_BSW</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_vent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="4" type="1">
<li>Combine with count table to estimate total standing stock in carbon</li>
</ol>
<p>Isolate at T0 all the euk cells per ml counts. Then add in the mean, min/max for the pg C per cell, based on the vent vs non-vent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_BSW,</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_vent,</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_min =</span> <span class="fu">case_when</span>(</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_BSW_min,</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_vent_min</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_max =</span> <span class="fu">case_when</span>(</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_BSW_max,</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_vent_max</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   EXPERIMENT SiteOrder      NameOrder TimePoint EXP_TYPE
1     Von Damm_Background_Bag  Von Damm     Background        T0      Bag
2          Von Damm_Plume_Bag  Von Damm          Plume        T0      Bag
3           Von Damm_X-18_Bag  Von Damm           X-18        T0      Bag
4   Von Damm_Old Man Tree_IGT  Von Damm   Old Man Tree        T0      IGT
5     Von Damm_Ravelin #2_Bag  Von Damm     Ravelin #2        T0      Bag
6     Von Damm_Ravelin #2_IGT  Von Damm     Ravelin #2        T0      IGT
7  Von Damm_Mustard Stand_Bag  Von Damm  Mustard Stand        T0      Bag
8    Von Damm_Shrimp Hole_Bag  Von Damm    Shrimp Hole        T0      Bag
9           Piccard_Plume_Bag   Piccard          Plume        T0      Bag
10 Piccard_Shrimpocalypse_Bag   Piccard Shrimpocalypse        T0      Bag
11 Piccard_Shrimpocalypse_IGT   Piccard Shrimpocalypse        T0      IGT
12 Piccard_Lots 'O Shrimp_Bag   Piccard Lots 'O Shrimp        T0      Bag
   VARIABLE  avg_conc   SEM_conc Site_Order SAMPLE_TYPE_BIN pgC_ml_mean
1   eukCONC  91.83773  21.866127   Von Damm        Non-vent    8391.106
2   eukCONC 157.77468  67.098589   Von Damm        Non-vent   14415.688
3   eukCONC 314.87222 104.957407   Von Damm            Vent   86989.981
4   eukCONC 472.30833 122.450309   Von Damm            Vent  130484.971
5   eukCONC 409.33389  73.470185   Von Damm            Vent  113086.975
6   eukCONC 620.99799 123.177023   Von Damm            Vent  171563.573
7   eukCONC 259.76958  28.863287   Von Damm            Vent   71766.734
8   eukCONC 385.71847   7.871806   Von Damm            Vent  106562.726
9   eukCONC  79.30115  16.819081    Piccard        Non-vent    7245.654
10  eukCONC 454.81543         NA    Piccard            Vent  125652.194
11  eukCONC 454.81543  69.971605    Piccard            Vent  125652.194
12  eukCONC 230.90630         NA    Piccard            Vent   63792.652
   pgC_ml_min pgC_ml_max
1   2595.7077   21900.26
2   4459.3540   37624.05
3    261.0534  352958.64
4    391.5801  529437.96
5    339.3694  458846.23
6    514.8553  696112.88
7    215.3690  291190.88
8    319.7904  432374.34
9   2241.3730   18910.70
10   377.0771  509829.15
11   377.0771  509829.15
12   191.4391  258836.34</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> (pgC_ml_mean<span class="sc">/</span><span class="dv">1000</span>))) <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (pgC_ml_min<span class="sc">/</span><span class="dv">1000</span>), <span class="at">ymax =</span> (pgC_ml_max<span class="sc">/</span><span class="dv">1000</span>))) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>L<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - derived from biovolume"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>**What should I do with replicates?</p>
</section>
<section id="c-biomass-based-on-size-fraction" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="c-biomass-based-on-size-fraction"><span class="header-section-number">8.2</span> C biomass based on size fraction</h2>
<p>Derived from Caron et al.&nbsp;1995</p>
<ol type="1">
<li>Assign by size class</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>c_n <span class="ot">&lt;-</span> <span class="fl">2.6</span> <span class="co"># pg C per cell</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>c_m <span class="ot">&lt;-</span> <span class="dv">138</span> <span class="co"># pg C per cell</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample_tmp <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">!=</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> <span class="co"># isolate micro vs. nano</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_cell =</span> <span class="fu">case_when</span>(</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> c_m,</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> c_n</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_ml_TMP =</span> avg_conc <span class="sc">*</span> pg_C_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXPERIMENT, SiteOrder, NameOrder, TimePoint, EXP_TYPE, SAMPLE_TYPE_BIN, Site_Order, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml_TMP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EXPERIMENT', 'SiteOrder', 'NameOrder',
'TimePoint', 'EXP_TYPE', 'SAMPLE_TYPE_BIN', 'Site_Order'. You can override
using the `.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXPERIMENT, SiteOrder, NameOrder, TimePoint, EXP_TYPE, SAMPLE_TYPE_BIN, Site_Order) <span class="sc">%&gt;%</span> </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pg_C_ml =</span> <span class="fu">sum</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">VARIABLE =</span> <span class="st">"totaleuk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'EXPERIMENT', 'SiteOrder', 'NameOrder',
'TimePoint', 'EXP_TYPE', 'SAMPLE_TYPE_BIN'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp2, pgC_ml_sizefrac_bysample_tmp)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pgC_ml_sizefrac_bysample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
  SAMPLE_TYPE_BIN VARIABLE  MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 Non-vent        microCONC        1481.       3156.          0 
2 Non-vent        nanoCONC          257.        351.        182.
3 Non-vent        totaleuk         1738.       3507.        239.
4 Vent            microCONC        4788.      14484.          0 
5 Vent            nanoCONC          951.       1524.        600.
6 Vent            totaleuk         5739.      15439.        600.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_sizefrac_bysample)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>by_sizefrac_plot <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> (pg_C_ml<span class="sc">/</span><span class="dv">1000</span>))) <span class="sc">+</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> VARIABLE)) <span class="sc">+</span> </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_linerange(aes(ymin = (pgC_ml_min/1000), ymax = (pgC_ml_max/1000))) +</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>L<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - based on size fraction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Combined supplementary plot showing two routes of determining total biomass.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="sc">+</span> by_sizefrac_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="compare-total-carbon-biomass---euks" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="compare-total-carbon-biomass---euks"><span class="header-section-number">8.3</span> Compare total carbon biomass - euks</h2>
<p>Compilation table of carbon biomass values for microeukaryotes by sample type and vent field</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="do">## carbon biomass derived from biovolume, by sample type</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN)<span class="sc">%&gt;%</span> </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  SAMPLE_TYPE_BIN MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml ORIGIN     
  &lt;chr&gt;                  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;      
1 Non-vent              10017.      14416.       7246. bybiovolume
2 Vent                 110617.     171564.      63793. bybiovolume</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">## carbon biomass derived from biovolume, by vent field (vent only)</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site_Order)<span class="sc">%&gt;%</span> </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Site_Order MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml ORIGIN     
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;      
1 Von Damm        113409.     171564.      71767. bybiovolume
2 Piccard         105032.     125652.      63793. bybiovolume</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass estimates from sample type and size fraction</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   SAMPLE_TYPE_BIN [2]
  SAMPLE_TYPE_BIN VARIABLE  MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml ORIGIN  
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;   
1 Non-vent        microCONC        1481.       3156.          0  sizefrac
2 Non-vent        nanoCONC          257.        351.        182. sizefrac
3 Non-vent        totaleuk         1738.       3507.        239. sizefrac
4 Vent            microCONC        4788.      14484.          0  sizefrac
5 Vent            nanoCONC          951.       1524.        600. sizefrac
6 Vent            totaleuk         5739.      15439.        600. sizefrac</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass estimates from vent sites only, by vent field and size fraction</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site_Order, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site_Order'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   Site_Order [2]
  Site_Order VARIABLE  MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml ORIGIN  
  &lt;fct&gt;      &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;   
1 Von Damm   microCONC        5572.      14484.          0  sizefrac
2 Von Damm   nanoCONC          962.       1524.        675. sizefrac
3 Von Damm   totaleuk         6535.      15439.        675. sizefrac
4 Piccard    microCONC        3219.       4828.          0  sizefrac
5 Piccard    nanoCONC          928.       1092.        600. sizefrac
6 Piccard    totaleuk         4147.       5920.        600. sizefrac</code></pre>
</div>
</div>
</section>
<section id="compare-biovolumes-from-literature-to-measured-in-this-study" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="compare-biovolumes-from-literature-to-measured-in-this-study"><span class="header-section-number">8.4</span> Compare biovolumes from literature to measured in this study</h2>
<p>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10^7 µm^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</p>
<p>Import the heterotroph species volume and carbon content to compare to my measured values. Compare to md-lessard (Supplementary)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># biov</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, <span class="at">Volume =</span> BIOVOLUME, <span class="at">pgC_cell =</span> pgC_cell_MD_nodiatom)) <span class="sc">%&gt;%</span> </span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>carbon_compare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</p>
</section>
</section>
<section id="carbon-biomass-for-prokaryotes" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Carbon biomass for prokaryotes</h1>
<p>Now, report estimated carbon per cell for bacteria.</p>
<p>Units: fg C per cell.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>bac_carbon_Mor_fg <span class="ot">&lt;-</span> (<span class="dv">86</span>) </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co">#From Derived from Morono et al. 2011 </span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>bac_carbon_Lof_fg <span class="ot">&lt;-</span> (<span class="dv">173</span>) </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Derived from McNichol et al. 2018; LOFERER-KROBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fg C per cell</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>bac_carbon_mean <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>bac_carbon_min <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>bac_carbon_max <span class="ot">&lt;-</span> <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Import main table with all estimates of cells</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"output-data/table1-grazing-exp-list.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 13 Columns: 17
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr  (5): FIELD, NAME, EXP, SAMPLE, TimePoints
dbl (12): EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, PROK_ml, PROK_sem, EUK_ml,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>RATE_min units = FLPs per grazer per minute Clearance rate _ml = ml per grazer per hour</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), RATE_min, CLEARANCE_RATE_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in calcs by fg C per cell.</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimates of carbon pool of microbes per ml. </span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MOR_fgC_ml =</span> bac_carbon_Mor_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">LOF_fgC_ml =</span> bac_carbon_Lof_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">MEAN_fgC_ml =</span> bac_carbon_mean <span class="sc">*</span> PROK_ml,</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_fgC_ml =</span> bac_carbon_max <span class="sc">*</span> PROK_ml,</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_fgC_ml =</span> bac_carbon_min <span class="sc">*</span> PROK_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"fgC_ml"</span>), <span class="at">names_to =</span> <span class="st">"fgC_ml"</span>)</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(est_prok_carbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  FIELD NAME  EXP   SAMPLE PROK_ml PROK_…¹ RATE_…² CLEAR…³ GRAZI…⁴ fgC_ml  value
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
1 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MOR_f… 3.26e6
2 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  LOF_f… 6.55e6
3 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MEAN_… 5.68e5
4 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MAX_f… 7.58e5
5 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MIN_f… 3.79e5
6 Von … Plume Bag   VD-Pl…  16478.   2624. 0.00527 9.24e-6    24.0 MOR_f… 1.42e6
# … with abbreviated variable names ¹​PROK_sem, ²​RATE_min, ³​CLEARANCE_RATE_ml,
#   ⁴​GRAZING_EFFECT_hr</code></pre>
</div>
</div>
<p>Get summary of prokaryotic biomass</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, fgC_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pgC_ml =</span> <span class="fu">mean</span>((value)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_pgC_ml =</span> <span class="fu">min</span>((value)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_pgC_ml =</span> <span class="fu">max</span>((value)<span class="sc">*</span>(<span class="fl">0.001</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
   SAMPLE_TYPE_BIN fgC_ml      mean_pgC_ml min_pgC_ml max_pgC_ml
   &lt;chr&gt;           &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Non-vent        LOF_fgC_ml        6101.      2851.      8897.
 2 Non-vent        MAX_fgC_ml         705.       330.      1029.
 3 Non-vent        MEAN_fgC_ml        529.       247.       771.
 4 Non-vent        MIN_fgC_ml         353.       165.       514.
 5 Non-vent        MOR_fgC_ml        3033.      1417.      4423.
 6 Vent            LOF_fgC_ml       17745.      7263.     41275.
 7 Vent            MAX_fgC_ml        2051.       840.      4772.
 8 Vent            MEAN_fgC_ml       1539.       630.      3579.
 9 Vent            MIN_fgC_ml        1026.       420.      2386.
10 Vent            MOR_fgC_ml        8821.      3611.     20518.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(est_prok_carbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  FIELD NAME  EXP   SAMPLE PROK_ml PROK_…¹ RATE_…² CLEAR…³ GRAZI…⁴ fgC_ml  value
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
1 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MOR_f… 3.26e6
2 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  LOF_f… 6.55e6
3 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MEAN_… 5.68e5
4 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MAX_f… 7.58e5
5 Von … Back… Bag   VD-BSW  37890.   8608. 0.00296 3.65e-5   127.  MIN_f… 3.79e5
6 Von … Plume Bag   VD-Pl…  16478.   2624. 0.00527 9.24e-6    24.0 MOR_f… 1.42e6
# … with abbreviated variable names ¹​PROK_sem, ²​RATE_min, ³​CLEARANCE_RATE_ml,
#   ⁴​GRAZING_EFFECT_hr</code></pre>
</div>
</div>
<section id="incorporate-carbon-biomass-of-prey-and-grazing-rate" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="incorporate-carbon-biomass-of-prey-and-grazing-rate"><span class="header-section-number">9.1</span> Incorporate carbon biomass of prey and grazing rate</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon consumed based on clearance rate</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="ot">&lt;-</span> est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fgC_ml <span class="sc">==</span> <span class="st">"MOR_fgC_ml"</span>) <span class="sc">%&gt;%</span> <span class="co">#use only value from Morono et al.</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ugC_cell =</span> (bac_carbon_Mor_fg <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, PROK_ml, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, ugC_cell, <span class="at">ugC_ml =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ugC_pergrazer_CLEARANCE =</span> ugC_ml <span class="sc">*</span> CLEARANCE_RATE_ml,</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ugC_perml_perhr =</span> ugC_cell <span class="sc">*</span> GRAZING_EFFECT_hr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Summary of carbon consumed:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="sc">%&gt;%</span> </span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">mean</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">MEAN_ugC_perml_perhr =</span> <span class="fu">mean</span>(ugC_perml_perhr),</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_pergrazer_CLEARANCE =</span> <span class="fu">max</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_perml_perhr =</span> <span class="fu">max</span>(ugC_perml_perhr),</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">min</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_perml_perhr =</span> <span class="fu">min</span>(ugC_perml_perhr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  SAMPLE_TYPE_BIN MEAN_ugC_pergrazer_C…¹ MEAN_…² MAX_u…³ MAX_u…⁴ MIN_u…⁵ MIN_u…⁶
  &lt;chr&gt;                            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Non-vent                          60.0    5.60    119.    10.9    13.1    2.07
2 Vent                             750.   358.     3863.  1757.      0      0   
# … with abbreviated variable names ¹​MEAN_ugC_pergrazer_CLEARANCE,
#   ²​MEAN_ugC_perml_perhr, ³​MAX_ugC_pergrazer_CLEARANCE, ⁴​MAX_ugC_perml_perhr,
#   ⁵​MIN_ugC_pergrazer_CLEARANCE, ⁶​MIN_ugC_perml_perhr</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="sc">%&gt;%</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD) <span class="sc">%&gt;%</span> </span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">mean</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MEAN_ugC_perml_perhr =</span> <span class="fu">mean</span>(ugC_perml_perhr),</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_pergrazer_CLEARANCE =</span> <span class="fu">max</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_perml_perhr =</span> <span class="fu">max</span>(ugC_perml_perhr),</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">min</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_perml_perhr =</span> <span class="fu">min</span>(ugC_perml_perhr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  FIELD    MEAN_ugC_pergrazer_CLEARANCE MEAN_u…¹ MAX_u…² MAX_u…³ MIN_u…⁴ MIN_u…⁵
  &lt;chr&gt;                           &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Piccard                         1666.     758.   3863.   1757.       0       0
2 Von Damm                         358.     186.   1056.    656.       0       0
# … with abbreviated variable names ¹​MEAN_ugC_perml_perhr,
#   ²​MAX_ugC_pergrazer_CLEARANCE, ³​MAX_ugC_perml_perhr,
#   ⁴​MIN_ugC_pergrazer_CLEARANCE, ⁵​MIN_ugC_perml_perhr</code></pre>
</div>
</div>
</section>
</section>
<section id="compare-with-axial-euk-cell-count" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Compare with Axial euk cell count</h1>
<p>From Axial Seamount cruise (July 2022) - have Anemone vent and plume euk cell counts to compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>counts_ax <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../GrazingatAxial-2022/euk-cell-counts-11142022.csv"</span>, </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>counts_ax[<span class="fu">is.na</span>(counts_ax)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Modify grazing code to count euk cells/ml so it considers euk cell count samples only.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_axial <span class="ot">&lt;-</span> counts_ax <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, <span class="at">EXP =</span> <span class="st">`</span><span class="at">EXP.ID</span><span class="st">`</span>, <span class="at">VOL =</span> <span class="st">`</span><span class="at">vol..ml.</span><span class="st">`</span>, <span class="at">MAG =</span> <span class="st">`</span><span class="at">Mag..x.</span><span class="st">`</span>, <span class="at">nano =</span> <span class="st">`</span><span class="at">X.20um..no.FLP</span><span class="st">`</span>, <span class="at">micro =</span> <span class="st">`</span><span class="at">X.20um..no.FLP.1</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXP, VOL) <span class="sc">%&gt;%</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nano), </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(micro),</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span> </span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar)))) <span class="sc">%&gt;%</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab filter rig, it is 283.385):</span></span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'EXP'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # left_join(expmeta) %&gt;%</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(SAMPLE, c("Site", "Name"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(EXPID, c("TimePoint", "Replicate"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data.frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Thoughts on cell counts. Combining nano and micro for now, as the de-pressurization can cause issues in size. Likely underestimates for these counts.</p>
<p>This is further supported because the biovolumes of all cells were pretty low.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_cellsml_axial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 16
# Groups:   SAMPLE, EXP [6]
  SAMPLE      EXP     VOL total…¹ nanoAvg nanoVar nanoSd micro…² micro…³ microSd
  &lt;chr&gt;       &lt;chr&gt; &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Anemone     eukc…   200      30   0.9     0.921   1.92  0.0333  0.0333   0.365
2 Anemone     eukc…   200      30   0.967   0.930   1.93  0.167   0.144    0.758
3 Anemone     eukc…   200      30   1.3     1.32    2.30  0.1     0.0931   0.610
4 ASHES Plume coun…   200      30   0.4     0.455   1.35  0.133   0.120    0.691
5 ASHES Plume coun…   200      30   0.267   0.271   1.04  0.133   0.120    0.691
6 ASHES Plume coun…   200      30   0.467   0.602   1.55  0.1     0.0931   0.610
# … with 6 more variables: euksAvg &lt;dbl&gt;, euksVar &lt;dbl&gt;, euksSd &lt;dbl&gt;,
#   nanoCONC &lt;dbl&gt;, microCONC &lt;dbl&gt;, eukCONC &lt;dbl&gt;, and abbreviated variable
#   names ¹​totalFOV, ²​microAvg, ³​microVar</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(counts_cellsml_axial<span class="sc">$</span>eukCONC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_euk_conc)</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_axial)</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="sc">%&gt;%</span> </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span> <span class="sc">&amp;</span> TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(CONCENTRATION)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"MidCaymanRise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(counts_cellsml_axial <span class="sc">%&gt;%</span> </span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Name =</span> EXP, eukCONC) <span class="sc">%&gt;%</span> </span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(eukCONC)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"AxialSeamount"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"ASHES Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"International District Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Name, <span class="at">y =</span> euk_conc_mean)) <span class="sc">+</span></span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> TYPE), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb160-25"><a href="#cb160-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> FIELD <span class="sc">+</span> TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb160-26"><a href="#cb160-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb160-27"><a href="#cb160-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb160-28"><a href="#cb160-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="environmental-parameters---mcr" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Environmental parameters - MCR</h1>
<p>Import from Hu et al.&nbsp;(<em>Molecular Ecology</em>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE, <span class="fu">everything</span>())</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate supplementary table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis-of-grazing-rate-results" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Analysis of grazing rate results</h1>
<p>Re-import table from output table with all grazing values</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Format and factor values to plot, and prioritize these values:</p>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
<li>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_wcalcs_biomass_bounded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            NAME    FIELD SAMPLE_TYPE_BIN MDL_BIOMASS CARON_BIOMASS EXP
1     Background Von Damm        Non-vent     8391106             0 Bag
2          Plume Von Damm        Non-vent    14415688       3156397 Bag
3          Plume  Piccard        Non-vent     7245653       1287478 Bag
4 Shrimpocalypse  Piccard            Vent   125652196       4828041 Bag
5 Shrimpocalypse  Piccard            Vent   125652196       4828041 IGT
6 Lots 'O Shrimp  Piccard            Vent    63792653             0 Bag
                  SAMPLE    RATE_min     FLP_ml   PROK_ml  PROK_sem    EUK_ml
1                 VD-BSW 0.002958889  4861.8239  37889.62  8608.427  91.83773
2               VD-Plume 0.005274231 34242.3542  16478.31  2623.935 157.77468
3          Piccard-Plume 0.005362856 29650.4676  51429.13  4618.126  79.30115
4 Piccard-Shrimpocalypse 0.015686872 17003.1000 238585.68 65792.588 454.81543
5 Piccard-Shrimpocalypse 0.016794258  5352.8278 238585.68 65792.588 454.81543
6    Piccard-LotsOShrimp 0.000000000   617.1496  53878.14 13727.191 230.90630
   EUK_sem        TimePoints EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL   RATE_hr
1 21.86613 0, 10, 15, 20, 40        3    2.00         2      0.5 0.1775333
2 67.09859 0, 10, 15, 25, 57        3    2.00         2      1.0 0.3164538
3 16.81908 0, 10, 15, 20, 40        3    2.00         2      0.5 0.3217713
4       NA 0, 10, 14, 22, 42        3    1.50         2      0.2 0.9412123
5 69.97160         0, 15, 25        1    0.15        NA       NA 1.0076555
6       NA     0, 15, 20, 40        3    1.50         2      0.2 0.0000000
   RATE_day      FLP_L CLEARANCE_RATE_ml CLEARANCE_RATE_nL SPEC_GRAZE_RATE_hr
1  4.260800  4861823.9      3.651579e-05      3.651579e-11          1.3835695
2  7.594892 34242354.2      9.241591e-06      9.241591e-12          0.1522858
3  7.722512 29650467.6      1.085215e-05      1.085215e-11          0.5581167
4 22.589096 17003100.0      5.535534e-05      5.535534e-11         13.2069906
5 24.183732  5352827.8      1.882473e-04      1.882473e-10         44.9131155
6  0.000000   617149.6      0.000000e+00      0.000000e+00          0.0000000
  GRAZE_RATE_DAY GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1       33.20567         127.06388              96.81058             157.31719
2        3.65486          24.02685              13.80868              34.24501
3       13.39480          44.25930              34.87229              53.64630
4      316.96778        6006.74315                    NA                    NA
5     1077.91477       20427.17803           17284.53525           23569.82080
6        0.00000           0.00000                    NA                    NA
  GRAZING_EFFECT_day BAC_TURNOVER_PERC BAC_TURNOVER_PERC_min
1          3049.5332          8.048465             10.414647
2           576.6444          3.499414              4.162182
3          1062.2231          2.065411              2.269174
4        144161.8356         60.423507             83.430323
5        490252.2727        205.482690            283.722148
6             0.0000          0.000000              0.000000
  BAC_TURNOVER_PERC_max bac_C_ug_MOR bac_C_ug_LOF
1              6.558411      8.6e-08     1.73e-07
2              3.018725      8.6e-08     1.73e-07
3              1.895228      8.6e-08     1.73e-07
4             47.362723      8.6e-08     1.73e-07
5            161.066779      8.6e-08     1.73e-07
6              0.000000      8.6e-08     1.73e-07
  RATE_ugCbac_pergrazer_perday_MOR RATE_ugCbac_pergrazer_perday_LOF
1                     3.664288e-07                     7.371184e-07
2                     6.531607e-07                     1.313916e-06
3                     6.641361e-07                     1.335995e-06
4                     1.942662e-06                     3.907914e-06
5                     2.079801e-06                     4.183786e-06
6                     0.000000e+00                     0.000000e+00
  SPEC_INGESTION_RATE_MDL SPEC_INGESTION_RATE_CAR Prok_biomass
1            4.366871e-14                     Inf  0.003258508
2            4.530902e-14            2.069324e-13  0.001417135
3            9.165993e-14            5.158428e-13  0.004422905
4            1.546063e-14            4.023707e-13  0.020518368
5            1.655205e-14            4.307754e-13  0.020518368
6            0.000000e+00                      NA  0.004633520
  Prok_biomass_L_MOR Prok_biomass_L_LOF Prok_biomass_sem_MOR
1           3.258508           6.554905         0.0007403247
2           1.417135           2.850748         0.0002256584
3           4.422905           8.897239         0.0003971588
4          20.518368          41.275323         0.0056581625
5          20.518368          41.275323         0.0056581625
6           4.633520           9.320917         0.0011805385
  Prok_biomass_sem_L_MOR detected       type  GRAZE_RATE  type_site
1              0.7403247 Detected Background 0.002958889 Background
2              0.2256584 Detected      Plume 0.005274231      Plume
3              0.3971588 Detected      Plume 0.005362856      Plume
4              5.6581625 Detected   Vent-Bag 0.015686872       Vent
5              5.6581625 Detected   Vent-IGT 0.016794258       Vent
6              1.1805385 Detected   Vent-Bag 0.000000000       Vent</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs_biomass_bounded$Euk</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Report grazing rates</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span> </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, EXP) <span class="sc">%&gt;%</span> </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">MEAN_RATE =</span> <span class="fu">mean</span>(GRAZING_EFFECT_hr),</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">MIN_RATE =</span> <span class="fu">min</span>(GRAZING_EFFECT_hr),</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">MAX_RATE =</span> <span class="fu">max</span>(GRAZING_EFFECT_hr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
  SAMPLE_TYPE_BIN EXP   MEAN_RATE MIN_RATE MAX_RATE
  &lt;chr&gt;           &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Non-vent        Bag        65.1     24.0     127.
2 Vent            Bag      1215.       0      6007.
3 Vent            IGT      8578.     794.    20427.</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot <span class="ot">&lt;-</span> table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, type,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>        PROK_ml, EUK_ml, PROK_sem, EUK_sem,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_L_MOR, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Euk_biomass_Hu_L, Euk_biomass_lit_L,</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>        GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, BAC_TURNOVER_PERC_min, BAC_TURNOVER_PERC_max,</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>        GRAZE_RATE) <span class="sc">%&gt;%</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml,</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>                        Prok_biomass_L_MOR, </span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Euk_biomass_Hu_L, Euk_biomass_lit_L,</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>                        GRAZING_EFFECT_hr, BAC_TURNOVER_PERC,</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>                        GRAZE_RATE),</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_sem, EUK_sem, </span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>                        BAC_TURNOVER_PERC_max, BAC_TURNOVER_PERC_min, GRAZING_EFFECT_hr_max, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max),</span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"SEM_variable"</span>, <span class="at">values_to =</span> <span class="st">"SEM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>VARIABLE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>Variable,</span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PROK_ml"</span>, <span class="st">"EUK_ml"</span>,</span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prok_biomass_L_MOR"</span>, </span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># "Euk_biomass_Hu_L", "Euk_biomass_lit_L",</span></span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZING_EFFECT_hr"</span>, <span class="st">"BAC_TURNOVER_PERC"</span>,</span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZE_RATE"</span>),</span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Prokaryote~cells~mL^{-1}"</span>, <span class="st">"Eukaryote~cells~mL^{-1}"</span>,</span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prokaryote~µg~C~L^{-1}"</span>, </span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># "Measured~eukaryote~µg~C~L^{-1}", "Literature-based~eukaryote~µg~C~L^{-1}",</span></span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cells~mL^{-1}~hr^{-1}"</span>, <span class="st">"Prokaryote~turnover~'%'~d^{-1}"</span>,</span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"FLP~consumed~min^{-1}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="function-to-plot-grazing-results" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="function-to-plot-grazing-results"><span class="header-section-number">12.1</span> Function to plot grazing results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>conc_rate_plot_mcr <span class="ot">&lt;-</span> <span class="cf">function</span>(df, var, sem){</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> var) <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> sem) <span class="sc">%&gt;%</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Value <span class="sc">+</span> SEM), <span class="at">ymin =</span> (Value <span class="sc">-</span> SEM)),</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(VARIABLE_ORDER <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free"</span>,</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>), <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb172-30"><a href="#cb172-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb172-31"><a href="#cb172-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb172-32"><a href="#cb172-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "PROK_ml", "PROK_sem")</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "EUK_ml", "EUK_sem")</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Prok_biomass_L", "Prok_biomass_sem_L")</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Euk_biomass_Hu_L", "Euk_biomass_Hu_sem_L")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biomass_rate_plot)</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(biomass_rate_plot$FIELD)</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> biomass_rate_plot <span class="sc">%&gt;%</span> </span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_min"</span> <span class="sc">|</span> SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_max"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> SEM_variable, <span class="at">values_from =</span> SEM) <span class="sc">%&gt;%</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">NAME_ORDER =</span> <span class="fu">factor</span>(NAME, <span class="at">levels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">FIELD_ORDER =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD_ORDER)) <span class="sc">+</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD_ORDER),</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELD_ORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># facet_wrap(. ~ FIELD_ORDER, scales = "free", </span></span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#            labeller = label_parsed) +</span></span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_flip() +</span></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb174-35"><a href="#cb174-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb174-36"><a href="#cb174-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb174-37"><a href="#cb174-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb174-38"><a href="#cb174-38" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb174-39"><a href="#cb174-39" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
</section>
<section id="figure-1-compilation" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Figure 1 compilation</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_prok_flp_rate &lt;- </span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">/</span> </span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> <span class="fu">guide_area</span>() <span class="sc">+</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">|</span> </span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  (grazing_min_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.02</span>))) <span class="sc">/</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>  (grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e4</span>))) <span class="sc">+</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span> <span class="fu">guide_area</span>() <span class="sc">|</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<section id="grazing-rate-vs.-cells-ml" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="grazing-rate-vs.-cells-ml"><span class="header-section-number">13.1</span> Grazing rate vs.&nbsp;cells ml</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>env_params <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> <span class="st">"input-data/table_wenv.txt"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(env_params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SEQ_SAMPLE"                   "VENT"                        
 [3] "COORDINATES"                  "SAMPLETYPE"                  
 [5] "DEPTH"                        "YEAR"                        
 [7] "TEMP"                         "pH"                          
 [9] "Perc"                         "Mg"                          
[11] "H2."                          "H2S"                         
[13] "CH4"                          "ProkConc"                    
[15] "Sample_actual"                "Type"                        
[17] "FIELD"                        "ref_num"                     
[19] "SITE"                         "Sample_or_Control"           
[21] "SAMPLEID"                     "NAME"                        
[23] "EXP"                          "RATE_min"                    
[25] "FLP_ml"                       "PROK_ml"                     
[27] "PROK_sem"                     "EUK_ml"                      
[29] "EUK_sem"                      "TimePoints"                  
[31] "EXP_REPS"                     "EXP_VOL"                     
[33] "CTRL_REPS"                    "CTRL_VOL"                    
[35] "RATE_hr"                      "RATE_day"                    
[37] "FLP_L"                        "CLEARANCE_RATE_ml"           
[39] "CLEARANCE_RATE_nL"            "SPEC_GRAZE_RATE_hr"          
[41] "GRAZE_RATE_DAY"               "GRAZING_EFFECT_hr"           
[43] "GRAZING_EFFECT_hr_min"        "GRAZING_EFFECT_hr_max"       
[45] "GRAZING_EFFECT_day"           "BAC_TURNOVER_PERC"           
[47] "BAC_TURNOVER_PERC_min"        "BAC_TURNOVER_PERC_max"       
[49] "euk_C_ug_Hu"                  "euk_C_ug_lit"                
[51] "bac_C_ug"                     "bac_C_ug_2"                  
[53] "RATE_ugCbac_pergrazer_perday" "SPEC_INGESTION_RATE"         
[55] "SPEC_INGESTION_RATE_lit"      "Prok_biomass"                
[57] "Euk_biomass_Hu"               "Euk_biomass_lit"             
[59] "Prok_biomass_L"               "Euk_biomass_Hu_L"            
[61] "Euk_biomass_lit_L"            "Prok_biomass_sem"            
[63] "Euk_biomass_Hu_sem"           "Euk_biomass_lit_sem"         
[65] "Prok_biomass_sem_L"           "Euk_biomass_Hu_sem_L"        
[67] "Euk_biomass_lit_sem_L"        "detected"                    
[69] "type"                         "GRAZE_RATE"                  
[71] "type_site"                    "fgC_cell"                    
[73] "fgC_ml_perday"                "ugC_L_perday"                
[75] "lower_mcnichol"               "upper_mcnichol"              </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="ot">&lt;-</span> env_params <span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_hr"</span>), pH, Mg, H2., CH4, H2S)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot_wider(names_from = "name", values_from = "value", values_fill = NA)</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compare microbial biomass, concentration, grazing and temperature across all sites.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>()) <span class="sc">+</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>euk_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem)))) <span class="sc">+</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Microial prey cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>prok_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="figure-2-compilation" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Figure 2 compilation</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>(euk_temp <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> prok_temp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plot other environmental parameters</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>plot_supp <span class="ot">&lt;-</span> <span class="cf">function</span>(PARAMETER){</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pH, Mg, H2., CH4, H2S), <span class="at">names_to =</span> <span class="st">"ENV"</span>, <span class="at">values_to =</span> <span class="st">"ENV_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ENV_NUM =</span> <span class="fu">as.numeric</span>(ENV_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ENV <span class="sc">==</span> PARAMETER) <span class="sc">%&gt;%</span> </span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> ENV_VALUE)) <span class="sc">+</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>,</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> PARAMETER)</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pH, Mg, H2., CH4, H2S</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_supp</span>(<span class="st">"pH"</span>) <span class="sc">+</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"Mg"</span>) <span class="sc">+</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2."</span>) <span class="sc">+</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"CH4"</span>) <span class="sc">+</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2S"</span>) <span class="sc">+</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values (geom_errorbarh).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="comparison-with-gorda-ridge" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Comparison with Gorda Ridge</h1>
<p>Import data from Gorda Ridge</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"/Users/sarahhu/Desktop/Projects/GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="combine-gr-and-mcr-data" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="combine-gr-and-mcr-data"><span class="header-section-number">15.1</span> Combine GR and MCR data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span> </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover)) <span class="sc">%&gt;%</span> </span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("NAME", "SAMPLE")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-combined-results" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="plot-combined-results"><span class="header-section-number">15.2</span> Plot combined results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add Gorda Ridge comparison to supplementary?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>allrates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-92-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="remove-undetected-grazing-rate" class="level3">
<h3 class="anchored" data-anchor-id="remove-undetected-grazing-rate">Remove undetected grazing rate</h3>
<p>Repeat grazing rate plot, but removed undetectable</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb225-26"><a href="#cb225-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb225-27"><a href="#cb225-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb225-28"><a href="#cb225-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb225-29"><a href="#cb225-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Panel plot, cells per ml and grazing rate</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("plot-gcellconc-grazing-log.svg", h = 10, w = 6)</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate + scale_y_log10(limits = c(1e-1,1e5), breaks=10^(0:7))</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>),</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>),</span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>(), <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/Plot%20cell%20conc%20and%20rates-1.png" class="img-fluid" width="576"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("cells-per-ml.svg", h = 7, w = 7)</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>) <span class="sc">+</span> <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="linear-regression-tidy-models" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Linear regression &amp; tidy models</h1>
<p>TO DO: find a tidy model tutorial to work with.</p>
<p>Use tidymodels to perform linear regression.</p>
<section id="mcr-and-gr-data-as-input" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="mcr-and-gr-data-as-input"><span class="header-section-number">16.1</span> MCR and GR data as input</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD           NAME                 SAMPLE EXP   PROK_ml    EUK_ml
1 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
2 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
3 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
4 Von Damm          Plume               VD-Plume Bag  16478.31 157.77468
5  Piccard          Plume          Piccard-Plume Bag  51429.13  79.30115
6  Piccard Shrimpocalypse Piccard-Shrimpocalypse Bag 238585.68 454.81543
  GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1         127.06388              96.81058             157.31719
2         127.06388              96.81058             157.31719
3         127.06388              96.81058             157.31719
4          24.02685              13.80868              34.24501
5          44.25930              34.87229              53.64630
6        6006.74315                    NA                    NA
  BAC_TURNOVER_PERC Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1          8.048465        4.181 NA NA  NA NA  NA  Background
2          8.048465        4.100 NA NA  NA NA  NA  Background
3          8.048465        4.000 NA NA  NA NA  NA  Background
4          3.499414        4.230 NA NA  NA NA  NA  Background
5          2.065411        4.722 NA NA  NA NA  NA  Background
6         60.423507       90.000 NA NA  NA NA  NA        Vent</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;%</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS,</span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>regression_results <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("RATE", "PARAMS")
Joining, by = c("RATE", "PARAMS")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>regression_results <span class="sc">%&gt;%</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;%</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 16 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Temperature (C)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$y
"Cells " ~ mL^-1 ~ hr^-1

$x
[1] "Temperature (C)"

attr(,"class")
[1] "labels"</code></pre>
</div>
</div>
</section>
<section id="mcr-only" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="mcr-only"><span class="header-section-number">16.2</span> MCR only</h2>
<p>repeat MCR only</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-20"><a href="#cb244-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb244-21"><a href="#cb244-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb244-22"><a href="#cb244-22" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb244-23"><a href="#cb244-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb244-24"><a href="#cb244-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb244-25"><a href="#cb244-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("RATE", "PARAMS")
Joining, by = c("RATE", "PARAMS")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_mcr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="sc">%&gt;%</span> </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb250-16"><a href="#cb250-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb250-17"><a href="#cb250-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mcr-vent-sites-only" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="mcr-vent-sites-only"><span class="header-section-number">16.3</span> MCR vent sites only</h2>
<p>Repeat with only vent sites &amp; remove undetected grazing.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$GRAZING_EFFECT_hr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Background"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Plume"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb253-18"><a href="#cb253-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb253-19"><a href="#cb253-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb253-20"><a href="#cb253-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb253-21"><a href="#cb253-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb253-22"><a href="#cb253-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb253-23"><a href="#cb253-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb253-24"><a href="#cb253-24" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb253-25"><a href="#cb253-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb253-26"><a href="#cb253-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb253-27"><a href="#cb253-27" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("RATE", "PARAMS")
Joining, by = c("RATE", "PARAMS")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_vent)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Regression thoughts</em>: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</p>
<p>Bacterial abundance typically increases with temperature (White et al.&nbsp;1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</p>
<p>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature… in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD           NAME                 SAMPLE EXP   PROK_ml    EUK_ml
1 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
2 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
3 Von Damm     Background                 VD-BSW Bag  37889.62  91.83773
4 Von Damm          Plume               VD-Plume Bag  16478.31 157.77468
5  Piccard          Plume          Piccard-Plume Bag  51429.13  79.30115
6  Piccard Shrimpocalypse Piccard-Shrimpocalypse Bag 238585.68 454.81543
  GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1         127.06388              96.81058             157.31719
2         127.06388              96.81058             157.31719
3         127.06388              96.81058             157.31719
4          24.02685              13.80868              34.24501
5          44.25930              34.87229              53.64630
6        6006.74315                    NA                    NA
  BAC_TURNOVER_PERC Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1          8.048465        4.181 NA NA  NA NA  NA  Background
2          8.048465        4.100 NA NA  NA NA  NA  Background
3          8.048465        4.000 NA NA  NA NA  NA  Background
4          3.499414        4.230 NA NA  NA NA  NA  Background
5          2.065411        4.722 NA NA  NA NA  NA  Background
6         60.423507       90.000 NA NA  NA NA  NA        Vent</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(allvent_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Function to plot results by two parameters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-temperature-by-eukprok-and-then-euk-and-prok" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="header-section-number">16.4</span> Plot temperature by euk:prok and then euk and prok</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-temperature-by-grazing-rate" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="plot-temperature-by-grazing-rate"><span class="header-section-number">16.5</span> Plot temperature by grazing rate</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FIELD"                 "NAME"                  "SAMPLE"               
 [4] "EXP"                   "PROK_ml"               "EUK_ml"               
 [7] "GRAZING_EFFECT_hr"     "GRAZING_EFFECT_hr_min" "GRAZING_EFFECT_hr_max"
[10] "BAC_TURNOVER_PERC"     "Highest.Temp"          "pH"                   
[13] "Mg"                    "H2S"                   "H2"                   
[16] "CH4"                   "SAMPLE_TYPE"           "PROK_EUK_RATIO"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, EUK_ml, "ugC_L_perday", "Euk cells per ml") + scale_y_log10()</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="carbon-biomass-investigation" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Carbon biomass investigation</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co"># carbon_density &lt;- crossing(fgC_cell = seq(86, 300, by = 1), </span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                              GRAZING_EFFECT_hr = seq(min(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   max(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   length.out = 215))  %&gt;%</span></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;%</span></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_lines &lt;- select(all_vents, GRAZING_EFFECT_hr, FIELD) %&gt;% </span></span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;% </span></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   crossing(fgC_cell = seq(86, 300, by = 20)) %&gt;%</span></span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb271-17"><a href="#cb271-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb271-18"><a href="#cb271-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(carbon_density, aes(x = fgC_cell, y = GRAZING_EFFECT_hr)) +</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_raster(aes(fill = ugC_L_perday)) +</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_gradientn(colors = c("#fef0d9", "#b30000"), name = bquote("ug C"~L^-1 ~day^-1)) +</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(expand = c(0,0)) +</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(expand = c(0,0)) +</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black"),</span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         rect = element_rect(fill = "transparent"),</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill = "transparent", color = NA)) +</span></span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = bquote("Cells "~mL^-1 ~consumed ~hr^-1), x = bquote("fg C"~cell^-1)) +</span></span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = samples_lines,</span></span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a><span class="co">#             aes(x = 87,</span></span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a><span class="co">#             y = GRAZING_EFFECT_hr, shape = FIELD), size = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eukaryote biomass comparison with measured vs.&nbsp;literature</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata &lt;- env_params %&gt;% </span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(SAMPLETYPE != "Incubation") %&gt;%</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(VENT != "Quakeplume") %&gt;% </span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, starts_with("PROK_"), starts_with("EUK_"), starts_with("GRAZING_EFFECT_hr"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata %&gt;% </span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Euk_biomass_Hu)) %&gt;% </span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Euk_biomass_Hu_fg = Euk_biomass_Hu * 1000000000,</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          Euk_biomass_lit_fg = Euk_biomass_lit * 1000000000) %&gt;% </span></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = VENT)) +</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_Hu_fg), color = "black", fill = "darkgreen", shape = 21, size = 4) +</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_lit), color = "black", fill = "lightgreen", shape = 21, size = 4) +</span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black")) +</span></span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(SAMPLETYPE ~ ., space = "free", scales = "free") +</span></span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "fg C of eukaryote population", y = "")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="prediction-of-mcr-data-with-parameters" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Prediction of MCR data with parameters</h1>
<p>Best model to estimate community grazing rate in Vaque et al.&nbsp;considered FLP uptake and similar experiments (in contrast to disappearance experiments).</p>
<p>From Vaque et al.&nbsp;1994 paper equation (1):</p>
<p>See Figure 6</p>
<blockquote class="blockquote">
<p>log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</p>
</blockquote>
<p><em>GT</em> = grazing rate (cells ml-1 hr-1) <em>HNF</em> = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) <em>BAC</em> = prokaryote abundance (cells ml-1)</p>
<p>Start with non-zero grazing rate values, etc. Where… <em>GT</em> == Grazing effect hr <em>HNF</em> == Euk_ml <em>BAC</em> == PROK_ml <em>T</em> == highest temp</p>
<p>We only have these for MCR data.. can include GR for the “predicting euk_ml”</p>
<p>Function to use above formula and estimate</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-27"><a href="#cb275-27" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-28"><a href="#cb275-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb275-29"><a href="#cb275-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-30"><a href="#cb275-30" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-31"><a href="#cb275-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb275-32"><a href="#cb275-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-33"><a href="#cb275-33" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb275-34"><a href="#cb275-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb275-35"><a href="#cb275-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb275-36"><a href="#cb275-36" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb275-37"><a href="#cb275-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb275-38"><a href="#cb275-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb275-39"><a href="#cb275-39" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb275-40"><a href="#cb275-40" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb275-41"><a href="#cb275-41" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NaNs produced

Warning in FUN(X[[i]], ...): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 8 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Mid-Cayman Rise only, no undetected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0) %&gt;% filter(!(NAME %in% bsw)), "Mid-Cayman Rise only, no undetected, vents only")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"All samples where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).
Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).
Removed 4 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-117-2.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NaNs produced

Warning in FUN(X[[i]], ...): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NaNs produced

Warning in FUN(X[[i]], ...): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-119-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).
Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid" width="1440"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).
Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-120-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="session" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Session</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_ids &lt;- c("BSW","Plume", "Shrimpocalypse", "LotsOShrimp", "X18", "OMT", "Rav2", "MustardStand", "ShrimpHole")</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_fullname &lt;- c("Background","Plume", "Shrimpocalypse", "Lots 'O Shrimp", "X-18", "Old Man Tree", "Ravelin #2", "Mustard Stand", "Shrimp Hole")</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="co"># site_ids &lt;- c("VD", "Piccard")</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co"># site_fullname &lt;- c("Von Damm", "Piccard")</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="co"># site_color &lt;- c("#264653", "#E76F51")</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="co"># names(site_color) &lt;- site_fullname</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="co"># whole_pal &lt;- c("#264653", "#2A9D8F", "#E9C46A","#F4A261", "#E76F51")</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a><span class="co"># extra &lt;- c("#eae2b7", "#5f0f40", "#90be6d", "#941b0c", "#577590")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>ggplot theme</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_minimal() +</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(panel.grid.major = element_line(), panel.grid.minor = element_blank(),</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            panel.background = element_blank(), </span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.line = element_line(colour = "black"), </span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.text.x = element_text(color="black", size = 12, </span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       angle = 45, hjust = 1, vjust = 1), </span></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.text.y = element_text(color="black", size = 12),</span></span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title =element_text(color="black", size = 12),</span></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.ticks = element_line(),</span></span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a><span class="co">#            strip.text =element_blank(), legend.title = element_blank()) +</span></span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = bquote("Eukaryote cells "~mL^-1),</span></span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.1.2 broom_1.0.1     cowplot_1.1.1   forcats_0.5.2  
 [5] stringr_1.4.1   dplyr_1.0.10    purrr_0.3.5     readr_2.1.2    
 [9] tidyr_1.2.1     tibble_3.1.8    ggplot2_3.3.6   tidyverse_1.3.2

loaded via a namespace (and not attached):
 [1] lubridate_1.8.0     assertthat_0.2.1    digest_0.6.30      
 [4] utf8_1.2.2          R6_2.5.1            cellranger_1.1.0   
 [7] backports_1.4.1     reprex_2.0.2        evaluate_0.16      
[10] httr_1.4.4          pillar_1.8.1        rlang_1.0.6        
[13] googlesheets4_1.0.1 readxl_1.4.1        rstudioapi_0.14    
[16] rmarkdown_2.16      labeling_0.4.2      googledrive_2.0.0  
[19] htmlwidgets_1.5.4   bit_4.0.4           munsell_0.5.0      
[22] compiler_4.2.1      modelr_0.1.9        xfun_0.33          
[25] pkgconfig_2.0.3     htmltools_0.5.3     tidyselect_1.2.0   
[28] fansi_1.0.3         crayon_1.5.2        tzdb_0.3.0         
[31] dbplyr_2.2.1        withr_2.5.0         grid_4.2.1         
[34] jsonlite_1.8.0      gtable_0.3.1        lifecycle_1.0.3    
[37] DBI_1.1.3           magrittr_2.0.3      scales_1.2.1       
[40] vroom_1.5.7         cli_3.4.1           stringi_1.7.8      
[43] farver_2.1.1        fs_1.5.2            xml2_1.3.3         
[46] ellipsis_0.3.2      generics_0.1.3      vctrs_0.5.0        
[49] RColorBrewer_1.1-3  tools_4.2.1         bit64_4.0.5        
[52] glue_1.6.2          hms_1.1.2           parallel_4.2.1     
[55] fastmap_1.1.0       yaml_2.3.5          colorspace_2.0-3   
[58] gargle_1.2.1        rvest_1.0.3         knitr_1.40         
[61] haven_2.5.1        </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb318" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Protistan grazing analysis"</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 2</span></span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Import &amp; format data</span></span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set up working R environment</span></span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-23"><a href="#cb318-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-24"><a href="#cb318-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb318-25"><a href="#cb318-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb318-26"><a href="#cb318-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb318-27"><a href="#cb318-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-28"><a href="#cb318-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-29"><a href="#cb318-29" aria-hidden="true" tabindex="-1"></a>Set color schematic</span>
<span id="cb318-32"><a href="#cb318-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-33"><a href="#cb318-33" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb318-34"><a href="#cb318-34" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb318-35"><a href="#cb318-35" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-36"><a href="#cb318-36" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-37"><a href="#cb318-37" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb318-38"><a href="#cb318-38" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb318-39"><a href="#cb318-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-40"><a href="#cb318-40" aria-hidden="true" tabindex="-1"></a>whole_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>,<span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb318-41"><a href="#cb318-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-42"><a href="#cb318-42" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#eae2b7"</span>, <span class="st">"#5f0f40"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#941b0c"</span>, <span class="st">"#577590"</span>)</span>
<span id="cb318-43"><a href="#cb318-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-44"><a href="#cb318-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import raw count data</span></span>
<span id="cb318-45"><a href="#cb318-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-46"><a href="#cb318-46" aria-hidden="true" tabindex="-1"></a>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</span>
<span id="cb318-47"><a href="#cb318-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-50"><a href="#cb318-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-51"><a href="#cb318-51" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb318-52"><a href="#cb318-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb318-53"><a href="#cb318-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb318-54"><a href="#cb318-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb318-55"><a href="#cb318-55" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span>
<span id="cb318-56"><a href="#cb318-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-57"><a href="#cb318-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-58"><a href="#cb318-58" aria-hidden="true" tabindex="-1"></a>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more 'R' friendly.</span>
<span id="cb318-59"><a href="#cb318-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-62"><a href="#cb318-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-63"><a href="#cb318-63" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb318-64"><a href="#cb318-64" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span>
<span id="cb318-65"><a href="#cb318-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-66"><a href="#cb318-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-67"><a href="#cb318-67" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</span></span>
<span id="cb318-68"><a href="#cb318-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-69"><a href="#cb318-69" aria-hidden="true" tabindex="-1"></a>Parse raw microscopy count data.</span>
<span id="cb318-70"><a href="#cb318-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-73"><a href="#cb318-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-74"><a href="#cb318-74" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb318-75"><a href="#cb318-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb318-76"><a href="#cb318-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-77"><a href="#cb318-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb318-78"><a href="#cb318-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb318-79"><a href="#cb318-79" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb318-80"><a href="#cb318-80" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb318-81"><a href="#cb318-81" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb318-82"><a href="#cb318-82" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb318-83"><a href="#cb318-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb318-84"><a href="#cb318-84" aria-hidden="true" tabindex="-1"></a>      data.frame</span>
<span id="cb318-85"><a href="#cb318-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-86"><a href="#cb318-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-87"><a href="#cb318-87" aria-hidden="true" tabindex="-1"></a><span class="fu"># Calculate cells per ml (euk)</span></span>
<span id="cb318-88"><a href="#cb318-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-89"><a href="#cb318-89" aria-hidden="true" tabindex="-1"></a>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionaly, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to <span class="sc">\&gt;</span>20um and nano is <span class="sc">\&lt;</span>20um. All counts were done at 100x magnification, confirm this: <span class="in">`unique(counts_occur$MAG)`</span>.</span>
<span id="cb318-90"><a href="#cb318-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-91"><a href="#cb318-91" aria-hidden="true" tabindex="-1"></a>Calculate cell concentration (cells/ml).</span>
<span id="cb318-92"><a href="#cb318-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-95"><a href="#cb318-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-96"><a href="#cb318-96" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb318-97"><a href="#cb318-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb318-98"><a href="#cb318-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb318-99"><a href="#cb318-99" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb318-100"><a href="#cb318-100" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb318-101"><a href="#cb318-101" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb318-102"><a href="#cb318-102" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb318-103"><a href="#cb318-103" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb318-104"><a href="#cb318-104" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb318-105"><a href="#cb318-105" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb318-106"><a href="#cb318-106" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb318-107"><a href="#cb318-107" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb318-108"><a href="#cb318-108" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-109"><a href="#cb318-109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb318-110"><a href="#cb318-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb318-111"><a href="#cb318-111" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb318-112"><a href="#cb318-112" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb318-113"><a href="#cb318-113" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb318-114"><a href="#cb318-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb318-115"><a href="#cb318-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-116"><a href="#cb318-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-117"><a href="#cb318-117" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-118"><a href="#cb318-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-119"><a href="#cb318-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-120"><a href="#cb318-120" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</span></span>
<span id="cb318-121"><a href="#cb318-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-122"><a href="#cb318-122" aria-hidden="true" tabindex="-1"></a>Average cells/ml across replicates, pivot to long format</span>
<span id="cb318-123"><a href="#cb318-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-126"><a href="#cb318-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-127"><a href="#cb318-127" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb318-128"><a href="#cb318-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb318-129"><a href="#cb318-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-130"><a href="#cb318-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb318-131"><a href="#cb318-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb318-132"><a href="#cb318-132" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-133"><a href="#cb318-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-134"><a href="#cb318-134" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb318-135"><a href="#cb318-135" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb318-136"><a href="#cb318-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb318-137"><a href="#cb318-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-138"><a href="#cb318-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb318-139"><a href="#cb318-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb318-140"><a href="#cb318-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb318-141"><a href="#cb318-141" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb318-142"><a href="#cb318-142" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb318-143"><a href="#cb318-143" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb318-144"><a href="#cb318-144" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb318-145"><a href="#cb318-145" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb318-146"><a href="#cb318-146" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-147"><a href="#cb318-147" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-148"><a href="#cb318-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-149"><a href="#cb318-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-150"><a href="#cb318-150" aria-hidden="true" tabindex="-1"></a>NOTES on calculations:</span>
<span id="cb318-151"><a href="#cb318-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-152"><a href="#cb318-152" aria-hidden="true" tabindex="-1"></a>*VAR* = takes the sum of the squares of each value's deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</span>
<span id="cb318-153"><a href="#cb318-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-154"><a href="#cb318-154" aria-hidden="true" tabindex="-1"></a>*SD* = standard deviation of all values</span>
<span id="cb318-155"><a href="#cb318-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-156"><a href="#cb318-156" aria-hidden="true" tabindex="-1"></a>*SEM* = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</span>
<span id="cb318-157"><a href="#cb318-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-158"><a href="#cb318-158" aria-hidden="true" tabindex="-1"></a>Save output file</span>
<span id="cb318-159"><a href="#cb318-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-162"><a href="#cb318-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-163"><a href="#cb318-163" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span>
<span id="cb318-164"><a href="#cb318-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-165"><a href="#cb318-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-166"><a href="#cb318-166" aria-hidden="true" tabindex="-1"></a>Reformat to parse experiment information type</span>
<span id="cb318-167"><a href="#cb318-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-170"><a href="#cb318-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-171"><a href="#cb318-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format and add column that reports IGT vs bag experiment</span></span>
<span id="cb318-172"><a href="#cb318-172" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb318-173"><a href="#cb318-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, <span class="fu">ends_with</span>(<span class="st">"CONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb318-174"><a href="#cb318-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-175"><a href="#cb318-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb318-176"><a href="#cb318-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb318-177"><a href="#cb318-177" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-178"><a href="#cb318-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-179"><a href="#cb318-179" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-180"><a href="#cb318-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-181"><a href="#cb318-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-182"><a href="#cb318-182" aria-hidden="true" tabindex="-1"></a>Factor cell count data</span>
<span id="cb318-183"><a href="#cb318-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-186"><a href="#cb318-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-187"><a href="#cb318-187" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(plot_euk_conc<span class="sc">$</span>Name)</span>
<span id="cb318-188"><a href="#cb318-188" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb318-189"><a href="#cb318-189" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb318-190"><a href="#cb318-190" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-191"><a href="#cb318-191" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-192"><a href="#cb318-192" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb318-193"><a href="#cb318-193" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb318-194"><a href="#cb318-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-195"><a href="#cb318-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-196"><a href="#cb318-196" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot eukaryote cells per ml</span></span>
<span id="cb318-197"><a href="#cb318-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-198"><a href="#cb318-198" aria-hidden="true" tabindex="-1"></a>@fig-boxplot-all reports all eukaryote cells per ml counts from all grazing assay counts..</span>
<span id="cb318-199"><a href="#cb318-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-202"><a href="#cb318-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-203"><a href="#cb318-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-all</span></span>
<span id="cb318-204"><a href="#cb318-204" aria-hidden="true" tabindex="-1"></a>conc_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_conc, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, </span>
<span id="cb318-205"><a href="#cb318-205" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">y =</span> CONCENTRATION, </span>
<span id="cb318-206"><a href="#cb318-206" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">group =</span> NameOrder,</span>
<span id="cb318-207"><a href="#cb318-207" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb318-208"><a href="#cb318-208" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb318-209"><a href="#cb318-209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb318-210"><a href="#cb318-210" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not color by time point</span></span>
<span id="cb318-211"><a href="#cb318-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE,</span>
<span id="cb318-212"><a href="#cb318-212" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb318-213"><a href="#cb318-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-214"><a href="#cb318-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb318-215"><a href="#cb318-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb318-216"><a href="#cb318-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-217"><a href="#cb318-217" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(limits = c(10,1000), expand = c(0, 0)) +</span></span>
<span id="cb318-218"><a href="#cb318-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-219"><a href="#cb318-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb318-220"><a href="#cb318-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb318-221"><a href="#cb318-221" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-222"><a href="#cb318-222" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb318-223"><a href="#cb318-223" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb318-224"><a href="#cb318-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb318-225"><a href="#cb318-225" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb318-226"><a href="#cb318-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-227"><a href="#cb318-227" aria-hidden="true" tabindex="-1"></a>conc_boxplot</span>
<span id="cb318-228"><a href="#cb318-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-229"><a href="#cb318-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-230"><a href="#cb318-230" aria-hidden="true" tabindex="-1"></a>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. \~300 cells/ml in background and plume compared to \~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</span>
<span id="cb318-231"><a href="#cb318-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-232"><a href="#cb318-232" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 </span><span class="sc">\*</span><span class="at"> interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</span></span>
<span id="cb318-233"><a href="#cb318-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-234"><a href="#cb318-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</span></span>
<span id="cb318-235"><a href="#cb318-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-236"><a href="#cb318-236" aria-hidden="true" tabindex="-1"></a>Plot eukaryote cell concentration over time.</span>
<span id="cb318-237"><a href="#cb318-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-240"><a href="#cb318-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-241"><a href="#cb318-241" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb318-242"><a href="#cb318-242" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb318-243"><a href="#cb318-243" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-244"><a href="#cb318-244" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-245"><a href="#cb318-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-246"><a href="#cb318-246" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb318-247"><a href="#cb318-247" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb318-248"><a href="#cb318-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-249"><a href="#cb318-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb318-250"><a href="#cb318-250" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb318-251"><a href="#cb318-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-252"><a href="#cb318-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-253"><a href="#cb318-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb318-254"><a href="#cb318-254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb318-255"><a href="#cb318-255" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (MEAN + SD), ymin = (MEAN - SD)), width = 0.2) +</span></span>
<span id="cb318-256"><a href="#cb318-256" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb318-257"><a href="#cb318-257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb318-258"><a href="#cb318-258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-259"><a href="#cb318-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb318-260"><a href="#cb318-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-261"><a href="#cb318-261" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-262"><a href="#cb318-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-263"><a href="#cb318-263" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-264"><a href="#cb318-264" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb318-265"><a href="#cb318-265" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb318-266"><a href="#cb318-266" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>) <span class="sc">+</span></span>
<span id="cb318-267"><a href="#cb318-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">21</span>)))</span>
<span id="cb318-268"><a href="#cb318-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-269"><a href="#cb318-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-270"><a href="#cb318-270" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</span></span>
<span id="cb318-271"><a href="#cb318-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-272"><a href="#cb318-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Isolate T0 only counts for cells/ml plot</span></span>
<span id="cb318-273"><a href="#cb318-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-276"><a href="#cb318-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-277"><a href="#cb318-277" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb318-278"><a href="#cb318-278" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb318-279"><a href="#cb318-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-280"><a href="#cb318-280" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="ot">&lt;-</span> plot_euk_conc <span class="sc">%&gt;%</span></span>
<span id="cb318-281"><a href="#cb318-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-282"><a href="#cb318-282" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TimePoint == "T0" &amp; (VARIABLE == "eukCONC")) %&gt;%</span></span>
<span id="cb318-283"><a href="#cb318-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteOrder, NameOrder, TimePoint, EXP_TYPE, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb318-284"><a href="#cb318-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_conc =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb318-285"><a href="#cb318-285" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM_conc =</span> (<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb318-286"><a href="#cb318-286" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-287"><a href="#cb318-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SiteOrder, NameOrder, EXP_TYPE, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-288"><a href="#cb318-288" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-289"><a href="#cb318-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-290"><a href="#cb318-290" aria-hidden="true" tabindex="-1"></a>plot_euk_format</span>
<span id="cb318-291"><a href="#cb318-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-292"><a href="#cb318-292" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb318-293"><a href="#cb318-293" aria-hidden="true" tabindex="-1"></a>plot_euk_format<span class="sc">$</span>Site_Order <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_format<span class="sc">$</span>SiteOrder, <span class="at">levels =</span> site_fullname, <span class="at">labels =</span> site_fullname)</span>
<span id="cb318-294"><a href="#cb318-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-295"><a href="#cb318-295" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_euk_format)</span></span>
<span id="cb318-296"><a href="#cb318-296" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate only total euk counts</span></span>
<span id="cb318-297"><a href="#cb318-297" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>((plot_euk_format <span class="sc">%&gt;%</span> <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>)), <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> avg_conc, <span class="at">fill =</span> Site_Order)) <span class="sc">+</span></span>
<span id="cb318-298"><a href="#cb318-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (avg_conc <span class="sc">+</span> SEM_conc), <span class="at">ymin =</span> (avg_conc <span class="sc">-</span> SEM_conc)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb318-299"><a href="#cb318-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Site_Order), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb318-300"><a href="#cb318-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-301"><a href="#cb318-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb318-302"><a href="#cb318-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-303"><a href="#cb318-303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-304"><a href="#cb318-304" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-305"><a href="#cb318-305" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-306"><a href="#cb318-306" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb318-307"><a href="#cb318-307" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-308"><a href="#cb318-308" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-309"><a href="#cb318-309" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-310"><a href="#cb318-310" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-311"><a href="#cb318-311" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb318-312"><a href="#cb318-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb318-313"><a href="#cb318-313" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb318-314"><a href="#cb318-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-315"><a href="#cb318-315" aria-hidden="true" tabindex="-1"></a>euk_plot</span>
<span id="cb318-316"><a href="#cb318-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-317"><a href="#cb318-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-318"><a href="#cb318-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-319"><a href="#cb318-319" aria-hidden="true" tabindex="-1"></a>Print table of eukaryote cell count information to include in results section summary.</span>
<span id="cb318-320"><a href="#cb318-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-323"><a href="#cb318-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-324"><a href="#cb318-324" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb318-325"><a href="#cb318-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-326"><a href="#cb318-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-327"><a href="#cb318-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-328"><a href="#cb318-328" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb318-329"><a href="#cb318-329" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb318-330"><a href="#cb318-330" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb318-331"><a href="#cb318-331" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-332"><a href="#cb318-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-333"><a href="#cb318-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-334"><a href="#cb318-334" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-335"><a href="#cb318-335" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-336"><a href="#cb318-336" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span>
<span id="cb318-337"><a href="#cb318-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-338"><a href="#cb318-338" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb318-339"><a href="#cb318-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-340"><a href="#cb318-340" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(VARIABLE == "eukCONC") %&gt;% </span></span>
<span id="cb318-341"><a href="#cb318-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-342"><a href="#cb318-342" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb318-343"><a href="#cb318-343" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb318-344"><a href="#cb318-344" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb318-345"><a href="#cb318-345" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-346"><a href="#cb318-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-347"><a href="#cb318-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-348"><a href="#cb318-348" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-349"><a href="#cb318-349" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-350"><a href="#cb318-350" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span>
<span id="cb318-351"><a href="#cb318-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-352"><a href="#cb318-352" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(plot_euk_format$NameOrder)</span></span>
<span id="cb318-353"><a href="#cb318-353" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb318-354"><a href="#cb318-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-355"><a href="#cb318-355" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-356"><a href="#cb318-356" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-357"><a href="#cb318-357" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-358"><a href="#cb318-358" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-359"><a href="#cb318-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-360"><a href="#cb318-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-361"><a href="#cb318-361" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-362"><a href="#cb318-362" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb318-363"><a href="#cb318-363" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span>
<span id="cb318-364"><a href="#cb318-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-365"><a href="#cb318-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-368"><a href="#cb318-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-369"><a href="#cb318-369" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs")</span></span>
<span id="cb318-370"><a href="#cb318-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-371"><a href="#cb318-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-372"><a href="#cb318-372" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bacteria &amp; archaea cell counts</span></span>
<span id="cb318-373"><a href="#cb318-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-374"><a href="#cb318-374" aria-hidden="true" tabindex="-1"></a>DAPI slide counts from prokaryotes from same sites. Import and compare.</span>
<span id="cb318-375"><a href="#cb318-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-378"><a href="#cb318-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-379"><a href="#cb318-379" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb318-380"><a href="#cb318-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-381"><a href="#cb318-381" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb318-382"><a href="#cb318-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-383"><a href="#cb318-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-384"><a href="#cb318-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb318-385"><a href="#cb318-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb318-386"><a href="#cb318-386" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb318-387"><a href="#cb318-387" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb318-388"><a href="#cb318-388" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-389"><a href="#cb318-389" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-390"><a href="#cb318-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-391"><a href="#cb318-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-392"><a href="#cb318-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cells per ml (prok)</span></span>
<span id="cb318-393"><a href="#cb318-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-394"><a href="#cb318-394" aria-hidden="true" tabindex="-1"></a>Visualize counts</span>
<span id="cb318-395"><a href="#cb318-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-396"><a href="#cb318-396" aria-hidden="true" tabindex="-1"></a>Summary of prok counts</span>
<span id="cb318-399"><a href="#cb318-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-400"><a href="#cb318-400" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(insitu_proks)</span>
<span id="cb318-401"><a href="#cb318-401" aria-hidden="true" tabindex="-1"></a><span class="co"># insitu_proks$Name</span></span>
<span id="cb318-402"><a href="#cb318-402" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Name <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-403"><a href="#cb318-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-404"><a href="#cb318-404" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb318-405"><a href="#cb318-405" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb318-406"><a href="#cb318-406" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb318-407"><a href="#cb318-407" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-408"><a href="#cb318-408" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group_by(type) %&gt;% </span></span>
<span id="cb318-409"><a href="#cb318-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb318-410"><a href="#cb318-410" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(MEAN),</span>
<span id="cb318-411"><a href="#cb318-411" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(MEAN),</span>
<span id="cb318-412"><a href="#cb318-412" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(MEAN))</span>
<span id="cb318-413"><a href="#cb318-413" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb318-414"><a href="#cb318-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-415"><a href="#cb318-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-416"><a href="#cb318-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-417"><a href="#cb318-417" aria-hidden="true" tabindex="-1"></a>Factor site names, etc.</span>
<span id="cb318-418"><a href="#cb318-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-421"><a href="#cb318-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-422"><a href="#cb318-422" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>, <span class="st">"HotChimlet1"</span>, <span class="st">"ShrimpGulley"</span>, <span class="st">"SouthofHotChimlet"</span>, <span class="st">"SouthofLungSnack"</span>, <span class="st">"ArrowLoop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Rav1"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb318-423"><a href="#cb318-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-424"><a href="#cb318-424" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-425"><a href="#cb318-425" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-426"><a href="#cb318-426" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb318-427"><a href="#cb318-427" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb318-428"><a href="#cb318-428" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb318-429"><a href="#cb318-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-430"><a href="#cb318-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-433"><a href="#cb318-433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-434"><a href="#cb318-434" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb318-435"><a href="#cb318-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb318-436"><a href="#cb318-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-437"><a href="#cb318-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-438"><a href="#cb318-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb318-439"><a href="#cb318-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb318-440"><a href="#cb318-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-441"><a href="#cb318-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-442"><a href="#cb318-442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-443"><a href="#cb318-443" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-444"><a href="#cb318-444" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-445"><a href="#cb318-445" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb318-446"><a href="#cb318-446" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-447"><a href="#cb318-447" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-448"><a href="#cb318-448" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-449"><a href="#cb318-449" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-450"><a href="#cb318-450" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb318-451"><a href="#cb318-451" aria-hidden="true" tabindex="-1"></a>prok_plot</span>
<span id="cb318-452"><a href="#cb318-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-453"><a href="#cb318-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-454"><a href="#cb318-454" aria-hidden="true" tabindex="-1"></a><span class="fu">### Euk and prok counts</span></span>
<span id="cb318-455"><a href="#cb318-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-456"><a href="#cb318-456" aria-hidden="true" tabindex="-1"></a>Combined eukaryote and prokaryote cell counts</span>
<span id="cb318-457"><a href="#cb318-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-460"><a href="#cb318-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-461"><a href="#cb318-461" aria-hidden="true" tabindex="-1"></a>euk_prok_ab <span class="ot">&lt;-</span> euk_plot <span class="sc">+</span> (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb318-462"><a href="#cb318-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-463"><a href="#cb318-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-464"><a href="#cb318-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combine with previous MCR cell counts</span></span>
<span id="cb318-465"><a href="#cb318-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-466"><a href="#cb318-466" aria-hidden="true" tabindex="-1"></a>Compare *in situ* prokaryote cell counts from 2020 to previous years</span>
<span id="cb318-467"><a href="#cb318-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-470"><a href="#cb318-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-471"><a href="#cb318-471" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb318-472"><a href="#cb318-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-473"><a href="#cb318-473" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb318-474"><a href="#cb318-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-475"><a href="#cb318-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb318-476"><a href="#cb318-476" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb318-477"><a href="#cb318-477" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-478"><a href="#cb318-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb318-479"><a href="#cb318-479" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb318-480"><a href="#cb318-480" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb318-481"><a href="#cb318-481" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb318-482"><a href="#cb318-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-483"><a href="#cb318-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span>
<span id="cb318-484"><a href="#cb318-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-485"><a href="#cb318-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-486"><a href="#cb318-486" aria-hidden="true" tabindex="-1"></a>Re-import 2020 data to compare.</span>
<span id="cb318-487"><a href="#cb318-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-490"><a href="#cb318-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-491"><a href="#cb318-491" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb318-492"><a href="#cb318-492" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb318-493"><a href="#cb318-493" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb318-494"><a href="#cb318-494" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb318-495"><a href="#cb318-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-496"><a href="#cb318-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-497"><a href="#cb318-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb318-498"><a href="#cb318-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-499"><a href="#cb318-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-500"><a href="#cb318-500" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb318-501"><a href="#cb318-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-502"><a href="#cb318-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-503"><a href="#cb318-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-504"><a href="#cb318-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-505"><a href="#cb318-505" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-506"><a href="#cb318-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-507"><a href="#cb318-507" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb318-508"><a href="#cb318-508" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb318-509"><a href="#cb318-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-510"><a href="#cb318-510" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb318-511"><a href="#cb318-511" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb318-512"><a href="#cb318-512" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb318-513"><a href="#cb318-513" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span>
<span id="cb318-514"><a href="#cb318-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-515"><a href="#cb318-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-516"><a href="#cb318-516" aria-hidden="true" tabindex="-1"></a>Plot by year.</span>
<span id="cb318-517"><a href="#cb318-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-520"><a href="#cb318-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-521"><a href="#cb318-521" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb318-522"><a href="#cb318-522" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb318-523"><a href="#cb318-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-524"><a href="#cb318-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb318-525"><a href="#cb318-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb318-526"><a href="#cb318-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-527"><a href="#cb318-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-528"><a href="#cb318-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb318-529"><a href="#cb318-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb318-530"><a href="#cb318-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-531"><a href="#cb318-531" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-532"><a href="#cb318-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb318-533"><a href="#cb318-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-534"><a href="#cb318-534" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb318-535"><a href="#cb318-535" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-536"><a href="#cb318-536" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb318-537"><a href="#cb318-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb318-538"><a href="#cb318-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span>
<span id="cb318-539"><a href="#cb318-539" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb318-540"><a href="#cb318-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-541"><a href="#cb318-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-542"><a href="#cb318-542" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimate grazing effect</span></span>
<span id="cb318-543"><a href="#cb318-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-544"><a href="#cb318-544" aria-hidden="true" tabindex="-1"></a>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</span>
<span id="cb318-545"><a href="#cb318-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-548"><a href="#cb318-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-549"><a href="#cb318-549" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb318-550"><a href="#cb318-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-551"><a href="#cb318-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-552"><a href="#cb318-552" aria-hidden="true" tabindex="-1"></a><span class="fu">## Determine FLP per euk cell</span></span>
<span id="cb318-553"><a href="#cb318-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-554"><a href="#cb318-554" aria-hidden="true" tabindex="-1"></a>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <span class="in">`counts_occur`</span> data frame from above.</span>
<span id="cb318-555"><a href="#cb318-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-558"><a href="#cb318-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-559"><a href="#cb318-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb318-560"><a href="#cb318-560" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb318-561"><a href="#cb318-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-562"><a href="#cb318-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb318-563"><a href="#cb318-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb318-564"><a href="#cb318-564" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb318-565"><a href="#cb318-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-566"><a href="#cb318-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-567"><a href="#cb318-567" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb318-568"><a href="#cb318-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-569"><a href="#cb318-569" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-570"><a href="#cb318-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-571"><a href="#cb318-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-572"><a href="#cb318-572" aria-hidden="true" tabindex="-1"></a>*optional gut check of data table modification*</span>
<span id="cb318-573"><a href="#cb318-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-576"><a href="#cb318-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-577"><a href="#cb318-577" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb318-578"><a href="#cb318-578" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb318-579"><a href="#cb318-579" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb318-580"><a href="#cb318-580" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb318-581"><a href="#cb318-581" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb318-582"><a href="#cb318-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-583"><a href="#cb318-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-584"><a href="#cb318-584" aria-hidden="true" tabindex="-1"></a>Isolate counts that are <span class="sc">\&gt;</span>0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</span>
<span id="cb318-585"><a href="#cb318-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-588"><a href="#cb318-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-589"><a href="#cb318-589" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb318-590"><a href="#cb318-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb318-591"><a href="#cb318-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-592"><a href="#cb318-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-593"><a href="#cb318-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-594"><a href="#cb318-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-595"><a href="#cb318-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-596"><a href="#cb318-596" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb318-597"><a href="#cb318-597" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb318-598"><a href="#cb318-598" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-599"><a href="#cb318-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-600"><a href="#cb318-600" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb318-601"><a href="#cb318-601" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb318-602"><a href="#cb318-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-603"><a href="#cb318-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb318-604"><a href="#cb318-604" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb318-605"><a href="#cb318-605" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-606"><a href="#cb318-606" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-607"><a href="#cb318-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-608"><a href="#cb318-608" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_flp)</span>
<span id="cb318-609"><a href="#cb318-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-610"><a href="#cb318-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-611"><a href="#cb318-611" aria-hidden="true" tabindex="-1"></a>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</span>
<span id="cb318-612"><a href="#cb318-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-613"><a href="#cb318-613" aria-hidden="true" tabindex="-1"></a>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</span>
<span id="cb318-614"><a href="#cb318-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-615"><a href="#cb318-615" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Below code repeats process and compiles with other FLP/euk cell data.</span></span>
<span id="cb318-616"><a href="#cb318-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-617"><a href="#cb318-617" aria-hidden="true" tabindex="-1"></a>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</span>
<span id="cb318-618"><a href="#cb318-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-621"><a href="#cb318-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-622"><a href="#cb318-622" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb318-623"><a href="#cb318-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb318-624"><a href="#cb318-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb318-625"><a href="#cb318-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb318-626"><a href="#cb318-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb318-627"><a href="#cb318-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-628"><a href="#cb318-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-629"><a href="#cb318-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-630"><a href="#cb318-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-631"><a href="#cb318-631" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb318-632"><a href="#cb318-632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb318-633"><a href="#cb318-633" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-634"><a href="#cb318-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-635"><a href="#cb318-635" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb318-636"><a href="#cb318-636" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-637"><a href="#cb318-637" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb318-638"><a href="#cb318-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-639"><a href="#cb318-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb318-640"><a href="#cb318-640" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-641"><a href="#cb318-641" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb318-642"><a href="#cb318-642" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb318-643"><a href="#cb318-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb318-644"><a href="#cb318-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb318-645"><a href="#cb318-645" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-646"><a href="#cb318-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-647"><a href="#cb318-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-648"><a href="#cb318-648" aria-hidden="true" tabindex="-1"></a>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</span>
<span id="cb318-649"><a href="#cb318-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-652"><a href="#cb318-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-653"><a href="#cb318-653" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb318-654"><a href="#cb318-654" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb318-655"><a href="#cb318-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb318-656"><a href="#cb318-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb318-657"><a href="#cb318-657" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb318-658"><a href="#cb318-658" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb318-659"><a href="#cb318-659" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-660"><a href="#cb318-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb318-661"><a href="#cb318-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb318-662"><a href="#cb318-662" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-663"><a href="#cb318-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-664"><a href="#cb318-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-665"><a href="#cb318-665" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate FLP per euk cell calculation</span></span>
<span id="cb318-666"><a href="#cb318-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-667"><a href="#cb318-667" aria-hidden="true" tabindex="-1"></a>First need to import and compile with metadata to get exact timing of experiments.</span>
<span id="cb318-668"><a href="#cb318-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-671"><a href="#cb318-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-672"><a href="#cb318-672" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb318-673"><a href="#cb318-673" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span>
<span id="cb318-674"><a href="#cb318-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-675"><a href="#cb318-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-676"><a href="#cb318-676" aria-hidden="true" tabindex="-1"></a>Add metadata</span>
<span id="cb318-677"><a href="#cb318-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-680"><a href="#cb318-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-681"><a href="#cb318-681" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb318-682"><a href="#cb318-682" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb318-683"><a href="#cb318-683" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, include them as replicates!</span></span>
<span id="cb318-684"><a href="#cb318-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb318-685"><a href="#cb318-685" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb318-686"><a href="#cb318-686" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb318-687"><a href="#cb318-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-688"><a href="#cb318-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-689"><a href="#cb318-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-690"><a href="#cb318-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-691"><a href="#cb318-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-692"><a href="#cb318-692" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb318-693"><a href="#cb318-693" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb318-694"><a href="#cb318-694" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb318-695"><a href="#cb318-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-696"><a href="#cb318-696" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb318-697"><a href="#cb318-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb318-698"><a href="#cb318-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-699"><a href="#cb318-699" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-700"><a href="#cb318-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-701"><a href="#cb318-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-702"><a href="#cb318-702" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; COLS: Timepoint, Minutes = time point label, actual incubated minutes</span></span>
<span id="cb318-703"><a href="#cb318-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-704"><a href="#cb318-704" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</span></span>
<span id="cb318-705"><a href="#cb318-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-706"><a href="#cb318-706" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate linear regression to obtain slope</span></span>
<span id="cb318-707"><a href="#cb318-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-708"><a href="#cb318-708" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`lm()`</span> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</span>
<span id="cb318-709"><a href="#cb318-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-710"><a href="#cb318-710" aria-hidden="true" tabindex="-1"></a>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</span>
<span id="cb318-711"><a href="#cb318-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-714"><a href="#cb318-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-715"><a href="#cb318-715" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb318-716"><a href="#cb318-716" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb318-717"><a href="#cb318-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-718"><a href="#cb318-718" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb318-719"><a href="#cb318-719" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb318-720"><a href="#cb318-720" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP, -SizeFrac) %&gt;%</span></span>
<span id="cb318-721"><a href="#cb318-721" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb318-722"><a href="#cb318-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-723"><a href="#cb318-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-724"><a href="#cb318-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb318-725"><a href="#cb318-725" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-726"><a href="#cb318-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb318-727"><a href="#cb318-727" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) %&gt;%</span></span>
<span id="cb318-728"><a href="#cb318-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb318-729"><a href="#cb318-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb318-730"><a href="#cb318-730" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-731"><a href="#cb318-731" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb318-732"><a href="#cb318-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb318-733"><a href="#cb318-733" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"REP"</span>,</span>
<span id="cb318-734"><a href="#cb318-734" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb318-735"><a href="#cb318-735" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb318-736"><a href="#cb318-736" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb318-737"><a href="#cb318-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-738"><a href="#cb318-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb318-739"><a href="#cb318-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb318-740"><a href="#cb318-740" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-741"><a href="#cb318-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb318-742"><a href="#cb318-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb318-743"><a href="#cb318-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb318-744"><a href="#cb318-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb318-745"><a href="#cb318-745" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-746"><a href="#cb318-746" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb318-747"><a href="#cb318-747" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb318-748"><a href="#cb318-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb318-749"><a href="#cb318-749" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb318-750"><a href="#cb318-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-751"><a href="#cb318-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-752"><a href="#cb318-752" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</span></span>
<span id="cb318-753"><a href="#cb318-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-754"><a href="#cb318-754" aria-hidden="true" tabindex="-1"></a>Apply to all data to obtain slope.</span>
<span id="cb318-755"><a href="#cb318-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-758"><a href="#cb318-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-759"><a href="#cb318-759" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span>
<span id="cb318-760"><a href="#cb318-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-761"><a href="#cb318-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-762"><a href="#cb318-762" aria-hidden="true" tabindex="-1"></a>*gut check* linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <span class="in">`nest()`</span> capability of tidyverse. Below, one experiment is subset to check the value.</span>
<span id="cb318-763"><a href="#cb318-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-766"><a href="#cb318-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-767"><a href="#cb318-767" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb318-768"><a href="#cb318-768" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb318-769"><a href="#cb318-769" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb318-770"><a href="#cb318-770" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb318-771"><a href="#cb318-771" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb318-772"><a href="#cb318-772" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb318-773"><a href="#cb318-773" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb318-774"><a href="#cb318-774" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb318-775"><a href="#cb318-775" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb318-776"><a href="#cb318-776" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span>
<span id="cb318-777"><a href="#cb318-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-778"><a href="#cb318-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-779"><a href="#cb318-779" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot linear regression trend</span></span>
<span id="cb318-780"><a href="#cb318-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-781"><a href="#cb318-781" aria-hidden="true" tabindex="-1"></a>Plot all bag experiments with estimated slope.</span>
<span id="cb318-784"><a href="#cb318-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-785"><a href="#cb318-785" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(calcs_wslope_regression<span class="sc">$</span>SITE)</span>
<span id="cb318-786"><a href="#cb318-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-787"><a href="#cb318-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-788"><a href="#cb318-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-791"><a href="#cb318-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-792"><a href="#cb318-792" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb318-793"><a href="#cb318-793" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb318-794"><a href="#cb318-794" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb318-795"><a href="#cb318-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-796"><a href="#cb318-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENT_IDS =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-797"><a href="#cb318-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb318-798"><a href="#cb318-798" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out IGT samples for now</span></span>
<span id="cb318-799"><a href="#cb318-799" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;%</span></span>
<span id="cb318-800"><a href="#cb318-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE_ORDER, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-801"><a href="#cb318-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE)) <span class="sc">+</span></span>
<span id="cb318-802"><a href="#cb318-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb318-803"><a href="#cb318-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb318-804"><a href="#cb318-804" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb318-805"><a href="#cb318-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-806"><a href="#cb318-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb318-807"><a href="#cb318-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb318-808"><a href="#cb318-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb318-809"><a href="#cb318-809" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb318-810"><a href="#cb318-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb318-811"><a href="#cb318-811" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-812"><a href="#cb318-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb318-813"><a href="#cb318-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-814"><a href="#cb318-814" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb318-815"><a href="#cb318-815" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-816"><a href="#cb318-816" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb318-817"><a href="#cb318-817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-818"><a href="#cb318-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-819"><a href="#cb318-819" aria-hidden="true" tabindex="-1"></a>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</span>
<span id="cb318-820"><a href="#cb318-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-821"><a href="#cb318-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remove IGT Tf time points.</span></span>
<span id="cb318-822"><a href="#cb318-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-823"><a href="#cb318-823" aria-hidden="true" tabindex="-1"></a>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</span>
<span id="cb318-824"><a href="#cb318-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-827"><a href="#cb318-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-828"><a href="#cb318-828" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb318-829"><a href="#cb318-829" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb318-830"><a href="#cb318-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-831"><a href="#cb318-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-832"><a href="#cb318-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-833"><a href="#cb318-833" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-834"><a href="#cb318-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-835"><a href="#cb318-835" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb318-836"><a href="#cb318-836" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span>
<span id="cb318-837"><a href="#cb318-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-838"><a href="#cb318-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-839"><a href="#cb318-839" aria-hidden="true" tabindex="-1"></a>Plot IGT grazing experiments with newly calculated grazing effect.</span>
<span id="cb318-840"><a href="#cb318-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-843"><a href="#cb318-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-844"><a href="#cb318-844" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb318-845"><a href="#cb318-845" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb318-846"><a href="#cb318-846" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb318-847"><a href="#cb318-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb318-848"><a href="#cb318-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-849"><a href="#cb318-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb318-850"><a href="#cb318-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb318-851"><a href="#cb318-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb318-852"><a href="#cb318-852" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb318-853"><a href="#cb318-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-854"><a href="#cb318-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb318-855"><a href="#cb318-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb318-856"><a href="#cb318-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb318-857"><a href="#cb318-857" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb318-858"><a href="#cb318-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb318-859"><a href="#cb318-859" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-860"><a href="#cb318-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb318-861"><a href="#cb318-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-862"><a href="#cb318-862" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb318-863"><a href="#cb318-863" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-864"><a href="#cb318-864" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb318-865"><a href="#cb318-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-866"><a href="#cb318-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-867"><a href="#cb318-867" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; results are more consistent across experiments.</span></span>
<span id="cb318-868"><a href="#cb318-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-869"><a href="#cb318-869" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile and save grazing experiment results</span></span>
<span id="cb318-870"><a href="#cb318-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-873"><a href="#cb318-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-874"><a href="#cb318-874" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb318-875"><a href="#cb318-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-876"><a href="#cb318-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-877"><a href="#cb318-877" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-878"><a href="#cb318-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-879"><a href="#cb318-879" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb318-880"><a href="#cb318-880" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb318-881"><a href="#cb318-881" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb318-882"><a href="#cb318-882" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-883"><a href="#cb318-883" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-884"><a href="#cb318-884" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb318-885"><a href="#cb318-885" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb318-886"><a href="#cb318-886" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb318-887"><a href="#cb318-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-888"><a href="#cb318-888" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb318-889"><a href="#cb318-889" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="sc">%&gt;%</span></span>
<span id="cb318-890"><a href="#cb318-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrigin, SiteOrder, NameOrder, Experiment, SizeFrac, r.squared, INTERCEPT, SLOPE) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb318-891"><a href="#cb318-891" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(calcs_wslope_regression_update, <span class="at">file =</span> <span class="st">"output-data/estimated-slopes-grazingexp.csv"</span>)</span>
<span id="cb318-892"><a href="#cb318-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-893"><a href="#cb318-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-894"><a href="#cb318-894" aria-hidden="true" tabindex="-1"></a><span class="fu"># Check FLP control experiments</span></span>
<span id="cb318-895"><a href="#cb318-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-896"><a href="#cb318-896" aria-hidden="true" tabindex="-1"></a>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</span>
<span id="cb318-897"><a href="#cb318-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-900"><a href="#cb318-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-901"><a href="#cb318-901" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb318-902"><a href="#cb318-902" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb318-903"><a href="#cb318-903" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb318-904"><a href="#cb318-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-905"><a href="#cb318-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-906"><a href="#cb318-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-907"><a href="#cb318-907" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-908"><a href="#cb318-908" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb318-909"><a href="#cb318-909" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb318-910"><a href="#cb318-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-911"><a href="#cb318-911" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb318-912"><a href="#cb318-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb318-913"><a href="#cb318-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-914"><a href="#cb318-914" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-915"><a href="#cb318-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-916"><a href="#cb318-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-917"><a href="#cb318-917" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bag grazing experiment controls</span></span>
<span id="cb318-918"><a href="#cb318-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-921"><a href="#cb318-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-922"><a href="#cb318-922" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb318-923"><a href="#cb318-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-924"><a href="#cb318-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb318-925"><a href="#cb318-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb318-926"><a href="#cb318-926" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb318-927"><a href="#cb318-927" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb318-928"><a href="#cb318-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb318-929"><a href="#cb318-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb318-930"><a href="#cb318-930" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb318-931"><a href="#cb318-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb318-932"><a href="#cb318-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-933"><a href="#cb318-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-934"><a href="#cb318-934" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-935"><a href="#cb318-935" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb318-936"><a href="#cb318-936" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb318-937"><a href="#cb318-937" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb318-938"><a href="#cb318-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb318-939"><a href="#cb318-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-940"><a href="#cb318-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-941"><a href="#cb318-941" aria-hidden="true" tabindex="-1"></a><span class="fu">## IGT experiment controls</span></span>
<span id="cb318-942"><a href="#cb318-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-943"><a href="#cb318-943" aria-hidden="true" tabindex="-1"></a>Repeat for IGT experiments.</span>
<span id="cb318-944"><a href="#cb318-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-947"><a href="#cb318-947" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-948"><a href="#cb318-948" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb318-949"><a href="#cb318-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-950"><a href="#cb318-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb318-951"><a href="#cb318-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb318-952"><a href="#cb318-952" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb318-953"><a href="#cb318-953" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb318-954"><a href="#cb318-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb318-955"><a href="#cb318-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb318-956"><a href="#cb318-956" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb318-957"><a href="#cb318-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb318-958"><a href="#cb318-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-959"><a href="#cb318-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-960"><a href="#cb318-960" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-961"><a href="#cb318-961" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb318-962"><a href="#cb318-962" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb318-963"><a href="#cb318-963" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb318-964"><a href="#cb318-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb318-965"><a href="#cb318-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-966"><a href="#cb318-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-967"><a href="#cb318-967" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate complete table with grazing rates and values</span></span>
<span id="cb318-968"><a href="#cb318-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-971"><a href="#cb318-971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-972"><a href="#cb318-972" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb318-973"><a href="#cb318-973" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb318-974"><a href="#cb318-974" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb318-975"><a href="#cb318-975" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb318-976"><a href="#cb318-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-977"><a href="#cb318-977" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb318-978"><a href="#cb318-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-979"><a href="#cb318-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, <span class="at">Site=</span>SiteOrder, <span class="at">Name=</span>NameOrder, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb318-980"><a href="#cb318-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb318-981"><a href="#cb318-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-982"><a href="#cb318-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-983"><a href="#cb318-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb318-984"><a href="#cb318-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-985"><a href="#cb318-985" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb318-986"><a href="#cb318-986" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb318-987"><a href="#cb318-987" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb318-988"><a href="#cb318-988" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-989"><a href="#cb318-989" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb318-990"><a href="#cb318-990" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb318-991"><a href="#cb318-991" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb318-992"><a href="#cb318-992" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Bag"</span></span>
<span id="cb318-993"><a href="#cb318-993" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-994"><a href="#cb318-994" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-995"><a href="#cb318-995" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="co"># view complete table of grazing rate results</span></span>
<span id="cb318-996"><a href="#cb318-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-997"><a href="#cb318-997" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb318-998"><a href="#cb318-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXP_TYPE, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb318-999"><a href="#cb318-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb318-1000"><a href="#cb318-1000" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb318-1001"><a href="#cb318-1001" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span>
<span id="cb318-1002"><a href="#cb318-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1003"><a href="#cb318-1003" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb318-1004"><a href="#cb318-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1005"><a href="#cb318-1005" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb318-1006"><a href="#cb318-1006" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb318-1007"><a href="#cb318-1007" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb318-1008"><a href="#cb318-1008" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1009"><a href="#cb318-1009" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(Site, TYPE) %&gt;% </span></span>
<span id="cb318-1010"><a href="#cb318-1010" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(TYPE) %&gt;%</span></span>
<span id="cb318-1011"><a href="#cb318-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPE, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1012"><a href="#cb318-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb318-1013"><a href="#cb318-1013" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb318-1014"><a href="#cb318-1014" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span>
<span id="cb318-1015"><a href="#cb318-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1016"><a href="#cb318-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1017"><a href="#cb318-1017" aria-hidden="true" tabindex="-1"></a>Amend table with estimated FLP concentration</span>
<span id="cb318-1018"><a href="#cb318-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1021"><a href="#cb318-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1022"><a href="#cb318-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb318-1023"><a href="#cb318-1023" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb318-1024"><a href="#cb318-1024" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-1025"><a href="#cb318-1025" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb318-1026"><a href="#cb318-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1027"><a href="#cb318-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1028"><a href="#cb318-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb318-1029"><a href="#cb318-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb318-1030"><a href="#cb318-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb318-1031"><a href="#cb318-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_conc =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb318-1032"><a href="#cb318-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1033"><a href="#cb318-1033" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-1034"><a href="#cb318-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1035"><a href="#cb318-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1036"><a href="#cb318-1036" aria-hidden="true" tabindex="-1"></a>Introduce factors in table for visualizations</span>
<span id="cb318-1037"><a href="#cb318-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1040"><a href="#cb318-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1041"><a href="#cb318-1041" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb318-1042"><a href="#cb318-1042" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb318-1043"><a href="#cb318-1043" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb318-1044"><a href="#cb318-1044" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb318-1045"><a href="#cb318-1045" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-1046"><a href="#cb318-1046" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-1047"><a href="#cb318-1047" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb318-1048"><a href="#cb318-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb318-1049"><a href="#cb318-1049" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>FIELDORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>FIELD, <span class="at">levels =</span> site_fullname)</span>
<span id="cb318-1050"><a href="#cb318-1050" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>VENTORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_fullname)</span>
<span id="cb318-1051"><a href="#cb318-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_grazerate_wflp)</span>
<span id="cb318-1052"><a href="#cb318-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1053"><a href="#cb318-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1054"><a href="#cb318-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot FLP/grazer /minute</span></span>
<span id="cb318-1055"><a href="#cb318-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1058"><a href="#cb318-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1059"><a href="#cb318-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb318-1060"><a href="#cb318-1060" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb318-1061"><a href="#cb318-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> VENTORDER, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELDORDER)) <span class="sc">+</span></span>
<span id="cb318-1062"><a href="#cb318-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELDORDER),</span>
<span id="cb318-1063"><a href="#cb318-1063" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb318-1064"><a href="#cb318-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-1065"><a href="#cb318-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb318-1066"><a href="#cb318-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELDORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-1067"><a href="#cb318-1067" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb318-1068"><a href="#cb318-1068" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-1069"><a href="#cb318-1069" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1070"><a href="#cb318-1070" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-1071"><a href="#cb318-1071" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-1072"><a href="#cb318-1072" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb318-1073"><a href="#cb318-1073" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-1074"><a href="#cb318-1074" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1075"><a href="#cb318-1075" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1076"><a href="#cb318-1076" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-1077"><a href="#cb318-1077" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb318-1078"><a href="#cb318-1078" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-1079"><a href="#cb318-1079" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-1080"><a href="#cb318-1080" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Mean FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb318-1081"><a href="#cb318-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb318-1082"><a href="#cb318-1082" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span>
<span id="cb318-1083"><a href="#cb318-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1084"><a href="#cb318-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1085"><a href="#cb318-1085" aria-hidden="true" tabindex="-1"></a>Amend table with eukaryote and prokaryote estimated biomass.</span>
<span id="cb318-1086"><a href="#cb318-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1089"><a href="#cb318-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1090"><a href="#cb318-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb318-1091"><a href="#cb318-1091" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb318-1092"><a href="#cb318-1092" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb318-1093"><a href="#cb318-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb318-1094"><a href="#cb318-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1095"><a href="#cb318-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to master table with data</span></span>
<span id="cb318-1096"><a href="#cb318-1096" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb318-1097"><a href="#cb318-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Prok_conc =</span> MEAN, <span class="at">Prok_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1098"><a href="#cb318-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1099"><a href="#cb318-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prok_conc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Prok_conc), avg_insitu, Prok_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1100"><a href="#cb318-1100" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-1101"><a href="#cb318-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1102"><a href="#cb318-1102" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb318-1103"><a href="#cb318-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Name =</span> NameOrder, <span class="at">FIELD =</span> SiteOrder, <span class="at">euk_conc =</span> avg_conc, EXP_TYPE, <span class="at">euk_conc_sem =</span> SEM_conc) <span class="sc">%&gt;%</span></span>
<span id="cb318-1104"><a href="#cb318-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp_wprok) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1105"><a href="#cb318-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> Name, <span class="at">EXP =</span> EXP_TYPE, <span class="at">SAMPLE =</span> Site, <span class="at">RATE_min =</span> GRAZE_RATE, <span class="at">FLP_ml =</span> FLP_conc, <span class="at">PROK_ml =</span> Prok_conc, <span class="at">PROK_sem =</span> Prok_sem, <span class="at">EUK_ml =</span> euk_conc, <span class="at">EUK_sem =</span> euk_conc_sem, TimePoints, EXP_REPS, EXP_VOL,  CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span></span>
<span id="cb318-1106"><a href="#cb318-1106" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-1107"><a href="#cb318-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1108"><a href="#cb318-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1109"><a href="#cb318-1109" aria-hidden="true" tabindex="-1"></a>Description of variables above:</span>
<span id="cb318-1110"><a href="#cb318-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1111"><a href="#cb318-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FIELD - vent location</span>
<span id="cb318-1112"><a href="#cb318-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NAME - name of vent site, or plume/background</span>
<span id="cb318-1113"><a href="#cb318-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>EXP - experiment type, bag or IGT</span>
<span id="cb318-1114"><a href="#cb318-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SAMPLE - vent site</span>
<span id="cb318-1115"><a href="#cb318-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_MIN - FLPs per grazer per minute (SLOPE of best fitline)</span>
<span id="cb318-1116"><a href="#cb318-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FLP_ml - FLP concentration at T0</span>
<span id="cb318-1117"><a href="#cb318-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</span>
<span id="cb318-1118"><a href="#cb318-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</span>
<span id="cb318-1119"><a href="#cb318-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1120"><a href="#cb318-1120" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grazing rate calculations</span></span>
<span id="cb318-1121"><a href="#cb318-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1122"><a href="#cb318-1122" aria-hidden="true" tabindex="-1"></a>Based on Unrein et al. 2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</span>
<span id="cb318-1123"><a href="#cb318-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1126"><a href="#cb318-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1127"><a href="#cb318-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_grazerate_wflp_wprok_weuk)</span>
<span id="cb318-1128"><a href="#cb318-1128" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb318-1129"><a href="#cb318-1129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb318-1130"><a href="#cb318-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_min <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb318-1131"><a href="#cb318-1131" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb318-1132"><a href="#cb318-1132" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb318-1133"><a href="#cb318-1133" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb318-1134"><a href="#cb318-1134" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb318-1135"><a href="#cb318-1135" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb318-1136"><a href="#cb318-1136" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb318-1137"><a href="#cb318-1137" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb318-1138"><a href="#cb318-1138" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb318-1139"><a href="#cb318-1139" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb318-1140"><a href="#cb318-1140" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb318-1141"><a href="#cb318-1141" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb318-1142"><a href="#cb318-1142" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb318-1143"><a href="#cb318-1143" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb318-1144"><a href="#cb318-1144" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb318-1145"><a href="#cb318-1145" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb318-1146"><a href="#cb318-1146" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb318-1147"><a href="#cb318-1147" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb318-1148"><a href="#cb318-1148" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb318-1149"><a href="#cb318-1149" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb318-1150"><a href="#cb318-1150" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb318-1151"><a href="#cb318-1151" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1152"><a href="#cb318-1152" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-1153"><a href="#cb318-1153" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span>
<span id="cb318-1154"><a href="#cb318-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1155"><a href="#cb318-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1156"><a href="#cb318-1156" aria-hidden="true" tabindex="-1"></a>Explanation of units for table with calculated values.</span>
<span id="cb318-1157"><a href="#cb318-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1158"><a href="#cb318-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_min &amp; RATE_hr = Grazing rate as 'FLPs per grazer per minute' and per hour</span>
<span id="cb318-1159"><a href="#cb318-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1160"><a href="#cb318-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CLEARANCE_RATE = ml or nL per grazer per hour</span>
<span id="cb318-1161"><a href="#cb318-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1162"><a href="#cb318-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</span>
<span id="cb318-1163"><a href="#cb318-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1164"><a href="#cb318-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GRAZING EFFECT = bacteria per ml per hour</span>
<span id="cb318-1165"><a href="#cb318-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1166"><a href="#cb318-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bacterial turnover rate = % per day</span>
<span id="cb318-1167"><a href="#cb318-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1168"><a href="#cb318-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">### gt table options</span></span>
<span id="cb318-1169"><a href="#cb318-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1172"><a href="#cb318-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1173"><a href="#cb318-1173" aria-hidden="true" tabindex="-1"></a><span class="co"># bkgd &lt;- c("Background", "Plume")</span></span>
<span id="cb318-1174"><a href="#cb318-1174" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-1175"><a href="#cb318-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gt)</span></span>
<span id="cb318-1176"><a href="#cb318-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-1177"><a href="#cb318-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb318-1178"><a href="#cb318-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb318-1179"><a href="#cb318-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb318-1180"><a href="#cb318-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb318-1181"><a href="#cb318-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb318-1182"><a href="#cb318-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb318-1183"><a href="#cb318-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb318-1184"><a href="#cb318-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb318-1185"><a href="#cb318-1185" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb318-1186"><a href="#cb318-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb318-1187"><a href="#cb318-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1188"><a href="#cb318-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1189"><a href="#cb318-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1190"><a href="#cb318-1190" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1191"><a href="#cb318-1191" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb318-1192"><a href="#cb318-1192" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1193"><a href="#cb318-1193" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1194"><a href="#cb318-1194" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1195"><a href="#cb318-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1196"><a href="#cb318-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1197"><a href="#cb318-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1198"><a href="#cb318-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1199"><a href="#cb318-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1200"><a href="#cb318-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1201"><a href="#cb318-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1202"><a href="#cb318-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1203"><a href="#cb318-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb318-1204"><a href="#cb318-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb318-1205"><a href="#cb318-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1206"><a href="#cb318-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb318-1207"><a href="#cb318-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb318-1208"><a href="#cb318-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb318-1209"><a href="#cb318-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb318-1210"><a href="#cb318-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb318-1211"><a href="#cb318-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb318-1212"><a href="#cb318-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1213"><a href="#cb318-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb318-1214"><a href="#cb318-1214" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb318-1215"><a href="#cb318-1215" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb318-1216"><a href="#cb318-1216" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1217"><a href="#cb318-1217" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb318-1218"><a href="#cb318-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb318-1219"><a href="#cb318-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb318-1220"><a href="#cb318-1220" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1221"><a href="#cb318-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb318-1222"><a href="#cb318-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb318-1223"><a href="#cb318-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb318-1224"><a href="#cb318-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1225"><a href="#cb318-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb318-1226"><a href="#cb318-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb318-1227"><a href="#cb318-1227" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb318-1228"><a href="#cb318-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1229"><a href="#cb318-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb318-1230"><a href="#cb318-1230" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb318-1231"><a href="#cb318-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb318-1232"><a href="#cb318-1232" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb318-1233"><a href="#cb318-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb318-1234"><a href="#cb318-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb318-1235"><a href="#cb318-1235" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb318-1236"><a href="#cb318-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb318-1237"><a href="#cb318-1237" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb318-1238"><a href="#cb318-1238" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb318-1239"><a href="#cb318-1239" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb318-1240"><a href="#cb318-1240" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb318-1241"><a href="#cb318-1241" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span>
<span id="cb318-1242"><a href="#cb318-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1243"><a href="#cb318-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1244"><a href="#cb318-1244" aria-hidden="true" tabindex="-1"></a>Table 1 and S1 - grazing experiment information only</span>
<span id="cb318-1245"><a href="#cb318-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1248"><a href="#cb318-1248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1249"><a href="#cb318-1249" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim((table_wcalcs %&gt;%</span></span>
<span id="cb318-1250"><a href="#cb318-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(FIELD, NAME, EXP, SAMPLE, TimePoints, starts_with("EXP_"), starts_with("CTRL_"), PROK_ml, PROK_sem, EUK_ml, EUK_sem, RATE_min, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC)), file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb318-1251"><a href="#cb318-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1252"><a href="#cb318-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1253"><a href="#cb318-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1254"><a href="#cb318-1254" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass for eukaryotes</span></span>
<span id="cb318-1255"><a href="#cb318-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1256"><a href="#cb318-1256" aria-hidden="true" tabindex="-1"></a>References for estimating biovolume *Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al. (2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782--792.*</span>
<span id="cb318-1257"><a href="#cb318-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1260"><a href="#cb318-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1261"><a href="#cb318-1261" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb318-1262"><a href="#cb318-1262" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb318-1263"><a href="#cb318-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span>
<span id="cb318-1264"><a href="#cb318-1264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1265"><a href="#cb318-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1266"><a href="#cb318-1266" aria-hidden="true" tabindex="-1"></a><span class="fu">## C factor based on biovolume</span></span>
<span id="cb318-1267"><a href="#cb318-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1268"><a href="#cb318-1268" aria-hidden="true" tabindex="-1"></a>(1) Calculate biovolume based on observed/imaged cells</span>
<span id="cb318-1269"><a href="#cb318-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1272"><a href="#cb318-1272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1273"><a href="#cb318-1273" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate biovolume, then apply carbon by biomass estimate for protists derived from biovolume.</span></span>
<span id="cb318-1274"><a href="#cb318-1274" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb318-1275"><a href="#cb318-1275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIOVOLUME =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> d)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb318-1276"><a href="#cb318-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_dino =</span> (<span class="fl">0.760</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.819</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb318-1277"><a href="#cb318-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_nodiatom =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.939</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb318-1278"><a href="#cb318-1278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_RANGE_min =</span> (<span class="dv">80</span> <span class="sc">*</span> BIOVOLUME)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb318-1279"><a href="#cb318-1279" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_cell_RANGE_max =</span> (<span class="dv">360</span> <span class="sc">*</span> BIOVOLUME)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb318-1280"><a href="#cb318-1280" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_cell_RANGE_mean =</span> (<span class="dv">220</span> <span class="sc">*</span> BIOVOLUME)<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb318-1281"><a href="#cb318-1281" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biov_calc)</span>
<span id="cb318-1282"><a href="#cb318-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># biov_calc</span></span>
<span id="cb318-1283"><a href="#cb318-1283" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(c(80, 360))</span></span>
<span id="cb318-1284"><a href="#cb318-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1285"><a href="#cb318-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1286"><a href="#cb318-1286" aria-hidden="true" tabindex="-1"></a>(2) Get a summary pg per cell for vent and background samples. This is derived from biovolume estimates.</span>
<span id="cb318-1289"><a href="#cb318-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1290"><a href="#cb318-1290" aria-hidden="true" tabindex="-1"></a>c_factor_biov <span class="ot">&lt;-</span> </span>
<span id="cb318-1291"><a href="#cb318-1291" aria-hidden="true" tabindex="-1"></a>  biov_calc <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>EXP, <span class="sc">-</span>h, <span class="sc">-</span>d) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1292"><a href="#cb318-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(BIOVOLUME, <span class="fu">starts_with</span>(<span class="st">"pgC_"</span>)), <span class="at">names_to =</span> <span class="st">"VARIABLES"</span>, <span class="at">values_to =</span> <span class="st">"VALUES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1293"><a href="#cb318-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW, VARIABLES) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1294"><a href="#cb318-1294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(VALUES),</span>
<span id="cb318-1295"><a href="#cb318-1295" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(VALUES),</span>
<span id="cb318-1296"><a href="#cb318-1296" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1297"><a href="#cb318-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VENT_BSW, <span class="at">values_from =</span> <span class="fu">c</span>(mean, max,min), <span class="at">names_sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb318-1298"><a href="#cb318-1298" aria-hidden="true" tabindex="-1"></a><span class="co"># View(c_factor_biov)</span></span>
<span id="cb318-1299"><a href="#cb318-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1300"><a href="#cb318-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1301"><a href="#cb318-1301" aria-hidden="true" tabindex="-1"></a>(3) Assign a C conversion factor for background and within vents based on biovolume</span>
<span id="cb318-1304"><a href="#cb318-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1305"><a href="#cb318-1305" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_BSW</span>
<span id="cb318-1306"><a href="#cb318-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1307"><a href="#cb318-1307" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_vent</span>
<span id="cb318-1308"><a href="#cb318-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1309"><a href="#cb318-1309" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_BSW</span>
<span id="cb318-1310"><a href="#cb318-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1311"><a href="#cb318-1311" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_vent</span>
<span id="cb318-1312"><a href="#cb318-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1313"><a href="#cb318-1313" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_BSW</span>
<span id="cb318-1314"><a href="#cb318-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1315"><a href="#cb318-1315" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_vent</span>
<span id="cb318-1316"><a href="#cb318-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1317"><a href="#cb318-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1318"><a href="#cb318-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1319"><a href="#cb318-1319" aria-hidden="true" tabindex="-1"></a>(4) Combine with count table to estimate total standing stock in carbon</span>
<span id="cb318-1320"><a href="#cb318-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1321"><a href="#cb318-1321" aria-hidden="true" tabindex="-1"></a>Isolate at T0 all the euk cells per ml counts. Then add in the mean, min/max for the pg C per cell, based on the vent vs non-vent.</span>
<span id="cb318-1324"><a href="#cb318-1324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1325"><a href="#cb318-1325" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb318-1326"><a href="#cb318-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1327"><a href="#cb318-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1328"><a href="#cb318-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1329"><a href="#cb318-1329" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1330"><a href="#cb318-1330" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1331"><a href="#cb318-1331" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1332"><a href="#cb318-1332" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1333"><a href="#cb318-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1334"><a href="#cb318-1334" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_BSW,</span>
<span id="cb318-1335"><a href="#cb318-1335" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_vent,</span>
<span id="cb318-1336"><a href="#cb318-1336" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1337"><a href="#cb318-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_min =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1338"><a href="#cb318-1338" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_BSW_min,</span>
<span id="cb318-1339"><a href="#cb318-1339" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_vent_min</span>
<span id="cb318-1340"><a href="#cb318-1340" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1341"><a href="#cb318-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_max =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1342"><a href="#cb318-1342" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_BSW_max,</span>
<span id="cb318-1343"><a href="#cb318-1343" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> avg_conc <span class="sc">*</span> pgC_cell_vent_max</span>
<span id="cb318-1344"><a href="#cb318-1344" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb318-1345"><a href="#cb318-1345" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample</span>
<span id="cb318-1346"><a href="#cb318-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1347"><a href="#cb318-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1350"><a href="#cb318-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1351"><a href="#cb318-1351" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1352"><a href="#cb318-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> (pgC_ml_mean<span class="sc">/</span><span class="dv">1000</span>))) <span class="sc">+</span></span>
<span id="cb318-1353"><a href="#cb318-1353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb318-1354"><a href="#cb318-1354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (pgC_ml_min<span class="sc">/</span><span class="dv">1000</span>), <span class="at">ymax =</span> (pgC_ml_max<span class="sc">/</span><span class="dv">1000</span>))) <span class="sc">+</span></span>
<span id="cb318-1355"><a href="#cb318-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-1356"><a href="#cb318-1356" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb318-1357"><a href="#cb318-1357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-1358"><a href="#cb318-1358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1359"><a href="#cb318-1359" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-1360"><a href="#cb318-1360" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-1361"><a href="#cb318-1361" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb318-1362"><a href="#cb318-1362" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-1363"><a href="#cb318-1363" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1364"><a href="#cb318-1364" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1365"><a href="#cb318-1365" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-1366"><a href="#cb318-1366" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb318-1367"><a href="#cb318-1367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-1368"><a href="#cb318-1368" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-1369"><a href="#cb318-1369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>L<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb318-1370"><a href="#cb318-1370" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - derived from biovolume"</span>)</span>
<span id="cb318-1371"><a href="#cb318-1371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1372"><a href="#cb318-1372" aria-hidden="true" tabindex="-1"></a>**What should I do with replicates?</span>
<span id="cb318-1373"><a href="#cb318-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1374"><a href="#cb318-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1375"><a href="#cb318-1375" aria-hidden="true" tabindex="-1"></a><span class="fu">## C biomass based on size fraction</span></span>
<span id="cb318-1376"><a href="#cb318-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1377"><a href="#cb318-1377" aria-hidden="true" tabindex="-1"></a>Derived from Caron et al. 1995</span>
<span id="cb318-1378"><a href="#cb318-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1379"><a href="#cb318-1379" aria-hidden="true" tabindex="-1"></a>(1) Assign by size class</span>
<span id="cb318-1382"><a href="#cb318-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1383"><a href="#cb318-1383" aria-hidden="true" tabindex="-1"></a>c_n <span class="ot">&lt;-</span> <span class="fl">2.6</span> <span class="co"># pg C per cell</span></span>
<span id="cb318-1384"><a href="#cb318-1384" aria-hidden="true" tabindex="-1"></a>c_m <span class="ot">&lt;-</span> <span class="dv">138</span> <span class="co"># pg C per cell</span></span>
<span id="cb318-1385"><a href="#cb318-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1386"><a href="#cb318-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1389"><a href="#cb318-1389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1390"><a href="#cb318-1390" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample_tmp <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb318-1391"><a href="#cb318-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1392"><a href="#cb318-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">!=</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> <span class="co"># isolate micro vs. nano</span></span>
<span id="cb318-1393"><a href="#cb318-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1394"><a href="#cb318-1394" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1395"><a href="#cb318-1395" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1396"><a href="#cb318-1396" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1397"><a href="#cb318-1397" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1398"><a href="#cb318-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_cell =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1399"><a href="#cb318-1399" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> c_m,</span>
<span id="cb318-1400"><a href="#cb318-1400" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> c_n</span>
<span id="cb318-1401"><a href="#cb318-1401" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1402"><a href="#cb318-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_ml_TMP =</span> avg_conc <span class="sc">*</span> pg_C_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1403"><a href="#cb318-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXPERIMENT, SiteOrder, NameOrder, TimePoint, EXP_TYPE, SAMPLE_TYPE_BIN, Site_Order, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1404"><a href="#cb318-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml_TMP))</span>
<span id="cb318-1405"><a href="#cb318-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1406"><a href="#cb318-1406" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb318-1407"><a href="#cb318-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXPERIMENT, SiteOrder, NameOrder, TimePoint, EXP_TYPE, SAMPLE_TYPE_BIN, Site_Order) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1408"><a href="#cb318-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pg_C_ml =</span> <span class="fu">sum</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1409"><a href="#cb318-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">VARIABLE =</span> <span class="st">"totaleuk"</span>)</span>
<span id="cb318-1410"><a href="#cb318-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1411"><a href="#cb318-1411" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp2, pgC_ml_sizefrac_bysample_tmp)</span>
<span id="cb318-1412"><a href="#cb318-1412" aria-hidden="true" tabindex="-1"></a><span class="co"># pgC_ml_sizefrac_bysample</span></span>
<span id="cb318-1413"><a href="#cb318-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1414"><a href="#cb318-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1417"><a href="#cb318-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1418"><a href="#cb318-1418" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1419"><a href="#cb318-1419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1420"><a href="#cb318-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb318-1421"><a href="#cb318-1421" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb318-1422"><a href="#cb318-1422" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml))</span>
<span id="cb318-1423"><a href="#cb318-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1424"><a href="#cb318-1424" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_sizefrac_bysample)</span></span>
<span id="cb318-1425"><a href="#cb318-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1426"><a href="#cb318-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1427"><a href="#cb318-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1430"><a href="#cb318-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1431"><a href="#cb318-1431" aria-hidden="true" tabindex="-1"></a>by_sizefrac_plot <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1432"><a href="#cb318-1432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> (pg_C_ml<span class="sc">/</span><span class="dv">1000</span>))) <span class="sc">+</span></span>
<span id="cb318-1433"><a href="#cb318-1433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> VARIABLE)) <span class="sc">+</span> </span>
<span id="cb318-1434"><a href="#cb318-1434" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_linerange(aes(ymin = (pgC_ml_min/1000), ymax = (pgC_ml_max/1000))) +</span></span>
<span id="cb318-1435"><a href="#cb318-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-1436"><a href="#cb318-1436" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb318-1437"><a href="#cb318-1437" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-1438"><a href="#cb318-1438" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1439"><a href="#cb318-1439" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-1440"><a href="#cb318-1440" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-1441"><a href="#cb318-1441" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb318-1442"><a href="#cb318-1442" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-1443"><a href="#cb318-1443" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1444"><a href="#cb318-1444" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1445"><a href="#cb318-1445" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-1446"><a href="#cb318-1446" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb318-1447"><a href="#cb318-1447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-1448"><a href="#cb318-1448" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-1449"><a href="#cb318-1449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>L<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb318-1450"><a href="#cb318-1450" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - based on size fraction"</span>)</span>
<span id="cb318-1451"><a href="#cb318-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1452"><a href="#cb318-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1453"><a href="#cb318-1453" aria-hidden="true" tabindex="-1"></a>Combined supplementary plot showing two routes of determining total biomass.</span>
<span id="cb318-1454"><a href="#cb318-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=7}</span></span>
<span id="cb318-1455"><a href="#cb318-1455" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="sc">+</span> by_sizefrac_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb318-1456"><a href="#cb318-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb318-1457"><a href="#cb318-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1458"><a href="#cb318-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1459"><a href="#cb318-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1460"><a href="#cb318-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare total carbon biomass - euks</span></span>
<span id="cb318-1461"><a href="#cb318-1461" aria-hidden="true" tabindex="-1"></a>Compilation table of carbon biomass values for microeukaryotes by sample type and vent field</span>
<span id="cb318-1464"><a href="#cb318-1464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1465"><a href="#cb318-1465" aria-hidden="true" tabindex="-1"></a><span class="do">## carbon biomass derived from biovolume, by sample type</span></span>
<span id="cb318-1466"><a href="#cb318-1466" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1467"><a href="#cb318-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN)<span class="sc">%&gt;%</span> </span>
<span id="cb318-1468"><a href="#cb318-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb318-1469"><a href="#cb318-1469" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb318-1470"><a href="#cb318-1470" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1471"><a href="#cb318-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>)</span>
<span id="cb318-1472"><a href="#cb318-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1473"><a href="#cb318-1473" aria-hidden="true" tabindex="-1"></a><span class="do">## carbon biomass derived from biovolume, by vent field (vent only)</span></span>
<span id="cb318-1474"><a href="#cb318-1474" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1475"><a href="#cb318-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1476"><a href="#cb318-1476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site_Order)<span class="sc">%&gt;%</span> </span>
<span id="cb318-1477"><a href="#cb318-1477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb318-1478"><a href="#cb318-1478" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb318-1479"><a href="#cb318-1479" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1480"><a href="#cb318-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>)</span>
<span id="cb318-1481"><a href="#cb318-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1482"><a href="#cb318-1482" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass estimates from sample type and size fraction</span></span>
<span id="cb318-1483"><a href="#cb318-1483" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1484"><a href="#cb318-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1485"><a href="#cb318-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb318-1486"><a href="#cb318-1486" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb318-1487"><a href="#cb318-1487" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1488"><a href="#cb318-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span>
<span id="cb318-1489"><a href="#cb318-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1490"><a href="#cb318-1490" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass estimates from vent sites only, by vent field and size fraction</span></span>
<span id="cb318-1491"><a href="#cb318-1491" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb318-1492"><a href="#cb318-1492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1493"><a href="#cb318-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site_Order, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1494"><a href="#cb318-1494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb318-1495"><a href="#cb318-1495" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb318-1496"><a href="#cb318-1496" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1497"><a href="#cb318-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span>
<span id="cb318-1498"><a href="#cb318-1498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1499"><a href="#cb318-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1500"><a href="#cb318-1500" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare biovolumes from literature to measured in this study</span></span>
<span id="cb318-1501"><a href="#cb318-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1502"><a href="#cb318-1502" aria-hidden="true" tabindex="-1"></a>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10\^7 µm\^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</span>
<span id="cb318-1503"><a href="#cb318-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1504"><a href="#cb318-1504" aria-hidden="true" tabindex="-1"></a>Import the heterotroph species volume and carbon content to compare to my measured values. Compare to md-lessard (Supplementary)</span>
<span id="cb318-1505"><a href="#cb318-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1508"><a href="#cb318-1508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1509"><a href="#cb318-1509" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb318-1510"><a href="#cb318-1510" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb318-1511"><a href="#cb318-1511" aria-hidden="true" tabindex="-1"></a><span class="co"># biov</span></span>
<span id="cb318-1512"><a href="#cb318-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb318-1513"><a href="#cb318-1513" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb318-1514"><a href="#cb318-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1515"><a href="#cb318-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1516"><a href="#cb318-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, <span class="at">Volume =</span> BIOVOLUME, <span class="at">pgC_cell =</span> pgC_cell_MD_nodiatom)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1517"><a href="#cb318-1517" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb318-1518"><a href="#cb318-1518" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-1519"><a href="#cb318-1519" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb318-1520"><a href="#cb318-1520" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb318-1521"><a href="#cb318-1521" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb318-1522"><a href="#cb318-1522" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb318-1523"><a href="#cb318-1523" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1524"><a href="#cb318-1524" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb318-1525"><a href="#cb318-1525" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb318-1526"><a href="#cb318-1526" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb318-1527"><a href="#cb318-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1528"><a href="#cb318-1528" aria-hidden="true" tabindex="-1"></a>carbon_compare</span>
<span id="cb318-1529"><a href="#cb318-1529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1530"><a href="#cb318-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1531"><a href="#cb318-1531" aria-hidden="true" tabindex="-1"></a>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</span>
<span id="cb318-1532"><a href="#cb318-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1533"><a href="#cb318-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1534"><a href="#cb318-1534" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass for prokaryotes</span></span>
<span id="cb318-1535"><a href="#cb318-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1536"><a href="#cb318-1536" aria-hidden="true" tabindex="-1"></a>Now, report estimated carbon per cell for bacteria.</span>
<span id="cb318-1537"><a href="#cb318-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1538"><a href="#cb318-1538" aria-hidden="true" tabindex="-1"></a>Units: fg C per cell.</span>
<span id="cb318-1539"><a href="#cb318-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1540"><a href="#cb318-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Incorporate prokaryote carbon estimates}</span></span>
<span id="cb318-1541"><a href="#cb318-1541" aria-hidden="true" tabindex="-1"></a>bac_carbon_Mor_fg <span class="ot">&lt;-</span> (<span class="dv">86</span>) </span>
<span id="cb318-1542"><a href="#cb318-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#From Derived from Morono et al. 2011 </span></span>
<span id="cb318-1543"><a href="#cb318-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1544"><a href="#cb318-1544" aria-hidden="true" tabindex="-1"></a>bac_carbon_Lof_fg <span class="ot">&lt;-</span> (<span class="dv">173</span>) </span>
<span id="cb318-1545"><a href="#cb318-1545" aria-hidden="true" tabindex="-1"></a><span class="co"># Derived from McNichol et al. 2018; LOFERER-KROBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb318-1546"><a href="#cb318-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1547"><a href="#cb318-1547" aria-hidden="true" tabindex="-1"></a><span class="co"># fg C per cell</span></span>
<span id="cb318-1548"><a href="#cb318-1548" aria-hidden="true" tabindex="-1"></a>bac_carbon_mean <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb318-1549"><a href="#cb318-1549" aria-hidden="true" tabindex="-1"></a>bac_carbon_min <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb318-1550"><a href="#cb318-1550" aria-hidden="true" tabindex="-1"></a>bac_carbon_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb318-1551"><a href="#cb318-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1552"><a href="#cb318-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1553"><a href="#cb318-1553" aria-hidden="true" tabindex="-1"></a>Import main table with all estimates of cells</span>
<span id="cb318-1556"><a href="#cb318-1556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1557"><a href="#cb318-1557" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"output-data/table1-grazing-exp-list.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb318-1558"><a href="#cb318-1558" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb318-1559"><a href="#cb318-1559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1560"><a href="#cb318-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1561"><a href="#cb318-1561" aria-hidden="true" tabindex="-1"></a>RATE_min units = FLPs per grazer per minute</span>
<span id="cb318-1562"><a href="#cb318-1562" aria-hidden="true" tabindex="-1"></a>Clearance rate _ml = ml per grazer per hour</span>
<span id="cb318-1563"><a href="#cb318-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1564"><a href="#cb318-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1567"><a href="#cb318-1567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1568"><a href="#cb318-1568" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb318-1569"><a href="#cb318-1569" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb318-1570"><a href="#cb318-1570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), RATE_min, CLEARANCE_RATE_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1571"><a href="#cb318-1571" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in calcs by fg C per cell.</span></span>
<span id="cb318-1572"><a href="#cb318-1572" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimates of carbon pool of microbes per ml. </span></span>
<span id="cb318-1573"><a href="#cb318-1573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MOR_fgC_ml =</span> bac_carbon_Mor_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb318-1574"><a href="#cb318-1574" aria-hidden="true" tabindex="-1"></a>         <span class="at">LOF_fgC_ml =</span> bac_carbon_Lof_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb318-1575"><a href="#cb318-1575" aria-hidden="true" tabindex="-1"></a>         <span class="at">MEAN_fgC_ml =</span> bac_carbon_mean <span class="sc">*</span> PROK_ml,</span>
<span id="cb318-1576"><a href="#cb318-1576" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_fgC_ml =</span> bac_carbon_max <span class="sc">*</span> PROK_ml,</span>
<span id="cb318-1577"><a href="#cb318-1577" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_fgC_ml =</span> bac_carbon_min <span class="sc">*</span> PROK_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1578"><a href="#cb318-1578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"fgC_ml"</span>), <span class="at">names_to =</span> <span class="st">"fgC_ml"</span>)</span>
<span id="cb318-1579"><a href="#cb318-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1580"><a href="#cb318-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(est_prok_carbon)</span>
<span id="cb318-1581"><a href="#cb318-1581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1582"><a href="#cb318-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1583"><a href="#cb318-1583" aria-hidden="true" tabindex="-1"></a>Get summary of prokaryotic biomass</span>
<span id="cb318-1586"><a href="#cb318-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1587"><a href="#cb318-1587" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb318-1588"><a href="#cb318-1588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1589"><a href="#cb318-1589" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1590"><a href="#cb318-1590" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1591"><a href="#cb318-1591" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1592"><a href="#cb318-1592" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-1593"><a href="#cb318-1593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, fgC_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1594"><a href="#cb318-1594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pgC_ml =</span> <span class="fu">mean</span>((value)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb318-1595"><a href="#cb318-1595" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_pgC_ml =</span> <span class="fu">min</span>((value)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb318-1596"><a href="#cb318-1596" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_pgC_ml =</span> <span class="fu">max</span>((value)<span class="sc">*</span>(<span class="fl">0.001</span>))) </span>
<span id="cb318-1597"><a href="#cb318-1597" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(est_prok_carbon)</span>
<span id="cb318-1598"><a href="#cb318-1598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1599"><a href="#cb318-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1600"><a href="#cb318-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1601"><a href="#cb318-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Incorporate carbon biomass of prey and grazing rate </span></span>
<span id="cb318-1604"><a href="#cb318-1604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1605"><a href="#cb318-1605" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon consumed based on clearance rate</span></span>
<span id="cb318-1606"><a href="#cb318-1606" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="ot">&lt;-</span> est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb318-1607"><a href="#cb318-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fgC_ml <span class="sc">==</span> <span class="st">"MOR_fgC_ml"</span>) <span class="sc">%&gt;%</span> <span class="co">#use only value from Morono et al.</span></span>
<span id="cb318-1608"><a href="#cb318-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ugC_cell =</span> (bac_carbon_Mor_fg <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1609"><a href="#cb318-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, PROK_ml, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, ugC_cell, <span class="at">ugC_ml =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1610"><a href="#cb318-1610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ugC_pergrazer_CLEARANCE =</span> ugC_ml <span class="sc">*</span> CLEARANCE_RATE_ml,</span>
<span id="cb318-1611"><a href="#cb318-1611" aria-hidden="true" tabindex="-1"></a>         <span class="at">ugC_perml_perhr =</span> ugC_cell <span class="sc">*</span> GRAZING_EFFECT_hr)</span>
<span id="cb318-1612"><a href="#cb318-1612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1613"><a href="#cb318-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1614"><a href="#cb318-1614" aria-hidden="true" tabindex="-1"></a>Summary of carbon consumed:</span>
<span id="cb318-1617"><a href="#cb318-1617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1618"><a href="#cb318-1618" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="sc">%&gt;%</span> </span>
<span id="cb318-1619"><a href="#cb318-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1620"><a href="#cb318-1620" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1621"><a href="#cb318-1621" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1622"><a href="#cb318-1622" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1623"><a href="#cb318-1623" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-1624"><a href="#cb318-1624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1625"><a href="#cb318-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">mean</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb318-1626"><a href="#cb318-1626" aria-hidden="true" tabindex="-1"></a>            <span class="at">MEAN_ugC_perml_perhr =</span> <span class="fu">mean</span>(ugC_perml_perhr),</span>
<span id="cb318-1627"><a href="#cb318-1627" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_pergrazer_CLEARANCE =</span> <span class="fu">max</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb318-1628"><a href="#cb318-1628" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_perml_perhr =</span> <span class="fu">max</span>(ugC_perml_perhr),</span>
<span id="cb318-1629"><a href="#cb318-1629" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">min</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb318-1630"><a href="#cb318-1630" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_perml_perhr =</span> <span class="fu">min</span>(ugC_perml_perhr))</span>
<span id="cb318-1631"><a href="#cb318-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1632"><a href="#cb318-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1633"><a href="#cb318-1633" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="sc">%&gt;%</span> </span>
<span id="cb318-1634"><a href="#cb318-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1635"><a href="#cb318-1635" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1636"><a href="#cb318-1636" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1637"><a href="#cb318-1637" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1638"><a href="#cb318-1638" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-1639"><a href="#cb318-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1640"><a href="#cb318-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1641"><a href="#cb318-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">mean</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb318-1642"><a href="#cb318-1642" aria-hidden="true" tabindex="-1"></a>            <span class="at">MEAN_ugC_perml_perhr =</span> <span class="fu">mean</span>(ugC_perml_perhr),</span>
<span id="cb318-1643"><a href="#cb318-1643" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_pergrazer_CLEARANCE =</span> <span class="fu">max</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb318-1644"><a href="#cb318-1644" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_ugC_perml_perhr =</span> <span class="fu">max</span>(ugC_perml_perhr),</span>
<span id="cb318-1645"><a href="#cb318-1645" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_pergrazer_CLEARANCE =</span> <span class="fu">min</span>(ugC_pergrazer_CLEARANCE),</span>
<span id="cb318-1646"><a href="#cb318-1646" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_ugC_perml_perhr =</span> <span class="fu">min</span>(ugC_perml_perhr))</span>
<span id="cb318-1647"><a href="#cb318-1647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1648"><a href="#cb318-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1649"><a href="#cb318-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1650"><a href="#cb318-1650" aria-hidden="true" tabindex="-1"></a><span class="fu"># Compare with Axial euk cell count</span></span>
<span id="cb318-1651"><a href="#cb318-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1652"><a href="#cb318-1652" aria-hidden="true" tabindex="-1"></a>From Axial Seamount cruise (July 2022) - have Anemone vent and plume euk cell counts to compare.</span>
<span id="cb318-1653"><a href="#cb318-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1656"><a href="#cb318-1656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1657"><a href="#cb318-1657" aria-hidden="true" tabindex="-1"></a>counts_ax <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../GrazingatAxial-2022/euk-cell-counts-11142022.csv"</span>, </span>
<span id="cb318-1658"><a href="#cb318-1658" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb318-1659"><a href="#cb318-1659" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb318-1660"><a href="#cb318-1660" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb318-1661"><a href="#cb318-1661" aria-hidden="true" tabindex="-1"></a>counts_ax[<span class="fu">is.na</span>(counts_ax)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span>
<span id="cb318-1662"><a href="#cb318-1662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1663"><a href="#cb318-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1664"><a href="#cb318-1664" aria-hidden="true" tabindex="-1"></a>Modify grazing code to count euk cells/ml so it considers euk cell count samples only.</span>
<span id="cb318-1665"><a href="#cb318-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1668"><a href="#cb318-1668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1669"><a href="#cb318-1669" aria-hidden="true" tabindex="-1"></a>counts_cellsml_axial <span class="ot">&lt;-</span> counts_ax <span class="sc">%&gt;%</span></span>
<span id="cb318-1670"><a href="#cb318-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, <span class="at">EXP =</span> <span class="st">`</span><span class="at">EXP.ID</span><span class="st">`</span>, <span class="at">VOL =</span> <span class="st">`</span><span class="at">vol..ml.</span><span class="st">`</span>, <span class="at">MAG =</span> <span class="st">`</span><span class="at">Mag..x.</span><span class="st">`</span>, <span class="at">nano =</span> <span class="st">`</span><span class="at">X.20um..no.FLP</span><span class="st">`</span>, <span class="at">micro =</span> <span class="st">`</span><span class="at">X.20um..no.FLP.1</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1671"><a href="#cb318-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXP, VOL) <span class="sc">%&gt;%</span></span>
<span id="cb318-1672"><a href="#cb318-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nano), </span>
<span id="cb318-1673"><a href="#cb318-1673" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(micro),</span>
<span id="cb318-1674"><a href="#cb318-1674" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1675"><a href="#cb318-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb318-1676"><a href="#cb318-1676" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb318-1677"><a href="#cb318-1677" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb318-1678"><a href="#cb318-1678" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb318-1679"><a href="#cb318-1679" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb318-1680"><a href="#cb318-1680" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb318-1681"><a href="#cb318-1681" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb318-1682"><a href="#cb318-1682" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb318-1683"><a href="#cb318-1683" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb318-1684"><a href="#cb318-1684" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar)))) <span class="sc">%&gt;%</span></span>
<span id="cb318-1685"><a href="#cb318-1685" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab filter rig, it is 283.385):</span></span>
<span id="cb318-1686"><a href="#cb318-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb318-1687"><a href="#cb318-1687" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb318-1688"><a href="#cb318-1688" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb318-1689"><a href="#cb318-1689" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb318-1690"><a href="#cb318-1690" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # left_join(expmeta) %&gt;%</span></span>
<span id="cb318-1691"><a href="#cb318-1691" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(SAMPLE, c("Site", "Name"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb318-1692"><a href="#cb318-1692" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(EXPID, c("TimePoint", "Replicate"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb318-1693"><a href="#cb318-1693" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data.frame</span></span>
<span id="cb318-1694"><a href="#cb318-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1695"><a href="#cb318-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1696"><a href="#cb318-1696" aria-hidden="true" tabindex="-1"></a>Thoughts on cell counts. Combining nano and micro for now, as the de-pressurization can cause issues in size. Likely underestimates for these counts.</span>
<span id="cb318-1697"><a href="#cb318-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1698"><a href="#cb318-1698" aria-hidden="true" tabindex="-1"></a>This is further supported because the biovolumes of all cells were pretty low.</span>
<span id="cb318-1699"><a href="#cb318-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1702"><a href="#cb318-1702" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1703"><a href="#cb318-1703" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(counts_cellsml_axial)</span>
<span id="cb318-1704"><a href="#cb318-1704" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(counts_cellsml_axial<span class="sc">$</span>eukCONC)</span>
<span id="cb318-1705"><a href="#cb318-1705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1706"><a href="#cb318-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1709"><a href="#cb318-1709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1710"><a href="#cb318-1710" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_euk_conc)</span></span>
<span id="cb318-1711"><a href="#cb318-1711" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_axial)</span></span>
<span id="cb318-1712"><a href="#cb318-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1713"><a href="#cb318-1713" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="sc">%&gt;%</span> </span>
<span id="cb318-1714"><a href="#cb318-1714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span> <span class="sc">&amp;</span> TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1715"><a href="#cb318-1715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1716"><a href="#cb318-1716" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(CONCENTRATION)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1717"><a href="#cb318-1717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"MidCaymanRise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1718"><a href="#cb318-1718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(counts_cellsml_axial <span class="sc">%&gt;%</span> </span>
<span id="cb318-1719"><a href="#cb318-1719" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Name =</span> EXP, eukCONC) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1720"><a href="#cb318-1720" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1721"><a href="#cb318-1721" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">euk_conc_mean =</span> <span class="fu">mean</span>(eukCONC)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1722"><a href="#cb318-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"AxialSeamount"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1723"><a href="#cb318-1723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1724"><a href="#cb318-1724" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb318-1725"><a href="#cb318-1725" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb318-1726"><a href="#cb318-1726" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"ASHES Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb318-1727"><a href="#cb318-1727" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"International District Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb318-1728"><a href="#cb318-1728" aria-hidden="true" tabindex="-1"></a>    Site <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"BSW"</span>,</span>
<span id="cb318-1729"><a href="#cb318-1729" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1730"><a href="#cb318-1730" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1731"><a href="#cb318-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Name, <span class="at">y =</span> euk_conc_mean)) <span class="sc">+</span></span>
<span id="cb318-1732"><a href="#cb318-1732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> TYPE), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-1733"><a href="#cb318-1733" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-1734"><a href="#cb318-1734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> FIELD <span class="sc">+</span> TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-1735"><a href="#cb318-1735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-1736"><a href="#cb318-1736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb318-1737"><a href="#cb318-1737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span>
<span id="cb318-1738"><a href="#cb318-1738" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb318-1739"><a href="#cb318-1739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1740"><a href="#cb318-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1741"><a href="#cb318-1741" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environmental parameters - MCR</span></span>
<span id="cb318-1742"><a href="#cb318-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1743"><a href="#cb318-1743" aria-hidden="true" tabindex="-1"></a>Import from Hu et al. (*Molecular Ecology*).</span>
<span id="cb318-1744"><a href="#cb318-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1747"><a href="#cb318-1747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1748"><a href="#cb318-1748" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb318-1749"><a href="#cb318-1749" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb318-1750"><a href="#cb318-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1751"><a href="#cb318-1751" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb318-1752"><a href="#cb318-1752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1753"><a href="#cb318-1753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb318-1754"><a href="#cb318-1754" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb318-1755"><a href="#cb318-1755" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1756"><a href="#cb318-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1757"><a href="#cb318-1757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE, <span class="fu">everything</span>())</span>
<span id="cb318-1758"><a href="#cb318-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1759"><a href="#cb318-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb318-1760"><a href="#cb318-1760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1761"><a href="#cb318-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1762"><a href="#cb318-1762" aria-hidden="true" tabindex="-1"></a>Generate supplementary table.</span>
<span id="cb318-1763"><a href="#cb318-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1766"><a href="#cb318-1766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1767"><a href="#cb318-1767" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb318-1768"><a href="#cb318-1768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc)</span>
<span id="cb318-1769"><a href="#cb318-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1770"><a href="#cb318-1770" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb318-1771"><a href="#cb318-1771" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span>
<span id="cb318-1772"><a href="#cb318-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1773"><a href="#cb318-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1774"><a href="#cb318-1774" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis of grazing rate results</span></span>
<span id="cb318-1775"><a href="#cb318-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1776"><a href="#cb318-1776" aria-hidden="true" tabindex="-1"></a>Re-import table from output table with all grazing values</span>
<span id="cb318-1777"><a href="#cb318-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1780"><a href="#cb318-1780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1781"><a href="#cb318-1781" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb318-1782"><a href="#cb318-1782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1783"><a href="#cb318-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1784"><a href="#cb318-1784" aria-hidden="true" tabindex="-1"></a>Format and factor values to plot, and prioritize these values:</span>
<span id="cb318-1785"><a href="#cb318-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1786"><a href="#cb318-1786" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing rate column == FLP per minute consumed</span>
<span id="cb318-1787"><a href="#cb318-1787" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing effect hr == cells per ml per hr</span>
<span id="cb318-1788"><a href="#cb318-1788" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</span>
<span id="cb318-1789"><a href="#cb318-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1792"><a href="#cb318-1792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1793"><a href="#cb318-1793" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_wcalcs_biomass_bounded)</span>
<span id="cb318-1794"><a href="#cb318-1794" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs_biomass_bounded$Euk</span></span>
<span id="cb318-1795"><a href="#cb318-1795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1796"><a href="#cb318-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1797"><a href="#cb318-1797" aria-hidden="true" tabindex="-1"></a>Report grazing rates</span>
<span id="cb318-1800"><a href="#cb318-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1801"><a href="#cb318-1801" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span> </span>
<span id="cb318-1802"><a href="#cb318-1802" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-1803"><a href="#cb318-1803" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1804"><a href="#cb318-1804" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb318-1805"><a href="#cb318-1805" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-1806"><a href="#cb318-1806" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb318-1807"><a href="#cb318-1807" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb318-1808"><a href="#cb318-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, EXP) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1809"><a href="#cb318-1809" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">MEAN_RATE =</span> <span class="fu">mean</span>(GRAZING_EFFECT_hr),</span>
<span id="cb318-1810"><a href="#cb318-1810" aria-hidden="true" tabindex="-1"></a>              <span class="at">MIN_RATE =</span> <span class="fu">min</span>(GRAZING_EFFECT_hr),</span>
<span id="cb318-1811"><a href="#cb318-1811" aria-hidden="true" tabindex="-1"></a>              <span class="at">MAX_RATE =</span> <span class="fu">max</span>(GRAZING_EFFECT_hr))</span>
<span id="cb318-1812"><a href="#cb318-1812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1815"><a href="#cb318-1815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1816"><a href="#cb318-1816" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot <span class="ot">&lt;-</span> table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span></span>
<span id="cb318-1817"><a href="#cb318-1817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, type,</span>
<span id="cb318-1818"><a href="#cb318-1818" aria-hidden="true" tabindex="-1"></a>        PROK_ml, EUK_ml, PROK_sem, EUK_sem,</span>
<span id="cb318-1819"><a href="#cb318-1819" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_L_MOR, </span>
<span id="cb318-1820"><a href="#cb318-1820" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Euk_biomass_Hu_L, Euk_biomass_lit_L,</span></span>
<span id="cb318-1821"><a href="#cb318-1821" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span></span>
<span id="cb318-1822"><a href="#cb318-1822" aria-hidden="true" tabindex="-1"></a>        GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, BAC_TURNOVER_PERC_min, BAC_TURNOVER_PERC_max,</span>
<span id="cb318-1823"><a href="#cb318-1823" aria-hidden="true" tabindex="-1"></a>        GRAZE_RATE) <span class="sc">%&gt;%</span></span>
<span id="cb318-1824"><a href="#cb318-1824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml,</span>
<span id="cb318-1825"><a href="#cb318-1825" aria-hidden="true" tabindex="-1"></a>                        Prok_biomass_L_MOR, </span>
<span id="cb318-1826"><a href="#cb318-1826" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Euk_biomass_Hu_L, Euk_biomass_lit_L,</span></span>
<span id="cb318-1827"><a href="#cb318-1827" aria-hidden="true" tabindex="-1"></a>                        GRAZING_EFFECT_hr, BAC_TURNOVER_PERC,</span>
<span id="cb318-1828"><a href="#cb318-1828" aria-hidden="true" tabindex="-1"></a>                        GRAZE_RATE),</span>
<span id="cb318-1829"><a href="#cb318-1829" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1830"><a href="#cb318-1830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_sem, EUK_sem, </span>
<span id="cb318-1831"><a href="#cb318-1831" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span></span>
<span id="cb318-1832"><a href="#cb318-1832" aria-hidden="true" tabindex="-1"></a>                        BAC_TURNOVER_PERC_max, BAC_TURNOVER_PERC_min, GRAZING_EFFECT_hr_max, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max),</span>
<span id="cb318-1833"><a href="#cb318-1833" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"SEM_variable"</span>, <span class="at">values_to =</span> <span class="st">"SEM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1834"><a href="#cb318-1834" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-1835"><a href="#cb318-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1836"><a href="#cb318-1836" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb318-1837"><a href="#cb318-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1838"><a href="#cb318-1838" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>VARIABLE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>Variable,</span>
<span id="cb318-1839"><a href="#cb318-1839" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PROK_ml"</span>, <span class="st">"EUK_ml"</span>,</span>
<span id="cb318-1840"><a href="#cb318-1840" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prok_biomass_L_MOR"</span>, </span>
<span id="cb318-1841"><a href="#cb318-1841" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># "Euk_biomass_Hu_L", "Euk_biomass_lit_L",</span></span>
<span id="cb318-1842"><a href="#cb318-1842" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZING_EFFECT_hr"</span>, <span class="st">"BAC_TURNOVER_PERC"</span>,</span>
<span id="cb318-1843"><a href="#cb318-1843" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZE_RATE"</span>),</span>
<span id="cb318-1844"><a href="#cb318-1844" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Prokaryote~cells~mL^{-1}"</span>, <span class="st">"Eukaryote~cells~mL^{-1}"</span>,</span>
<span id="cb318-1845"><a href="#cb318-1845" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prokaryote~µg~C~L^{-1}"</span>, </span>
<span id="cb318-1846"><a href="#cb318-1846" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># "Measured~eukaryote~µg~C~L^{-1}", "Literature-based~eukaryote~µg~C~L^{-1}",</span></span>
<span id="cb318-1847"><a href="#cb318-1847" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cells~mL^{-1}~hr^{-1}"</span>, <span class="st">"Prokaryote~turnover~'%'~d^{-1}"</span>,</span>
<span id="cb318-1848"><a href="#cb318-1848" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"FLP~consumed~min^{-1}"</span>))</span>
<span id="cb318-1849"><a href="#cb318-1849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1850"><a href="#cb318-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1851"><a href="#cb318-1851" aria-hidden="true" tabindex="-1"></a><span class="fu">## Function to plot grazing results</span></span>
<span id="cb318-1852"><a href="#cb318-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1855"><a href="#cb318-1855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1856"><a href="#cb318-1856" aria-hidden="true" tabindex="-1"></a>conc_rate_plot_mcr <span class="ot">&lt;-</span> <span class="cf">function</span>(df, var, sem){</span>
<span id="cb318-1857"><a href="#cb318-1857" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb318-1858"><a href="#cb318-1858" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> var) <span class="sc">%&gt;%</span></span>
<span id="cb318-1859"><a href="#cb318-1859" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> sem) <span class="sc">%&gt;%</span></span>
<span id="cb318-1860"><a href="#cb318-1860" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-1861"><a href="#cb318-1861" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Value <span class="sc">+</span> SEM), <span class="at">ymin =</span> (Value <span class="sc">-</span> SEM)),</span>
<span id="cb318-1862"><a href="#cb318-1862" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-1863"><a href="#cb318-1863" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb318-1864"><a href="#cb318-1864" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-1865"><a href="#cb318-1865" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb318-1866"><a href="#cb318-1866" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb318-1867"><a href="#cb318-1867" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(VARIABLE_ORDER <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free"</span>,</span>
<span id="cb318-1868"><a href="#cb318-1868" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>), <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb318-1869"><a href="#cb318-1869" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb318-1870"><a href="#cb318-1870" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb318-1871"><a href="#cb318-1871" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-1872"><a href="#cb318-1872" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1873"><a href="#cb318-1873" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1874"><a href="#cb318-1874" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb318-1875"><a href="#cb318-1875" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb318-1876"><a href="#cb318-1876" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb318-1877"><a href="#cb318-1877" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-1878"><a href="#cb318-1878" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb318-1879"><a href="#cb318-1879" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-1880"><a href="#cb318-1880" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1881"><a href="#cb318-1881" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-1882"><a href="#cb318-1882" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-1883"><a href="#cb318-1883" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb318-1884"><a href="#cb318-1884" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-1885"><a href="#cb318-1885" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-1886"><a href="#cb318-1886" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb318-1887"><a href="#cb318-1887" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb318-1888"><a href="#cb318-1888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1889"><a href="#cb318-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1892"><a href="#cb318-1892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1893"><a href="#cb318-1893" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "PROK_ml", "PROK_sem")</span></span>
<span id="cb318-1894"><a href="#cb318-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1895"><a href="#cb318-1895" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "EUK_ml", "EUK_sem")</span></span>
<span id="cb318-1896"><a href="#cb318-1896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1897"><a href="#cb318-1897" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Prok_biomass_L", "Prok_biomass_sem_L")</span></span>
<span id="cb318-1898"><a href="#cb318-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1899"><a href="#cb318-1899" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Euk_biomass_Hu_L", "Euk_biomass_Hu_sem_L")</span></span>
<span id="cb318-1900"><a href="#cb318-1900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1901"><a href="#cb318-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1902"><a href="#cb318-1902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=6}</span></span>
<span id="cb318-1903"><a href="#cb318-1903" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb318-1904"><a href="#cb318-1904" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biomass_rate_plot)</span></span>
<span id="cb318-1905"><a href="#cb318-1905" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(biomass_rate_plot$FIELD)</span></span>
<span id="cb318-1906"><a href="#cb318-1906" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> biomass_rate_plot <span class="sc">%&gt;%</span> </span>
<span id="cb318-1907"><a href="#cb318-1907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1908"><a href="#cb318-1908" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1909"><a href="#cb318-1909" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_min"</span> <span class="sc">|</span> SEM_variable <span class="sc">==</span> <span class="st">"GRAZING_EFFECT_hr_max"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1910"><a href="#cb318-1910" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> SEM_variable, <span class="at">values_from =</span> SEM) <span class="sc">%&gt;%</span></span>
<span id="cb318-1911"><a href="#cb318-1911" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">NAME_ORDER =</span> <span class="fu">factor</span>(NAME, <span class="at">levels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1912"><a href="#cb318-1912" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">FIELD_ORDER =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1913"><a href="#cb318-1913" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD_ORDER)) <span class="sc">+</span></span>
<span id="cb318-1914"><a href="#cb318-1914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb318-1915"><a href="#cb318-1915" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-1916"><a href="#cb318-1916" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD_ORDER),</span>
<span id="cb318-1917"><a href="#cb318-1917" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-1918"><a href="#cb318-1918" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-1919"><a href="#cb318-1919" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb318-1920"><a href="#cb318-1920" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELD_ORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-1921"><a href="#cb318-1921" aria-hidden="true" tabindex="-1"></a>    <span class="co"># facet_wrap(. ~ FIELD_ORDER, scales = "free", </span></span>
<span id="cb318-1922"><a href="#cb318-1922" aria-hidden="true" tabindex="-1"></a>    <span class="co">#            labeller = label_parsed) +</span></span>
<span id="cb318-1923"><a href="#cb318-1923" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb318-1924"><a href="#cb318-1924" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_flip() +</span></span>
<span id="cb318-1925"><a href="#cb318-1925" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1926"><a href="#cb318-1926" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-1927"><a href="#cb318-1927" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-1928"><a href="#cb318-1928" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb318-1929"><a href="#cb318-1929" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-1930"><a href="#cb318-1930" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1931"><a href="#cb318-1931" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1932"><a href="#cb318-1932" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-1933"><a href="#cb318-1933" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-1934"><a href="#cb318-1934" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-1935"><a href="#cb318-1935" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb318-1936"><a href="#cb318-1936" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb318-1937"><a href="#cb318-1937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-1938"><a href="#cb318-1938" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-1939"><a href="#cb318-1939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb318-1940"><a href="#cb318-1940" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb318-1941"><a href="#cb318-1941" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e4</span>))</span>
<span id="cb318-1942"><a href="#cb318-1942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1943"><a href="#cb318-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1944"><a href="#cb318-1944" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 1 compilation</span></span>
<span id="cb318-1945"><a href="#cb318-1945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=9, fig.width=11}</span></span>
<span id="cb318-1946"><a href="#cb318-1946" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_prok_flp_rate &lt;- </span></span>
<span id="cb318-1947"><a href="#cb318-1947" aria-hidden="true" tabindex="-1"></a>  (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">/</span> </span>
<span id="cb318-1948"><a href="#cb318-1948" aria-hidden="true" tabindex="-1"></a>  (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> <span class="fu">guide_area</span>() <span class="sc">+</span></span>
<span id="cb318-1949"><a href="#cb318-1949" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">|</span> </span>
<span id="cb318-1950"><a href="#cb318-1950" aria-hidden="true" tabindex="-1"></a>  (grazing_min_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.02</span>))) <span class="sc">/</span></span>
<span id="cb318-1951"><a href="#cb318-1951" aria-hidden="true" tabindex="-1"></a>  (grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e4</span>))) <span class="sc">+</span></span>
<span id="cb318-1952"><a href="#cb318-1952" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span> <span class="fu">guide_area</span>() <span class="sc">|</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb318-1953"><a href="#cb318-1953" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1954"><a href="#cb318-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1955"><a href="#cb318-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1956"><a href="#cb318-1956" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grazing rate vs. cells ml</span></span>
<span id="cb318-1957"><a href="#cb318-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1960"><a href="#cb318-1960" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1961"><a href="#cb318-1961" aria-hidden="true" tabindex="-1"></a>env_params <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> <span class="st">"input-data/table_wenv.txt"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb318-1962"><a href="#cb318-1962" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(env_params)</span>
<span id="cb318-1963"><a href="#cb318-1963" aria-hidden="true" tabindex="-1"></a>plot_metadata <span class="ot">&lt;-</span> env_params <span class="sc">%&gt;%</span> </span>
<span id="cb318-1964"><a href="#cb318-1964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-1965"><a href="#cb318-1965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1966"><a href="#cb318-1966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_hr"</span>), pH, Mg, H2., CH4, H2S)</span>
<span id="cb318-1967"><a href="#cb318-1967" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot_wider(names_from = "name", values_from = "value", values_fill = NA)</span></span>
<span id="cb318-1968"><a href="#cb318-1968" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb318-1969"><a href="#cb318-1969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1970"><a href="#cb318-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1971"><a href="#cb318-1971" aria-hidden="true" tabindex="-1"></a>Compare microbial biomass, concentration, grazing and temperature across all sites.</span>
<span id="cb318-1972"><a href="#cb318-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1975"><a href="#cb318-1975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-1976"><a href="#cb318-1976" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb318-1977"><a href="#cb318-1977" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-1978"><a href="#cb318-1978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb318-1979"><a href="#cb318-1979" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb318-1980"><a href="#cb318-1980" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb318-1981"><a href="#cb318-1981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb318-1982"><a href="#cb318-1982" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb318-1983"><a href="#cb318-1983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb318-1984"><a href="#cb318-1984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>()) <span class="sc">+</span></span>
<span id="cb318-1985"><a href="#cb318-1985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb318-1986"><a href="#cb318-1986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb318-1987"><a href="#cb318-1987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-1988"><a href="#cb318-1988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb318-1989"><a href="#cb318-1989" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb318-1990"><a href="#cb318-1990" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb318-1991"><a href="#cb318-1991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb318-1992"><a href="#cb318-1992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1993"><a href="#cb318-1993" aria-hidden="true" tabindex="-1"></a>euk_temp</span>
<span id="cb318-1994"><a href="#cb318-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1995"><a href="#cb318-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-1996"><a href="#cb318-1996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-1997"><a href="#cb318-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2000"><a href="#cb318-2000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2001"><a href="#cb318-2001" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb318-2002"><a href="#cb318-2002" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(TEMP)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2003"><a href="#cb318-2003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, <span class="at">fill =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb318-2004"><a href="#cb318-2004" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb318-2005"><a href="#cb318-2005" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb318-2006"><a href="#cb318-2006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem)))) <span class="sc">+</span></span>
<span id="cb318-2007"><a href="#cb318-2007" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb318-2008"><a href="#cb318-2008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb318-2009"><a href="#cb318-2009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb318-2010"><a href="#cb318-2010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb318-2011"><a href="#cb318-2011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb318-2012"><a href="#cb318-2012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-2013"><a href="#cb318-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb318-2014"><a href="#cb318-2014" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb318-2015"><a href="#cb318-2015" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb318-2016"><a href="#cb318-2016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Microial prey cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>)</span>
<span id="cb318-2017"><a href="#cb318-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2018"><a href="#cb318-2018" aria-hidden="true" tabindex="-1"></a>prok_temp</span>
<span id="cb318-2019"><a href="#cb318-2019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2020"><a href="#cb318-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2021"><a href="#cb318-2021" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 2 compilation</span></span>
<span id="cb318-2022"><a href="#cb318-2022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=7}</span></span>
<span id="cb318-2023"><a href="#cb318-2023" aria-hidden="true" tabindex="-1"></a>(euk_temp <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> prok_temp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb318-2024"><a href="#cb318-2024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2025"><a href="#cb318-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2026"><a href="#cb318-2026" aria-hidden="true" tabindex="-1"></a>Plot other environmental parameters</span>
<span id="cb318-2027"><a href="#cb318-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2030"><a href="#cb318-2030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2031"><a href="#cb318-2031" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb318-2032"><a href="#cb318-2032" aria-hidden="true" tabindex="-1"></a>plot_supp <span class="ot">&lt;-</span> <span class="cf">function</span>(PARAMETER){</span>
<span id="cb318-2033"><a href="#cb318-2033" aria-hidden="true" tabindex="-1"></a>  plot_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb318-2034"><a href="#cb318-2034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pH, Mg, H2., CH4, H2S), <span class="at">names_to =</span> <span class="st">"ENV"</span>, <span class="at">values_to =</span> <span class="st">"ENV_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2035"><a href="#cb318-2035" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ENV_NUM =</span> <span class="fu">as.numeric</span>(ENV_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2036"><a href="#cb318-2036" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(ENV <span class="sc">==</span> PARAMETER) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2037"><a href="#cb318-2037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, <span class="at">fill =</span> ENV_VALUE)) <span class="sc">+</span></span>
<span id="cb318-2038"><a href="#cb318-2038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem)))) <span class="sc">+</span></span>
<span id="cb318-2039"><a href="#cb318-2039" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max))) <span class="sc">+</span></span>
<span id="cb318-2040"><a href="#cb318-2040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb318-2041"><a href="#cb318-2041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb318-2042"><a href="#cb318-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb318-2043"><a href="#cb318-2043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb318-2044"><a href="#cb318-2044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-2045"><a href="#cb318-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb318-2046"><a href="#cb318-2046" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb318-2047"><a href="#cb318-2047" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))  <span class="sc">+</span></span>
<span id="cb318-2048"><a href="#cb318-2048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Euk cells per ml"</span>, <span class="at">x =</span> <span class="st">"Grazing rate per hr"</span>,</span>
<span id="cb318-2049"><a href="#cb318-2049" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> PARAMETER)</span>
<span id="cb318-2050"><a href="#cb318-2050" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb318-2051"><a href="#cb318-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2052"><a href="#cb318-2052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2053"><a href="#cb318-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2054"><a href="#cb318-2054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=16, fig.width=15}</span></span>
<span id="cb318-2055"><a href="#cb318-2055" aria-hidden="true" tabindex="-1"></a><span class="co"># pH, Mg, H2., CH4, H2S</span></span>
<span id="cb318-2056"><a href="#cb318-2056" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_supp</span>(<span class="st">"pH"</span>) <span class="sc">+</span></span>
<span id="cb318-2057"><a href="#cb318-2057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"Mg"</span>) <span class="sc">+</span></span>
<span id="cb318-2058"><a href="#cb318-2058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2."</span>) <span class="sc">+</span></span>
<span id="cb318-2059"><a href="#cb318-2059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"CH4"</span>) <span class="sc">+</span></span>
<span id="cb318-2060"><a href="#cb318-2060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_supp</span>(<span class="st">"H2S"</span>) <span class="sc">+</span></span>
<span id="cb318-2061"><a href="#cb318-2061" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span>
<span id="cb318-2062"><a href="#cb318-2062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2063"><a href="#cb318-2063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2064"><a href="#cb318-2064" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison with Gorda Ridge</span></span>
<span id="cb318-2065"><a href="#cb318-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2066"><a href="#cb318-2066" aria-hidden="true" tabindex="-1"></a>Import data from Gorda Ridge</span>
<span id="cb318-2067"><a href="#cb318-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2070"><a href="#cb318-2070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2071"><a href="#cb318-2071" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb318-2072"><a href="#cb318-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2073"><a href="#cb318-2073" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"/Users/sarahhu/Desktop/Projects/GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb318-2074"><a href="#cb318-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2075"><a href="#cb318-2075" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb318-2076"><a href="#cb318-2076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2077"><a href="#cb318-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2078"><a href="#cb318-2078" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combine GR and MCR data</span></span>
<span id="cb318-2079"><a href="#cb318-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2082"><a href="#cb318-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2083"><a href="#cb318-2083" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb318-2084"><a href="#cb318-2084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-2085"><a href="#cb318-2085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2086"><a href="#cb318-2086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb318-2087"><a href="#cb318-2087" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2088"><a href="#cb318-2088" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2089"><a href="#cb318-2089" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2090"><a href="#cb318-2090" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2091"><a href="#cb318-2091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2092"><a href="#cb318-2092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb318-2093"><a href="#cb318-2093" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb318-2094"><a href="#cb318-2094" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb318-2095"><a href="#cb318-2095" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb318-2096"><a href="#cb318-2096" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb318-2097"><a href="#cb318-2097" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb318-2098"><a href="#cb318-2098" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb318-2099"><a href="#cb318-2099" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb318-2100"><a href="#cb318-2100" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb318-2101"><a href="#cb318-2101" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span>
<span id="cb318-2102"><a href="#cb318-2102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2103"><a href="#cb318-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2104"><a href="#cb318-2104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot combined results</span></span>
<span id="cb318-2105"><a href="#cb318-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2108"><a href="#cb318-2108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2109"><a href="#cb318-2109" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2110"><a href="#cb318-2110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2111"><a href="#cb318-2111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb318-2112"><a href="#cb318-2112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb318-2113"><a href="#cb318-2113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb318-2114"><a href="#cb318-2114" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-2115"><a href="#cb318-2115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb318-2116"><a href="#cb318-2116" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-2117"><a href="#cb318-2117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-2118"><a href="#cb318-2118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb318-2119"><a href="#cb318-2119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-2120"><a href="#cb318-2120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-2121"><a href="#cb318-2121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2122"><a href="#cb318-2122" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-2123"><a href="#cb318-2123" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-2124"><a href="#cb318-2124" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb318-2125"><a href="#cb318-2125" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-2126"><a href="#cb318-2126" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-2127"><a href="#cb318-2127" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-2128"><a href="#cb318-2128" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-2129"><a href="#cb318-2129" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2130"><a href="#cb318-2130" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-2131"><a href="#cb318-2131" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-2132"><a href="#cb318-2132" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb318-2133"><a href="#cb318-2133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-2134"><a href="#cb318-2134" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-2135"><a href="#cb318-2135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb318-2136"><a href="#cb318-2136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2137"><a href="#cb318-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2138"><a href="#cb318-2138" aria-hidden="true" tabindex="-1"></a>Add Gorda Ridge comparison to supplementary?</span>
<span id="cb318-2139"><a href="#cb318-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2142"><a href="#cb318-2142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2143"><a href="#cb318-2143" aria-hidden="true" tabindex="-1"></a>allrates</span>
<span id="cb318-2144"><a href="#cb318-2144" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb318-2145"><a href="#cb318-2145" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span>
<span id="cb318-2146"><a href="#cb318-2146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2147"><a href="#cb318-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2148"><a href="#cb318-2148" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove undetected grazing rate</span></span>
<span id="cb318-2149"><a href="#cb318-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2150"><a href="#cb318-2150" aria-hidden="true" tabindex="-1"></a>Repeat grazing rate plot, but removed undetectable</span>
<span id="cb318-2151"><a href="#cb318-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2154"><a href="#cb318-2154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2155"><a href="#cb318-2155" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb318-2156"><a href="#cb318-2156" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2157"><a href="#cb318-2157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2158"><a href="#cb318-2158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2159"><a href="#cb318-2159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb318-2160"><a href="#cb318-2160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb318-2161"><a href="#cb318-2161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb318-2162"><a href="#cb318-2162" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-2163"><a href="#cb318-2163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb318-2164"><a href="#cb318-2164" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb318-2165"><a href="#cb318-2165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-2166"><a href="#cb318-2166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb318-2167"><a href="#cb318-2167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb318-2168"><a href="#cb318-2168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-2169"><a href="#cb318-2169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2170"><a href="#cb318-2170" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb318-2171"><a href="#cb318-2171" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb318-2172"><a href="#cb318-2172" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb318-2173"><a href="#cb318-2173" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb318-2174"><a href="#cb318-2174" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-2175"><a href="#cb318-2175" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-2176"><a href="#cb318-2176" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb318-2177"><a href="#cb318-2177" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2178"><a href="#cb318-2178" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-2179"><a href="#cb318-2179" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb318-2180"><a href="#cb318-2180" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb318-2181"><a href="#cb318-2181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb318-2182"><a href="#cb318-2182" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb318-2183"><a href="#cb318-2183" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb318-2184"><a href="#cb318-2184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2185"><a href="#cb318-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2186"><a href="#cb318-2186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=7}</span></span>
<span id="cb318-2187"><a href="#cb318-2187" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb318-2188"><a href="#cb318-2188" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb318-2189"><a href="#cb318-2189" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb318-2190"><a href="#cb318-2190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2191"><a href="#cb318-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2192"><a href="#cb318-2192" aria-hidden="true" tabindex="-1"></a>Panel plot, cells per ml and grazing rate</span>
<span id="cb318-2193"><a href="#cb318-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2194"><a href="#cb318-2194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Plot cell conc and rates, fig.width=6, fig.height=10}</span></span>
<span id="cb318-2195"><a href="#cb318-2195" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("plot-gcellconc-grazing-log.svg", h = 10, w = 6)</span></span>
<span id="cb318-2196"><a href="#cb318-2196" aria-hidden="true" tabindex="-1"></a><span class="co"># grazing_rate + scale_y_log10(limits = c(1e-1,1e5), breaks=10^(0:7))</span></span>
<span id="cb318-2197"><a href="#cb318-2197" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>),</span>
<span id="cb318-2198"><a href="#cb318-2198" aria-hidden="true" tabindex="-1"></a>          <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>),</span>
<span id="cb318-2199"><a href="#cb318-2199" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>(), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb318-2200"><a href="#cb318-2200" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb318-2201"><a href="#cb318-2201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2202"><a href="#cb318-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2203"><a href="#cb318-2203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=7, fig.height=7}</span></span>
<span id="cb318-2204"><a href="#cb318-2204" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("cells-per-ml.svg", h = 7, w = 7)</span></span>
<span id="cb318-2205"><a href="#cb318-2205" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"EUK_ml"</span>, <span class="st">"EUK_sem"</span>) <span class="sc">+</span> <span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"PROK_ml"</span>, <span class="st">"PROK_sem"</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) </span>
<span id="cb318-2206"><a href="#cb318-2206" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb318-2207"><a href="#cb318-2207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2208"><a href="#cb318-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2209"><a href="#cb318-2209" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear regression &amp; tidy models</span></span>
<span id="cb318-2210"><a href="#cb318-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2211"><a href="#cb318-2211" aria-hidden="true" tabindex="-1"></a>TO DO: find a tidy model tutorial to work with.</span>
<span id="cb318-2212"><a href="#cb318-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2213"><a href="#cb318-2213" aria-hidden="true" tabindex="-1"></a>Use tidymodels to perform linear regression. </span>
<span id="cb318-2214"><a href="#cb318-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2215"><a href="#cb318-2215" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR and GR data as input</span></span>
<span id="cb318-2216"><a href="#cb318-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2219"><a href="#cb318-2219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2220"><a href="#cb318-2220" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb318-2221"><a href="#cb318-2221" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb318-2222"><a href="#cb318-2222" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb318-2223"><a href="#cb318-2223" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb318-2224"><a href="#cb318-2224" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span></span>
<span id="cb318-2225"><a href="#cb318-2225" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;%</span></span>
<span id="cb318-2226"><a href="#cb318-2226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span></span>
<span id="cb318-2227"><a href="#cb318-2227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span></span>
<span id="cb318-2228"><a href="#cb318-2228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb318-2229"><a href="#cb318-2229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-2230"><a href="#cb318-2230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-2231"><a href="#cb318-2231" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2232"><a href="#cb318-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2233"><a href="#cb318-2233" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb318-2234"><a href="#cb318-2234" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb318-2235"><a href="#cb318-2235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb318-2236"><a href="#cb318-2236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb318-2237"><a href="#cb318-2237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb318-2238"><a href="#cb318-2238" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb318-2239"><a href="#cb318-2239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb318-2240"><a href="#cb318-2240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS,</span>
<span id="cb318-2241"><a href="#cb318-2241" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb318-2242"><a href="#cb318-2242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb318-2243"><a href="#cb318-2243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb318-2244"><a href="#cb318-2244" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2245"><a href="#cb318-2245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2246"><a href="#cb318-2246" aria-hidden="true" tabindex="-1"></a>regression_results <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span></span>
<span id="cb318-2247"><a href="#cb318-2247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb318-2248"><a href="#cb318-2248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb318-2249"><a href="#cb318-2249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb318-2250"><a href="#cb318-2250" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span></span>
<span id="cb318-2251"><a href="#cb318-2251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span></span>
<span id="cb318-2252"><a href="#cb318-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb318-2253"><a href="#cb318-2253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb318-2254"><a href="#cb318-2254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb318-2255"><a href="#cb318-2255" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2256"><a href="#cb318-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2257"><a href="#cb318-2257" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span>
<span id="cb318-2258"><a href="#cb318-2258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2259"><a href="#cb318-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2260"><a href="#cb318-2260" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb318-2261"><a href="#cb318-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2262"><a href="#cb318-2262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb318-2263"><a href="#cb318-2263" aria-hidden="true" tabindex="-1"></a>regression_results <span class="sc">%&gt;%</span></span>
<span id="cb318-2264"><a href="#cb318-2264" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb318-2265"><a href="#cb318-2265" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;%</span></span>
<span id="cb318-2266"><a href="#cb318-2266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2267"><a href="#cb318-2267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb318-2268"><a href="#cb318-2268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2269"><a href="#cb318-2269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-2270"><a href="#cb318-2270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb318-2271"><a href="#cb318-2271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb318-2272"><a href="#cb318-2272" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb318-2273"><a href="#cb318-2273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-2274"><a href="#cb318-2274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb318-2275"><a href="#cb318-2275" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2276"><a href="#cb318-2276" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-2277"><a href="#cb318-2277" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-2278"><a href="#cb318-2278" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-2279"><a href="#cb318-2279" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb318-2280"><a href="#cb318-2280" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Temperature (C)"</span>)</span>
<span id="cb318-2281"><a href="#cb318-2281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2282"><a href="#cb318-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2283"><a href="#cb318-2283" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR only</span></span>
<span id="cb318-2284"><a href="#cb318-2284" aria-hidden="true" tabindex="-1"></a>repeat MCR only</span>
<span id="cb318-2285"><a href="#cb318-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2288"><a href="#cb318-2288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2289"><a href="#cb318-2289" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb318-2290"><a href="#cb318-2290" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb318-2291"><a href="#cb318-2291" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb318-2292"><a href="#cb318-2292" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2293"><a href="#cb318-2293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2294"><a href="#cb318-2294" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb318-2295"><a href="#cb318-2295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2296"><a href="#cb318-2296" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2297"><a href="#cb318-2297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2298"><a href="#cb318-2298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2299"><a href="#cb318-2299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2300"><a href="#cb318-2300" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2301"><a href="#cb318-2301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2302"><a href="#cb318-2302" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb318-2303"><a href="#cb318-2303" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb318-2304"><a href="#cb318-2304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2305"><a href="#cb318-2305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2306"><a href="#cb318-2306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb318-2307"><a href="#cb318-2307" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2308"><a href="#cb318-2308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2309"><a href="#cb318-2309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb318-2310"><a href="#cb318-2310" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2311"><a href="#cb318-2311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2312"><a href="#cb318-2312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb318-2313"><a href="#cb318-2313" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2314"><a href="#cb318-2314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2315"><a href="#cb318-2315" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb318-2316"><a href="#cb318-2316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2317"><a href="#cb318-2317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2318"><a href="#cb318-2318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb318-2319"><a href="#cb318-2319" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2320"><a href="#cb318-2320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2321"><a href="#cb318-2321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2322"><a href="#cb318-2322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb318-2323"><a href="#cb318-2323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb318-2324"><a href="#cb318-2324" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2325"><a href="#cb318-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2326"><a href="#cb318-2326" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_mcr)</span></span>
<span id="cb318-2327"><a href="#cb318-2327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2328"><a href="#cb318-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2329"><a href="#cb318-2329" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb318-2330"><a href="#cb318-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2331"><a href="#cb318-2331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb318-2332"><a href="#cb318-2332" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="sc">%&gt;%</span> </span>
<span id="cb318-2333"><a href="#cb318-2333" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb318-2334"><a href="#cb318-2334" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb318-2335"><a href="#cb318-2335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2336"><a href="#cb318-2336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb318-2337"><a href="#cb318-2337" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2338"><a href="#cb318-2338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-2339"><a href="#cb318-2339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb318-2340"><a href="#cb318-2340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb318-2341"><a href="#cb318-2341" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb318-2342"><a href="#cb318-2342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-2343"><a href="#cb318-2343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb318-2344"><a href="#cb318-2344" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2345"><a href="#cb318-2345" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-2346"><a href="#cb318-2346" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-2347"><a href="#cb318-2347" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-2348"><a href="#cb318-2348" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb318-2349"><a href="#cb318-2349" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb318-2350"><a href="#cb318-2350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2351"><a href="#cb318-2351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2352"><a href="#cb318-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2353"><a href="#cb318-2353" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR vent sites only</span></span>
<span id="cb318-2354"><a href="#cb318-2354" aria-hidden="true" tabindex="-1"></a>Repeat with only vent sites &amp; remove undetected grazing.</span>
<span id="cb318-2355"><a href="#cb318-2355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2358"><a href="#cb318-2358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2359"><a href="#cb318-2359" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb318-2360"><a href="#cb318-2360" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb318-2361"><a href="#cb318-2361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2362"><a href="#cb318-2362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2363"><a href="#cb318-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2366"><a href="#cb318-2366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2367"><a href="#cb318-2367" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb318-2368"><a href="#cb318-2368" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb318-2369"><a href="#cb318-2369" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb318-2370"><a href="#cb318-2370" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2371"><a href="#cb318-2371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2372"><a href="#cb318-2372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Background"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Plume"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2373"><a href="#cb318-2373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2374"><a href="#cb318-2374" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb318-2375"><a href="#cb318-2375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2376"><a href="#cb318-2376" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2377"><a href="#cb318-2377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2378"><a href="#cb318-2378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2379"><a href="#cb318-2379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2380"><a href="#cb318-2380" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2381"><a href="#cb318-2381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2382"><a href="#cb318-2382" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb318-2383"><a href="#cb318-2383" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb318-2384"><a href="#cb318-2384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2385"><a href="#cb318-2385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2386"><a href="#cb318-2386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb318-2387"><a href="#cb318-2387" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2388"><a href="#cb318-2388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2389"><a href="#cb318-2389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb318-2390"><a href="#cb318-2390" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2391"><a href="#cb318-2391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2392"><a href="#cb318-2392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb318-2393"><a href="#cb318-2393" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2394"><a href="#cb318-2394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2395"><a href="#cb318-2395" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb318-2396"><a href="#cb318-2396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2397"><a href="#cb318-2397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2398"><a href="#cb318-2398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb318-2399"><a href="#cb318-2399" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2400"><a href="#cb318-2400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2401"><a href="#cb318-2401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2402"><a href="#cb318-2402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb318-2403"><a href="#cb318-2403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb318-2404"><a href="#cb318-2404" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb318-2405"><a href="#cb318-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2406"><a href="#cb318-2406" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_vent)</span></span>
<span id="cb318-2407"><a href="#cb318-2407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2408"><a href="#cb318-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2409"><a href="#cb318-2409" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb318-2410"><a href="#cb318-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2411"><a href="#cb318-2411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb318-2412"><a href="#cb318-2412" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="sc">%&gt;%</span> </span>
<span id="cb318-2413"><a href="#cb318-2413" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb318-2414"><a href="#cb318-2414" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb318-2415"><a href="#cb318-2415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2416"><a href="#cb318-2416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb318-2417"><a href="#cb318-2417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2418"><a href="#cb318-2418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb318-2419"><a href="#cb318-2419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb318-2420"><a href="#cb318-2420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb318-2421"><a href="#cb318-2421" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb318-2422"><a href="#cb318-2422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb318-2423"><a href="#cb318-2423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb318-2424"><a href="#cb318-2424" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-2425"><a href="#cb318-2425" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb318-2426"><a href="#cb318-2426" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-2427"><a href="#cb318-2427" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb318-2428"><a href="#cb318-2428" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb318-2429"><a href="#cb318-2429" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb318-2430"><a href="#cb318-2430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2431"><a href="#cb318-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2432"><a href="#cb318-2432" aria-hidden="true" tabindex="-1"></a>*Regression thoughts*: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</span>
<span id="cb318-2433"><a href="#cb318-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2434"><a href="#cb318-2434" aria-hidden="true" tabindex="-1"></a>Bacterial abundance typically increases with temperature (White et al. 1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</span>
<span id="cb318-2435"><a href="#cb318-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2436"><a href="#cb318-2436" aria-hidden="true" tabindex="-1"></a>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature... in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</span>
<span id="cb318-2437"><a href="#cb318-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2440"><a href="#cb318-2440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2441"><a href="#cb318-2441" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb318-2442"><a href="#cb318-2442" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2443"><a href="#cb318-2443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb318-2444"><a href="#cb318-2444" aria-hidden="true" tabindex="-1"></a><span class="co"># head(allvent_data)</span></span>
<span id="cb318-2445"><a href="#cb318-2445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2446"><a href="#cb318-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2447"><a href="#cb318-2447" aria-hidden="true" tabindex="-1"></a>Function to plot results by two parameters.</span>
<span id="cb318-2448"><a href="#cb318-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2451"><a href="#cb318-2451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2452"><a href="#cb318-2452" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb318-2453"><a href="#cb318-2453" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb318-2454"><a href="#cb318-2454" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb318-2455"><a href="#cb318-2455" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb318-2456"><a href="#cb318-2456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2457"><a href="#cb318-2457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb318-2458"><a href="#cb318-2458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb318-2459"><a href="#cb318-2459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb318-2460"><a href="#cb318-2460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2461"><a href="#cb318-2461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb318-2462"><a href="#cb318-2462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb318-2463"><a href="#cb318-2463" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb318-2464"><a href="#cb318-2464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2465"><a href="#cb318-2465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2466"><a href="#cb318-2466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2467"><a href="#cb318-2467" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by euk:prok and then euk and prok</span></span>
<span id="cb318-2468"><a href="#cb318-2468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2471"><a href="#cb318-2471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2472"><a href="#cb318-2472" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span>
<span id="cb318-2473"><a href="#cb318-2473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2474"><a href="#cb318-2474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2475"><a href="#cb318-2475" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by grazing rate</span></span>
<span id="cb318-2476"><a href="#cb318-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2479"><a href="#cb318-2479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2480"><a href="#cb318-2480" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span>
<span id="cb318-2481"><a href="#cb318-2481" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb318-2482"><a href="#cb318-2482" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, EUK_ml, "ugC_L_perday", "Euk cells per ml") + scale_y_log10()</span></span>
<span id="cb318-2483"><a href="#cb318-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2484"><a href="#cb318-2484" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span>
<span id="cb318-2485"><a href="#cb318-2485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2486"><a href="#cb318-2486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2487"><a href="#cb318-2487" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass investigation</span></span>
<span id="cb318-2488"><a href="#cb318-2488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2491"><a href="#cb318-2491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2492"><a href="#cb318-2492" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb318-2493"><a href="#cb318-2493" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span>
<span id="cb318-2494"><a href="#cb318-2494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2495"><a href="#cb318-2495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2496"><a href="#cb318-2496" aria-hidden="true" tabindex="-1"></a>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</span>
<span id="cb318-2497"><a href="#cb318-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2500"><a href="#cb318-2500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2501"><a href="#cb318-2501" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb318-2502"><a href="#cb318-2502" aria-hidden="true" tabindex="-1"></a><span class="co"># carbon_density &lt;- crossing(fgC_cell = seq(86, 300, by = 1), </span></span>
<span id="cb318-2503"><a href="#cb318-2503" aria-hidden="true" tabindex="-1"></a><span class="co">#                              GRAZING_EFFECT_hr = seq(min(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb318-2504"><a href="#cb318-2504" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   max(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb318-2505"><a href="#cb318-2505" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   length.out = 215))  %&gt;%</span></span>
<span id="cb318-2506"><a href="#cb318-2506" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb318-2507"><a href="#cb318-2507" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb318-2508"><a href="#cb318-2508" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;%</span></span>
<span id="cb318-2509"><a href="#cb318-2509" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb318-2510"><a href="#cb318-2510" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-2511"><a href="#cb318-2511" aria-hidden="true" tabindex="-1"></a><span class="co"># # unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb318-2512"><a href="#cb318-2512" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-2513"><a href="#cb318-2513" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_lines &lt;- select(all_vents, GRAZING_EFFECT_hr, FIELD) %&gt;% </span></span>
<span id="cb318-2514"><a href="#cb318-2514" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;% </span></span>
<span id="cb318-2515"><a href="#cb318-2515" aria-hidden="true" tabindex="-1"></a><span class="co">#   crossing(fgC_cell = seq(86, 300, by = 20)) %&gt;%</span></span>
<span id="cb318-2516"><a href="#cb318-2516" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb318-2517"><a href="#cb318-2517" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb318-2518"><a href="#cb318-2518" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb318-2519"><a href="#cb318-2519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2520"><a href="#cb318-2520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2523"><a href="#cb318-2523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2524"><a href="#cb318-2524" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(carbon_density, aes(x = fgC_cell, y = GRAZING_EFFECT_hr)) +</span></span>
<span id="cb318-2525"><a href="#cb318-2525" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_raster(aes(fill = ugC_L_perday)) +</span></span>
<span id="cb318-2526"><a href="#cb318-2526" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_gradientn(colors = c("#fef0d9", "#b30000"), name = bquote("ug C"~L^-1 ~day^-1)) +</span></span>
<span id="cb318-2527"><a href="#cb318-2527" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb318-2528"><a href="#cb318-2528" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(expand = c(0,0)) +</span></span>
<span id="cb318-2529"><a href="#cb318-2529" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(expand = c(0,0)) +</span></span>
<span id="cb318-2530"><a href="#cb318-2530" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb318-2531"><a href="#cb318-2531" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black"),</span></span>
<span id="cb318-2532"><a href="#cb318-2532" aria-hidden="true" tabindex="-1"></a><span class="co">#         rect = element_rect(fill = "transparent"),</span></span>
<span id="cb318-2533"><a href="#cb318-2533" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb318-2534"><a href="#cb318-2534" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill = "transparent", color = NA)) +</span></span>
<span id="cb318-2535"><a href="#cb318-2535" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = bquote("Cells "~mL^-1 ~consumed ~hr^-1), x = bquote("fg C"~cell^-1)) +</span></span>
<span id="cb318-2536"><a href="#cb318-2536" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = samples_lines,</span></span>
<span id="cb318-2537"><a href="#cb318-2537" aria-hidden="true" tabindex="-1"></a><span class="co">#             aes(x = 87,</span></span>
<span id="cb318-2538"><a href="#cb318-2538" aria-hidden="true" tabindex="-1"></a><span class="co">#             y = GRAZING_EFFECT_hr, shape = FIELD), size = 1)</span></span>
<span id="cb318-2539"><a href="#cb318-2539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2540"><a href="#cb318-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2541"><a href="#cb318-2541" aria-hidden="true" tabindex="-1"></a>Eukaryote biomass comparison with measured vs. literature</span>
<span id="cb318-2542"><a href="#cb318-2542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2545"><a href="#cb318-2545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2546"><a href="#cb318-2546" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb318-2547"><a href="#cb318-2547" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata &lt;- env_params %&gt;% </span></span>
<span id="cb318-2548"><a href="#cb318-2548" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(SAMPLETYPE != "Incubation") %&gt;%</span></span>
<span id="cb318-2549"><a href="#cb318-2549" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(VENT != "Quakeplume") %&gt;% </span></span>
<span id="cb318-2550"><a href="#cb318-2550" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, starts_with("PROK_"), starts_with("EUK_"), starts_with("GRAZING_EFFECT_hr"))</span></span>
<span id="cb318-2551"><a href="#cb318-2551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2552"><a href="#cb318-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2553"><a href="#cb318-2553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=5}</span></span>
<span id="cb318-2554"><a href="#cb318-2554" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb318-2555"><a href="#cb318-2555" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata %&gt;% </span></span>
<span id="cb318-2556"><a href="#cb318-2556" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Euk_biomass_Hu)) %&gt;% </span></span>
<span id="cb318-2557"><a href="#cb318-2557" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Euk_biomass_Hu_fg = Euk_biomass_Hu * 1000000000,</span></span>
<span id="cb318-2558"><a href="#cb318-2558" aria-hidden="true" tabindex="-1"></a><span class="co">#          Euk_biomass_lit_fg = Euk_biomass_lit * 1000000000) %&gt;% </span></span>
<span id="cb318-2559"><a href="#cb318-2559" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = VENT)) +</span></span>
<span id="cb318-2560"><a href="#cb318-2560" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_Hu_fg), color = "black", fill = "darkgreen", shape = 21, size = 4) +</span></span>
<span id="cb318-2561"><a href="#cb318-2561" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_lit), color = "black", fill = "lightgreen", shape = 21, size = 4) +</span></span>
<span id="cb318-2562"><a href="#cb318-2562" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb318-2563"><a href="#cb318-2563" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb318-2564"><a href="#cb318-2564" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black")) +</span></span>
<span id="cb318-2565"><a href="#cb318-2565" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(SAMPLETYPE ~ ., space = "free", scales = "free") +</span></span>
<span id="cb318-2566"><a href="#cb318-2566" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "fg C of eukaryote population", y = "")</span></span>
<span id="cb318-2567"><a href="#cb318-2567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2568"><a href="#cb318-2568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2569"><a href="#cb318-2569" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction of MCR data with parameters</span></span>
<span id="cb318-2570"><a href="#cb318-2570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2571"><a href="#cb318-2571" aria-hidden="true" tabindex="-1"></a>Best model to estimate community grazing rate in Vaque et al. considered FLP uptake and similar experiments (in contrast to disappearance experiments).</span>
<span id="cb318-2572"><a href="#cb318-2572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2573"><a href="#cb318-2573" aria-hidden="true" tabindex="-1"></a>From Vaque et al. 1994 paper equation (1):</span>
<span id="cb318-2574"><a href="#cb318-2574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2575"><a href="#cb318-2575" aria-hidden="true" tabindex="-1"></a>See Figure 6</span>
<span id="cb318-2576"><a href="#cb318-2576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2577"><a href="#cb318-2577" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</span></span>
<span id="cb318-2578"><a href="#cb318-2578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2579"><a href="#cb318-2579" aria-hidden="true" tabindex="-1"></a>*GT* = grazing rate (cells ml-1 hr-1) *HNF* = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) *BAC* = prokaryote abundance (cells ml-1)</span>
<span id="cb318-2580"><a href="#cb318-2580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2581"><a href="#cb318-2581" aria-hidden="true" tabindex="-1"></a>Start with non-zero grazing rate values, etc. Where... *GT* == Grazing effect hr *HNF* == Euk_ml *BAC* == PROK_ml *T* == highest temp</span>
<span id="cb318-2582"><a href="#cb318-2582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2583"><a href="#cb318-2583" aria-hidden="true" tabindex="-1"></a>We only have these for MCR data.. can include GR for the "predicting euk_ml"</span>
<span id="cb318-2584"><a href="#cb318-2584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2585"><a href="#cb318-2585" aria-hidden="true" tabindex="-1"></a>Function to use above formula and estimate</span>
<span id="cb318-2586"><a href="#cb318-2586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2589"><a href="#cb318-2589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2590"><a href="#cb318-2590" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb318-2591"><a href="#cb318-2591" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb318-2592"><a href="#cb318-2592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2593"><a href="#cb318-2593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2594"><a href="#cb318-2594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2595"><a href="#cb318-2595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb318-2596"><a href="#cb318-2596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb318-2597"><a href="#cb318-2597" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb318-2598"><a href="#cb318-2598" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb318-2599"><a href="#cb318-2599" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb318-2600"><a href="#cb318-2600" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb318-2601"><a href="#cb318-2601" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2602"><a href="#cb318-2602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb318-2603"><a href="#cb318-2603" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2604"><a href="#cb318-2604" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2605"><a href="#cb318-2605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb318-2606"><a href="#cb318-2606" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2607"><a href="#cb318-2607" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2608"><a href="#cb318-2608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb318-2609"><a href="#cb318-2609" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2610"><a href="#cb318-2610" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2611"><a href="#cb318-2611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb318-2612"><a href="#cb318-2612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2613"><a href="#cb318-2613" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2614"><a href="#cb318-2614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb318-2615"><a href="#cb318-2615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2616"><a href="#cb318-2616" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2617"><a href="#cb318-2617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb318-2618"><a href="#cb318-2618" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2619"><a href="#cb318-2619" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2620"><a href="#cb318-2620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb318-2621"><a href="#cb318-2621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2622"><a href="#cb318-2622" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb318-2623"><a href="#cb318-2623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb318-2624"><a href="#cb318-2624" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb318-2625"><a href="#cb318-2625" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb318-2626"><a href="#cb318-2626" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb318-2627"><a href="#cb318-2627" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb318-2628"><a href="#cb318-2628" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb318-2629"><a href="#cb318-2629" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb318-2630"><a href="#cb318-2630" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span>
<span id="cb318-2631"><a href="#cb318-2631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2632"><a href="#cb318-2632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2633"><a href="#cb318-2633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2634"><a href="#cb318-2634" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span>
<span id="cb318-2635"><a href="#cb318-2635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2636"><a href="#cb318-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2637"><a href="#cb318-2637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2638"><a href="#cb318-2638" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb318-2639"><a href="#cb318-2639" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb318-2640"><a href="#cb318-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2641"><a href="#cb318-2641" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb318-2642"><a href="#cb318-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2643"><a href="#cb318-2643" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Mid-Cayman Rise only, no undetected"</span>)</span>
<span id="cb318-2644"><a href="#cb318-2644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2645"><a href="#cb318-2645" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0) %&gt;% filter(!(NAME %in% bsw)), "Mid-Cayman Rise only, no undetected, vents only")</span></span>
<span id="cb318-2646"><a href="#cb318-2646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2647"><a href="#cb318-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2648"><a href="#cb318-2648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2649"><a href="#cb318-2649" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"All samples where grazing was detected"</span>)</span>
<span id="cb318-2650"><a href="#cb318-2650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2651"><a href="#cb318-2651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2652"><a href="#cb318-2652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2653"><a href="#cb318-2653" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb318-2654"><a href="#cb318-2654" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb318-2655"><a href="#cb318-2655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2656"><a href="#cb318-2656" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span>
<span id="cb318-2657"><a href="#cb318-2657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2658"><a href="#cb318-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2659"><a href="#cb318-2659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2660"><a href="#cb318-2660" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb318-2661"><a href="#cb318-2661" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2662"><a href="#cb318-2662" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2663"><a href="#cb318-2663" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2664"><a href="#cb318-2664" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb318-2665"><a href="#cb318-2665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2666"><a href="#cb318-2666" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2667"><a href="#cb318-2667" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2668"><a href="#cb318-2668" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb318-2669"><a href="#cb318-2669" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb318-2670"><a href="#cb318-2670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2671"><a href="#cb318-2671" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb318-2672"><a href="#cb318-2672" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb318-2673"><a href="#cb318-2673" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb318-2674"><a href="#cb318-2674" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb318-2675"><a href="#cb318-2675" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span>
<span id="cb318-2676"><a href="#cb318-2676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2677"><a href="#cb318-2677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2680"><a href="#cb318-2680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2681"><a href="#cb318-2681" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span>
<span id="cb318-2682"><a href="#cb318-2682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2683"><a href="#cb318-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2684"><a href="#cb318-2684" aria-hidden="true" tabindex="-1"></a>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</span>
<span id="cb318-2685"><a href="#cb318-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2686"><a href="#cb318-2686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2687"><a href="#cb318-2687" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2688"><a href="#cb318-2688" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb318-2689"><a href="#cb318-2689" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span>
<span id="cb318-2690"><a href="#cb318-2690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2691"><a href="#cb318-2691" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2692"><a href="#cb318-2692" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb318-2693"><a href="#cb318-2693" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span>
<span id="cb318-2694"><a href="#cb318-2694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2695"><a href="#cb318-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2696"><a href="#cb318-2696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb318-2697"><a href="#cb318-2697" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2698"><a href="#cb318-2698" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-2699"><a href="#cb318-2699" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span>
<span id="cb318-2700"><a href="#cb318-2700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2701"><a href="#cb318-2701" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb318-2702"><a href="#cb318-2702" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-2703"><a href="#cb318-2703" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span>
<span id="cb318-2704"><a href="#cb318-2704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2705"><a href="#cb318-2705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2706"><a href="#cb318-2706" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session</span></span>
<span id="cb318-2707"><a href="#cb318-2707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2710"><a href="#cb318-2710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2711"><a href="#cb318-2711" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_ids &lt;- c("BSW","Plume", "Shrimpocalypse", "LotsOShrimp", "X18", "OMT", "Rav2", "MustardStand", "ShrimpHole")</span></span>
<span id="cb318-2712"><a href="#cb318-2712" aria-hidden="true" tabindex="-1"></a><span class="co"># vent_fullname &lt;- c("Background","Plume", "Shrimpocalypse", "Lots 'O Shrimp", "X-18", "Old Man Tree", "Ravelin #2", "Mustard Stand", "Shrimp Hole")</span></span>
<span id="cb318-2713"><a href="#cb318-2713" aria-hidden="true" tabindex="-1"></a><span class="co"># site_ids &lt;- c("VD", "Piccard")</span></span>
<span id="cb318-2714"><a href="#cb318-2714" aria-hidden="true" tabindex="-1"></a><span class="co"># site_fullname &lt;- c("Von Damm", "Piccard")</span></span>
<span id="cb318-2715"><a href="#cb318-2715" aria-hidden="true" tabindex="-1"></a><span class="co"># site_color &lt;- c("#264653", "#E76F51")</span></span>
<span id="cb318-2716"><a href="#cb318-2716" aria-hidden="true" tabindex="-1"></a><span class="co"># names(site_color) &lt;- site_fullname</span></span>
<span id="cb318-2717"><a href="#cb318-2717" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-2718"><a href="#cb318-2718" aria-hidden="true" tabindex="-1"></a><span class="co"># whole_pal &lt;- c("#264653", "#2A9D8F", "#E9C46A","#F4A261", "#E76F51")</span></span>
<span id="cb318-2719"><a href="#cb318-2719" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb318-2720"><a href="#cb318-2720" aria-hidden="true" tabindex="-1"></a><span class="co"># extra &lt;- c("#eae2b7", "#5f0f40", "#90be6d", "#941b0c", "#577590")</span></span>
<span id="cb318-2721"><a href="#cb318-2721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2722"><a href="#cb318-2722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2723"><a href="#cb318-2723" aria-hidden="true" tabindex="-1"></a>ggplot theme</span>
<span id="cb318-2726"><a href="#cb318-2726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2727"><a href="#cb318-2727" aria-hidden="true" tabindex="-1"></a><span class="co"># theme_minimal() +</span></span>
<span id="cb318-2728"><a href="#cb318-2728" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(panel.grid.major = element_line(), panel.grid.minor = element_blank(),</span></span>
<span id="cb318-2729"><a href="#cb318-2729" aria-hidden="true" tabindex="-1"></a><span class="co">#            panel.background = element_blank(), </span></span>
<span id="cb318-2730"><a href="#cb318-2730" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.line = element_line(colour = "black"), </span></span>
<span id="cb318-2731"><a href="#cb318-2731" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.text.x = element_text(color="black", size = 12, </span></span>
<span id="cb318-2732"><a href="#cb318-2732" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       angle = 45, hjust = 1, vjust = 1), </span></span>
<span id="cb318-2733"><a href="#cb318-2733" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.text.y = element_text(color="black", size = 12),</span></span>
<span id="cb318-2734"><a href="#cb318-2734" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.title =element_text(color="black", size = 12),</span></span>
<span id="cb318-2735"><a href="#cb318-2735" aria-hidden="true" tabindex="-1"></a><span class="co">#            axis.ticks = element_line(),</span></span>
<span id="cb318-2736"><a href="#cb318-2736" aria-hidden="true" tabindex="-1"></a><span class="co">#            strip.text =element_blank(), legend.title = element_blank()) +</span></span>
<span id="cb318-2737"><a href="#cb318-2737" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = bquote("Eukaryote cells "~mL^-1),</span></span>
<span id="cb318-2738"><a href="#cb318-2738" aria-hidden="true" tabindex="-1"></a><span class="co">#        title = "")</span></span>
<span id="cb318-2739"><a href="#cb318-2739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb318-2740"><a href="#cb318-2740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2741"><a href="#cb318-2741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2742"><a href="#cb318-2742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-2745"><a href="#cb318-2745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb318-2746"><a href="#cb318-2746" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb318-2747"><a href="#cb318-2747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>