<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mid-Cayman Rise analysis - Protistan grazing analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Mid-Cayman Rise analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./results.html" rel="" target="">
 <span class="menu-text">Summary of results</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./grazing.html" rel="" target="" aria-current="page">
 <span class="menu-text">Grazing analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./asv-analysis.html" rel="" target="">
 <span class="menu-text">Sequence analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sequence-qc.html" rel="" target="">
 <span class="menu-text">Sequence QC &amp; import</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-format-data" id="toc-import-format-data" class="nav-link active" data-scroll-target="#import-format-data"><span class="header-section-number">1</span> Import &amp; format data</a>
  <ul class="collapse">
  <li><a href="#set-up-working-r-environment" id="toc-set-up-working-r-environment" class="nav-link" data-scroll-target="#set-up-working-r-environment"><span class="header-section-number">1.1</span> Set up working R environment</a></li>
  <li><a href="#import-raw-count-data" id="toc-import-raw-count-data" class="nav-link" data-scroll-target="#import-raw-count-data"><span class="header-section-number">1.2</span> Import raw count data</a>
  <ul class="collapse">
  <li><a href="#parse-raw-microscopy-count-data" id="toc-parse-raw-microscopy-count-data" class="nav-link" data-scroll-target="#parse-raw-microscopy-count-data">Parse raw microscopy count data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#calculate-cells-per-ml-euk" id="toc-calculate-cells-per-ml-euk" class="nav-link" data-scroll-target="#calculate-cells-per-ml-euk"><span class="header-section-number">2</span> Calculate cells per ml (euk)</a>
  <ul class="collapse">
  <li><a href="#plot-eukaryote-cell-abundance-for-all-time-points" id="toc-plot-eukaryote-cell-abundance-for-all-time-points" class="nav-link" data-scroll-target="#plot-eukaryote-cell-abundance-for-all-time-points"><span class="header-section-number">2.1</span> Plot eukaryote cell abundance for all time points</a>
  <ul class="collapse">
  <li><a href="#figure-s2" id="toc-figure-s2" class="nav-link" data-scroll-target="#figure-s2">Figure S2</a></li>
  </ul></li>
  <li><a href="#plot-eukaryote-cell-concentration-over-time." id="toc-plot-eukaryote-cell-concentration-over-time." class="nav-link" data-scroll-target="#plot-eukaryote-cell-concentration-over-time."><span class="header-section-number">2.2</span> Plot eukaryote cell concentration over time.</a></li>
  <li><a href="#plot-t0-only-counts-for-cellsml-plot" id="toc-plot-t0-only-counts-for-cellsml-plot" class="nav-link" data-scroll-target="#plot-t0-only-counts-for-cellsml-plot"><span class="header-section-number">2.3</span> Plot T0 only counts for cells/ml plot</a>
  <ul class="collapse">
  <li><a href="#boxplot-eukaryote-cell-abundance" id="toc-boxplot-eukaryote-cell-abundance" class="nav-link" data-scroll-target="#boxplot-eukaryote-cell-abundance">Boxplot eukaryote cell abundance</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bacteria-archaea-cell-counts" id="toc-bacteria-archaea-cell-counts" class="nav-link" data-scroll-target="#bacteria-archaea-cell-counts"><span class="header-section-number">3</span> Bacteria &amp; archaea cell counts</a>
  <ul class="collapse">
  <li><a href="#cells-per-ml-prok" id="toc-cells-per-ml-prok" class="nav-link" data-scroll-target="#cells-per-ml-prok"><span class="header-section-number">3.1</span> Cells per ml (prok)</a>
  <ul class="collapse">
  <li><a href="#compare-euk-and-prok-cell-abundance" id="toc-compare-euk-and-prok-cell-abundance" class="nav-link" data-scroll-target="#compare-euk-and-prok-cell-abundance">Compare euk and prok cell abundance</a></li>
  <li><a href="#combine-with-previous-mcr-cell-counts" id="toc-combine-with-previous-mcr-cell-counts" class="nav-link" data-scroll-target="#combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</a></li>
  </ul></li>
  <li><a href="#compile-table-with-euk-and-prok-counts" id="toc-compile-table-with-euk-and-prok-counts" class="nav-link" data-scroll-target="#compile-table-with-euk-and-prok-counts"><span class="header-section-number">3.2</span> Compile table with euk and prok counts</a></li>
  </ul></li>
  <li><a href="#estimate-grazing-effect" id="toc-estimate-grazing-effect" class="nav-link" data-scroll-target="#estimate-grazing-effect"><span class="header-section-number">4</span> Estimate grazing effect</a>
  <ul class="collapse">
  <li><a href="#determine-flp-per-euk-cell" id="toc-determine-flp-per-euk-cell" class="nav-link" data-scroll-target="#determine-flp-per-euk-cell"><span class="header-section-number">4.1</span> Determine FLP per euk cell</a>
  <ul class="collapse">
  <li><a href="#consider-igt-replicates." id="toc-consider-igt-replicates." class="nav-link" data-scroll-target="#consider-igt-replicates.">Consider IGT replicates.</a></li>
  </ul></li>
  <li><a href="#calculate-linear-regression-to-obtain-slope" id="toc-calculate-linear-regression-to-obtain-slope" class="nav-link" data-scroll-target="#calculate-linear-regression-to-obtain-slope"><span class="header-section-number">4.2</span> Calculate linear regression to obtain slope</a>
  <ul class="collapse">
  <li><a href="#plot-linear-regression-trend" id="toc-plot-linear-regression-trend" class="nav-link" data-scroll-target="#plot-linear-regression-trend">Plot linear regression trend</a></li>
  </ul></li>
  <li><a href="#remove-igt-tf-time-points." id="toc-remove-igt-tf-time-points." class="nav-link" data-scroll-target="#remove-igt-tf-time-points."><span class="header-section-number">4.3</span> Remove IGT Tf time points.</a>
  <ul class="collapse">
  <li><a href="#repeat-but-include-technical-replicates" id="toc-repeat-but-include-technical-replicates" class="nav-link" data-scroll-target="#repeat-but-include-technical-replicates">Repeat, but include technical replicates</a></li>
  </ul></li>
  <li><a href="#compile-and-save-grazing-experiment-results" id="toc-compile-and-save-grazing-experiment-results" class="nav-link" data-scroll-target="#compile-and-save-grazing-experiment-results"><span class="header-section-number">4.4</span> Compile and save grazing experiment results</a></li>
  </ul></li>
  <li><a href="#check-flp-control-experiments" id="toc-check-flp-control-experiments" class="nav-link" data-scroll-target="#check-flp-control-experiments"><span class="header-section-number">5</span> Check FLP control experiments</a>
  <ul class="collapse">
  <li><a href="#bag-grazing-experiment-controls" id="toc-bag-grazing-experiment-controls" class="nav-link" data-scroll-target="#bag-grazing-experiment-controls"><span class="header-section-number">5.1</span> Bag grazing experiment controls</a></li>
  <li><a href="#igt-experiment-controls" id="toc-igt-experiment-controls" class="nav-link" data-scroll-target="#igt-experiment-controls"><span class="header-section-number">5.2</span> IGT experiment controls</a></li>
  </ul></li>
  <li><a href="#generate-complete-table-with-grazing-rates-and-values" id="toc-generate-complete-table-with-grazing-rates-and-values" class="nav-link" data-scroll-target="#generate-complete-table-with-grazing-rates-and-values"><span class="header-section-number">6</span> Generate complete table with grazing rates and values</a>
  <ul class="collapse">
  <li><a href="#plot-flpgrazer-minute" id="toc-plot-flpgrazer-minute" class="nav-link" data-scroll-target="#plot-flpgrazer-minute"><span class="header-section-number">6.1</span> Plot FLP/grazer /minute</a>
  <ul class="collapse">
  <li><a href="#table-1" id="toc-table-1" class="nav-link" data-scroll-target="#table-1">Table 1</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#grazing-rate-calculations" id="toc-grazing-rate-calculations" class="nav-link" data-scroll-target="#grazing-rate-calculations"><span class="header-section-number">7</span> Grazing rate calculations</a></li>
  <li><a href="#carbon-biomass-for-eukaryotes" id="toc-carbon-biomass-for-eukaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-eukaryotes"><span class="header-section-number">8</span> Carbon biomass for eukaryotes</a>
  <ul class="collapse">
  <li><a href="#c-factor-based-on-biovolume" id="toc-c-factor-based-on-biovolume" class="nav-link" data-scroll-target="#c-factor-based-on-biovolume"><span class="header-section-number">8.1</span> C factor based on biovolume</a></li>
  <li><a href="#biomass-summaries" id="toc-biomass-summaries" class="nav-link" data-scroll-target="#biomass-summaries"><span class="header-section-number">8.2</span> Biomass summaries</a></li>
  <li><a href="#c-biomass-based-on-size-fraction" id="toc-c-biomass-based-on-size-fraction" class="nav-link" data-scroll-target="#c-biomass-based-on-size-fraction"><span class="header-section-number">8.3</span> C biomass based on size fraction</a></li>
  <li><a href="#figure-s3" id="toc-figure-s3" class="nav-link" data-scroll-target="#figure-s3"><span class="header-section-number">8.4</span> Figure S3</a></li>
  <li><a href="#compare-total-carbon-biomass---euks" id="toc-compare-total-carbon-biomass---euks" class="nav-link" data-scroll-target="#compare-total-carbon-biomass---euks"><span class="header-section-number">8.5</span> Compare total carbon biomass - euks</a>
  <ul class="collapse">
  <li><a href="#table-s4" id="toc-table-s4" class="nav-link" data-scroll-target="#table-s4">Table S4</a></li>
  </ul></li>
  <li><a href="#compare-biovolumes-from-literature-to-measured-in-this-study" id="toc-compare-biovolumes-from-literature-to-measured-in-this-study" class="nav-link" data-scroll-target="#compare-biovolumes-from-literature-to-measured-in-this-study"><span class="header-section-number">8.6</span> Compare biovolumes from literature to measured in this study</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-for-prokaryotes" id="toc-carbon-biomass-for-prokaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-prokaryotes"><span class="header-section-number">9</span> Carbon biomass for prokaryotes</a>
  <ul class="collapse">
  <li><a href="#incorporate-carbon-biomass-of-prey-and-grazing-rate" id="toc-incorporate-carbon-biomass-of-prey-and-grazing-rate" class="nav-link" data-scroll-target="#incorporate-carbon-biomass-of-prey-and-grazing-rate"><span class="header-section-number">9.1</span> Incorporate carbon biomass of prey and grazing rate</a></li>
  </ul></li>
  <li><a href="#environmental-parameters---mcr" id="toc-environmental-parameters---mcr" class="nav-link" data-scroll-target="#environmental-parameters---mcr"><span class="header-section-number">10</span> Environmental parameters - MCR</a></li>
  <li><a href="#analysis-of-grazing-rate-results" id="toc-analysis-of-grazing-rate-results" class="nav-link" data-scroll-target="#analysis-of-grazing-rate-results"><span class="header-section-number">11</span> Analysis of grazing rate results</a>
  <ul class="collapse">
  <li><a href="#box-plots-grazing-rate" id="toc-box-plots-grazing-rate" class="nav-link" data-scroll-target="#box-plots-grazing-rate">Box plots: Grazing rate</a></li>
  </ul></li>
  <li><a href="#figure-1-compilation" id="toc-figure-1-compilation" class="nav-link" data-scroll-target="#figure-1-compilation"><span class="header-section-number">12</span> Figure 1 compilation</a>
  <ul class="collapse">
  <li><a href="#grazing-rate-vs.-cells-ml" id="toc-grazing-rate-vs.-cells-ml" class="nav-link" data-scroll-target="#grazing-rate-vs.-cells-ml"><span class="header-section-number">12.1</span> Grazing rate vs.&nbsp;cells ml</a></li>
  </ul></li>
  <li><a href="#figure-2-compilation" id="toc-figure-2-compilation" class="nav-link" data-scroll-target="#figure-2-compilation"><span class="header-section-number">13</span> Figure 2 compilation</a></li>
  <li><a href="#comparison-with-gorda-ridge" id="toc-comparison-with-gorda-ridge" class="nav-link" data-scroll-target="#comparison-with-gorda-ridge"><span class="header-section-number">14</span> Comparison with Gorda Ridge</a>
  <ul class="collapse">
  <li><a href="#combine-gr-and-mcr-data" id="toc-combine-gr-and-mcr-data" class="nav-link" data-scroll-target="#combine-gr-and-mcr-data"><span class="header-section-number">14.1</span> Combine GR and MCR data</a></li>
  <li><a href="#plot-combined-results" id="toc-plot-combined-results" class="nav-link" data-scroll-target="#plot-combined-results"><span class="header-section-number">14.2</span> Plot combined results</a>
  <ul class="collapse">
  <li><a href="#remove-undetected-grazing-rate" id="toc-remove-undetected-grazing-rate" class="nav-link" data-scroll-target="#remove-undetected-grazing-rate">Remove undetected grazing rate</a></li>
  </ul></li>
  <li><a href="#plot-variables-as-a-factor-of-grazing-rate." id="toc-plot-variables-as-a-factor-of-grazing-rate." class="nav-link" data-scroll-target="#plot-variables-as-a-factor-of-grazing-rate."><span class="header-section-number">14.3</span> Plot variables as a factor of grazing rate.</a>
  <ul class="collapse">
  <li><a href="#figure-s7-2" id="toc-figure-s7-2" class="nav-link" data-scroll-target="#figure-s7-2">Figure S7 #2</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-regression-tidy-models" id="toc-linear-regression-tidy-models" class="nav-link" data-scroll-target="#linear-regression-tidy-models"><span class="header-section-number">15</span> Linear regression &amp; tidy models</a>
  <ul class="collapse">
  <li><a href="#mcr-and-gr-data-as-input" id="toc-mcr-and-gr-data-as-input" class="nav-link" data-scroll-target="#mcr-and-gr-data-as-input"><span class="header-section-number">15.1</span> MCR and GR data as input</a></li>
  <li><a href="#mcr-only" id="toc-mcr-only" class="nav-link" data-scroll-target="#mcr-only"><span class="header-section-number">15.2</span> MCR only</a></li>
  <li><a href="#mcr-vent-sites-only" id="toc-mcr-vent-sites-only" class="nav-link" data-scroll-target="#mcr-vent-sites-only"><span class="header-section-number">15.3</span> MCR vent sites only</a></li>
  <li><a href="#plot-temperature-by-eukprok-and-then-euk-and-prok" id="toc-plot-temperature-by-eukprok-and-then-euk-and-prok" class="nav-link" data-scroll-target="#plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="header-section-number">15.4</span> Plot temperature by euk:prok and then euk and prok</a></li>
  <li><a href="#plot-temperature-by-grazing-rate" id="toc-plot-temperature-by-grazing-rate" class="nav-link" data-scroll-target="#plot-temperature-by-grazing-rate"><span class="header-section-number">15.5</span> Plot temperature by grazing rate</a></li>
  </ul></li>
  <li><a href="#carbon-biomass-investigation" id="toc-carbon-biomass-investigation" class="nav-link" data-scroll-target="#carbon-biomass-investigation"><span class="header-section-number">16</span> Carbon biomass investigation</a></li>
  <li><a href="#prediction-of-mcr-data-with-parameters" id="toc-prediction-of-mcr-data-with-parameters" class="nav-link" data-scroll-target="#prediction-of-mcr-data-with-parameters"><span class="header-section-number">17</span> Prediction of MCR data with parameters</a></li>
  <li><a href="#save-robjects-for-results" id="toc-save-robjects-for-results" class="nav-link" data-scroll-target="#save-robjects-for-results"><span class="header-section-number">18</span> Save Robjects for Results</a></li>
  <li><a href="#session" id="toc-session" class="nav-link" data-scroll-target="#session"><span class="header-section-number">19</span> Session</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Protistan grazing analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="import-format-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Import &amp; format data</h1>
<p>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations, calculate cell abundances, estimate grazing rate, and cell biomass. This accompanies paper <em>in review</em>: Hu, S. K., Anderson, R. E., Pachiadaki, M. G., Edgcomb, V. P., Serres, M. H., Sylva, S. P., German, C. R., Seewald, J. S., Lang, S. Q., &amp; Huber, J. A. (2023). Microbial eukaryotic predation pressure and biomass at deep-sea hydrothermal vents: Implications for deep-sea carbon cycling. In bioRxiv (p.&nbsp;2023.08.11.552852). https://doi.org/10.1101/2023.08.11.552852</p>
<section id="set-up-working-r-environment" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="set-up-working-r-environment"><span class="header-section-number">1.1</span> Set up working R environment</h2>
<p>Load relevant libraries. A few libraries are loaded below in the code, but these are essential.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Set color schematic for the entire dataset. This is set so that all figures will be uniform for publication.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>whole_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>,<span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#eae2b7"</span>, <span class="st">"#5f0f40"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#941b0c"</span>, <span class="st">"#577590"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-raw-count-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="import-raw-count-data"><span class="header-section-number">1.2</span> Import raw count data</h2>
<p>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more ‘R’ friendly.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset column headers</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View new column headers</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DATE"         "SAMPLE"       "EXPID"        "VOL"          "MAG"         
 [6] "FOV"          "nanoNoFLP"    "microNoFLP"   "nanoFLP"      "microFLP"    
[11] "NOTES"        "DateCompiled"</code></pre>
</div>
</div>
<section id="parse-raw-microscopy-count-data" class="level3">
<h3 class="anchored" data-anchor-id="parse-raw-microscopy-count-data">Parse raw microscopy count data</h3>
<p>First we need to count the occurrence and total number of FLP ingested by eukaryotic cells. At the microscope, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but we also need to retain the number of FLP per cell.</p>
<p>At deep-sea hydrothermal vents, sometimes particulate material can form when we fixed vent fluid. Unfortunately, when we go to do microscopy counts the samples are uncountable because too much precipiate lands on top of the slide. These are labeled as <code>Note countable</code> in my raw count sheets and are removed below.</p>
<p>In a single field of view, if the <strong>nanoFLP</strong> entry is <code>2</code>, <strong>nanoFLP_occur</strong> will be set to <code>1</code>. And if the <strong>nanoFLP</strong> entry is <code>2,1</code> (which means a euk cell had 2 FLP, and a second cell had 1 FLP), <strong>nanoFLP_occur</strong> will be set to <code>2</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="calculate-cells-per-ml-euk" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Calculate cells per ml (euk)</h1>
<p>Calculations below determine the cells/ml based on the occurrence of eukaryotic cells in each FOV. Variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to &gt;20um and nano is &lt;20um. All counts were done at 100x magnification, which can be confirmed with this cmd: <code>unique(counts_occur$MAG)</code>.</p>
<p>Calculate cell concentration (cells/ml).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Replicates belong to the same experiment for either Bag (shipboard or ambient pressure) or IGT (in situ pressure) incubation. Below, modify these names and label new column with Bag or IGT and create an average across replicates.</p>
</blockquote>
<p>Average cells/ml across replicates, pivot to long format</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span> <span class="co">#remove replicates</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOTES on calculations:</p>
<p><em>VAR</em> = takes the sum of the squares of each value’s deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</p>
<p><em>SD</em> = standard deviation of all values</p>
<p><em>SEM</em> = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</p>
<p>Save output file.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-eukaryote-cell-abundance-for-all-time-points" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="plot-eukaryote-cell-abundance-for-all-time-points"><span class="header-section-number">2.1</span> Plot eukaryote cell abundance for all time points</h2>
<p>The average eukaryotic cells per ml value was taken when TRUE replicates were conducted and we observed a cell count.</p>
<p>As a Supplementary figure, plot eukaryote cells/ml for all time points to show that the protistan community wasn’t compromised during the experiments.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order the vent sites by temperature</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_avg)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="figure-s2" class="level3">
<h3 class="anchored" data-anchor-id="figure-s2">Figure S2</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS2.svg")</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VARIABLE_FIX =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> <span class="st">"microeukaryote"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> <span class="st">"nanoeukaryote"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span> <span class="sc">~</span> <span class="st">"Total eukaryote"</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot with outline vs. solid circle</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">group =</span> NameOrder,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE_FIX,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">color =</span> VARIABLE_FIX,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE_FIX, <span class="at">color =</span> VARIABLE_FIX,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="768"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. ~10s-100 cells/ml in background and plume compared to ~300-1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</p>
<blockquote class="blockquote">
<p>Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 * interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</p>
</blockquote>
<blockquote class="blockquote">
<p>eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</p>
</blockquote>
</section>
</section>
<section id="plot-eukaryote-cell-concentration-over-time." class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="plot-eukaryote-cell-concentration-over-time."><span class="header-section-number">2.2</span> Plot eukaryote cell concentration over time.</h2>
<p>Include plot over time.</p>
<section id="figure-s5" class="level4">
<h4 class="anchored" data-anchor-id="figure-s5">Figure S5</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS4.svg")</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, NameOrder, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_CATEGORY, <span class="at">fill =</span> NameOrder, </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment_rep), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> NameOrder, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>There is an overall drop in euk cells/ml in the final time point. This is especially true among the IGT samples. We take this into consideration in the manuscript, where the T3 (or final time point) for the IGT experiments is removed.</p>
</blockquote>
</section>
</section>
<section id="plot-t0-only-counts-for-cellsml-plot" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="plot-t0-only-counts-for-cellsml-plot"><span class="header-section-number">2.3</span> Plot T0 only counts for cells/ml plot</h2>
<p>For Figure 1, we want to show eukaryote cell abundances. For this value, we will use the total eukaryote cell values (micro + nano) from the initial time points (T0).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">shape =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cfacet_grid(. ~ SiteOrder, scales = "free") +</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>euk_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Above Figure shows the eukaryote cell abundances separated by vent site (x-axis).</p>
<section id="boxplot-eukaryote-cell-abundance" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-eukaryote-cell-abundance">Boxplot eukaryote cell abundance</h3>
<p>To better show comparison across vent fields (Von Damm vs.&nbsp;Piccard), habitat type (vent fluid vs.&nbsp;background or non-vent), and experiment type (shipboard vs.&nbsp;IGT), cell abundances are better shown as a box plot.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_site <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LOCATION_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"Plume"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"BSW"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> LOCATION_BIN, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">fill =</span> SiteOrder,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_site</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Repeat, but subset vent sites only and group by experiment approach.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_exp <span class="ot">&lt;-</span>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LOCATION_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"Plume"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"BSW"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LOCATION_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> EXP_CATEGORY, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">19</span>)) <span class="sc">+</span>  </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("#264653", "#E76F51")) +</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_color_manual(values = c("#264653", "#E76F51")) +</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># facet_grid(.~SiteOrder) +</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Option to show eukaryote cell abundances without a log scale.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, EXPID) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, EXPID) <span class="sc">~</span> <span class="fu">paste</span>(Site, <span class="st">"IGT"</span>),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(Site, <span class="st">"Shipboard"</span>),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># unite("SITE_TYPE", Site, EXP_CATEGORY, sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, EXPID))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> eukCONC, <span class="at">x =</span> TYPE_BIN)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="bacteria-archaea-cell-counts" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Bacteria &amp; archaea cell counts</h1>
<p>DAPI slide counts from prokaryotes from same sites. Import and compare.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CELLML),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CELLML),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cells-per-ml-prok" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="cells-per-ml-prok"><span class="header-section-number">3.1</span> Cells per ml (prok)</h2>
<p>Visualize counts from proks. Get summary of prok counts, and incorporate into plot. Throughout dataset, sample called “Quakeplume” did not work. This was an opportunistic sample that can be removed.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Name <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(MEAN),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(MEAN),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(MEAN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'type'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   type [2]
  type     Site       mean    min     max
  &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 non-vent Piccard  31645. 11860.  51429.
2 non-vent VD       27184. 16478.  37890.
3 vent     Piccard 109713. 53878. 238586.
4 vent     VD       40907.  8816. 111430.</code></pre>
</div>
</div>
<p>Factor site names, so order can be uniform with other figures.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordered by temperature</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"MustardStand"</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Rav2"</span>, <span class="st">"OMT"</span>,<span class="st">"Bartizan"</span>,<span class="st">"ArrowLoop"</span>, <span class="st">"Rav1"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Quakeplume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"SouthofHotChimlet"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"SouthofLungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"ShrimpGulley"</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"HotChimlet1"</span>), </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>,<span class="st">"Mustard Stand"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Ravelin #2"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Ravelin #1"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                                          </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Quakeplume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"South of Hot Chimlet"</span>, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"South of LungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"Hot Chimlet #1"</span>))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>site_fill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># names(site_color) &lt;- site_fullname</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Write function to output scientific notation in the plot with <code>x 10^a</code></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'scales' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    discard</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">==</span><span class="dv">0</span>, <span class="st">"0"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">sub</span>(<span class="st">"e[+]?"</span>, <span class="st">" %*% 10^"</span>, scales<span class="sc">::</span><span class="fu">scientific_format</span>()(x)))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">color =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_log10(label=trans_format("log10",math_format(10^.x))) +</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(label = scientific_10) +</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>prok_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Show prokaryote cell abundance as boxplot.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TYPE_BIN, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_errorbar(aes(ymax = (MEAN + SEM), ymin = (MEAN - SEM)), width = 0.2) +</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">color =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_log10(label=trans_format("log10",math_format(10^.x))) +</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(label = scientific_10) +</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<section id="compare-euk-and-prok-cell-abundance" class="level3">
<h3 class="anchored" data-anchor-id="compare-euk-and-prok-cell-abundance">Compare euk and prok cell abundance</h3>
<p>Combined eukaryote and prokaryote cell counts.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>euk_prok_ab <span class="ot">&lt;-</span> (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>euk_prok_ab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combine-with-previous-mcr-cell-counts" class="level3">
<h3 class="anchored" data-anchor-id="combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</h3>
<p>Compare <em>in situ</em> prokaryote cell counts from 2020 to previous years</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Re-import 2020 data to compare.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot by year.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(counts_cellsml_avg)</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>prok_tojoin <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MEAN), <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MIN), <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MAX), <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"PROK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, <span class="at">PROK_ml =</span> MEAN_SIG, PROK_MinMax, <span class="at">PROK_sem =</span> SEM)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># prok_tojoin</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compile-table-with-euk-and-prok-counts" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="compile-table-with-euk-and-prok-counts"><span class="header-section-number">3.2</span> Compile table with euk and prok counts</h2>
<p>Part of Table 1.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(MEAN, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(MIN, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(MAX, <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"EUK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, SITE_TYPE, Experiment, Experiment_rep, VARIABLE, <span class="at">EUK_ml =</span> MEAN_SIG, EUK_MinMax, <span class="at">EUK_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prok_tojoin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Site, Name)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="co"># add to this later for Table 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Site           Name         SITE_TYPE               Experiment
1  Piccard    LotsOShrimp Piccard-Shipboard    LotsOShrimp-Shipboard
2  Piccard          Plume Piccard-Shipboard          Plume-Shipboard
3  Piccard Shrimpocalypse Piccard-Shipboard Shrimpocalypse-Shipboard
4  Piccard Shrimpocalypse       Piccard-IGT       Shrimpocalypse-IGT
5  Piccard Shrimpocalypse       Piccard-IGT       Shrimpocalypse-IGT
6       VD            BSW      VD-Shipboard            BSW-Shipboard
7       VD   MustardStand      VD-Shipboard   MustardStand-Shipboard
8       VD            OMT            VD-IGT                  OMT-IGT
9       VD          Plume      VD-Shipboard          Plume-Shipboard
10      VD           Rav2      VD-Shipboard           Rav2-Shipboard
11      VD           Rav2            VD-IGT                 Rav2-IGT
12      VD           Rav2            VD-IGT                 Rav2-IGT
13      VD     ShrimpHole      VD-Shipboard     ShrimpHole-Shipboard
14      VD            X18      VD-Shipboard            X18-Shipboard
             Experiment_rep VARIABLE  EUK_ml    EUK_MinMax    EUK_sem PROK_ml
1     LotsOShrimp-Shipboard  eukCONC 230.910 230.9 / 230.9         NA   53878
2           Plume-Shipboard  eukCONC  79.301   55.98 / 112  16.819081   51429
3  Shrimpocalypse-Shipboard  eukCONC 454.820 454.8 / 454.8         NA  238590
4       Shrimpocalypse-IGT3  eukCONC 384.840 384.8 / 384.8         NA  238590
5       Shrimpocalypse-IGT7  eukCONC 524.790 524.8 / 524.8         NA  238590
6             BSW-Shipboard  eukCONC  91.838 69.97 / 113.7  21.866127   37890
7    MustardStand-Shipboard  eukCONC 259.770 230.9 / 288.6  28.863287   56677
8                  OMT-IGT4  eukCONC 349.860 349.9 / 349.9         NA      NA
9           Plume-Shipboard  eukCONC 157.770 55.98 / 284.4  67.098589   16478
10           Rav2-Shipboard  eukCONC 409.330 335.9 / 482.8  73.470185      NA
11                Rav2-IGT4  eukCONC 944.620 944.6 / 944.6         NA      NA
12                Rav2-IGT5  eukCONC 629.740 629.7 / 629.7         NA      NA
13     ShrimpHole-Shipboard  eukCONC 385.720 377.8 / 393.6   7.871806   41983
14            X18-Shipboard  eukCONC 314.870 209.9 / 419.8 104.957407  111430
       PROK_MinMax  PROK_sem
1    26240 / 90260 13727.191
2    46810 / 56050  4618.126
3  108700 / 322000 65792.588
4  108700 / 322000 65792.588
5  108700 / 322000 65792.588
6    18470 / 56470  8608.427
7    42400 / 70950 14274.207
8             &lt;NA&gt;        NA
9    13850 / 19100  2623.935
10            &lt;NA&gt;        NA
11            &lt;NA&gt;        NA
12            &lt;NA&gt;        NA
13   38830 / 45130  3148.722
14 108500 / 114400  2973.793</code></pre>
</div>
</div>
</section>
</section>
<section id="estimate-grazing-effect" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Estimate grazing effect</h1>
<p>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs.RData"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  counts_cellsml_all
  counts_cellsml_avg
  counts_occur</code></pre>
</div>
</div>
<section id="determine-flp-per-euk-cell" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="determine-flp-per-euk-cell"><span class="header-section-number">4.1</span> Determine FLP per euk cell</h2>
<p>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <code>counts_occur</code> data frame from above. We can use the command <code>separate_rows()</code> to do this.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> <span class="co"># uncountable</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span> <span class="co"># uncountable</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>optional gut check of data table modification</em></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See FOV 23, where nanoFLP is 4,5</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Check FOV 23. It is separated into 2 rows, 4 and then 5.</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Isolate counts that are &gt;0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1. <em>Each row is a euk cell, based on data transformation above.</em></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(counts_flp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 157
Columns: 7
$ SAMPLE          &lt;chr&gt; "Piccard-LotsOShrimp", "Piccard-LotsOShrimp", "Piccard…
$ EXPID           &lt;chr&gt; "T0-Rep3", "T15-Rep3", "T15-Rep3", "T20-Rep3", "T0-Rep…
$ EXP_TYPE        &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag"…
$ IGT_REP         &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag"…
$ SizeFrac        &lt;chr&gt; "nano_size", "micro_size", "nano_size", "nano_size", "…
$ total_FLP       &lt;int&gt; 3, 1, 3, 2, 2, 4, 3, 2, 8, 6, 3, 3, 9, 1, 7, 4, 7, 8, …
$ total_euks_wflp &lt;int&gt; 2, 1, 2, 1, 1, 3, 2, 1, 5, 5, 2, 1, 4, 1, 3, 1, 4, 2, …</code></pre>
</div>
</div>
<p><em>OUTPUT COLUMNS:</em> (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</p>
<p>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</p>
<blockquote class="blockquote">
<p>Below code repeats process and compiles with other FLP/euk cell data.</p>
</blockquote>
<p>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(counts_flp_compiled_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 336
Columns: 8
$ SAMPLE           &lt;chr&gt; "Piccard-LotsOShrimp", "Piccard-LotsOShrimp", "Piccar…
$ EXPID            &lt;chr&gt; "T0-Rep3", "T15-Rep3", "T20-Rep3", "T40-Rep3", "T0-Re…
$ EXP_TYPE         &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag…
$ IGT_REP          &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag…
$ total_euks_noFLP &lt;int&gt; 9, 8, 9, 5, 6, 5, 11, 8, 2, 9, 10, 1, 5, 5, 3, 7, 5, …
$ total_FLP        &lt;int&gt; 3, 4, 2, 0, 6, 5, 8, 6, 3, 12, 8, 11, 19, 5, 4, 9, 11…
$ total_euks_wflp  &lt;int&gt; 2, 3, 1, 0, 4, 3, 5, 5, 2, 5, 4, 5, 6, 4, 3, 5, 4, 1,…
$ SizeFrac         &lt;chr&gt; "total_euks", "total_euks", "total_euks", "total_euks…</code></pre>
</div>
</div>
<p>The code above takes the processed microscopy counts, and estimates the total number of FLP and the total number of eukaryotes counted (with or without FLP inside). To calculate the rate that FLP were ingested, we need the slope of the line when we plot the number of ingested FLP per eukaryote cell by experiment time.</p>
<p>We will use this equation below: <code>FLPperEuk = total_FLP/(sum(total_euks_noFLP, total_euks_wflp))</code>.</p>
<p>First need to import and compile with metadata to get exact timing of experiments.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="consider-igt-replicates." class="level3">
<h3 class="anchored" data-anchor-id="consider-igt-replicates.">Consider IGT replicates.</h3>
<p>IGT_#_ denotes a separate IGT experiment. Due to bottle effects and the need to look at how replicate experiments compared, lets keep these separate. For IGT experiments labeled “b”, this means the OTHER HALF of the filter was counted or re-counted as a way to confirm my eukaryote cell counting was precise (explored in manuscript supplement).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, use this to include them as replicates</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) %&gt;%</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(counts_flp_calcs_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 336
Columns: 23
$ SAMPLE           &lt;chr&gt; "Piccard-LotsOShrimp", "Piccard-LotsOShrimp", "Piccar…
$ Site             &lt;chr&gt; "Piccard", "Piccard", "Piccard", "Piccard", "Piccard"…
$ Experiment       &lt;chr&gt; "LotsOShrimp-Bag", "LotsOShrimp-Bag", "LotsOShrimp-Ba…
$ Name             &lt;chr&gt; "LotsOShrimp", "LotsOShrimp", "LotsOShrimp", "LotsOSh…
$ EXPID            &lt;chr&gt; "T0-Rep3", "T15-Rep3", "T20-Rep3", "T40-Rep3", "T0-Re…
$ TimePoint        &lt;chr&gt; "T0", "T15", "T20", "T40", "T0", "T0", "T0", "T10", "…
$ Replicate_ID     &lt;chr&gt; "Rep3", "Rep3", "Rep3", "Rep3", "Rep1", "Rep2", "Rep3…
$ REP              &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag…
$ EXP_TYPE         &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag…
$ IGT_REP          &lt;chr&gt; "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag", "Bag…
$ total_euks_noFLP &lt;int&gt; 9, 8, 9, 5, 6, 5, 11, 8, 2, 9, 10, 1, 5, 5, 3, 7, 5, …
$ total_FLP        &lt;int&gt; 3, 4, 2, 0, 6, 5, 8, 6, 3, 12, 8, 11, 19, 5, 4, 9, 11…
$ total_euks_wflp  &lt;int&gt; 2, 3, 1, 0, 4, 3, 5, 5, 2, 5, 4, 5, 6, 4, 3, 5, 4, 1,…
$ SizeFrac         &lt;chr&gt; "total_euks", "total_euks", "total_euks", "total_euks…
$ Minutes          &lt;int&gt; 0, 15, 20, 40, 0, 0, 0, 10, 10, 10, 15, 15, 15, 20, 2…
$ SiteOrigin       &lt;chr&gt; "Vent", "Vent", "Vent", "Vent", "Plume", "Plume", "Pl…
$ FLUID_ORIGIN     &lt;chr&gt; "J2-1241", "J2-1241", "J2-1241", "J2-1241", "CTD004",…
$ CRUISE_SAMPLE    &lt;chr&gt; "LV24", "LV24", "LV24", "LV24", "Niskin 10", "Niskin …
$ EXP_REPS         &lt;int&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…
$ EXP_VOL          &lt;dbl&gt; 1.50, 1.50, 1.50, 1.50, 2.00, 2.00, 2.00, 2.00, 2.00,…
$ CTRL_REPS        &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
$ CTRL_VOL         &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5…
$ FLPperEuk        &lt;dbl&gt; 0.27272727, 0.36363636, 0.20000000, 0.00000000, 0.600…</code></pre>
</div>
</div>
<p>Explanation of main columns:</p>
<ul>
<li><code>Timepoint</code> shows the time point for the experiment, while <code>Minutes</code> = reports the actual minutes at incubation.</li>
</ul>
<p><code>Replicate_ID</code>, <code>REP</code>, and <code>IGT_REP</code> = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</p>
<p>An example of the Ravelin #2 site, where we have two IGT experiments and 1 ambient/bag/shipboard experiment. Below, we have plotted the FLP per EUK cell by the time of the experiment. This is showing the total number of counts done, so replicates 1-3 are shown for the Bag experiment.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Name <span class="sc">==</span> <span class="st">"Rav2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Experiment, <span class="at">group =</span> Replicate_ID)) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Experiment)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 13 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>
<section id="calculate-linear-regression-to-obtain-slope" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="calculate-linear-regression-to-obtain-slope"><span class="header-section-number">4.2</span> Calculate linear regression to obtain slope</h2>
<p>Use <code>lm()</code> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</p>
<p>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) %&gt;% </span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"IGT_REP"</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) %&gt;% </span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</p>
</blockquote>
<p>Apply to all data to obtain slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`
Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p><em>gut check</em> linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <code>nest()</code> capability of tidyverse. Below, one experiment is subset to check the value.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # tmp_plume # View</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Perform linear regression</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Check output</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Compare with nested function output</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-linear-regression-trend" class="level3">
<h3 class="anchored" data-anchor-id="plot-linear-regression-trend">Plot linear regression trend</h3>
<p>Plot all shipboard experiments with estimated slope.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Filter out IGT samples for now</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, </span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder, <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(21, 21, 21, 21)) +</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_fill_manual(values = c("white", "#264653", "white", "#E76F51")) +</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_color_manual(values = c("#264653", "#264653", "#E76F51", "#E76F51")) +</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Report r.squared</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>shipboardregression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</p>
</section>
</section>
<section id="remove-igt-tf-time-points." class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="remove-igt-tf-time-points."><span class="header-section-number">4.3</span> Remove IGT Tf time points.</h2>
<p>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"b"</span>, Replicate_ID)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`
Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated grazing effect.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>igtregression <span class="ot">&lt;-</span> igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>igtregression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Results are more consistent across experiments when we remove Tf from the IGT experiments</p>
</blockquote>
<section id="figure-s4" class="level4">
<h4 class="anchored" data-anchor-id="figure-s4">Figure S4</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS3.svg", h = 12, w = 7)</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="sc">+</span> igtregression <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="repeat-but-include-technical-replicates" class="level3">
<h3 class="anchored" data-anchor-id="repeat-but-include-technical-replicates">Repeat, but include technical replicates</h3>
<p>Assess technical replicates for supplemental.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf_wb <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!grepl("b", Replicate_ID)) %&gt;% </span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(EXP_TYPE = IGT_REP) %&gt;% </span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> Replicate_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, Replicate_ID, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>REP, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf_wb) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP,
  -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`
Joining with `by = join_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac)`</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated slope.</p>
<section id="figure-s9" class="level4">
<h4 class="anchored" data-anchor-id="figure-s9">Figure S9</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS9_new.svg")</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only isolate IGT 4s, where the technical replicates were done</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"IGT4"</span>, IGT_REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Name, IGT_REP, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="compile-and-save-grazing-experiment-results" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="compile-and-save-grazing-experiment-results"><span class="header-section-number">4.4</span> Compile and save grazing experiment results</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="sc">%&gt;%</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrigin, SiteOrder, NameOrder, Experiment, SizeFrac, r.squared, INTERCEPT, SLOPE) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SiteOrigin SiteOrder      NameOrder          Experiment   SizeFrac
1        Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag total_euks
2       Plume   Piccard          Plume           Plume-Bag total_euks
3        Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag total_euks
4  Background  Von Damm     Background             BSW-Bag total_euks
5        Vent  Von Damm  Mustard Stand    MustardStand-Bag total_euks
6       Plume  Von Damm          Plume           Plume-Bag total_euks
7        Vent  Von Damm     Ravelin #2            Rav2-Bag total_euks
8        Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag total_euks
9        Vent  Von Damm           X-18             X18-Bag total_euks
10       Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag micro_size
11       Vent   Piccard Lots 'O Shrimp     LotsOShrimp-Bag  nano_size
12      Plume   Piccard          Plume           Plume-Bag micro_size
13      Plume   Piccard          Plume           Plume-Bag  nano_size
14       Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag micro_size
15       Vent   Piccard Shrimpocalypse  Shrimpocalypse-Bag  nano_size
16 Background  Von Damm     Background             BSW-Bag micro_size
17 Background  Von Damm     Background             BSW-Bag  nano_size
18       Vent  Von Damm  Mustard Stand    MustardStand-Bag micro_size
19       Vent  Von Damm  Mustard Stand    MustardStand-Bag  nano_size
20      Plume  Von Damm          Plume           Plume-Bag micro_size
21      Plume  Von Damm          Plume           Plume-Bag  nano_size
22       Vent  Von Damm     Ravelin #2            Rav2-Bag micro_size
23       Vent  Von Damm     Ravelin #2            Rav2-Bag  nano_size
24       Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag micro_size
25       Vent  Von Damm    Shrimp Hole      ShrimpHole-Bag  nano_size
26       Vent  Von Damm           X-18             X18-Bag micro_size
27       Vent  Von Damm           X-18             X18-Bag  nano_size
28       Vent   Piccard Shrimpocalypse Shrimpocalypse-IGT3 total_euks
29       Vent  Von Damm   Old Man Tree            OMT-IGT4 total_euks
30       Vent  Von Damm     Ravelin #2           Rav2-IGT4 total_euks
31       Vent  Von Damm     Ravelin #2           Rav2-IGT5 total_euks
     r.squared   INTERCEPT        SLOPE
1  0.660252577  0.35170021 -0.007605829
2  0.028109981  0.74350881  0.005362856
3  0.134500775  0.74142021  0.015686872
4  0.016339803  0.33810711  0.002958889
5  0.679501856  0.53165317 -0.005445545
6  0.152459998  0.45659816  0.005274231
7  0.003588551  0.96801815  0.003470217
8  0.002436342  0.89841555 -0.001967253
9  0.007917377  0.39372646  0.001744429
10 0.000000000  0.50000000           NA
11 0.723950257  0.34152209 -0.007467037
12 0.031027392  1.84477124 -0.021241830
13 0.134388231  0.56572102  0.009146535
14 0.016488447  1.89710611 -0.016881029
15 0.219942841  0.57936763  0.022967165
16 0.289513467  1.45183824 -0.027181373
17 0.015152403  0.29347056  0.002856863
18 0.000000000  0.00000000           NA
19 0.679997859  0.52917792 -0.004985856
20 0.098467998  0.78410898  0.019766939
21 0.019373495  0.45137023  0.002263909
22 0.696359782 -1.71474878  0.394651540
23 0.001444937  0.93924980  0.002011385
24 0.233424455  2.28754579 -0.092124542
25 0.002819273  0.93709575  0.002424242
26 0.302757291  0.67091295  0.036093418
27 0.018916716  0.30417816  0.002196051
28 0.661389551  0.02153110  0.016794258
29 0.294853437  0.23949718  0.003764672
30 0.990856592  0.06472882  0.021062665
31 0.550820859  0.43701267 -0.002850877</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="check-flp-control-experiments" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Check FLP control experiments</h1>
<p>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ORIG_ID =</span> Site) <span class="sc">%&gt;%</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Name <span class="sc">==</span> <span class="st">"Rav2"</span> <span class="sc">&amp;</span> Cells.ml <span class="sc">&gt;</span> <span class="dv">90000</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove inconsistent replicate from Ravelin #2</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Name <span class="sc">==</span> <span class="st">"Rav2"</span> <span class="sc">&amp;</span> Replicate <span class="sc">==</span> <span class="st">"REP1"</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove inconsistent replicate from Ravelin #2</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 17 rows [33, 34, 35, 36, 37,
38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49].</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(Cells.ml),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TimePoint', 'Stain', 'Site'. You can
override using the `.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dtaf_avg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="bag-grazing-experiment-controls" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="bag-grazing-experiment-controls"><span class="header-section-number">5.1</span> Bag grazing experiment controls</h2>
<p>Option to plot averages. However, consistency between Replicate 1 and 2 was not always great. So plotting individually is best to show that the FLP do not disappear due to anomalous reasons.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bag_ctrls &lt;- dtaf_avg %&gt;% </span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Site != "IGT") %&gt;% </span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = TimePoint, y = Avg_cellsperml, fill = Name, shape = Site)) +</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar(aes(ymin = MIN, ymax = MAX), width = 0.1) +</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_rect(data = filter(dtaf_avg, TimePoint == "T0", Site != "IGT"), aes(</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            ymin = (Avg_cellsperml-(0.15*Avg_cellsperml)),</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            ymax = (Avg_cellsperml+(0.15*Avg_cellsperml))), color = NA, alpha = 0.4, xmin = 0, xmax = 6, fill = "black") +</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(aes(group = Name)) +</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(stat = "identity", aes(shape = Site, fill = Name), size = 2) +</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(Name ~ Site) +</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_log10(labels = scientific_10) +</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() + theme(strip.background = element_blank(), </span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend.title = element_blank(),</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                      axis.text = element_text(size = 10, color = "black"),</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = element_text(size = 10, face = "bold"),</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                           axis.title = element_text(size = 9)) +</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "FLP counts for controls", y = bquote("Log FLP "~mL^-1), x = "Time point")</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="co"># bag_ctrls</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(dtaf)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>ship_ctrls_reps <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Cells.ml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Cells.ml<span class="sc">-</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml)),</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Cells.ml<span class="sc">+</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Replicate), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>ship_ctrls_reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="igt-experiment-controls" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="igt-experiment-controls"><span class="header-section-number">5.2</span> IGT experiment controls</h2>
<p>Repeat for IGT experiments.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>igt_ctrl_reps <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Cells.ml, <span class="at">shape =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Cells.ml<span class="sc">-</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml)),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Cells.ml<span class="sc">+</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Replicate), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> ORIG_ID) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>igt_ctrl_reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<section id="figure-s6" class="level5">
<h5 class="anchored" data-anchor-id="figure-s6">Figure S6</h5>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6_1.svg", w = 9, h = 7)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>ship_ctrls_reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6_2.svg", w = 7, h = 5)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>igt_ctrl_reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="generate-complete-table-with-grazing-rates-and-values" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Generate complete table with grazing rates and values</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, IGT_REP, Site, Name, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, IGT_REP, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, SiteOrder, NameOrder, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume-Shipboard"</span>,</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background-Shipboard"</span>,</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Shipboard"</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">LABEL_REPS =</span> <span class="fu">case_when</span>(</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, LABEL_REPS, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'FLUID_ORIGIN', 'CRUISE_SAMPLE',
'IGT_REP', 'EXP_TYPE', 'EXP_REPS', 'EXP_VOL', 'CTRL_REPS', 'CTRL_VOL', 'Site',
'Name', 'SiteOrder', 'NameOrder'. You can override using the `.groups`
argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="co"># view complete table of grazing rate results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   SAMPLE FLUID_ORIGIN CRUISE_SAMPLE IGT_REP EXP_TYPE EXP_REPS
1     Piccard-LotsOShrimp      J2-1241          LV24     Bag      Bag        3
2           Piccard-Plume       CTD004     Niskin 10     Bag      Bag        3
3  Piccard-Shrimpocalypse      J2-1240          IGT3    IGT3      IGT        1
4  Piccard-Shrimpocalypse      J2-1240          LV13     Bag      Bag        3
5                  VD-BSW       CTD002  Niskins 8-10     Bag      Bag        3
6         VD-MustardStand      J2-1243          LV17     Bag      Bag        2
7                  VD-OMT      J2-1238          IGT4    IGT4      IGT        1
8                VD-Plume       CTD001      Niskin 2     Bag      Bag        3
9                 VD-Rav2      J2-1238         LV13a     Bag      Bag        3
10                VD-Rav2      J2-1244          IGT4    IGT4      IGT        1
11                VD-Rav2      J2-1244          IGT5    IGT5      IGT        1
12          VD-ShrimpHole      J2-1244          LV13     Bag      Bag        2
13                 VD-X18      J2-1235   LV23 &amp; Bio5     Bag      Bag        2
   EXP_VOL CTRL_REPS CTRL_VOL    Site           Experiment_rep           Name
1     1.50         2      0.2 Piccard    LotsOShrimp-Shipboard    LotsOShrimp
2     2.00         2      0.5 Piccard          Plume-Shipboard          Plume
3     0.15        NA       NA Piccard      Shrimpocalypse-IGT3 Shrimpocalypse
4     1.50         2      0.2 Piccard Shrimpocalypse-Shipboard Shrimpocalypse
5     2.00         2      0.5      VD            BSW-Shipboard            BSW
6     1.50         2      0.2      VD   MustardStand-Shipboard   MustardStand
7     0.15        NA       NA      VD                 OMT-IGT4            OMT
8     2.00         2      1.0      VD          Plume-Shipboard          Plume
9     1.50         2      0.5      VD           Rav2-Shipboard           Rav2
10    0.15        NA       NA      VD                Rav2-IGT4           Rav2
11    0.15        NA       NA      VD                Rav2-IGT5           Rav2
12    1.50         2      0.2      VD     ShrimpHole-Shipboard     ShrimpHole
13    1.50         2      0.5      VD            X18-Shipboard            X18
   SiteOrder      NameOrder         RATE        TimePoints  GRAZE_RATE
1    Piccard Lots 'O Shrimp -0.007605829     0, 15, 20, 40 0.000000000
2    Piccard          Plume  0.005362856 0, 10, 15, 20, 40 0.005362856
3    Piccard Shrimpocalypse  0.016794258         0, 15, 25 0.016794258
4    Piccard Shrimpocalypse  0.015686872 0, 10, 14, 22, 42 0.015686872
5   Von Damm     Background  0.002958889 0, 10, 15, 20, 40 0.002958889
6   Von Damm  Mustard Stand -0.005445545     0, 10, 20, 40 0.000000000
7   Von Damm   Old Man Tree  0.003764672          0, 7, 25 0.003764672
8   Von Damm          Plume  0.005274231 0, 10, 15, 25, 57 0.005274231
9   Von Damm     Ravelin #2  0.003470217 0, 10, 15, 21, 40 0.003470217
10  Von Damm     Ravelin #2  0.021062665         0, 12, 20 0.021062665
11  Von Damm     Ravelin #2 -0.002850877         0, 35, 40 0.000000000
12  Von Damm    Shrimp Hole -0.001967253 0, 10, 15, 20, 40 0.000000000
13  Von Damm           X-18  0.001744429     0, 15, 20, 40 0.001744429
              type LABEL_REPS
1   Vent-Shipboard  Shipboard
2  Plume-Shipboard  Shipboard
3         Vent-IGT       IGT3
4   Vent-Shipboard  Shipboard
5   Vent-Shipboard  Shipboard
6   Vent-Shipboard  Shipboard
7         Vent-IGT       IGT4
8  Plume-Shipboard  Shipboard
9   Vent-Shipboard  Shipboard
10        Vent-IGT       IGT4
11        Vent-IGT       IGT5
12  Vent-Shipboard  Shipboard
13  Vent-Shipboard  Shipboard</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Experiment_rep'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
# Groups:   Experiment_rep [12]
   Experiment_rep           Site    mean_rate min_rate     max
   &lt;chr&gt;                    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 BSW-Shipboard            VD        0.00296  0.00296 0.00296
 2 LotsOShrimp-Shipboard    Piccard   0        0       0      
 3 MustardStand-Shipboard   VD        0        0       0      
 4 OMT-IGT4                 VD        0.00376  0.00376 0.00376
 5 Plume-Shipboard          Piccard   0.00536  0.00536 0.00536
 6 Plume-Shipboard          VD        0.00527  0.00527 0.00527
 7 Rav2-IGT4                VD        0.0211   0.0211  0.0211 
 8 Rav2-IGT5                VD        0        0       0      
 9 Rav2-Shipboard           VD        0.00347  0.00347 0.00347
10 ShrimpHole-Shipboard     VD        0        0       0      
11 Shrimpocalypse-IGT3      Piccard   0.0168   0.0168  0.0168 
12 Shrimpocalypse-Shipboard Piccard   0.0157   0.0157  0.0157 
13 X18-Shipboard            VD        0.00174  0.00174 0.00174</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(Site, TYPE) %&gt;% </span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(TYPE) %&gt;%</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPE, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TYPE'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   TYPE [2]
  TYPE     EXP_TYPE mean_rate min_rate     max
  &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 non-vent Bag        0.00532  0.00527 0.00536
2 vent     Bag        0.00341  0       0.0157 
3 vent     IGT        0.0104   0       0.0211 </code></pre>
</div>
</div>
<p>Amend table with estimated FLP concentration</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_ml =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>, <span class="sc">-</span>FLP_conc) <span class="sc">%&gt;%</span> </span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Introduce factors in table for visualizations</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>FIELDORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>VENTORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-flpgrazer-minute" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="plot-flpgrazer-minute"><span class="header-section-number">6.1</span> Plot FLP/grazer /minute</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, FIELD, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> VENTORDER, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELDORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="table-1" class="level3">
<h3 class="anchored" data-anchor-id="table-1">Table 1</h3>
<p>Create table with all base experiment results. Including, grazing rate derived from slope (and corrected), number of experiments, replicates, and prok and euk counts.</p>
<p>For IGT experiments, or experiments where in situ prok counts were not obtained, the average in situ prok count was used.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_grazerate_wflp)</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View(euk_prok_counts)</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Experiment_rep, FIELD, Name, SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, RATE, <span class="at">RATE_minute =</span> GRAZE_RATE, FLP_ml, TimePoints, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span> </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(euk_prok_counts, <span class="fu">join_by</span>(Experiment_rep <span class="sc">==</span> Experiment_rep, Name <span class="sc">==</span> Name, FIELD <span class="sc">==</span> Site)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(PROK_ml), avg_insitu, PROK_ml))</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp_wprok_weuk</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="co"># names(table_grazerate_wflp_wprok_weuk)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Description of variables above:</p>
<ul>
<li>FIELD - vent location</li>
<li>NAME - name of vent site, or plume/background</li>
<li>EXP - experiment type, bag or IGT</li>
<li>SAMPLE - vent site</li>
<li>RATE_minute = GRAZE_RATE - FLPs per grazer per minute (SLOPE of best fitline)</li>
<li>FLP_ml - FLP concentration at T0</li>
<li>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</li>
<li>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</li>
</ul>
</section>
</section>
</section>
<section id="grazing-rate-calculations" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Grazing rate calculations</h1>
<p>Based on Unrein et al.&nbsp;2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_minute <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs, file = "output-data/table-wcalc.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explanation of units for table with calculated values.</p>
<ul>
<li><p>RATE_min &amp; RATE_hr = Grazing rate as ‘FLPs per grazer per minute’ and per hour</p></li>
<li><p>CLEARANCE_RATE = ml or nL per grazer per hour</p></li>
<li><p>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</p></li>
<li><p>GRAZING EFFECT = bacteria per ml per hour</p></li>
<li><p>Bacterial turnover rate = % per day</p></li>
</ul>
<p>Table 1 and S1 - grazing experiment information only</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Table 1</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>              <span class="co"># select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, EUK_ml, EUK_MinMax, PROK_ml, PROK_MinMax, GRAZING_EFFECT_hr, RATE_minute, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # ## Table S2</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE,</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                      TimePoints, starts_with("EXP"), starts_with("CTRL"), EUK_ml, EUK_MinMax, EUK_sem, PROK_ml, PROK_MinMax, PROK_sem, FLP_ml, GRAZE_RATE_DAY, Slope = RATE, RATE_minute, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/tableS2-grazing-exp-list.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="carbon-biomass-for-eukaryotes" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Carbon biomass for eukaryotes</h1>
<p>References for estimating biovolume <em>Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al.&nbsp;(2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782–792.</em></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="c-factor-based-on-biovolume" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="c-factor-based-on-biovolume"><span class="header-section-number">8.1</span> C factor based on biovolume</h2>
<ol type="1">
<li>Calculate biovolume based on observed/imaged cells</li>
</ol>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate biovolume, then apply carbon by biomass estimate for protists derived from biovolume.</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># h = largest cell dimension "height"</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># d = largest cross-section of h</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIOVOLUME =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> h)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_dino =</span> (<span class="fl">0.760</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.819</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_nodiatom =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.939</span>))) <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co"># biov_calc</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(c(80, 360))</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co"># no diatom is what Pernice used.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Use <code>pgC_cell_MD_nodiatom</code> moving forward.</p>
<ol start="2" type="1">
<li>Get a summary pg per cell for vent and background samples. This is derived from biovolume estimates.</li>
</ol>
</section>
<section id="biomass-summaries" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="biomass-summaries"><span class="header-section-number">8.2</span> Biomass summaries</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>c_factor_biov <span class="ot">&lt;-</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  biov_calc <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>EXP, <span class="sc">-</span>h, <span class="sc">-</span>d) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(BIOVOLUME, <span class="fu">starts_with</span>(<span class="st">"pgC_"</span>)), <span class="at">names_to =</span> <span class="st">"VARIABLES"</span>, <span class="at">values_to =</span> <span class="st">"VALUES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW, VARIABLES) <span class="sc">%&gt;%</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(VALUES),</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(VALUES),</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VENT_BSW, <span class="at">values_from =</span> <span class="fu">c</span>(mean, max,min), <span class="at">names_sort =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'VENT_BSW'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(c_factor_biov)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>Assign a C conversion factor for background and within vents based on biovolume</li>
</ol>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pg C per cell (pgC_cell)</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_BSW</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_vent</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_BSW</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_vent</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_BSW</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_vent</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 109.1574</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 414.8068</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Combine with count table to estimate total standing stock in carbon</li>
</ol>
<p>Isolate at T0 all the euk cells per ml counts. Then add in the mean, min/max for the pg C per cell, based on the vent vs non-vent.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># counts_cellsml_avg</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pg C per ml = (cells per ml)*(pg C per)</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Apply the non-vent and vent pg C per cell value to total cells per ml</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW,</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent,</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_min =</span> <span class="fu">case_when</span>(</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_min,</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_min</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_max =</span> <span class="fu">case_when</span>(</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_max,</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_max</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Site           Experiment_rep           Name TimePoint EXP_TYPE   IGT_REP
1  Piccard    LotsOShrimp-Shipboard    LotsOShrimp        T0      Bag Shipboard
2  Piccard          Plume-Shipboard          Plume        T0      Bag Shipboard
3  Piccard Shrimpocalypse-Shipboard Shrimpocalypse        T0      Bag Shipboard
4  Piccard      Shrimpocalypse-IGT3 Shrimpocalypse        T0      IGT      IGT3
5  Piccard      Shrimpocalypse-IGT7 Shrimpocalypse        T0      IGT      IGT7
6       VD            BSW-Shipboard            BSW        T0      Bag Shipboard
7       VD   MustardStand-Shipboard   MustardStand        T0      Bag Shipboard
8       VD                 OMT-IGT4            OMT        T0      IGT      IGT4
9       VD                OMT-IGT4b            OMT        T0      IGT     IGT4b
10      VD          Plume-Shipboard          Plume        T0      Bag Shipboard
11      VD           Rav2-Shipboard           Rav2        T0      Bag Shipboard
12      VD                Rav2-IGT4           Rav2        T0      IGT      IGT4
13      VD               Rav2-IGT4b           Rav2        T0      IGT     IGT4b
14      VD                Rav2-IGT5           Rav2        T0      IGT      IGT5
15      VD               Rav2-IGT5b           Rav2        T0      IGT     IGT5b
16      VD     ShrimpHole-Shipboard     ShrimpHole        T0      Bag Shipboard
17      VD            X18-Shipboard            X18        T0      Bag Shipboard
   VARIABLE      MEAN        VAR        SD        SEM       MIN      MAX
1   eukCONC 230.90630         NA        NA         NA 230.90630 230.9063
2   eukCONC  79.30115   848.6444  29.13150  16.819081  55.97728 111.9546
3   eukCONC 454.81543         NA        NA         NA 454.81543 454.8154
4   eukCONC 384.84383         NA        NA         NA 384.84383 384.8438
5   eukCONC 524.78704         NA        NA         NA 524.78704 524.7870
6   eukCONC  91.83773   956.2550  30.92337  21.866127  69.97160 113.7039
7   eukCONC 259.76958  1666.1787  40.81885  28.863287 230.90630 288.6329
8   eukCONC 349.85802         NA        NA         NA 349.85802 349.8580
9   eukCONC 594.75864         NA        NA         NA 594.75864 594.7586
10  eukCONC 157.77468 13506.6620 116.21817  67.098589  55.97728 284.4007
11  eukCONC 409.33389 10795.7362 103.90253  73.470185 335.86370 482.8041
12  eukCONC 944.61667         NA        NA         NA 944.61667 944.6167
13  eukCONC 559.77284         NA        NA         NA 559.77284 559.7728
14  eukCONC 629.74444         NA        NA         NA 629.74444 629.7444
15  eukCONC 349.85802         NA        NA         NA 349.85802 349.8580
16  eukCONC 385.71847   123.9306  11.13241   7.871806 377.84667 393.5903
17  eukCONC 314.87222 22032.1147 148.43219 104.957407 209.91481 419.8296
   SAMPLE_TYPE_BIN pgC_ml_mean pgC_ml_min pgC_ml_max
1             Vent   95781.500  1216.6456  296465.66
2         Non-vent    8656.305  2241.3730   20432.20
3             Vent  188660.531  2396.4232  583947.52
4             Vent  159635.834  2027.7427  494109.44
5             Vent  217685.228  2765.1037  673785.60
6             Vent   38094.915   483.8932  117912.48
7             Vent  107754.188  1368.7263  333523.87
8             Vent  145123.485  1843.4025  449190.40
9             Vent  246709.925  3133.7842  763623.68
10        Non-vent   17222.270  4459.3540   40651.15
11            Vent  169794.478  2156.7809  525552.77
12            Vent  391833.410  4977.1867 1212814.08
13            Vent  232197.576  2949.4440  718704.64
14            Vent  261222.273  3318.1245  808542.72
15            Vent  145123.485  1843.4025  449190.40
16            Vent  159998.642  2032.3512  495232.42
17            Vent  130611.137  1659.0622  404271.36</code></pre>
</div>
</div>
<p>Table reports the total pg of carbon per ml when we consider the whole eukaryote community (based on cell count).</p>
<p>Report in pg of C per ml.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pgC_ml_mean))) <span class="sc">+</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (pgC_ml_min), <span class="at">ymax =</span> (pgC_ml_max))) <span class="sc">+</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - derived from biovolume"</span>)</span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>by_biovol_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="c-biomass-based-on-size-fraction" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="c-biomass-based-on-size-fraction"><span class="header-section-number">8.3</span> C biomass based on size fraction</h2>
<p>Derived from Caron et al.&nbsp;1995</p>
<ol type="1">
<li>Assign by size class</li>
</ol>
<p>Assuming conversion factor is 183 fg C per um.</p>
<p>For nanoplankton &lt;20um, picoplankton are included for now. We are assuming the size range of nanoplankton are 3um.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>vol_nano <span class="ot">&lt;-</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> pi <span class="sc">*</span> (<span class="dv">3</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>vol_nano <span class="co"># units are um^3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 113.0973</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>fg_nano_c <span class="ot">&lt;-</span> <span class="dv">183</span> <span class="sc">*</span> vol_nano <span class="co">#units are now fg per C</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>c_n <span class="ot">&lt;-</span> (fg_nano_c)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>c_n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.69681</code></pre>
</div>
</div>
<p>For microplankton, we are assuming the cell diameter is 50 um.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>vol_micr <span class="ot">&lt;-</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> pi <span class="sc">*</span> (<span class="dv">50</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>vol_micr <span class="co"># units are um^3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 523598.8</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>fg_micr_c <span class="ot">&lt;-</span> <span class="dv">183</span> <span class="sc">*</span> vol_micr <span class="co">#units are now fg per C</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>c_m <span class="ot">&lt;-</span> (fg_micr_c)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>c_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 95818.58</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>c_n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.69681</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>c_m <span class="sc">*</span> (<span class="fl">1e-6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09581858</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1pg to 1e-6ug</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample_tmp <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">!=</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> <span class="co"># isolate micro vs. nano</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_cell =</span> <span class="fu">case_when</span>(</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> c_m,</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> c_n</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiply mean cells per ml of micro and nano by pg C for each size fraction:</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_ml_TMP =</span> MEAN <span class="sc">*</span> pg_C_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Take the average of the micro and nano for each experiment.</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml_TMP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Experiment_rep', 'Site', 'Name',
'TimePoint', 'EXP_TYPE', 'IGT_REP', 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate total euk for each experiment by adding.</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add across micro and nano to get total</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pg_C_ml =</span> <span class="fu">sum</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">VARIABLE =</span> <span class="st">"totaleuk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Experiment_rep', 'Site', 'Name',
'TimePoint', 'EXP_TYPE', 'IGT_REP'. You can override using the `.groups`
argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp2, pgC_ml_sizefrac_bysample_tmp)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51 × 9
# Groups:   Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP [17]
   Experiment_rep Site  Name  TimePoint EXP_TYPE IGT_REP SAMPLE_TYPE_BIN pg_C_ml
   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
 1 BSW-Shipboard  VD    BSW   T0        Bag      Shipbo… Vent             1.90e3
 2 LotsOShrimp-S… Picc… Lots… T0        Bag      Shipbo… Vent             4.78e3
 3 MustardStand-… VD    Must… T0        Bag      Shipbo… Vent             5.38e3
 4 OMT-IGT4       VD    OMT   T0        IGT      IGT4    Vent             6.71e6
 5 OMT-IGT4b      VD    OMT   T0        IGT      IGT4b   Vent             1.34e7
 6 Plume-Shipboa… Picc… Plume T0        Bag      Shipbo… Non-vent         8.95e5
 7 Plume-Shipboa… VD    Plume T0        Bag      Shipbo… Non-vent         2.19e6
 8 Rav2-IGT4      VD    Rav2  T0        IGT      IGT4    Vent             1.96e4
 9 Rav2-IGT4b     VD    Rav2  T0        IGT      IGT4b   Vent             3.36e6
10 Rav2-IGT5      VD    Rav2  T0        IGT      IGT5    Vent             6.72e6
# ℹ 41 more rows
# ℹ 1 more variable: VARIABLE &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
  SAMPLE_TYPE_BIN VARIABLE  MEAN_pg_C_ml MAX_pg_C_ml MIN_pg_C_ml
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 Non-vent        microCONC     1542774.    2191604.     893944.
2 Non-vent        nanoCONC         2120.       2792.       1448.
3 Non-vent        totaleuk      1544894.    2194397.     895392.
4 Vent            microCONC     3559014.   13409159.          0 
5 Vent            nanoCONC         8180.      19551.       1901.
6 Vent            totaleuk      3567194.   13418572.       1901.</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>by_sizefrac_plot <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pg_C_ml))) <span class="sc">+</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> VARIABLE)) <span class="sc">+</span> </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_linerange(aes(ymin = (pgC_ml_min/1000), ymax = (pgC_ml_max/1000))) +</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - based on size fraction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Combined supplementary plot showing two routes of determining total biomass.</p>
</section>
<section id="figure-s3" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="figure-s3"><span class="header-section-number">8.4</span> Figure S3</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS3_new.svg", h = 8, w = 7)</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="sc">+</span> by_sizefrac_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-total-carbon-biomass---euks" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="compare-total-carbon-biomass---euks"><span class="header-section-number">8.5</span> Compare total carbon biomass - euks</h2>
<p>Compilation table of carbon biomass values for microeukaryotes by sample type and vent field</p>
<section id="table-s4" class="level3">
<h3 class="anchored" data-anchor-id="table-s4">Table S4</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass derived from biovolume, by vent field (vent only)</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>table4_cbiomass_total <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, EXP_TYPE, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, SAMPLE_TYPE_BIN, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'VARIABLE', 'Site', 'EXP_TYPE'. You can
override using the `.groups` argument.
`summarise()` has grouped output by 'VARIABLE', 'Site', 'SAMPLE_TYPE_BIN'. You
can override using the `.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table4_cbiomass_total</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(table4_cbiomass_total, <span class="at">file =</span> <span class="st">"output-data/tableS4-cbiomass.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compare-biovolumes-from-literature-to-measured-in-this-study" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="compare-biovolumes-from-literature-to-measured-in-this-study"><span class="header-section-number">8.6</span> Compare biovolumes from literature to measured in this study</h2>
<p>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10^7 µm^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</p>
<p>Import the heterotroph species volume and carbon content to compare to my measured values. Compare to md-lessard (Supplementary)</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># biov</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, <span class="at">Volume =</span> BIOVOLUME, <span class="at">pgC_cell =</span> pgC_cell_MD_nodiatom)) <span class="sc">%&gt;%</span> </span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>carbon_compare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_biov_bysample)</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(pgC_ml_biov_bysample)</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pgC_ml_mean, <span class="at">x =</span> SAMPLE_TYPE_BIN, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(.~FIELDORDER, space = "free", scales = "free") +</span></span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="384"></p>
</div>
</div>
</section>
</section>
<section id="carbon-biomass-for-prokaryotes" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Carbon biomass for prokaryotes</h1>
<p>Now, report estimated carbon per cell for bacteria.</p>
<p>Units: fg C per cell.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>bac_carbon_Mor_fg <span class="ot">&lt;-</span> (<span class="dv">86</span>) </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co">#From Derived from Morono et al. 2011 </span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>bac_carbon_Lof_fg <span class="ot">&lt;-</span> (<span class="dv">173</span>) </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Derived from McNichol et al. 2018; LOFERER-KROBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fg C per cell</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>bac_carbon_mean <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>bac_carbon_min <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>bac_carbon_max <span class="ot">&lt;-</span> <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Import main table with all estimates of cells</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs &lt;- read_delim(file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>RATE_min units = FLPs per grazer per minute Clearance rate _ml = ml per grazer per hour</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE,  <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, RATE_minute) <span class="sc">%&gt;%</span> </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in calcs by fg C per cell.</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimates of carbon pool of microbes per ml. </span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MOR_fgC_ml =</span> bac_carbon_Mor_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">LOF_fgC_ml =</span> bac_carbon_Lof_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">MEAN_fgC_ml =</span> bac_carbon_mean <span class="sc">*</span> PROK_ml,</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_fgC_ml =</span> bac_carbon_max <span class="sc">*</span> PROK_ml,</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_fgC_ml =</span> bac_carbon_min <span class="sc">*</span> PROK_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"fgC_ml"</span>), <span class="at">names_to =</span> <span class="st">"prokC_category"</span>, <span class="at">values_to =</span> <span class="st">"fgC_ml"</span>)</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get summary of prokaryotic biomass</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, prokC_category) <span class="sc">%&gt;%</span> </span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 fg == 0.001 pg</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to pg C per ml</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pgC_ml =</span> <span class="fu">mean</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_pgC_ml =</span> <span class="fu">min</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_pgC_ml =</span> <span class="fu">max</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE_TYPE_BIN'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
# Groups:   SAMPLE_TYPE_BIN [2]
   SAMPLE_TYPE_BIN prokC_category mean_pgC_ml min_pgC_ml max_pgC_ml
   &lt;chr&gt;           &lt;chr&gt;                &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Non-vent        LOF_fgC_ml           6101.      2851.      8897.
 2 Non-vent        MAX_fgC_ml            705.       330.      1029.
 3 Non-vent        MEAN_fgC_ml           529.       247.       771.
 4 Non-vent        MIN_fgC_ml            353.       165.       514.
 5 Non-vent        MOR_fgC_ml           3033.      1417.      4423.
 6 Vent            LOF_fgC_ml          19884.      7263.     41276.
 7 Vent            MAX_fgC_ml           2299.       840.      4772.
 8 Vent            MEAN_fgC_ml          1724.       630.      3579.
 9 Vent            MIN_fgC_ml           1149.       420.      2386.
10 Vent            MOR_fgC_ml           9885.      3611.     20519.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="incorporate-carbon-biomass-of-prey-and-grazing-rate" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="incorporate-carbon-biomass-of-prey-and-grazing-rate"><span class="header-section-number">9.1</span> Incorporate carbon biomass of prey and grazing rate</h2>
<p>Clearance rate is mL per grazer per hour (Table S3). Grazing effect is prokaryotes ml-1 hr-1 (Table S3).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon consumed based on clearance rate</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="ot">&lt;-</span> est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use only value from Morono et al., convert to pg C per cell.</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prokC_category <span class="sc">==</span> <span class="st">"MOR_fgC_ml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_carbon_Mor_pg =</span> (bac_carbon_Mor_fg <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE, PROK_ml, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, bac_carbon_Mor_pg, fgC_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clearance rate * fg of prok == pg C per grazer per hr</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bac_carbon_Mor_pg * grazing effect == pg C per ml per hr</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_pergrazer_CLEARANCE =</span> (fgC_ml<span class="sc">*</span><span class="fl">0.001</span>) <span class="sc">*</span> CLEARANCE_RATE_ml,</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_perml_perhr =</span> bac_carbon_Mor_pg <span class="sc">*</span> GRAZING_EFFECT_hr)</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>carbon_consumed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 11
   SiteOrder NameOrder      FLUID_ORIGIN CRUISE_SAMPLE PROK_ml GRAZING_EFFECT_hr
   &lt;fct&gt;     &lt;fct&gt;          &lt;chr&gt;        &lt;chr&gt;           &lt;dbl&gt;             &lt;dbl&gt;
 1 Piccard   Lots 'O Shrimp J2-1241      LV24           53878                0  
 2 Piccard   Plume          CTD004       Niskin 10      51429               44.3
 3 Piccard   Shrimpocalypse J2-1240      LV13          238590             6007. 
 4 Von Damm  Background     CTD002       Niskins 8-10   37890              127. 
 5 Von Damm  Mustard Stand  J2-1243      LV17           56677                0  
 6 Von Damm  Plume          CTD001       Niskin 2       16478               24.0
 7 Von Damm  Ravelin #2     J2-1238      LV13a          71147.             117. 
 8 Von Damm  Shrimp Hole    J2-1244      LV13           41983                0  
 9 Von Damm  X-18           J2-1235      LV23 &amp; Bio5   111430             1166. 
10 Piccard   Shrimpocalypse J2-1240      IGT3          238590            17285. 
11 Von Damm  Old Man Tree   J2-1238      IGT4           71147.            1050. 
12 Von Damm  Ravelin #2     J2-1244      IGT4           71147.           15867. 
13 Von Damm  Ravelin #2     J2-1244      IGT5           71147.               0  
14 &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;         &lt;NA&gt;          238590               NA  
# ℹ 5 more variables: CLEARANCE_RATE_ml &lt;dbl&gt;, bac_carbon_Mor_pg &lt;dbl&gt;,
#   fgC_ml &lt;dbl&gt;, pgC_pergrazer_CLEARANCE &lt;dbl&gt;, pgC_perml_perhr &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="environmental-parameters---mcr" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Environmental parameters - MCR</h1>
<p>Import from Hu et al.&nbsp;(<em>Molecular Ecology</em>).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"num"</span>, <span class="st">"loc"</span>, <span class="st">"loc2"</span>, <span class="st">"fluid_origin"</span>, <span class="st">"name"</span>, <span class="st">"FLUID_ORIGIN"</span>, <span class="st">"else"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE,FLUID_ORIGIN, <span class="fu">everything</span>(), <span class="sc">-</span>num, <span class="sc">-</span>loc, <span class="sc">-</span>loc2, <span class="sc">-</span>fluid_origin, <span class="sc">-</span>name, <span class="sc">-</span><span class="st">`</span><span class="at">else</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 7 pieces. Additional pieces discarded in 16 rows [2, 3, 4, 5, 6, 7, 8,
9, 10, 11, 12, 13, 14, 15, 16, 17].</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 7 pieces. Missing pieces filled with `NA` in 1 rows [1].</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate supplementary table.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc, <span class="fu">everything</span>())</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis-of-grazing-rate-results" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Analysis of grazing rate results</h1>
<p>Re-import table from output table with all grazing values</p>
<p>Format and factor values to plot, and prioritize these values:</p>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
<li>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</li>
</ul>
<p>Report grazing rates</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_biov_bysample)</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_sizefrac_bysample)</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="co"># save(table_grazerate_wflp_wprok_weuk, table_wcalcs, pgC_ml_biov_bysample, pgC_ml_sizefrac_bysample, carbon_consumed, file = "output-data/processed-dfs-mcr-grazing.RData")</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load("output-data/processed-dfs-mcr-grazing.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot grazing rates</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="box-plots-grazing-rate" class="level3">
<h3 class="anchored" data-anchor-id="box-plots-grazing-rate">Box plots: Grazing rate</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>boxplot_rate_site <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SAMPLE_TYPE_BIN, <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">color =</span> SiteOrder, <span class="at">fill =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder) <span class="sc">+</span></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>boxplot_rate_exp <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exptype, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> exptype)) <span class="sc">+</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">19</span>)) <span class="sc">+</span> </span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(.~SiteOrder) +</span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="figure-1-compilation" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Figure 1 compilation</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig1.svg", w = 10, h = 8)</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  grazing_min_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (grazing_min_plot + theme(legend.position = "none") + scale_y_continuous(limits = c(0, 0.02))) +</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  (grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="960"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig1-revisions.svg", w = 11, h = 6)</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>(boxplot_eukcell_site <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> </span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  (boxplot_rate_site <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  (boxplot_eukcell_exp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> </span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  (boxplot_rate_exp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>     patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="1056"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="grazing-rate-vs.-cells-ml" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="grazing-rate-vs.-cells-ml"><span class="header-section-number">12.1</span> Grazing rate vs.&nbsp;cells ml</h2>
<p>Combine metadata from environment with grazing rate results.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify fluid origin to match metadata and results</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>mod_metadata <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID"</span>, <span class="st">"HOG"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID2"</span>, <span class="st">"excess"</span>), <span class="at">sep =</span> <span class="st">"J2"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(excess, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID3"</span>, <span class="st">"hogexcess"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLUID_ORIGIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>    FLUID2 <span class="sc">==</span> <span class="st">"CTD003"</span> <span class="sc">~</span> <span class="st">"CTD001"</span>, <span class="co">#Correction for plume VD</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(FLUID3) <span class="sc">~</span> FLUID2,</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"J2-"</span>, FLUID3, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FLUID, <span class="sc">-</span>FLUID2, <span class="sc">-</span>FLUID3, <span class="sc">-</span>HOG, <span class="sc">-</span>excess, <span class="sc">-</span>hogexcess) <span class="sc">%&gt;%</span> </span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">case_when</span>(</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>    VENT <span class="sc">==</span> <span class="st">"OldManTree"</span> <span class="sc">~</span> <span class="st">"OMT"</span>,</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> VENT</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Missing pieces filled with `NA` in 4 rows [1, 2, 6, 7].
Expected 2 pieces. Missing pieces filled with `NA` in 4 rows [1, 2, 6, 7].</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(table_wcalcs$Name)</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mod_metadata</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># setdiff(mod_metadata$FLUID_ORIGIN, table_wcalcs$FLUID_ORIGIN)</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, Name, Experiment_rep, FLUID_ORIGIN, RATE_minute, <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT"</span>), CLEARANCE_RATE_ml, SPEC_GRAZE_RATE_hr, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mod_metadata, <span class="fu">join_by</span>(Name <span class="sc">==</span> Name, FLUID_ORIGIN <span class="sc">==</span> FLUID_ORIGIN))</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(grazing_wenv)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_metadata)</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, </span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(shape = EXP_TYPE), size = 4, stroke = 2) +</span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb193-21"><a href="#cb193-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb193-22"><a href="#cb193-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb193-23"><a href="#cb193-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb193-24"><a href="#cb193-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb193-25"><a href="#cb193-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb193-26"><a href="#cb193-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb193-27"><a href="#cb193-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb193-28"><a href="#cb193-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb193-29"><a href="#cb193-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb193-30"><a href="#cb193-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb193-31"><a href="#cb193-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb193-32"><a href="#cb193-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb193-33"><a href="#cb193-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb193-34"><a href="#cb193-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb193-35"><a href="#cb193-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb193-36"><a href="#cb193-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb193-37"><a href="#cb193-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-38"><a href="#cb193-38" aria-hidden="true" tabindex="-1"></a>euk_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_errorbarh()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, </span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span> </span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(1, 19)) +</span></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Microbial prey cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>prok_temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_errorbarh()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="figure-2-compilation" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Figure 2 compilation</h1>
<div class="cell" data-warnings="false">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fig2 &lt;- (euk_temp + labs(x = "") + theme(legend.position = "none")) + prok_temp + patchwork::plot_layout(ncol = 1) + patchwork::plot_annotation(tag_levels = "a")</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2.svg", h = 10, w = 7)</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fig2</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2-a.svg", h = 5, w = 7)</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_temp</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2-b.svg", h = 5, w = 7)</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="co"># prok_temp</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="comparison-with-gorda-ridge" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Comparison with Gorda Ridge</h1>
<p>Import data from Gorda Ridge</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mcr_graze)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14
Columns: 38
$ Experiment_rep        &lt;chr&gt; "LotsOShrimp-Shipboard", "Plume-Shipboard", "Shr…
$ FIELD                 &lt;chr&gt; "Piccard", "Piccard", "Piccard", "VD", "VD", "VD…
$ Name                  &lt;chr&gt; "LotsOShrimp", "Plume", "Shrimpocalypse", "BSW",…
$ SiteOrder             &lt;chr&gt; "Piccard", "Piccard", "Piccard", "Von Damm", "Vo…
$ NameOrder             &lt;chr&gt; "Lots 'O Shrimp", "Plume", "Shrimpocalypse", "Ba…
$ FLUID_ORIGIN          &lt;chr&gt; "J2-1241", "CTD004", "J2-1240", "CTD002", "J2-12…
$ CRUISE_SAMPLE         &lt;chr&gt; "LV24", "Niskin 10", "LV13", "Niskins 8-10", "LV…
$ RATE                  &lt;dbl&gt; -0.007605829, 0.005362856, 0.015686872, 0.002958…
$ RATE_minute           &lt;dbl&gt; 0.000000000, 0.005362856, 0.015686872, 0.0029588…
$ FLP_ml                &lt;dbl&gt; 617.1496, 29650.4676, 17003.1000, 4861.8239, 660…
$ TimePoints            &lt;chr&gt; "0, 15, 20, 40", "0, 10, 15, 20, 40", "0, 10, 14…
$ EXP_REPS              &lt;int&gt; 3, 3, 3, 3, 2, 3, 3, 2, 2, 1, 1, 1, 1, NA
$ EXP_VOL               &lt;dbl&gt; 1.50, 2.00, 1.50, 2.00, 1.50, 2.00, 1.50, 1.50, …
$ CTRL_REPS             &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, NA, NA, NA, NA
$ CTRL_VOL              &lt;dbl&gt; 0.2, 0.5, 0.2, 0.5, 0.2, 1.0, 0.5, 0.2, 0.5, NA,…
$ SITE_TYPE             &lt;chr&gt; "Piccard-Shipboard", "Piccard-Shipboard", "Picca…
$ Experiment            &lt;chr&gt; "LotsOShrimp-Shipboard", "Plume-Shipboard", "Shr…
$ VARIABLE              &lt;chr&gt; "eukCONC", "eukCONC", "eukCONC", "eukCONC", "euk…
$ EUK_ml                &lt;dbl&gt; 230.910, 79.301, 454.820, 91.838, 259.770, 157.7…
$ EUK_MinMax            &lt;chr&gt; "230.9 / 230.9", "55.98 / 112", "454.8 / 454.8",…
$ EUK_sem               &lt;dbl&gt; NA, 16.819081, NA, 21.866127, 28.863287, 67.0985…
$ PROK_ml               &lt;dbl&gt; 53878.0, 51429.0, 238590.0, 37890.0, 56677.0, 16…
$ PROK_MinMax           &lt;chr&gt; "26240 / 90260", "46810 / 56050", "108700 / 3220…
$ PROK_sem              &lt;dbl&gt; 13727.191, 4618.126, 65792.588, 8608.427, 14274.…
$ RATE_hr               &lt;dbl&gt; 0.0000000, 0.3217713, 0.9412123, 0.1775333, 0.00…
$ RATE_day              &lt;dbl&gt; 0.000000, 7.722512, 22.589096, 4.260800, 0.00000…
$ FLP_L                 &lt;dbl&gt; 617149.6, 29650467.6, 17003100.0, 4861823.9, 660…
$ CLEARANCE_RATE_ml     &lt;dbl&gt; 0.000000e+00, 1.085215e-05, 5.535534e-05, 3.6515…
$ CLEARANCE_RATE_nL     &lt;dbl&gt; 0.000000e+00, 1.085215e-11, 5.535534e-11, 3.6515…
$ SPEC_GRAZE_RATE_hr    &lt;dbl&gt; 0.0000000, 0.5581153, 13.2072298, 1.3835832, 0.0…
$ GRAZE_RATE_DAY        &lt;dbl&gt; 0.000000, 13.394766, 316.973515, 33.205997, 0.00…
$ GRAZING_EFFECT_hr     &lt;dbl&gt; 0.00000, 44.25910, 6006.91224, 127.06552, 0.0000…
$ GRAZING_EFFECT_hr_min &lt;dbl&gt; NA, 34.87211, NA, 96.81191, 0.00000, 13.80771, 9…
$ GRAZING_EFFECT_hr_max &lt;dbl&gt; NA, 53.64608, NA, 157.31912, 0.00000, 34.24365, …
$ GRAZING_EFFECT_day    &lt;dbl&gt; 0.0000, 1062.2184, 144165.8939, 3049.5724, 0.000…
$ BAC_TURNOVER_PERC     &lt;dbl&gt; 0.000000, 2.065407, 60.424114, 8.048489, 0.00000…
$ BAC_TURNOVER_PERC_min &lt;dbl&gt; 0.000000, 2.269170, 83.430586, 10.414647, 0.0000…
$ BAC_TURNOVER_PERC_max &lt;dbl&gt; 0.000000, 1.895224, 47.363384, 6.558442, 0.00000…</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5
Columns: 42
$ SAMPLE                &lt;chr&gt; "BW-Near vent BW", "Vent-Mt Edwards", "Vent-Vent…
$ SampleOrigin          &lt;chr&gt; "BW", "Vent", "Vent", "Vent", "Vent"
$ Bottle                &lt;chr&gt; "Exp", "Exp", "Exp", "Exp", "Exp"
$ Vent.name             &lt;chr&gt; "Near vent BW", "Mt Edwards", "Venti latte", "Ca…
$ SAMPLE_ORDER          &lt;chr&gt; "Near vent BW", "Mt. Edwards", "Venti latte", "C…
$ BOTTLE                &lt;chr&gt; "Experimental", "Experimental", "Experimental", …
$ cellmL_T0             &lt;dbl&gt; 69818.95, 60381.13, 45154.57, 25622.60, 27985.33
$ cellmL_Tf             &lt;dbl&gt; 57808.35, 40639.10, 32448.30, 14701.50, 10606.10
$ sem_T0                &lt;dbl&gt; 6594.5107, 4786.6367, 670.3404, 3964.4107, 5055.…
$ sem_Tf                &lt;dbl&gt; 472.550, 4095.400, 5670.600, 3079.078, 4108.875
$ Hrs_Tf                &lt;int&gt; 35, 24, 19, 26, 18
$ Sample.location       &lt;chr&gt; "BW", "Vent", "Vent", "Vent", "Vent"
$ prok_avg              &lt;dbl&gt; 51959.11, 51439.52, 111192.50, 55076.66, 52998.29
$ MORTALITY             &lt;dbl&gt; 0.1294438, 0.3959460, 0.4174021, 0.5127925, 1.29…
$ MORTALITY_min         &lt;dbl&gt; 0.06703935, 0.41957541, 0.64113500, 0.57456692, …
$ MORTALITY_max         &lt;dbl&gt; 0.1857493, 0.3762200, 0.2325695, 0.4700572, 1.07…
$ G                     &lt;dbl&gt; 8938.263, 16818.511, 31289.007, 23475.280, 32912…
$ G_min                 &lt;dbl&gt; 4839.402, 17626.994, 44259.125, 25520.903, 37981…
$ G_max                 &lt;dbl&gt; 12329.66, 16128.80, 18698.35, 21977.85, 29395.13
$ GrazingRate_hr        &lt;dbl&gt; 255.3789, 700.7713, 1646.7899, 902.8954, 1828.47…
$ GrazingRate_hr_min    &lt;dbl&gt; 138.2686, 734.4581, 2329.4276, 981.5732, 2110.06…
$ GrazingRate_hr_max    &lt;dbl&gt; 352.2759, 672.0331, 984.1237, 845.3019, 1633.0627
$ Prok_turnover         &lt;dbl&gt; 17.20249, 32.69570, 28.13949, 42.62292, 62.10122
$ Prok_turnover_min     &lt;dbl&gt; 9.313866, 34.267415, 39.804056, 46.337057, 71.66…
$ Prok_turnover_max     &lt;dbl&gt; 23.72954, 31.35487, 16.81620, 39.90411, 55.46429
$ N_avg                 &lt;dbl&gt; 51959.11, 51439.52, 111192.50, 55076.66, 52998.29
$ F_avg                 &lt;dbl&gt; 63813.65, 50510.12, 38801.43, 20162.05, 19295.72
$ q                     &lt;dbl&gt; 0.1882137, 0.3908531, 0.3274690, 0.5416662, 0.90…
$ G_II_a                &lt;dbl&gt; 9779.414, 20105.294, 36412.097, 29833.162, 47734…
$ G_II_b                &lt;dbl&gt; 9779.414, 20105.294, 36412.097, 29833.162, 47734…
$ GrazingRate_hr_II     &lt;dbl&gt; 279.4118, 837.7206, 1916.4262, 1147.4293, 2651.9…
$ fgC_cell_morono       &lt;int&gt; 86, 86, 86, 86, 86
$ fgC_cell_mcnic        &lt;int&gt; 173, 173, 173, 173, 173
$ cells_consumed_perday &lt;dbl&gt; 6129.094, 16818.511, 39522.957, 21669.489, 43883…
$ fgC_ml_perday_morono  &lt;dbl&gt; 527102.1, 1446391.9, 3398974.3, 1863576.1, 37739…
$ fgC_ml_perday_mcnic   &lt;dbl&gt; 1060333, 2909602, 6837471, 3748822, 7591837
$ ugC_L_perday_morono   &lt;dbl&gt; 0.5271021, 1.4463919, 3.3989743, 1.8635761, 3.77…
$ ugC_L_perday_mcnic    &lt;dbl&gt; 1.060333, 2.909602, 6.837471, 3.748822, 7.591837
$ lower_mcnichol_morono &lt;dbl&gt; 3.046833, 8.360647, 19.647250, 10.772116, 21.814…
$ upper_mcnichol_morono &lt;dbl&gt; 0.1640019, 0.4500286, 1.0575527, 0.5798308, 1.17…
$ lower_mcnichol_mcnic  &lt;dbl&gt; 6.129094, 16.818511, 39.522957, 21.669489, 43.88…
$ upper_mcnichol_mcnic  &lt;dbl&gt; 0.3299108, 0.9052901, 2.1274025, 1.1664037, 2.36…</code></pre>
</div>
</div>
<section id="combine-gr-and-mcr-data" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="combine-gr-and-mcr-data"><span class="header-section-number">14.1</span> Combine GR and MCR data</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SAMPLE, FIELD, Name, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> NameOrder, SAMPLE, <span class="at">EXP =</span> CRUISE_SAMPLE, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span> </span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover)) <span class="sc">%&gt;%</span> </span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(NAME, SAMPLE)`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., temps): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 1 of `x` matches multiple rows in `y`.
ℹ Row 5 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-combined-results" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="plot-combined-results"><span class="header-section-number">14.2</span> Plot combined results</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPERIMENTTYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>    EXP <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EXPERIMENTTYPE, FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE)) <span class="sc">+</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE),</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#addd8e"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb208-28"><a href="#cb208-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb208-31"><a href="#cb208-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb208-32"><a href="#cb208-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb208-33"><a href="#cb208-33" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb208-34"><a href="#cb208-34" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_fill_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb208-35"><a href="#cb208-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("#E76F51", "#264653")) +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add Gorda Ridge comparison to supplementary?</p>
<section id="figure-s8" class="level4">
<h4 class="anchored" data-anchor-id="figure-s8">Figure S8</h4>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7.svg", h = 4, w = 6)</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="576"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7.svg", h = 4, w = 6)</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="576"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPERIMENTTYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>    EXP <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EXPERIMENTTYPE, FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SAMPLE_TYPE == "Vent" ) %&gt;% </span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (GRAZING_EFFECT_hr_max), ymin = (GRAZING_EFFECT_hr_min)), </span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># width = 0.2, position = position_dodge(width = 0.4), color = "black") +</span></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> FIELD),</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#addd8e"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb216-32"><a href="#cb216-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb216-33"><a href="#cb216-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb216-34"><a href="#cb216-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="384"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_fill_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("#E76F51", "#264653")) +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="remove-undetected-grazing-rate" class="level3">
<h3 class="anchored" data-anchor-id="remove-undetected-grazing-rate">Remove undetected grazing rate</h3>
<p>Repeat grazing rate plot, but removed undetectable</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="plot-variables-as-a-factor-of-grazing-rate." class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="plot-variables-as-a-factor-of-grazing-rate."><span class="header-section-number">14.3</span> Plot variables as a factor of grazing rate.</h2>
<section id="figure-s7" class="level5">
<h5 class="anchored" data-anchor-id="figure-s7">Figure S7</h5>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6.svg", h = 8, w = 10)</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EUK_ml =</span> <span class="fu">as.character</span>(EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">as.character</span>(PROK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.character</span>(temp),</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pH =</span> <span class="fu">as.character</span>(pH),</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">mg =</span> <span class="fu">as.character</span>(mg),</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">h2 =</span> <span class="fu">as.character</span>(h2),</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">ch4 =</span> <span class="fu">as.character</span>(ch4),</span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">percseawater =</span> <span class="fu">as.character</span>(percseawater)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE_TYPE, SiteOrder, EXP_TYPE, Experiment_rep, GRAZING_EFFECT_hr, EUK_ml, PROK_ml, temp, DEPTH, pH, percseawater, mg, h2, ch4) <span class="sc">%&gt;%</span> </span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> EUK_ml<span class="sc">:</span>ch4, <span class="at">values_to =</span> <span class="st">"VALUES"</span>, <span class="at">values_ptypes =</span> <span class="fu">list</span>(<span class="at">VALUES =</span> <span class="fu">character</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VALUES =</span> <span class="fu">as.numeric</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> VALUES, </span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="960"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>grazing_wenv_forLM <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(Name == "Shrimpocalypse" &amp; grepl("IGT", Experiment_rep))) %&gt;%</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EUK_ml =</span> <span class="fu">as.character</span>(EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">as.character</span>(PROK_ml),</span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">PROK_EUK_RATIO =</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(PROK_ml)<span class="sc">/</span><span class="fu">as.numeric</span>(EUK_ml))) <span class="sc">%&gt;%</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.character</span>(temp),</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">pH =</span> <span class="fu">as.character</span>(pH),</span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">mg =</span> <span class="fu">as.character</span>(mg),</span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">h2 =</span> <span class="fu">as.character</span>(h2),</span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">ch4 =</span> <span class="fu">as.character</span>(ch4),</span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">percseawater =</span> <span class="fu">as.character</span>(percseawater)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE_TYPE, SiteOrder, EXP_TYPE, Experiment_rep, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, SPEC_GRAZE_RATE_hr, BAC_TURNOVER_PERC, EUK_ml, PROK_ml, PROK_EUK_RATIO, temp, DEPTH, pH, percseawater, mg, h2, ch4) <span class="sc">%&gt;%</span> </span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, SPEC_GRAZE_RATE_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, temp, DEPTH, pH, percseawater, mg, h2, ch4, PROK_EUK_RATIO), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> grazing_wenv_forLM <span class="sc">%&gt;%</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PARAMS_VALUE =</span> <span class="fu">as.numeric</span>(PARAMS_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS)) <span class="sc">%&gt;%</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS,</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>regression_results_S8 <span class="ot">&lt;-</span> grazing_wenv_forLM <span class="sc">%&gt;%</span></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS)) <span class="sc">%&gt;%</span></span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(grazing_wenv_forLM) <span class="sc">%&gt;%</span></span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(RATE, PARAMS)`
Joining with `by = join_by(RATE, PARAMS)`</code></pre>
</div>
</div>
<p>Supplementary Table</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>regression_results_TABLE <span class="ot">&lt;-</span> regression_results_S8 <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared, SLOPE) <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(regression_results_TABLE, file = "output-data/LM-results-table.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6.svg", h = 8, w = 10)</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>grazing_for_supp <span class="ot">&lt;-</span> regression_results_S8</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co"># y = mx+b</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 = slope (x) + b</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="co"># solve for b</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>plot_r2 <span class="ot">&lt;-</span> grazing_for_supp <span class="sc">%&gt;%</span> </span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(RATE_VALUE), <span class="at">y =</span> <span class="fu">as.numeric</span>(PARAMS_VALUE), </span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> PARAMS <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb230-23"><a href="#cb230-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb230-24"><a href="#cb230-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb230-25"><a href="#cb230-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb230-26"><a href="#cb230-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb230-27"><a href="#cb230-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb230-28"><a href="#cb230-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-29"><a href="#cb230-29" aria-hidden="true" tabindex="-1"></a>plot_wslope <span class="ot">&lt;-</span> grazing_for_supp <span class="sc">%&gt;%</span> </span>
<span id="cb230-30"><a href="#cb230-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">b =</span> (SLOPE)<span class="sc">*</span>(<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb230-31"><a href="#cb230-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_xint =</span> ((<span class="dv">0</span> <span class="sc">-</span> b)<span class="sc">/</span>SLOPE)) <span class="sc">%&gt;%</span> </span>
<span id="cb230-32"><a href="#cb230-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">new_xint_2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb230-33"><a href="#cb230-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> (<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>)<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb230-34"><a href="#cb230-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> (<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>),</span>
<span id="cb230-35"><a href="#cb230-35" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb230-36"><a href="#cb230-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(PARAMS_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb230-37"><a href="#cb230-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(RATE_VALUE), <span class="at">y =</span> <span class="fu">as.numeric</span>(PARAMS_VALUE), </span>
<span id="cb230-38"><a href="#cb230-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb230-39"><a href="#cb230-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb230-40"><a href="#cb230-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> PARAMS <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb230-41"><a href="#cb230-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb230-42"><a href="#cb230-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() +</span></span>
<span id="cb230-43"><a href="#cb230-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_log10() +</span></span>
<span id="cb230-44"><a href="#cb230-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="fu">log10_trans</span>(),</span>
<span id="cb230-45"><a href="#cb230-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb230-46"><a href="#cb230-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb230-47"><a href="#cb230-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> (SLOPE), <span class="at">intercept =</span> (<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb230-48"><a href="#cb230-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_abline(aes(slope = (SLOPE), yintercept = (b)), color = "black", linetype = "dashed", size = 0.5) +</span></span>
<span id="cb230-49"><a href="#cb230-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb230-50"><a href="#cb230-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb230-51"><a href="#cb230-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb230-52"><a href="#cb230-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb230-53"><a href="#cb230-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb230-54"><a href="#cb230-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb230-55"><a href="#cb230-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb230-56"><a href="#cb230-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb230-57"><a href="#cb230-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb230-58"><a href="#cb230-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb230-59"><a href="#cb230-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb230-60"><a href="#cb230-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb230-61"><a href="#cb230-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb230-62"><a href="#cb230-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-63"><a href="#cb230-63" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_wslope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="figure-s7-2" class="level3">
<h3 class="anchored" data-anchor-id="figure-s7-2">Figure S7 #2</h3>
<p>Supplementary figure</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7_log.svg", h = 8, w = 16)</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_r2</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7_slope.svg", h = 8, w = 16)</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_wslope</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="linear-regression-tidy-models" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Linear regression &amp; tidy models</h1>
<p>Use tidymodels to perform linear regression.</p>
<section id="mcr-and-gr-data-as-input" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="mcr-and-gr-data-as-input"><span class="header-section-number">15.1</span> MCR and GR data as input</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_input &lt;- all_vents %&gt;%</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;%</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Highest.Temp)) %&gt;%</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, TEMP = Highest.Temp) %&gt;%</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(PROK_EUK_RATIO = (PROK_ml/EUK_ml)) %&gt;%</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = c(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), names_to = "RATE", values_to = "RATE_VALUE") %&gt;%</span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = c(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), names_to = "PARAMS", values_to = "PARAMS_VALUE") %&gt;%</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_tmp &lt;- regression_input %&gt;%</span></span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Set up the linear regression</span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(RATE, PARAMS) %&gt;%</span></span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   nest(-RATE, -PARAMS) %&gt;%</span></span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(lm_fit = map(data, ~lm(RATE_VALUE ~ PARAMS_VALUE, data = .)),</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     tidied = map(lm_fit, tidy)) %&gt;%</span></span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   unnest(tidied) %&gt;%</span></span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(RATE, PARAMS,</span></span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     term, estimate) %&gt;%</span></span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(names_from = term, values_from = estimate) %&gt;%</span></span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(everything(), SLOPE = PARAMS_VALUE) %&gt;%</span></span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_results &lt;- regression_input %&gt;%</span></span>
<span id="cb232-28"><a href="#cb232-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(RATE, PARAMS) %&gt;%</span></span>
<span id="cb232-29"><a href="#cb232-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   nest(-RATE, -PARAMS) %&gt;%</span></span>
<span id="cb232-30"><a href="#cb232-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(lm_fit = map(data, ~lm(RATE_VALUE ~ PARAMS_VALUE, data = .)),</span></span>
<span id="cb232-31"><a href="#cb232-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     glanced = map(lm_fit, glance)) %&gt;%</span></span>
<span id="cb232-32"><a href="#cb232-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   unnest(glanced) %&gt;%</span></span>
<span id="cb232-33"><a href="#cb232-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(RATE, PARAMS, r.squared, adj.r.squared) %&gt;%</span></span>
<span id="cb232-34"><a href="#cb232-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   right_join(regression_tmp) %&gt;%</span></span>
<span id="cb232-35"><a href="#cb232-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   right_join(regression_input) %&gt;%</span></span>
<span id="cb232-36"><a href="#cb232-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb232-37"><a href="#cb232-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-38"><a href="#cb232-38" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_results %&gt;%</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(PARAMS == "TEMP") %&gt;%</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = PARAMS_VALUE, y = RATE_VALUE, shape = SAMPLE_TYPE, fill = FIELD)) +</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_abline(aes(slope = SLOPE, intercept = `X.Intercept.`), color = "black", linetype = "dashed", size = 0.5) +</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(color = "black", aes(shape = SAMPLE_TYPE, fill = FIELD)) +</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_shape_manual(values = c(21, 24)) +</span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_fill_manual(values = c("#476AA7","#7299CE", "#A2937A")) +</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     facet_wrap(PARAMS ~ RATE + round(r.squared, 3), scales = "free", ncol = 5,</span></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              strip.position = "bottom", labeller = label_parsed) +</span></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     strip.background = element_blank(),</span></span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     strip.placement = "outside",</span></span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     strip.text = element_text(color = "black", size = 10),</span></span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     axis.title = element_text(color = "black", size = 10),</span></span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend.title = element_blank()) # +</span></span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a><span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mcr-only" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="mcr-only"><span class="header-section-number">15.2</span> MCR only</h2>
<p>repeat MCR only</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(regression_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    FIELD           NAME              SAMPLE SAMPLE_TYPE  EXP              RATE
1 Piccard Lots 'O Shrimp Piccard-LotsOShrimp        Vent LV24 GRAZING_EFFECT_hr
2 Piccard Lots 'O Shrimp Piccard-LotsOShrimp        Vent LV24 GRAZING_EFFECT_hr
3 Piccard Lots 'O Shrimp Piccard-LotsOShrimp        Vent LV24 GRAZING_EFFECT_hr
4 Piccard Lots 'O Shrimp Piccard-LotsOShrimp        Vent LV24 GRAZING_EFFECT_hr
5 Piccard Lots 'O Shrimp Piccard-LotsOShrimp        Vent LV24 BAC_TURNOVER_PERC
6 Piccard Lots 'O Shrimp Piccard-LotsOShrimp        Vent LV24 BAC_TURNOVER_PERC
  RATE_VALUE         PARAMS PARAMS_VALUE
1          0        PROK_ml    53878.000
2          0         EUK_ml      230.910
3          0 PROK_EUK_RATIO      233.329
4          0           TEMP       36.000
5          0        PROK_ml    53878.000
6          0         EUK_ml      230.910</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(RATE, PARAMS)`
Joining with `by = join_by(RATE, PARAMS)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_mcr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="sc">%&gt;%</span> </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mcr-vent-sites-only" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="mcr-vent-sites-only"><span class="header-section-number">15.3</span> MCR vent sites only</h2>
<p>Repeat with only vent sites &amp; remove undetected grazing.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$GRAZING_EFFECT_hr)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Background"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Plume"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb245-21"><a href="#cb245-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb245-22"><a href="#cb245-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb245-23"><a href="#cb245-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb245-24"><a href="#cb245-24" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb245-25"><a href="#cb245-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb245-26"><a href="#cb245-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb245-27"><a href="#cb245-27" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Supplying `...` without names was deprecated in tidyr 1.0.0.
ℹ Please specify a name for each selection.
ℹ Did you want `data = c(-RATE, -PARAMS)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(RATE, PARAMS)`
Joining with `by = join_by(RATE, PARAMS)`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_vent)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot results from regression</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="sc">%&gt;%</span> </span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Regression thoughts</em>: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</p>
<p>Bacterial abundance typically increases with temperature (White et al.&nbsp;1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</p>
<p>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature… in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    FIELD           NAME                 SAMPLE          EXP PROK_ml  EUK_ml
1 Piccard Lots 'O Shrimp    Piccard-LotsOShrimp         LV24   53878 230.910
2 Piccard Lots 'O Shrimp    Piccard-LotsOShrimp         LV24   53878 230.910
3 Piccard          Plume          Piccard-Plume    Niskin 10   51429  79.301
4 Piccard Shrimpocalypse Piccard-Shrimpocalypse         LV13  238590 454.820
5      VD     Background                 VD-BSW Niskins 8-10   37890  91.838
6      VD     Background                 VD-BSW Niskins 8-10   37890  91.838
  GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min GRAZING_EFFECT_hr_max
1            0.0000                    NA                    NA
2            0.0000                    NA                    NA
3           44.2591              34.87211              53.64608
4         6006.9122                    NA                    NA
5          127.0655              96.81191             157.31912
6          127.0655              96.81191             157.31912
  BAC_TURNOVER_PERC Highest.Temp pH Mg H2S H2 CH4 SAMPLE_TYPE
1          0.000000       36.000 NA NA  NA NA  NA        Vent
2          0.000000       35.000 NA NA  NA NA  NA        Vent
3          2.065407        4.722 NA NA  NA NA  NA  Background
4         60.424114       90.000 NA NA  NA NA  NA        Vent
5          8.048489        4.181 NA NA  NA NA  NA  Background
6          8.048489        4.100 NA NA  NA NA  NA  Background</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(allvent_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Function to plot results by two parameters.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-temperature-by-eukprok-and-then-euk-and-prok" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="plot-temperature-by-eukprok-and-then-euk-and-prok"><span class="header-section-number">15.4</span> Plot temperature by euk:prok and then euk and prok</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-temperature-by-grazing-rate" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="plot-temperature-by-grazing-rate"><span class="header-section-number">15.5</span> Plot temperature by grazing rate</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FIELD"                 "NAME"                  "SAMPLE"               
 [4] "EXP"                   "PROK_ml"               "EUK_ml"               
 [7] "GRAZING_EFFECT_hr"     "GRAZING_EFFECT_hr_min" "GRAZING_EFFECT_hr_max"
[10] "BAC_TURNOVER_PERC"     "Highest.Temp"          "pH"                   
[13] "Mg"                    "H2S"                   "H2"                   
[16] "CH4"                   "SAMPLE_TYPE"           "PROK_EUK_RATIO"       </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, EUK_ml, "ugC_L_perday", "Euk cells per ml") + scale_y_log10()</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="carbon-biomass-investigation" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Carbon biomass investigation</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="co"># carbon_density &lt;- crossing(fgC_cell = seq(86, 300, by = 1), </span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                              GRAZING_EFFECT_hr = seq(min(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   max(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   length.out = 215))  %&gt;%</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;%</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_lines &lt;- select(all_vents, GRAZING_EFFECT_hr, FIELD) %&gt;% </span></span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;% </span></span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   crossing(fgC_cell = seq(86, 300, by = 20)) %&gt;%</span></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(carbon_density, aes(x = fgC_cell, y = GRAZING_EFFECT_hr)) +</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_raster(aes(fill = ugC_L_perday)) +</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_gradientn(colors = c("#fef0d9", "#b30000"), name = bquote("ug C"~L^-1 ~day^-1)) +</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(expand = c(0,0)) +</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(expand = c(0,0)) +</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black"),</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         rect = element_rect(fill = "transparent"),</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill = "transparent", color = NA)) +</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = bquote("Cells "~mL^-1 ~consumed ~hr^-1), x = bquote("fg C"~cell^-1)) +</span></span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = samples_lines,</span></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a><span class="co">#             aes(x = 87,</span></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="co">#             y = GRAZING_EFFECT_hr, shape = FIELD), size = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eukaryote biomass comparison with measured vs.&nbsp;literature</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata &lt;- env_params %&gt;% </span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(SAMPLETYPE != "Incubation") %&gt;%</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(VENT != "Quakeplume") %&gt;% </span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, starts_with("PROK_"), starts_with("EUK_"), starts_with("GRAZING_EFFECT_hr"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata %&gt;% </span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Euk_biomass_Hu)) %&gt;% </span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Euk_biomass_Hu_fg = Euk_biomass_Hu * 1000000000,</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          Euk_biomass_lit_fg = Euk_biomass_lit * 1000000000) %&gt;% </span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = VENT)) +</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_Hu_fg), color = "black", fill = "darkgreen", shape = 21, size = 4) +</span></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_lit), color = "black", fill = "lightgreen", shape = 21, size = 4) +</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black")) +</span></span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(SAMPLETYPE ~ ., space = "free", scales = "free") +</span></span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "fg C of eukaryote population", y = "")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="prediction-of-mcr-data-with-parameters" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Prediction of MCR data with parameters</h1>
<p>Best model to estimate community grazing rate in Vaque et al.&nbsp;considered FLP uptake and similar experiments (in contrast to disappearance experiments).</p>
<p>From Vaque et al.&nbsp;1994 paper equation (1):</p>
<p>See Figure 6</p>
<blockquote class="blockquote">
<p>log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</p>
</blockquote>
<p><em>GT</em> = grazing rate (cells ml-1 hr-1) <em>HNF</em> = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) <em>BAC</em> = prokaryote abundance (cells ml-1)</p>
<p>Start with non-zero grazing rate values, etc. Where… <em>GT</em> == Grazing effect hr <em>HNF</em> == Euk_ml <em>BAC</em> == PROK_ml <em>T</em> == highest temp</p>
<p>We only have these for MCR data.. can include GR for the “predicting euk_ml”</p>
<p>Function to use above formula and estimate</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-17"><a href="#cb267-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb267-18"><a href="#cb267-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-19"><a href="#cb267-19" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-20"><a href="#cb267-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb267-21"><a href="#cb267-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-22"><a href="#cb267-22" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-23"><a href="#cb267-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb267-24"><a href="#cb267-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-25"><a href="#cb267-25" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-26"><a href="#cb267-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb267-27"><a href="#cb267-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-28"><a href="#cb267-28" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-29"><a href="#cb267-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb267-30"><a href="#cb267-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-31"><a href="#cb267-31" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-32"><a href="#cb267-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb267-33"><a href="#cb267-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-34"><a href="#cb267-34" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb267-35"><a href="#cb267-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb267-36"><a href="#cb267-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb267-37"><a href="#cb267-37" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb267-38"><a href="#cb267-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb267-39"><a href="#cb267-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb267-40"><a href="#cb267-40" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb267-41"><a href="#cb267-41" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb267-42"><a href="#cb267-42" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).
Removed 5 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0), "Mid-Cayman Rise only, no undetected")</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)), <span class="st">"Mid-Cayman Rise only, no undetected, vents only"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).
Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-128-2.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-130-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).
Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid" width="1440"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'FIELD', 'NAME', 'SAMPLE', 'EXP',
'PROK_ml', 'EUK_ml'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).
Removed 3 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-131-2.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="save-robjects-for-results" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Save Robjects for Results</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Oct 22, 2023</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(euk_prok_counts, table_grazerate_wflp_wprok_weuk,</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>     table_wcalcs, biov_calc, c_factor_biov,</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>     pgC_ml_biov_bysample, pgC_ml_sizefrac_bysample,</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>     carbon_consumed, <span class="at">file =</span> <span class="st">"input-data/all-dfs-for-Tables.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="session" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Session</h1>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.5.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] scales_1.3.0    patchwork_1.1.2 broom_1.0.4     cowplot_1.1.1  
 [5] lubridate_1.9.2 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    
 [9] purrr_1.0.2     readr_2.1.4     tidyr_1.3.0     tibble_3.2.1   
[13] ggplot2_3.4.4   tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] RColorBrewer_1.1-3 compiler_4.2.2     pillar_1.9.0       tools_4.2.2       
 [5] digest_0.6.33      timechange_0.2.0   jsonlite_1.8.8     evaluate_0.23     
 [9] lifecycle_1.0.4    gtable_0.3.4       pkgconfig_2.0.3    rlang_1.1.2       
[13] cli_3.6.2          rstudioapi_0.14    yaml_2.3.7         xfun_0.39         
[17] fastmap_1.1.1      withr_2.5.2        knitr_1.43         generics_0.1.3    
[21] vctrs_0.6.5        htmlwidgets_1.6.2  hms_1.1.3          grid_4.2.2        
[25] tidyselect_1.2.0   glue_1.6.2         R6_2.5.1           fansi_1.0.6       
[29] rmarkdown_2.22     farver_2.1.1       tzdb_0.4.0         magrittr_2.0.3    
[33] backports_1.4.1    htmltools_0.5.5    colorspace_2.1-0   labeling_0.4.3    
[37] utf8_1.2.4         stringi_1.8.3      munsell_0.5.0     </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb299" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Protistan grazing analysis"</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 2</span></span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Import &amp; format data</span></span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations, calculate cell abundances, estimate grazing rate, and cell biomass. This accompanies paper _in review_: Hu, S. K., Anderson, R. E., Pachiadaki, M. G., Edgcomb, V. P., Serres, M. H., Sylva, S. P., German, C. R., Seewald, J. S., Lang, S. Q., &amp; Huber, J. A. (2023). Microbial eukaryotic predation pressure and biomass at deep-sea hydrothermal vents: Implications for deep-sea carbon cycling. In bioRxiv (p. 2023.08.11.552852). https://doi.org/10.1101/2023.08.11.552852</span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set up working R environment</span></span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a>Load relevant libraries. A few libraries are loaded below in the code, but these are essential.</span>
<span id="cb299-24"><a href="#cb299-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-25"><a href="#cb299-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb299-26"><a href="#cb299-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb299-27"><a href="#cb299-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span>
<span id="cb299-28"><a href="#cb299-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb299-29"><a href="#cb299-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-30"><a href="#cb299-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-31"><a href="#cb299-31" aria-hidden="true" tabindex="-1"></a>Set color schematic for the entire dataset. This is set so that all figures will be uniform for publication.</span>
<span id="cb299-32"><a href="#cb299-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-35"><a href="#cb299-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-36"><a href="#cb299-36" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb299-37"><a href="#cb299-37" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb299-38"><a href="#cb299-38" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb299-39"><a href="#cb299-39" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb299-40"><a href="#cb299-40" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-41"><a href="#cb299-41" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-42"><a href="#cb299-42" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb299-43"><a href="#cb299-43" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb299-44"><a href="#cb299-44" aria-hidden="true" tabindex="-1"></a>whole_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#2A9D8F"</span>, <span class="st">"#E9C46A"</span>,<span class="st">"#F4A261"</span>, <span class="st">"#E76F51"</span>)</span>
<span id="cb299-45"><a href="#cb299-45" aria-hidden="true" tabindex="-1"></a>extra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#eae2b7"</span>, <span class="st">"#5f0f40"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#941b0c"</span>, <span class="st">"#577590"</span>)</span>
<span id="cb299-46"><a href="#cb299-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-47"><a href="#cb299-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-48"><a href="#cb299-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import raw count data</span></span>
<span id="cb299-49"><a href="#cb299-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-50"><a href="#cb299-50" aria-hidden="true" tabindex="-1"></a>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</span>
<span id="cb299-51"><a href="#cb299-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-54"><a href="#cb299-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-55"><a href="#cb299-55" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb299-56"><a href="#cb299-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb299-57"><a href="#cb299-57" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb299-58"><a href="#cb299-58" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb299-59"><a href="#cb299-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-60"><a href="#cb299-60" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span>
<span id="cb299-61"><a href="#cb299-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-62"><a href="#cb299-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-63"><a href="#cb299-63" aria-hidden="true" tabindex="-1"></a>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more 'R' friendly.</span>
<span id="cb299-64"><a href="#cb299-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-67"><a href="#cb299-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-68"><a href="#cb299-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset column headers</span></span>
<span id="cb299-69"><a href="#cb299-69" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>)</span>
<span id="cb299-70"><a href="#cb299-70" aria-hidden="true" tabindex="-1"></a><span class="co"># View new column headers</span></span>
<span id="cb299-71"><a href="#cb299-71" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts)</span>
<span id="cb299-72"><a href="#cb299-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-73"><a href="#cb299-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-74"><a href="#cb299-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parse raw microscopy count data</span></span>
<span id="cb299-75"><a href="#cb299-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-76"><a href="#cb299-76" aria-hidden="true" tabindex="-1"></a>First we need to count the occurrence and total number of FLP ingested by eukaryotic cells. At the microscope, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but we also need to retain the number of FLP per cell.</span>
<span id="cb299-77"><a href="#cb299-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-78"><a href="#cb299-78" aria-hidden="true" tabindex="-1"></a>At deep-sea hydrothermal vents, sometimes particulate material can form when we fixed vent fluid. Unfortunately, when we go to do microscopy counts the samples are uncountable because too much precipiate lands on top of the slide. These are labeled as <span class="in">`Note countable`</span> in my raw count sheets and are removed below.</span>
<span id="cb299-79"><a href="#cb299-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-80"><a href="#cb299-80" aria-hidden="true" tabindex="-1"></a>In a single field of view, if the **nanoFLP** entry is `2`, **nanoFLP_occur** will be set to `1`. And if the **nanoFLP** entry is `2,1` (which means a euk cell had 2 FLP, and a second cell had 1 FLP), **nanoFLP_occur** will be set to <span class="in">`2`</span>.</span>
<span id="cb299-81"><a href="#cb299-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-84"><a href="#cb299-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-85"><a href="#cb299-85" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb299-86"><a href="#cb299-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb299-87"><a href="#cb299-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-88"><a href="#cb299-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb299-89"><a href="#cb299-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb299-90"><a href="#cb299-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb299-91"><a href="#cb299-91" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb299-92"><a href="#cb299-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb299-93"><a href="#cb299-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb299-94"><a href="#cb299-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb299-95"><a href="#cb299-95" aria-hidden="true" tabindex="-1"></a>      data.frame</span>
<span id="cb299-96"><a href="#cb299-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-97"><a href="#cb299-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-98"><a href="#cb299-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-99"><a href="#cb299-99" aria-hidden="true" tabindex="-1"></a><span class="fu"># Calculate cells per ml (euk)</span></span>
<span id="cb299-100"><a href="#cb299-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-101"><a href="#cb299-101" aria-hidden="true" tabindex="-1"></a>Calculations below determine the cells/ml based on the occurrence of eukaryotic cells in each FOV. Variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to <span class="sc">\&gt;</span>20um and nano is <span class="sc">\&lt;</span>20um. All counts were done at 100x magnification, which can be confirmed with this cmd: <span class="in">`unique(counts_occur$MAG)`</span>.</span>
<span id="cb299-102"><a href="#cb299-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-103"><a href="#cb299-103" aria-hidden="true" tabindex="-1"></a>Calculate cell concentration (cells/ml).</span>
<span id="cb299-104"><a href="#cb299-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-107"><a href="#cb299-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-108"><a href="#cb299-108" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb299-109"><a href="#cb299-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb299-110"><a href="#cb299-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb299-111"><a href="#cb299-111" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb299-112"><a href="#cb299-112" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb299-113"><a href="#cb299-113" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb299-114"><a href="#cb299-114" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb299-115"><a href="#cb299-115" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb299-116"><a href="#cb299-116" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb299-117"><a href="#cb299-117" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb299-118"><a href="#cb299-118" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb299-119"><a href="#cb299-119" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb299-120"><a href="#cb299-120" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-121"><a href="#cb299-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb299-122"><a href="#cb299-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb299-123"><a href="#cb299-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb299-124"><a href="#cb299-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb299-125"><a href="#cb299-125" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb299-126"><a href="#cb299-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb299-127"><a href="#cb299-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-128"><a href="#cb299-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-129"><a href="#cb299-129" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-130"><a href="#cb299-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-131"><a href="#cb299-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-132"><a href="#cb299-132" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Replicates belong to the same experiment for either Bag (shipboard or ambient pressure) or IGT (in situ pressure) incubation. Below, modify these names and label new column with Bag or IGT and create an average across replicates.</span></span>
<span id="cb299-133"><a href="#cb299-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-134"><a href="#cb299-134" aria-hidden="true" tabindex="-1"></a>Average cells/ml across replicates, pivot to long format</span>
<span id="cb299-135"><a href="#cb299-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-138"><a href="#cb299-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-139"><a href="#cb299-139" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb299-140"><a href="#cb299-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb299-141"><a href="#cb299-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-142"><a href="#cb299-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-143"><a href="#cb299-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb299-144"><a href="#cb299-144" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-145"><a href="#cb299-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-146"><a href="#cb299-146" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb299-147"><a href="#cb299-147" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb299-148"><a href="#cb299-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span> <span class="co">#remove replicates</span></span>
<span id="cb299-149"><a href="#cb299-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-150"><a href="#cb299-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb299-151"><a href="#cb299-151" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb299-152"><a href="#cb299-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb299-153"><a href="#cb299-153" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb299-154"><a href="#cb299-154" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb299-155"><a href="#cb299-155" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb299-156"><a href="#cb299-156" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb299-157"><a href="#cb299-157" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb299-158"><a href="#cb299-158" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-159"><a href="#cb299-159" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-160"><a href="#cb299-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-161"><a href="#cb299-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-162"><a href="#cb299-162" aria-hidden="true" tabindex="-1"></a>NOTES on calculations:</span>
<span id="cb299-163"><a href="#cb299-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-164"><a href="#cb299-164" aria-hidden="true" tabindex="-1"></a>*VAR* = takes the sum of the squares of each value's deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</span>
<span id="cb299-165"><a href="#cb299-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-166"><a href="#cb299-166" aria-hidden="true" tabindex="-1"></a>*SD* = standard deviation of all values</span>
<span id="cb299-167"><a href="#cb299-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-168"><a href="#cb299-168" aria-hidden="true" tabindex="-1"></a>*SEM* = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</span>
<span id="cb299-169"><a href="#cb299-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-170"><a href="#cb299-170" aria-hidden="true" tabindex="-1"></a>Save output file. </span>
<span id="cb299-173"><a href="#cb299-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-174"><a href="#cb299-174" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span>
<span id="cb299-175"><a href="#cb299-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-176"><a href="#cb299-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-177"><a href="#cb299-177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot eukaryote cell abundance for all time points</span></span>
<span id="cb299-178"><a href="#cb299-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-179"><a href="#cb299-179" aria-hidden="true" tabindex="-1"></a>The average eukaryotic cells per ml value was taken when TRUE replicates were conducted and we observed a cell count.</span>
<span id="cb299-180"><a href="#cb299-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-181"><a href="#cb299-181" aria-hidden="true" tabindex="-1"></a>As a Supplementary figure, plot eukaryote cells/ml for all time points to show that the protistan community wasn't compromised during the experiments.</span>
<span id="cb299-182"><a href="#cb299-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-185"><a href="#cb299-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-186"><a href="#cb299-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Order the vent sites by temperature</span></span>
<span id="cb299-187"><a href="#cb299-187" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb299-188"><a href="#cb299-188" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb299-189"><a href="#cb299-189" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb299-190"><a href="#cb299-190" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb299-191"><a href="#cb299-191" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-192"><a href="#cb299-192" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-193"><a href="#cb299-193" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts_cellsml_avg)</span></span>
<span id="cb299-194"><a href="#cb299-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-195"><a href="#cb299-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-196"><a href="#cb299-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure S2</span></span>
<span id="cb299-197"><a href="#cb299-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-200"><a href="#cb299-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-201"><a href="#cb299-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb299-202"><a href="#cb299-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb299-203"><a href="#cb299-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb299-204"><a href="#cb299-204" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS2.svg")</span></span>
<span id="cb299-205"><a href="#cb299-205" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb299-206"><a href="#cb299-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-207"><a href="#cb299-207" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-208"><a href="#cb299-208" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-209"><a href="#cb299-209" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-210"><a href="#cb299-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VARIABLE_FIX =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-211"><a href="#cb299-211" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> <span class="st">"microeukaryote"</span>,</span>
<span id="cb299-212"><a href="#cb299-212" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> <span class="st">"nanoeukaryote"</span>,</span>
<span id="cb299-213"><a href="#cb299-213" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span> <span class="sc">~</span> <span class="st">"Total eukaryote"</span></span>
<span id="cb299-214"><a href="#cb299-214" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-215"><a href="#cb299-215" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-216"><a href="#cb299-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-217"><a href="#cb299-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-218"><a href="#cb299-218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot with outline vs. solid circle</span></span>
<span id="cb299-219"><a href="#cb299-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">group =</span> NameOrder,</span>
<span id="cb299-220"><a href="#cb299-220" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE_FIX,</span>
<span id="cb299-221"><a href="#cb299-221" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">color =</span> VARIABLE_FIX,</span>
<span id="cb299-222"><a href="#cb299-222" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb299-223"><a href="#cb299-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE_FIX, <span class="at">color =</span> VARIABLE_FIX,</span>
<span id="cb299-224"><a href="#cb299-224" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb299-225"><a href="#cb299-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb299-226"><a href="#cb299-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-227"><a href="#cb299-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb299-228"><a href="#cb299-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb299-229"><a href="#cb299-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb299-230"><a href="#cb299-230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb299-231"><a href="#cb299-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-232"><a href="#cb299-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb299-233"><a href="#cb299-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb299-234"><a href="#cb299-234" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-235"><a href="#cb299-235" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb299-236"><a href="#cb299-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-237"><a href="#cb299-237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-238"><a href="#cb299-238" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb299-239"><a href="#cb299-239" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-240"><a href="#cb299-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-241"><a href="#cb299-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-242"><a href="#cb299-242" aria-hidden="true" tabindex="-1"></a>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. \~10s-100 cells/ml in background and plume compared to \~300-1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</span>
<span id="cb299-243"><a href="#cb299-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-244"><a href="#cb299-244" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 </span><span class="sc">\*</span><span class="at"> interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</span></span>
<span id="cb299-245"><a href="#cb299-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-246"><a href="#cb299-246" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</span></span>
<span id="cb299-247"><a href="#cb299-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-248"><a href="#cb299-248" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot eukaryote cell concentration over time.</span></span>
<span id="cb299-249"><a href="#cb299-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-250"><a href="#cb299-250" aria-hidden="true" tabindex="-1"></a>Include plot over time.</span>
<span id="cb299-251"><a href="#cb299-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-252"><a href="#cb299-252" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S5</span></span>
<span id="cb299-253"><a href="#cb299-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-256"><a href="#cb299-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-257"><a href="#cb299-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb299-258"><a href="#cb299-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb299-259"><a href="#cb299-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb299-260"><a href="#cb299-260" aria-hidden="true" tabindex="-1"></a><span class="co"># svg(filename = "../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS4.svg")</span></span>
<span id="cb299-261"><a href="#cb299-261" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb299-262"><a href="#cb299-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-263"><a href="#cb299-263" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-264"><a href="#cb299-264" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-265"><a href="#cb299-265" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-266"><a href="#cb299-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-267"><a href="#cb299-267" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-268"><a href="#cb299-268" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-269"><a href="#cb299-269" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-270"><a href="#cb299-270" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-271"><a href="#cb299-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-272"><a href="#cb299-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-273"><a href="#cb299-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-274"><a href="#cb299-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-275"><a href="#cb299-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, NameOrder, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-276"><a href="#cb299-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_CATEGORY, <span class="at">fill =</span> NameOrder, </span>
<span id="cb299-277"><a href="#cb299-277" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb299-278"><a href="#cb299-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment_rep), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-279"><a href="#cb299-279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb299-280"><a href="#cb299-280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb299-281"><a href="#cb299-281" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> NameOrder, </span>
<span id="cb299-282"><a href="#cb299-282" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb299-283"><a href="#cb299-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-284"><a href="#cb299-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb299-285"><a href="#cb299-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb299-286"><a href="#cb299-286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb299-287"><a href="#cb299-287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_CATEGORY, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-288"><a href="#cb299-288" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-289"><a href="#cb299-289" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-290"><a href="#cb299-290" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb299-291"><a href="#cb299-291" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb299-292"><a href="#cb299-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb299-293"><a href="#cb299-293" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-294"><a href="#cb299-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-295"><a href="#cb299-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-296"><a href="#cb299-296" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; There is an overall drop in euk cells/ml in the final time point. This is especially true among the IGT samples. We take this into consideration in the manuscript, where the T3 (or final time point) for the IGT experiments is removed.</span></span>
<span id="cb299-297"><a href="#cb299-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-298"><a href="#cb299-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot T0 only counts for cells/ml plot</span></span>
<span id="cb299-299"><a href="#cb299-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-300"><a href="#cb299-300" aria-hidden="true" tabindex="-1"></a>For Figure 1, we want to show eukaryote cell abundances. For this value, we will use the total eukaryote cell values (micro + nano) from the initial time points (T0).</span>
<span id="cb299-301"><a href="#cb299-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-304"><a href="#cb299-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-305"><a href="#cb299-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb299-306"><a href="#cb299-306" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb299-307"><a href="#cb299-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-308"><a href="#cb299-308" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-309"><a href="#cb299-309" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-310"><a href="#cb299-310" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-311"><a href="#cb299-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-312"><a href="#cb299-312" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-313"><a href="#cb299-313" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-314"><a href="#cb299-314" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-315"><a href="#cb299-315" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-316"><a href="#cb299-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-317"><a href="#cb299-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-318"><a href="#cb299-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-319"><a href="#cb299-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-320"><a href="#cb299-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb299-321"><a href="#cb299-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-322"><a href="#cb299-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-323"><a href="#cb299-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-324"><a href="#cb299-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> MEAN, <span class="at">shape =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb299-325"><a href="#cb299-325" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-326"><a href="#cb299-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-327"><a href="#cb299-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-328"><a href="#cb299-328" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb299-329"><a href="#cb299-329" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-330"><a href="#cb299-330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-331"><a href="#cb299-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-332"><a href="#cb299-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-333"><a href="#cb299-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb299-334"><a href="#cb299-334" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cfacet_grid(. ~ SiteOrder, scales = "free") +</span></span>
<span id="cb299-335"><a href="#cb299-335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-336"><a href="#cb299-336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-337"><a href="#cb299-337" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-338"><a href="#cb299-338" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-339"><a href="#cb299-339" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-340"><a href="#cb299-340" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-341"><a href="#cb299-341" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-342"><a href="#cb299-342" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-343"><a href="#cb299-343" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-344"><a href="#cb299-344" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-345"><a href="#cb299-345" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-346"><a href="#cb299-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-347"><a href="#cb299-347" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-348"><a href="#cb299-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-349"><a href="#cb299-349" aria-hidden="true" tabindex="-1"></a>euk_plot</span>
<span id="cb299-350"><a href="#cb299-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-351"><a href="#cb299-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-352"><a href="#cb299-352" aria-hidden="true" tabindex="-1"></a>Above Figure shows the eukaryote cell abundances separated by vent site (x-axis).</span>
<span id="cb299-353"><a href="#cb299-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-354"><a href="#cb299-354" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplot eukaryote cell abundance</span></span>
<span id="cb299-355"><a href="#cb299-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-356"><a href="#cb299-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-357"><a href="#cb299-357" aria-hidden="true" tabindex="-1"></a>To better show comparison across vent fields (Von Damm vs. Piccard), habitat type (vent fluid vs. background or non-vent), and experiment type (shipboard vs. IGT), cell abundances are better shown as a box plot.</span>
<span id="cb299-358"><a href="#cb299-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-361"><a href="#cb299-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-362"><a href="#cb299-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb299-363"><a href="#cb299-363" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_site <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb299-364"><a href="#cb299-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LOCATION_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-365"><a href="#cb299-365" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"Plume"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-366"><a href="#cb299-366" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"BSW"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-367"><a href="#cb299-367" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-368"><a href="#cb299-368" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-369"><a href="#cb299-369" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-370"><a href="#cb299-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-371"><a href="#cb299-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-372"><a href="#cb299-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-373"><a href="#cb299-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb299-374"><a href="#cb299-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> LOCATION_BIN, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb299-375"><a href="#cb299-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb299-376"><a href="#cb299-376" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">fill =</span> SiteOrder,</span>
<span id="cb299-377"><a href="#cb299-377" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb299-378"><a href="#cb299-378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-379"><a href="#cb299-379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-380"><a href="#cb299-380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb299-381"><a href="#cb299-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb299-382"><a href="#cb299-382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder) <span class="sc">+</span></span>
<span id="cb299-383"><a href="#cb299-383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-384"><a href="#cb299-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-385"><a href="#cb299-385" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-386"><a href="#cb299-386" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-387"><a href="#cb299-387" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb299-388"><a href="#cb299-388" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb299-389"><a href="#cb299-389" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-390"><a href="#cb299-390" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-391"><a href="#cb299-391" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-392"><a href="#cb299-392" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-393"><a href="#cb299-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-394"><a href="#cb299-394" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-395"><a href="#cb299-395" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_site</span>
<span id="cb299-396"><a href="#cb299-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-397"><a href="#cb299-397" aria-hidden="true" tabindex="-1"></a>Repeat, but subset vent sites only and group by experiment approach.</span>
<span id="cb299-398"><a href="#cb299-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-401"><a href="#cb299-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-402"><a href="#cb299-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb299-403"><a href="#cb299-403" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_exp <span class="ot">&lt;-</span>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb299-404"><a href="#cb299-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-405"><a href="#cb299-405" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-406"><a href="#cb299-406" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-407"><a href="#cb299-407" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-408"><a href="#cb299-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-409"><a href="#cb299-409" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-410"><a href="#cb299-410" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-411"><a href="#cb299-411" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-412"><a href="#cb299-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LOCATION_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-413"><a href="#cb299-413" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"Plume"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-414"><a href="#cb299-414" aria-hidden="true" tabindex="-1"></a>    (Name <span class="sc">==</span> <span class="st">"BSW"</span>) <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-415"><a href="#cb299-415" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-416"><a href="#cb299-416" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-417"><a href="#cb299-417" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-418"><a href="#cb299-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-419"><a href="#cb299-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-420"><a href="#cb299-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LOCATION_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-421"><a href="#cb299-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-422"><a href="#cb299-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb299-423"><a href="#cb299-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> EXP_CATEGORY, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb299-424"><a href="#cb299-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb299-425"><a href="#cb299-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb299-426"><a href="#cb299-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">19</span>)) <span class="sc">+</span>  </span>
<span id="cb299-427"><a href="#cb299-427" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("#264653", "#E76F51")) +</span></span>
<span id="cb299-428"><a href="#cb299-428" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_color_manual(values = c("#264653", "#E76F51")) +</span></span>
<span id="cb299-429"><a href="#cb299-429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb299-430"><a href="#cb299-430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb299-431"><a href="#cb299-431" aria-hidden="true" tabindex="-1"></a>    <span class="co"># facet_grid(.~SiteOrder) +</span></span>
<span id="cb299-432"><a href="#cb299-432" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-433"><a href="#cb299-433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-434"><a href="#cb299-434" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-435"><a href="#cb299-435" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-436"><a href="#cb299-436" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb299-437"><a href="#cb299-437" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb299-438"><a href="#cb299-438" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-439"><a href="#cb299-439" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-440"><a href="#cb299-440" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-441"><a href="#cb299-441" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-442"><a href="#cb299-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-443"><a href="#cb299-443" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-444"><a href="#cb299-444" aria-hidden="true" tabindex="-1"></a>boxplot_eukcell_exp</span>
<span id="cb299-445"><a href="#cb299-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-446"><a href="#cb299-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-447"><a href="#cb299-447" aria-hidden="true" tabindex="-1"></a>Option to show eukaryote cell abundances without a log scale.</span>
<span id="cb299-448"><a href="#cb299-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-449"><a href="#cb299-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=5, fig.width=4}</span></span>
<span id="cb299-450"><a href="#cb299-450" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb299-451"><a href="#cb299-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-452"><a href="#cb299-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-453"><a href="#cb299-453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, EXPID) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-454"><a href="#cb299-454" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-455"><a href="#cb299-455" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-456"><a href="#cb299-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-457"><a href="#cb299-457" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-458"><a href="#cb299-458" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-459"><a href="#cb299-459" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-460"><a href="#cb299-460" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-461"><a href="#cb299-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-462"><a href="#cb299-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, EXPID) <span class="sc">~</span> <span class="fu">paste</span>(Site, <span class="st">"IGT"</span>),</span>
<span id="cb299-463"><a href="#cb299-463" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(Site, <span class="st">"Shipboard"</span>),</span>
<span id="cb299-464"><a href="#cb299-464" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-465"><a href="#cb299-465" aria-hidden="true" tabindex="-1"></a>  <span class="co"># unite("SITE_TYPE", Site, EXP_CATEGORY, sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb299-466"><a href="#cb299-466" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-467"><a href="#cb299-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-468"><a href="#cb299-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-469"><a href="#cb299-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, EXPID))) <span class="sc">%&gt;%</span> </span>
<span id="cb299-470"><a href="#cb299-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> eukCONC, <span class="at">x =</span> TYPE_BIN)) <span class="sc">+</span></span>
<span id="cb299-471"><a href="#cb299-471" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb299-472"><a href="#cb299-472" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-473"><a href="#cb299-473" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill =</span> SITE_TYPE, </span>
<span id="cb299-474"><a href="#cb299-474" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-475"><a href="#cb299-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-476"><a href="#cb299-476" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-477"><a href="#cb299-477" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-478"><a href="#cb299-478" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-479"><a href="#cb299-479" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-480"><a href="#cb299-480" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-481"><a href="#cb299-481" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-482"><a href="#cb299-482" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-483"><a href="#cb299-483" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-484"><a href="#cb299-484" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-485"><a href="#cb299-485" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-486"><a href="#cb299-486" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-487"><a href="#cb299-487" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-488"><a href="#cb299-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-489"><a href="#cb299-489" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-490"><a href="#cb299-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-491"><a href="#cb299-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-494"><a href="#cb299-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-495"><a href="#cb299-495" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs.RData")</span></span>
<span id="cb299-496"><a href="#cb299-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-497"><a href="#cb299-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-498"><a href="#cb299-498" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bacteria &amp; archaea cell counts</span></span>
<span id="cb299-499"><a href="#cb299-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-500"><a href="#cb299-500" aria-hidden="true" tabindex="-1"></a>DAPI slide counts from prokaryotes from same sites. Import and compare.</span>
<span id="cb299-501"><a href="#cb299-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-504"><a href="#cb299-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-505"><a href="#cb299-505" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb299-506"><a href="#cb299-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-507"><a href="#cb299-507" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb299-508"><a href="#cb299-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-509"><a href="#cb299-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-510"><a href="#cb299-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb299-511"><a href="#cb299-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb299-512"><a href="#cb299-512" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb299-513"><a href="#cb299-513" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb299-514"><a href="#cb299-514" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CELLML),</span>
<span id="cb299-515"><a href="#cb299-515" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CELLML),</span>
<span id="cb299-516"><a href="#cb299-516" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-517"><a href="#cb299-517" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-518"><a href="#cb299-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-519"><a href="#cb299-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-520"><a href="#cb299-520" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cells per ml (prok)</span></span>
<span id="cb299-521"><a href="#cb299-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-522"><a href="#cb299-522" aria-hidden="true" tabindex="-1"></a>Visualize counts from proks. Get summary of prok counts, and incorporate into plot. Throughout dataset, sample called "Quakeplume" did not work. This was an opportunistic sample that can be removed.</span>
<span id="cb299-523"><a href="#cb299-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-526"><a href="#cb299-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-527"><a href="#cb299-527" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Name <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-528"><a href="#cb299-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-529"><a href="#cb299-529" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb299-530"><a href="#cb299-530" aria-hidden="true" tabindex="-1"></a>  Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb299-531"><a href="#cb299-531" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb299-532"><a href="#cb299-532" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-533"><a href="#cb299-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb299-534"><a href="#cb299-534" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(MEAN),</span>
<span id="cb299-535"><a href="#cb299-535" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(MEAN),</span>
<span id="cb299-536"><a href="#cb299-536" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(MEAN))</span>
<span id="cb299-537"><a href="#cb299-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-538"><a href="#cb299-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-539"><a href="#cb299-539" aria-hidden="true" tabindex="-1"></a>Factor site names, so order can be uniform with other figures.</span>
<span id="cb299-540"><a href="#cb299-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-543"><a href="#cb299-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-544"><a href="#cb299-544" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordered by temperature</span></span>
<span id="cb299-545"><a href="#cb299-545" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>,</span>
<span id="cb299-546"><a href="#cb299-546" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"MustardStand"</span>, </span>
<span id="cb299-547"><a href="#cb299-547" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Rav2"</span>, <span class="st">"OMT"</span>,<span class="st">"Bartizan"</span>,<span class="st">"ArrowLoop"</span>, <span class="st">"Rav1"</span>,</span>
<span id="cb299-548"><a href="#cb299-548" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"Quakeplume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"SouthofHotChimlet"</span>,</span>
<span id="cb299-549"><a href="#cb299-549" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"SouthofLungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"ShrimpGulley"</span>, </span>
<span id="cb299-550"><a href="#cb299-550" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"HotChimlet1"</span>), </span>
<span id="cb299-551"><a href="#cb299-551" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, </span>
<span id="cb299-552"><a href="#cb299-552" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>,<span class="st">"Mustard Stand"</span>,</span>
<span id="cb299-553"><a href="#cb299-553" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Ravelin #2"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Ravelin #1"</span>,</span>
<span id="cb299-554"><a href="#cb299-554" aria-hidden="true" tabindex="-1"></a>                                          </span>
<span id="cb299-555"><a href="#cb299-555" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Quakeplume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"South of Hot Chimlet"</span>, </span>
<span id="cb299-556"><a href="#cb299-556" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"South of LungSnack"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"Hot Chimlet #1"</span>))</span>
<span id="cb299-557"><a href="#cb299-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-558"><a href="#cb299-558" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-559"><a href="#cb299-559" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-560"><a href="#cb299-560" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb299-561"><a href="#cb299-561" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb299-562"><a href="#cb299-562" aria-hidden="true" tabindex="-1"></a>site_fill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb299-563"><a href="#cb299-563" aria-hidden="true" tabindex="-1"></a><span class="co"># names(site_color) &lt;- site_fullname</span></span>
<span id="cb299-564"><a href="#cb299-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-565"><a href="#cb299-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-566"><a href="#cb299-566" aria-hidden="true" tabindex="-1"></a>Write function to output scientific notation in the plot with <span class="in">`x 10^a`</span></span>
<span id="cb299-567"><a href="#cb299-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-570"><a href="#cb299-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-571"><a href="#cb299-571" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb299-572"><a href="#cb299-572" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb299-573"><a href="#cb299-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb299-574"><a href="#cb299-574" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">==</span><span class="dv">0</span>, <span class="st">"0"</span>,</span>
<span id="cb299-575"><a href="#cb299-575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">sub</span>(<span class="st">"e[+]?"</span>, <span class="st">" %*% 10^"</span>, scales<span class="sc">::</span><span class="fu">scientific_format</span>()(x)))</span>
<span id="cb299-576"><a href="#cb299-576" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb299-577"><a href="#cb299-577" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb299-578"><a href="#cb299-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-579"><a href="#cb299-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-582"><a href="#cb299-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-583"><a href="#cb299-583" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb299-584"><a href="#cb299-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb299-585"><a href="#cb299-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order,</span>
<span id="cb299-586"><a href="#cb299-586" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">color =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-587"><a href="#cb299-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-588"><a href="#cb299-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb299-589"><a href="#cb299-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb299-590"><a href="#cb299-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb299-591"><a href="#cb299-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-592"><a href="#cb299-592" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_log10(label=trans_format("log10",math_format(10^.x))) +</span></span>
<span id="cb299-593"><a href="#cb299-593" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(label = scientific_10) +</span></span>
<span id="cb299-594"><a href="#cb299-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-595"><a href="#cb299-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-596"><a href="#cb299-596" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-597"><a href="#cb299-597" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-598"><a href="#cb299-598" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-599"><a href="#cb299-599" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-600"><a href="#cb299-600" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-601"><a href="#cb299-601" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-602"><a href="#cb299-602" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-603"><a href="#cb299-603" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb299-604"><a href="#cb299-604" aria-hidden="true" tabindex="-1"></a>prok_plot</span>
<span id="cb299-605"><a href="#cb299-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-606"><a href="#cb299-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-607"><a href="#cb299-607" aria-hidden="true" tabindex="-1"></a>Show prokaryote cell abundance as boxplot.</span>
<span id="cb299-608"><a href="#cb299-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=4}</span></span>
<span id="cb299-609"><a href="#cb299-609" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb299-610"><a href="#cb299-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-611"><a href="#cb299-611" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"BSW"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-612"><a href="#cb299-612" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-613"><a href="#cb299-613" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-614"><a href="#cb299-614" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-615"><a href="#cb299-615" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TYPE_BIN, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb299-616"><a href="#cb299-616" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_errorbar(aes(ymax = (MEAN + SEM), ymin = (MEAN - SEM)), width = 0.2) +</span></span>
<span id="cb299-617"><a href="#cb299-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb299-618"><a href="#cb299-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site_order,</span>
<span id="cb299-619"><a href="#cb299-619" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">color =</span> Site_order), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-620"><a href="#cb299-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb299-621"><a href="#cb299-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb299-622"><a href="#cb299-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb299-623"><a href="#cb299-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-624"><a href="#cb299-624" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_log10(label=trans_format("log10",math_format(10^.x))) +</span></span>
<span id="cb299-625"><a href="#cb299-625" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(label = scientific_10) +</span></span>
<span id="cb299-626"><a href="#cb299-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-627"><a href="#cb299-627" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-628"><a href="#cb299-628" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-629"><a href="#cb299-629" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-630"><a href="#cb299-630" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-631"><a href="#cb299-631" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-632"><a href="#cb299-632" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-633"><a href="#cb299-633" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-634"><a href="#cb299-634" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-635"><a href="#cb299-635" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb299-636"><a href="#cb299-636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-637"><a href="#cb299-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-638"><a href="#cb299-638" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compare euk and prok cell abundance</span></span>
<span id="cb299-639"><a href="#cb299-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-640"><a href="#cb299-640" aria-hidden="true" tabindex="-1"></a>Combined eukaryote and prokaryote cell counts.</span>
<span id="cb299-641"><a href="#cb299-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-644"><a href="#cb299-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-645"><a href="#cb299-645" aria-hidden="true" tabindex="-1"></a>euk_prok_ab <span class="ot">&lt;-</span> (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb299-646"><a href="#cb299-646" aria-hidden="true" tabindex="-1"></a>euk_prok_ab</span>
<span id="cb299-647"><a href="#cb299-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-648"><a href="#cb299-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-649"><a href="#cb299-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combine with previous MCR cell counts</span></span>
<span id="cb299-650"><a href="#cb299-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-651"><a href="#cb299-651" aria-hidden="true" tabindex="-1"></a>Compare *in situ* prokaryote cell counts from 2020 to previous years</span>
<span id="cb299-652"><a href="#cb299-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-655"><a href="#cb299-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-656"><a href="#cb299-656" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb299-657"><a href="#cb299-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-658"><a href="#cb299-658" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb299-659"><a href="#cb299-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-660"><a href="#cb299-660" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb299-661"><a href="#cb299-661" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb299-662"><a href="#cb299-662" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-663"><a href="#cb299-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb299-664"><a href="#cb299-664" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb299-665"><a href="#cb299-665" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb299-666"><a href="#cb299-666" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb299-667"><a href="#cb299-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-668"><a href="#cb299-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span>
<span id="cb299-669"><a href="#cb299-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-670"><a href="#cb299-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-671"><a href="#cb299-671" aria-hidden="true" tabindex="-1"></a>Re-import 2020 data to compare.</span>
<span id="cb299-672"><a href="#cb299-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-675"><a href="#cb299-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-676"><a href="#cb299-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb299-677"><a href="#cb299-677" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb299-678"><a href="#cb299-678" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb299-679"><a href="#cb299-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-680"><a href="#cb299-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-681"><a href="#cb299-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb299-682"><a href="#cb299-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-683"><a href="#cb299-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-684"><a href="#cb299-684" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb299-685"><a href="#cb299-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-686"><a href="#cb299-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-687"><a href="#cb299-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-688"><a href="#cb299-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-689"><a href="#cb299-689" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-690"><a href="#cb299-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-691"><a href="#cb299-691" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb299-692"><a href="#cb299-692" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb299-693"><a href="#cb299-693" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb299-694"><a href="#cb299-694" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span>
<span id="cb299-695"><a href="#cb299-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-696"><a href="#cb299-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-697"><a href="#cb299-697" aria-hidden="true" tabindex="-1"></a>Plot by year.</span>
<span id="cb299-698"><a href="#cb299-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-701"><a href="#cb299-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-702"><a href="#cb299-702" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb299-703"><a href="#cb299-703" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb299-704"><a href="#cb299-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-705"><a href="#cb299-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb299-706"><a href="#cb299-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb299-707"><a href="#cb299-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-708"><a href="#cb299-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb299-709"><a href="#cb299-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb299-710"><a href="#cb299-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb299-711"><a href="#cb299-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb299-712"><a href="#cb299-712" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-713"><a href="#cb299-713" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb299-714"><a href="#cb299-714" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-715"><a href="#cb299-715" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb299-716"><a href="#cb299-716" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-717"><a href="#cb299-717" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb299-718"><a href="#cb299-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb299-719"><a href="#cb299-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span>
<span id="cb299-720"><a href="#cb299-720" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-721"><a href="#cb299-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-722"><a href="#cb299-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-725"><a href="#cb299-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-726"><a href="#cb299-726" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb299-727"><a href="#cb299-727" aria-hidden="true" tabindex="-1"></a><span class="co"># names(counts_cellsml_avg)</span></span>
<span id="cb299-728"><a href="#cb299-728" aria-hidden="true" tabindex="-1"></a>prok_tojoin <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb299-729"><a href="#cb299-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MEAN), <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb299-730"><a href="#cb299-730" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MIN), <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb299-731"><a href="#cb299-731" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(MAX), <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-732"><a href="#cb299-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"PROK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-733"><a href="#cb299-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, <span class="at">PROK_ml =</span> MEAN_SIG, PROK_MinMax, <span class="at">PROK_sem =</span> SEM)</span>
<span id="cb299-734"><a href="#cb299-734" aria-hidden="true" tabindex="-1"></a><span class="co"># prok_tojoin</span></span>
<span id="cb299-735"><a href="#cb299-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-736"><a href="#cb299-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-737"><a href="#cb299-737" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile table with euk and prok counts</span></span>
<span id="cb299-738"><a href="#cb299-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-739"><a href="#cb299-739" aria-hidden="true" tabindex="-1"></a>Part of Table 1.</span>
<span id="cb299-740"><a href="#cb299-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-743"><a href="#cb299-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-744"><a href="#cb299-744" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb299-745"><a href="#cb299-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-746"><a href="#cb299-746" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-747"><a href="#cb299-747" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-748"><a href="#cb299-748" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-749"><a href="#cb299-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-750"><a href="#cb299-750" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-751"><a href="#cb299-751" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-752"><a href="#cb299-752" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-753"><a href="#cb299-753" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-754"><a href="#cb299-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-755"><a href="#cb299-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-756"><a href="#cb299-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-757"><a href="#cb299-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-758"><a href="#cb299-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">"b"</span>, IGT_REP))) <span class="sc">%&gt;%</span> </span>
<span id="cb299-759"><a href="#cb299-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-760"><a href="#cb299-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-761"><a href="#cb299-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, EXP_CATEGORY_WREP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-762"><a href="#cb299-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEAN_SIG =</span> <span class="fu">signif</span>(MEAN, <span class="at">digits =</span> <span class="dv">5</span>),</span>
<span id="cb299-763"><a href="#cb299-763" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_sig =</span> <span class="fu">signif</span>(MIN, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb299-764"><a href="#cb299-764" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_sig =</span> <span class="fu">signif</span>(MAX, <span class="at">digits =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-765"><a href="#cb299-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"EUK_MinMax"</span>, MIN_sig, MAX_sig, <span class="at">sep =</span> <span class="st">" / "</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-766"><a href="#cb299-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, SITE_TYPE, Experiment, Experiment_rep, VARIABLE, <span class="at">EUK_ml =</span> MEAN_SIG, EUK_MinMax, <span class="at">EUK_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb299-767"><a href="#cb299-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(prok_tojoin)</span>
<span id="cb299-768"><a href="#cb299-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-769"><a href="#cb299-769" aria-hidden="true" tabindex="-1"></a>euk_prok_counts <span class="co"># add to this later for Table 1</span></span>
<span id="cb299-770"><a href="#cb299-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-771"><a href="#cb299-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-772"><a href="#cb299-772" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimate grazing effect</span></span>
<span id="cb299-773"><a href="#cb299-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-774"><a href="#cb299-774" aria-hidden="true" tabindex="-1"></a>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</span>
<span id="cb299-775"><a href="#cb299-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-778"><a href="#cb299-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-779"><a href="#cb299-779" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs.RData"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb299-780"><a href="#cb299-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-781"><a href="#cb299-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-782"><a href="#cb299-782" aria-hidden="true" tabindex="-1"></a><span class="fu">## Determine FLP per euk cell</span></span>
<span id="cb299-783"><a href="#cb299-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-784"><a href="#cb299-784" aria-hidden="true" tabindex="-1"></a>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <span class="in">`counts_occur`</span> data frame from above. We can use the command <span class="in">`separate_rows()`</span> to do this.</span>
<span id="cb299-785"><a href="#cb299-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-788"><a href="#cb299-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-789"><a href="#cb299-789" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb299-790"><a href="#cb299-790" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb299-791"><a href="#cb299-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> <span class="co"># uncountable</span></span>
<span id="cb299-792"><a href="#cb299-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span> <span class="co"># uncountable</span></span>
<span id="cb299-793"><a href="#cb299-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb299-794"><a href="#cb299-794" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb299-795"><a href="#cb299-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-796"><a href="#cb299-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-797"><a href="#cb299-797" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb299-798"><a href="#cb299-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-799"><a href="#cb299-799" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-800"><a href="#cb299-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-801"><a href="#cb299-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-802"><a href="#cb299-802" aria-hidden="true" tabindex="-1"></a>*optional gut check of data table modification*</span>
<span id="cb299-803"><a href="#cb299-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-806"><a href="#cb299-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-807"><a href="#cb299-807" aria-hidden="true" tabindex="-1"></a><span class="co"># See FOV 23, where nanoFLP is 4,5</span></span>
<span id="cb299-808"><a href="#cb299-808" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb299-809"><a href="#cb299-809" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb299-810"><a href="#cb299-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-811"><a href="#cb299-811" aria-hidden="true" tabindex="-1"></a><span class="do">## Check FOV 23. It is separated into 2 rows, 4 and then 5.</span></span>
<span id="cb299-812"><a href="#cb299-812" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb299-813"><a href="#cb299-813" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb299-814"><a href="#cb299-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-815"><a href="#cb299-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-816"><a href="#cb299-816" aria-hidden="true" tabindex="-1"></a>Isolate counts that are <span class="sc">\&gt;</span>0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1. *Each row is a euk cell, based on data transformation above.*</span>
<span id="cb299-817"><a href="#cb299-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-820"><a href="#cb299-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-821"><a href="#cb299-821" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb299-822"><a href="#cb299-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb299-823"><a href="#cb299-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-824"><a href="#cb299-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-825"><a href="#cb299-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-826"><a href="#cb299-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-827"><a href="#cb299-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-828"><a href="#cb299-828" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-829"><a href="#cb299-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb299-830"><a href="#cb299-830" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-831"><a href="#cb299-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-832"><a href="#cb299-832" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb299-833"><a href="#cb299-833" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb299-834"><a href="#cb299-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-835"><a href="#cb299-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb299-836"><a href="#cb299-836" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb299-837"><a href="#cb299-837" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-838"><a href="#cb299-838" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-839"><a href="#cb299-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-840"><a href="#cb299-840" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(counts_flp)</span>
<span id="cb299-841"><a href="#cb299-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-842"><a href="#cb299-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-843"><a href="#cb299-843" aria-hidden="true" tabindex="-1"></a>*OUTPUT COLUMNS:* (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</span>
<span id="cb299-844"><a href="#cb299-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-845"><a href="#cb299-845" aria-hidden="true" tabindex="-1"></a>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</span>
<span id="cb299-846"><a href="#cb299-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-847"><a href="#cb299-847" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Below code repeats process and compiles with other FLP/euk cell data.</span></span>
<span id="cb299-848"><a href="#cb299-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-849"><a href="#cb299-849" aria-hidden="true" tabindex="-1"></a>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</span>
<span id="cb299-850"><a href="#cb299-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-853"><a href="#cb299-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-854"><a href="#cb299-854" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb299-855"><a href="#cb299-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb299-856"><a href="#cb299-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb299-857"><a href="#cb299-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb299-858"><a href="#cb299-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb299-859"><a href="#cb299-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-860"><a href="#cb299-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-861"><a href="#cb299-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-862"><a href="#cb299-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-863"><a href="#cb299-863" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-864"><a href="#cb299-864" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb299-865"><a href="#cb299-865" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-866"><a href="#cb299-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-867"><a href="#cb299-867" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb299-868"><a href="#cb299-868" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-869"><a href="#cb299-869" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb299-870"><a href="#cb299-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-871"><a href="#cb299-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb299-872"><a href="#cb299-872" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-873"><a href="#cb299-873" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb299-874"><a href="#cb299-874" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb299-875"><a href="#cb299-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb299-876"><a href="#cb299-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb299-877"><a href="#cb299-877" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-878"><a href="#cb299-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-879"><a href="#cb299-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-882"><a href="#cb299-882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-883"><a href="#cb299-883" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb299-884"><a href="#cb299-884" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb299-885"><a href="#cb299-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb299-886"><a href="#cb299-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb299-887"><a href="#cb299-887" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb299-888"><a href="#cb299-888" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb299-889"><a href="#cb299-889" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-890"><a href="#cb299-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb299-891"><a href="#cb299-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb299-892"><a href="#cb299-892" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-893"><a href="#cb299-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-894"><a href="#cb299-894" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(counts_flp_compiled_all)</span>
<span id="cb299-895"><a href="#cb299-895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-896"><a href="#cb299-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-897"><a href="#cb299-897" aria-hidden="true" tabindex="-1"></a>The code above takes the processed microscopy counts, and estimates the total number of FLP and the total number of eukaryotes counted (with or without FLP inside). To calculate the rate that FLP were ingested, we need the slope of the line when we plot the number of ingested FLP per eukaryote cell by experiment time.</span>
<span id="cb299-898"><a href="#cb299-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-899"><a href="#cb299-899" aria-hidden="true" tabindex="-1"></a>We will use this equation below: <span class="in">`FLPperEuk = total_FLP/(sum(total_euks_noFLP, total_euks_wflp))`</span>.</span>
<span id="cb299-900"><a href="#cb299-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-901"><a href="#cb299-901" aria-hidden="true" tabindex="-1"></a>First need to import and compile with metadata to get exact timing of experiments.</span>
<span id="cb299-902"><a href="#cb299-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-905"><a href="#cb299-905" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-906"><a href="#cb299-906" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb299-907"><a href="#cb299-907" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span>
<span id="cb299-908"><a href="#cb299-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-909"><a href="#cb299-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-910"><a href="#cb299-910" aria-hidden="true" tabindex="-1"></a><span class="fu">### Consider IGT replicates.</span></span>
<span id="cb299-911"><a href="#cb299-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-912"><a href="#cb299-912" aria-hidden="true" tabindex="-1"></a>IGT<span class="sc">\_</span>#<span class="sc">\_</span> denotes a separate IGT experiment. Due to bottle effects and the need to look at how replicate experiments compared, lets keep these separate. For IGT experiments labeled "b", this means the OTHER HALF of the filter was counted or re-counted as a way to confirm my eukaryote cell counting was precise (explored in manuscript supplement).</span>
<span id="cb299-913"><a href="#cb299-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-916"><a href="#cb299-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-917"><a href="#cb299-917" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb299-918"><a href="#cb299-918" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb299-919"><a href="#cb299-919" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, use this to include them as replicates</span></span>
<span id="cb299-920"><a href="#cb299-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-921"><a href="#cb299-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb299-922"><a href="#cb299-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb299-923"><a href="#cb299-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb299-924"><a href="#cb299-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-925"><a href="#cb299-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-926"><a href="#cb299-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-927"><a href="#cb299-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-928"><a href="#cb299-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-929"><a href="#cb299-929" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb299-930"><a href="#cb299-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-931"><a href="#cb299-931" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb299-932"><a href="#cb299-932" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) %&gt;%</span></span>
<span id="cb299-933"><a href="#cb299-933" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb299-934"><a href="#cb299-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb299-935"><a href="#cb299-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-936"><a href="#cb299-936" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-937"><a href="#cb299-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-938"><a href="#cb299-938" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(counts_flp_calcs_all)</span>
<span id="cb299-939"><a href="#cb299-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-940"><a href="#cb299-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-941"><a href="#cb299-941" aria-hidden="true" tabindex="-1"></a>Explanation of main columns:</span>
<span id="cb299-942"><a href="#cb299-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-943"><a href="#cb299-943" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`Timepoint`</span> shows the time point for the experiment, while <span class="in">`Minutes`</span> = reports the actual  minutes at incubation.</span>
<span id="cb299-944"><a href="#cb299-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-945"><a href="#cb299-945" aria-hidden="true" tabindex="-1"></a><span class="in">`Replicate_ID`</span>, <span class="in">`REP`</span>, and <span class="in">`IGT_REP`</span> = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</span>
<span id="cb299-946"><a href="#cb299-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-947"><a href="#cb299-947" aria-hidden="true" tabindex="-1"></a>An example of the Ravelin #2 site, where we have two IGT experiments and 1 ambient/bag/shipboard experiment. Below, we have plotted the FLP per EUK cell by the time of the experiment. This is showing the total number of counts done, so replicates 1-3 are shown for the Bag experiment.</span>
<span id="cb299-948"><a href="#cb299-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-949"><a href="#cb299-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=8, fig.height=3}</span></span>
<span id="cb299-950"><a href="#cb299-950" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb299-951"><a href="#cb299-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Name <span class="sc">==</span> <span class="st">"Rav2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-952"><a href="#cb299-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Experiment, <span class="at">group =</span> Replicate_ID)) <span class="sc">+</span></span>
<span id="cb299-953"><a href="#cb299-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-954"><a href="#cb299-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Experiment)) <span class="sc">+</span></span>
<span id="cb299-955"><a href="#cb299-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb299-956"><a href="#cb299-956" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb299-957"><a href="#cb299-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-958"><a href="#cb299-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-959"><a href="#cb299-959" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate linear regression to obtain slope</span></span>
<span id="cb299-960"><a href="#cb299-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-961"><a href="#cb299-961" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`lm()`</span> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</span>
<span id="cb299-962"><a href="#cb299-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-963"><a href="#cb299-963" aria-hidden="true" tabindex="-1"></a>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</span>
<span id="cb299-964"><a href="#cb299-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-967"><a href="#cb299-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-968"><a href="#cb299-968" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb299-969"><a href="#cb299-969" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb299-970"><a href="#cb299-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-971"><a href="#cb299-971" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb299-972"><a href="#cb299-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-973"><a href="#cb299-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-974"><a href="#cb299-974" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb299-975"><a href="#cb299-975" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb299-976"><a href="#cb299-976" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb299-977"><a href="#cb299-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb299-978"><a href="#cb299-978" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-979"><a href="#cb299-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb299-980"><a href="#cb299-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb299-981"><a href="#cb299-981" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) %&gt;% </span></span>
<span id="cb299-982"><a href="#cb299-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb299-983"><a href="#cb299-983" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-984"><a href="#cb299-984" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb299-985"><a href="#cb299-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb299-986"><a href="#cb299-986" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"IGT_REP"</span>,</span>
<span id="cb299-987"><a href="#cb299-987" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb299-988"><a href="#cb299-988" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb299-989"><a href="#cb299-989" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb299-990"><a href="#cb299-990" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb299-991"><a href="#cb299-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-992"><a href="#cb299-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>IGT_REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb299-993"><a href="#cb299-993" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, REP, SizeFrac) %&gt;%</span></span>
<span id="cb299-994"><a href="#cb299-994" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac) %&gt;%</span></span>
<span id="cb299-995"><a href="#cb299-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb299-996"><a href="#cb299-996" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-997"><a href="#cb299-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb299-998"><a href="#cb299-998" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb299-999"><a href="#cb299-999" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) %&gt;% </span></span>
<span id="cb299-1000"><a href="#cb299-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1001"><a href="#cb299-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1002"><a href="#cb299-1002" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1003"><a href="#cb299-1003" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb299-1004"><a href="#cb299-1004" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb299-1005"><a href="#cb299-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb299-1006"><a href="#cb299-1006" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb299-1007"><a href="#cb299-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1008"><a href="#cb299-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1009"><a href="#cb299-1009" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</span></span>
<span id="cb299-1010"><a href="#cb299-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1011"><a href="#cb299-1011" aria-hidden="true" tabindex="-1"></a>Apply to all data to obtain slope.</span>
<span id="cb299-1012"><a href="#cb299-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1015"><a href="#cb299-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1016"><a href="#cb299-1016" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span>
<span id="cb299-1017"><a href="#cb299-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1018"><a href="#cb299-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1019"><a href="#cb299-1019" aria-hidden="true" tabindex="-1"></a>*gut check* linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <span class="in">`nest()`</span> capability of tidyverse. Below, one experiment is subset to check the value.</span>
<span id="cb299-1020"><a href="#cb299-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1023"><a href="#cb299-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1024"><a href="#cb299-1024" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb299-1025"><a href="#cb299-1025" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb299-1026"><a href="#cb299-1026" aria-hidden="true" tabindex="-1"></a><span class="co"># # tmp_plume # View</span></span>
<span id="cb299-1027"><a href="#cb299-1027" aria-hidden="true" tabindex="-1"></a><span class="co"># # Perform linear regression</span></span>
<span id="cb299-1028"><a href="#cb299-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb299-1029"><a href="#cb299-1029" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Check output</span></span>
<span id="cb299-1030"><a href="#cb299-1030" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb299-1031"><a href="#cb299-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb299-1032"><a href="#cb299-1032" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Compare with nested function output</span></span>
<span id="cb299-1033"><a href="#cb299-1033" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span>
<span id="cb299-1034"><a href="#cb299-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1035"><a href="#cb299-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1036"><a href="#cb299-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot linear regression trend</span></span>
<span id="cb299-1037"><a href="#cb299-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1038"><a href="#cb299-1038" aria-hidden="true" tabindex="-1"></a>Plot all shipboard experiments with estimated slope.</span>
<span id="cb299-1039"><a href="#cb299-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1040"><a href="#cb299-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=5.5, fig.width=6}</span></span>
<span id="cb299-1041"><a href="#cb299-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb299-1042"><a href="#cb299-1042" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb299-1043"><a href="#cb299-1043" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb299-1044"><a href="#cb299-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1045"><a href="#cb299-1045" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1046"><a href="#cb299-1046" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-1047"><a href="#cb299-1047" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1048"><a href="#cb299-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1049"><a href="#cb299-1049" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1050"><a href="#cb299-1050" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-1051"><a href="#cb299-1051" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1052"><a href="#cb299-1052" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor name order and label</span></span>
<span id="cb299-1053"><a href="#cb299-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1054"><a href="#cb299-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1055"><a href="#cb299-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1056"><a href="#cb299-1056" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Filter out IGT samples for now</span></span>
<span id="cb299-1057"><a href="#cb299-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1058"><a href="#cb299-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, NameOrder, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1059"><a href="#cb299-1059" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, </span>
<span id="cb299-1060"><a href="#cb299-1060" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder, <span class="at">shape =</span> EXP_CATEGORY)) <span class="sc">+</span></span>
<span id="cb299-1061"><a href="#cb299-1061" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb299-1062"><a href="#cb299-1062" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb299-1063"><a href="#cb299-1063" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_CATEGORY, </span>
<span id="cb299-1064"><a href="#cb299-1064" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> SiteOrder, <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb299-1065"><a href="#cb299-1065" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-1066"><a href="#cb299-1066" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb299-1067"><a href="#cb299-1067" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)) <span class="sc">+</span></span>
<span id="cb299-1068"><a href="#cb299-1068" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(21, 21, 21, 21)) +</span></span>
<span id="cb299-1069"><a href="#cb299-1069" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_fill_manual(values = c("white", "#264653", "white", "#E76F51")) +</span></span>
<span id="cb299-1070"><a href="#cb299-1070" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   scale_color_manual(values = c("#264653", "#264653", "#E76F51", "#E76F51")) +</span></span>
<span id="cb299-1071"><a href="#cb299-1071" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb299-1072"><a href="#cb299-1072" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb299-1073"><a href="#cb299-1073" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Report r.squared</span></span>
<span id="cb299-1074"><a href="#cb299-1074" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb299-1075"><a href="#cb299-1075" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-1076"><a href="#cb299-1076" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb299-1077"><a href="#cb299-1077" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1078"><a href="#cb299-1078" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb299-1079"><a href="#cb299-1079" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1080"><a href="#cb299-1080" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb299-1081"><a href="#cb299-1081" aria-hidden="true" tabindex="-1"></a>shipboardregression</span>
<span id="cb299-1082"><a href="#cb299-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1083"><a href="#cb299-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1084"><a href="#cb299-1084" aria-hidden="true" tabindex="-1"></a>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</span>
<span id="cb299-1085"><a href="#cb299-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1086"><a href="#cb299-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remove IGT Tf time points.</span></span>
<span id="cb299-1087"><a href="#cb299-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1088"><a href="#cb299-1088" aria-hidden="true" tabindex="-1"></a>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</span>
<span id="cb299-1089"><a href="#cb299-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1092"><a href="#cb299-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1093"><a href="#cb299-1093" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb299-1094"><a href="#cb299-1094" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb299-1095"><a href="#cb299-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1096"><a href="#cb299-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1097"><a href="#cb299-1097" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb299-1098"><a href="#cb299-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"b"</span>, Replicate_ID)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1099"><a href="#cb299-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1100"><a href="#cb299-1100" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1101"><a href="#cb299-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1102"><a href="#cb299-1102" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb299-1103"><a href="#cb299-1103" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span>
<span id="cb299-1104"><a href="#cb299-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1105"><a href="#cb299-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1106"><a href="#cb299-1106" aria-hidden="true" tabindex="-1"></a>Plot IGT grazing experiments with newly calculated grazing effect.</span>
<span id="cb299-1107"><a href="#cb299-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1110"><a href="#cb299-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1111"><a href="#cb299-1111" aria-hidden="true" tabindex="-1"></a>igtregression <span class="ot">&lt;-</span> igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb299-1112"><a href="#cb299-1112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb299-1113"><a href="#cb299-1113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb299-1114"><a href="#cb299-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1115"><a href="#cb299-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1116"><a href="#cb299-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb299-1117"><a href="#cb299-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb299-1118"><a href="#cb299-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb299-1119"><a href="#cb299-1119" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb299-1120"><a href="#cb299-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-1121"><a href="#cb299-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb299-1122"><a href="#cb299-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb299-1123"><a href="#cb299-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb299-1124"><a href="#cb299-1124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb299-1125"><a href="#cb299-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb299-1126"><a href="#cb299-1126" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-1127"><a href="#cb299-1127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb299-1128"><a href="#cb299-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1129"><a href="#cb299-1129" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb299-1130"><a href="#cb299-1130" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1131"><a href="#cb299-1131" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb299-1132"><a href="#cb299-1132" aria-hidden="true" tabindex="-1"></a>igtregression</span>
<span id="cb299-1133"><a href="#cb299-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1134"><a href="#cb299-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1135"><a href="#cb299-1135" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Results are more consistent across experiments when we remove Tf from the IGT experiments</span></span>
<span id="cb299-1136"><a href="#cb299-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1137"><a href="#cb299-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S4</span></span>
<span id="cb299-1138"><a href="#cb299-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1139"><a href="#cb299-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=12, fig.width=7}</span></span>
<span id="cb299-1140"><a href="#cb299-1140" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS3.svg", h = 12, w = 7)</span></span>
<span id="cb299-1141"><a href="#cb299-1141" aria-hidden="true" tabindex="-1"></a>shipboardregression <span class="sc">+</span> igtregression <span class="sc">+</span></span>
<span id="cb299-1142"><a href="#cb299-1142" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb299-1143"><a href="#cb299-1143" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-1144"><a href="#cb299-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1145"><a href="#cb299-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1146"><a href="#cb299-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repeat, but include technical replicates</span></span>
<span id="cb299-1147"><a href="#cb299-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1148"><a href="#cb299-1148" aria-hidden="true" tabindex="-1"></a>Assess technical replicates for supplemental.</span>
<span id="cb299-1149"><a href="#cb299-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1152"><a href="#cb299-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1153"><a href="#cb299-1153" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf_wb <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb299-1154"><a href="#cb299-1154" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb299-1155"><a href="#cb299-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1156"><a href="#cb299-1156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1157"><a href="#cb299-1157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove repeated counts. Use this in supplement</span></span>
<span id="cb299-1158"><a href="#cb299-1158" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!grepl("b", Replicate_ID)) %&gt;% </span></span>
<span id="cb299-1159"><a href="#cb299-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1160"><a href="#cb299-1160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(EXP_TYPE = IGT_REP) %&gt;% </span></span>
<span id="cb299-1161"><a href="#cb299-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> Replicate_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1162"><a href="#cb299-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, Replicate_ID, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1163"><a href="#cb299-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>REP, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1164"><a href="#cb299-1164" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1165"><a href="#cb299-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1166"><a href="#cb299-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb299-1167"><a href="#cb299-1167" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf_wb) <span class="co"># Recalculate</span></span>
<span id="cb299-1168"><a href="#cb299-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1169"><a href="#cb299-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1170"><a href="#cb299-1170" aria-hidden="true" tabindex="-1"></a>Plot IGT grazing experiments with newly calculated slope.</span>
<span id="cb299-1171"><a href="#cb299-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1172"><a href="#cb299-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S9</span></span>
<span id="cb299-1173"><a href="#cb299-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1176"><a href="#cb299-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1177"><a href="#cb299-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS9_new.svg")</span></span>
<span id="cb299-1178"><a href="#cb299-1178" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf_wb <span class="sc">%&gt;%</span> </span>
<span id="cb299-1179"><a href="#cb299-1179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb299-1180"><a href="#cb299-1180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb299-1181"><a href="#cb299-1181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only isolate IGT 4s, where the technical replicates were done</span></span>
<span id="cb299-1182"><a href="#cb299-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"IGT4"</span>, IGT_REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1183"><a href="#cb299-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SITE_ORDER =</span> <span class="fu">factor</span>(SITE, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1184"><a href="#cb299-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Name, IGT_REP, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1185"><a href="#cb299-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> SITE_ORDER, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb299-1186"><a href="#cb299-1186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb299-1187"><a href="#cb299-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb299-1188"><a href="#cb299-1188" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">color =</span> SITE_ORDER)) <span class="sc">+</span></span>
<span id="cb299-1189"><a href="#cb299-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-1190"><a href="#cb299-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> site_color) <span class="sc">+</span></span>
<span id="cb299-1191"><a href="#cb299-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb299-1192"><a href="#cb299-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb299-1193"><a href="#cb299-1193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb299-1194"><a href="#cb299-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb299-1195"><a href="#cb299-1195" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-1196"><a href="#cb299-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb299-1197"><a href="#cb299-1197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1198"><a href="#cb299-1198" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb299-1199"><a href="#cb299-1199" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1200"><a href="#cb299-1200" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb299-1201"><a href="#cb299-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-1202"><a href="#cb299-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1203"><a href="#cb299-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1204"><a href="#cb299-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compile and save grazing experiment results</span></span>
<span id="cb299-1205"><a href="#cb299-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1208"><a href="#cb299-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1209"><a href="#cb299-1209" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb299-1210"><a href="#cb299-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1211"><a href="#cb299-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1212"><a href="#cb299-1212" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1213"><a href="#cb299-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1214"><a href="#cb299-1214" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb299-1215"><a href="#cb299-1215" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb299-1216"><a href="#cb299-1216" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb299-1217"><a href="#cb299-1217" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb299-1218"><a href="#cb299-1218" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb299-1219"><a href="#cb299-1219" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-1220"><a href="#cb299-1220" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-1221"><a href="#cb299-1221" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb299-1222"><a href="#cb299-1222" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb299-1223"><a href="#cb299-1223" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb299-1224"><a href="#cb299-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1225"><a href="#cb299-1225" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb299-1226"><a href="#cb299-1226" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="sc">%&gt;%</span></span>
<span id="cb299-1227"><a href="#cb299-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrigin, SiteOrder, NameOrder, Experiment, SizeFrac, r.squared, INTERCEPT, SLOPE) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb299-1228"><a href="#cb299-1228" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span>
<span id="cb299-1229"><a href="#cb299-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1230"><a href="#cb299-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1231"><a href="#cb299-1231" aria-hidden="true" tabindex="-1"></a><span class="fu"># Check FLP control experiments</span></span>
<span id="cb299-1232"><a href="#cb299-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1233"><a href="#cb299-1233" aria-hidden="true" tabindex="-1"></a>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</span>
<span id="cb299-1234"><a href="#cb299-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1237"><a href="#cb299-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1238"><a href="#cb299-1238" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb299-1239"><a href="#cb299-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb299-1240"><a href="#cb299-1240" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb299-1241"><a href="#cb299-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ORIG_ID =</span> Site) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1242"><a href="#cb299-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1243"><a href="#cb299-1243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1244"><a href="#cb299-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1245"><a href="#cb299-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Name <span class="sc">==</span> <span class="st">"Rav2"</span> <span class="sc">&amp;</span> Cells.ml <span class="sc">&gt;</span> <span class="dv">90000</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove inconsistent replicate from Ravelin #2</span></span>
<span id="cb299-1246"><a href="#cb299-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Name <span class="sc">==</span> <span class="st">"Rav2"</span> <span class="sc">&amp;</span> Replicate <span class="sc">==</span> <span class="st">"REP1"</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove inconsistent replicate from Ravelin #2</span></span>
<span id="cb299-1247"><a href="#cb299-1247" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1248"><a href="#cb299-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1249"><a href="#cb299-1249" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-1250"><a href="#cb299-1250" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span></span>
<span id="cb299-1251"><a href="#cb299-1251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span></span>
<span id="cb299-1252"><a href="#cb299-1252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml),</span>
<span id="cb299-1253"><a href="#cb299-1253" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(Cells.ml),</span>
<span id="cb299-1254"><a href="#cb299-1254" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1255"><a href="#cb299-1255" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1256"><a href="#cb299-1256" aria-hidden="true" tabindex="-1"></a><span class="co"># dtaf_avg</span></span>
<span id="cb299-1257"><a href="#cb299-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1258"><a href="#cb299-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1259"><a href="#cb299-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bag grazing experiment controls</span></span>
<span id="cb299-1260"><a href="#cb299-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1261"><a href="#cb299-1261" aria-hidden="true" tabindex="-1"></a>Option to plot averages. However, consistency between Replicate 1 and 2 was not always great. So plotting individually is best to show that the FLP do not disappear due to anomalous reasons.</span>
<span id="cb299-1262"><a href="#cb299-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1263"><a href="#cb299-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=7, fig.width=7}</span></span>
<span id="cb299-1264"><a href="#cb299-1264" aria-hidden="true" tabindex="-1"></a><span class="co"># bag_ctrls &lt;- dtaf_avg %&gt;% </span></span>
<span id="cb299-1265"><a href="#cb299-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Site != "IGT") %&gt;% </span></span>
<span id="cb299-1266"><a href="#cb299-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = TimePoint, y = Avg_cellsperml, fill = Name, shape = Site)) +</span></span>
<span id="cb299-1267"><a href="#cb299-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar(aes(ymin = MIN, ymax = MAX), width = 0.1) +</span></span>
<span id="cb299-1268"><a href="#cb299-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_rect(data = filter(dtaf_avg, TimePoint == "T0", Site != "IGT"), aes(</span></span>
<span id="cb299-1269"><a href="#cb299-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            ymin = (Avg_cellsperml-(0.15*Avg_cellsperml)),</span></span>
<span id="cb299-1270"><a href="#cb299-1270" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            ymax = (Avg_cellsperml+(0.15*Avg_cellsperml))), color = NA, alpha = 0.4, xmin = 0, xmax = 6, fill = "black") +</span></span>
<span id="cb299-1271"><a href="#cb299-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(aes(group = Name)) +</span></span>
<span id="cb299-1272"><a href="#cb299-1272" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(stat = "identity", aes(shape = Site, fill = Name), size = 2) +</span></span>
<span id="cb299-1273"><a href="#cb299-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb299-1274"><a href="#cb299-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(Name ~ Site) +</span></span>
<span id="cb299-1275"><a href="#cb299-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_log10(labels = scientific_10) +</span></span>
<span id="cb299-1276"><a href="#cb299-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() + theme(strip.background = element_blank(), </span></span>
<span id="cb299-1277"><a href="#cb299-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend.title = element_blank(),</span></span>
<span id="cb299-1278"><a href="#cb299-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#                      axis.text = element_text(size = 10, color = "black"),</span></span>
<span id="cb299-1279"><a href="#cb299-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = element_text(size = 10, face = "bold"),</span></span>
<span id="cb299-1280"><a href="#cb299-1280" aria-hidden="true" tabindex="-1"></a><span class="co">#                           axis.title = element_text(size = 9)) +</span></span>
<span id="cb299-1281"><a href="#cb299-1281" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "FLP counts for controls", y = bquote("Log FLP "~mL^-1), x = "Time point")</span></span>
<span id="cb299-1282"><a href="#cb299-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># bag_ctrls</span></span>
<span id="cb299-1283"><a href="#cb299-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1284"><a href="#cb299-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1285"><a href="#cb299-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=7, fig.width=8}</span></span>
<span id="cb299-1286"><a href="#cb299-1286" aria-hidden="true" tabindex="-1"></a><span class="co"># View(dtaf)</span></span>
<span id="cb299-1287"><a href="#cb299-1287" aria-hidden="true" tabindex="-1"></a>ship_ctrls_reps <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb299-1288"><a href="#cb299-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1289"><a href="#cb299-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Cells.ml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb299-1290"><a href="#cb299-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb299-1291"><a href="#cb299-1291" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Cells.ml<span class="sc">-</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml)),</span>
<span id="cb299-1292"><a href="#cb299-1292" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Cells.ml<span class="sc">+</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-1293"><a href="#cb299-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb299-1294"><a href="#cb299-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Replicate), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-1295"><a href="#cb299-1295" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb299-1296"><a href="#cb299-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb299-1297"><a href="#cb299-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-1298"><a href="#cb299-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-1299"><a href="#cb299-1299" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1300"><a href="#cb299-1300" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb299-1301"><a href="#cb299-1301" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb299-1302"><a href="#cb299-1302" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb299-1303"><a href="#cb299-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb299-1304"><a href="#cb299-1304" aria-hidden="true" tabindex="-1"></a>ship_ctrls_reps</span>
<span id="cb299-1305"><a href="#cb299-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1306"><a href="#cb299-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1307"><a href="#cb299-1307" aria-hidden="true" tabindex="-1"></a><span class="fu">## IGT experiment controls</span></span>
<span id="cb299-1308"><a href="#cb299-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1309"><a href="#cb299-1309" aria-hidden="true" tabindex="-1"></a>Repeat for IGT experiments.</span>
<span id="cb299-1310"><a href="#cb299-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1311"><a href="#cb299-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=6, fig.height=5}</span></span>
<span id="cb299-1312"><a href="#cb299-1312" aria-hidden="true" tabindex="-1"></a>igt_ctrl_reps <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb299-1313"><a href="#cb299-1313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1314"><a href="#cb299-1314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Cells.ml, <span class="at">shape =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb299-1315"><a href="#cb299-1315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb299-1316"><a href="#cb299-1316" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Cells.ml<span class="sc">-</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml)),</span>
<span id="cb299-1317"><a href="#cb299-1317" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Cells.ml<span class="sc">+</span>(<span class="fl">0.15</span><span class="sc">*</span>Cells.ml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-1318"><a href="#cb299-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb299-1319"><a href="#cb299-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Replicate), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-1320"><a href="#cb299-1320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> ORIG_ID) <span class="sc">+</span></span>
<span id="cb299-1321"><a href="#cb299-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-1322"><a href="#cb299-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-1323"><a href="#cb299-1323" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1324"><a href="#cb299-1324" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb299-1325"><a href="#cb299-1325" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb299-1326"><a href="#cb299-1326" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb299-1327"><a href="#cb299-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span>
<span id="cb299-1328"><a href="#cb299-1328" aria-hidden="true" tabindex="-1"></a>igt_ctrl_reps</span>
<span id="cb299-1329"><a href="#cb299-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1330"><a href="#cb299-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1331"><a href="#cb299-1331" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure S6</span></span>
<span id="cb299-1332"><a href="#cb299-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1335"><a href="#cb299-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1336"><a href="#cb299-1336" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6_1.svg", w = 9, h = 7)</span></span>
<span id="cb299-1337"><a href="#cb299-1337" aria-hidden="true" tabindex="-1"></a>ship_ctrls_reps</span>
<span id="cb299-1338"><a href="#cb299-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-1339"><a href="#cb299-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1340"><a href="#cb299-1340" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6_2.svg", w = 7, h = 5)</span></span>
<span id="cb299-1341"><a href="#cb299-1341" aria-hidden="true" tabindex="-1"></a>igt_ctrl_reps</span>
<span id="cb299-1342"><a href="#cb299-1342" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-1343"><a href="#cb299-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1344"><a href="#cb299-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1345"><a href="#cb299-1345" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate complete table with grazing rates and values</span></span>
<span id="cb299-1346"><a href="#cb299-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1349"><a href="#cb299-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1350"><a href="#cb299-1350" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb299-1351"><a href="#cb299-1351" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb299-1352"><a href="#cb299-1352" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb299-1353"><a href="#cb299-1353" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb299-1354"><a href="#cb299-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1355"><a href="#cb299-1355" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb299-1356"><a href="#cb299-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1357"><a href="#cb299-1357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, IGT_REP, Site, Name, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1358"><a href="#cb299-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-1359"><a href="#cb299-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, IGT_REP, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, SiteOrder, NameOrder, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1360"><a href="#cb299-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1361"><a href="#cb299-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb299-1362"><a href="#cb299-1362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1363"><a href="#cb299-1363" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb299-1364"><a href="#cb299-1364" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb299-1365"><a href="#cb299-1365" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb299-1366"><a href="#cb299-1366" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1367"><a href="#cb299-1367" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume-Shipboard"</span>,</span>
<span id="cb299-1368"><a href="#cb299-1368" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background-Shipboard"</span>,</span>
<span id="cb299-1369"><a href="#cb299-1369" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb299-1370"><a href="#cb299-1370" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Shipboard"</span></span>
<span id="cb299-1371"><a href="#cb299-1371" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb299-1372"><a href="#cb299-1372" aria-hidden="true" tabindex="-1"></a>  <span class="at">LABEL_REPS =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1373"><a href="#cb299-1373" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1374"><a href="#cb299-1374" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-1375"><a href="#cb299-1375" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-1376"><a href="#cb299-1376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, LABEL_REPS, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1377"><a href="#cb299-1377" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1378"><a href="#cb299-1378" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="co"># view complete table of grazing rate results</span></span>
<span id="cb299-1379"><a href="#cb299-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1380"><a href="#cb299-1380" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb299-1381"><a href="#cb299-1381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1382"><a href="#cb299-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb299-1383"><a href="#cb299-1383" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb299-1384"><a href="#cb299-1384" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span>
<span id="cb299-1385"><a href="#cb299-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1386"><a href="#cb299-1386" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="sc">%&gt;%</span> </span>
<span id="cb299-1387"><a href="#cb299-1387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1388"><a href="#cb299-1388" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb299-1389"><a href="#cb299-1389" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"non-vent"</span>,</span>
<span id="cb299-1390"><a href="#cb299-1390" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"vent"</span></span>
<span id="cb299-1391"><a href="#cb299-1391" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1392"><a href="#cb299-1392" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(Site, TYPE) %&gt;% </span></span>
<span id="cb299-1393"><a href="#cb299-1393" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(TYPE) %&gt;%</span></span>
<span id="cb299-1394"><a href="#cb299-1394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TYPE, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1395"><a href="#cb299-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rate =</span> <span class="fu">mean</span>(GRAZE_RATE),</span>
<span id="cb299-1396"><a href="#cb299-1396" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_rate =</span> <span class="fu">min</span>(GRAZE_RATE),</span>
<span id="cb299-1397"><a href="#cb299-1397" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(GRAZE_RATE))</span>
<span id="cb299-1398"><a href="#cb299-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1399"><a href="#cb299-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1400"><a href="#cb299-1400" aria-hidden="true" tabindex="-1"></a>Amend table with estimated FLP concentration</span>
<span id="cb299-1401"><a href="#cb299-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1404"><a href="#cb299-1404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1405"><a href="#cb299-1405" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb299-1406"><a href="#cb299-1406" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb299-1407"><a href="#cb299-1407" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-1408"><a href="#cb299-1408" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb299-1409"><a href="#cb299-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1410"><a href="#cb299-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1411"><a href="#cb299-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb299-1412"><a href="#cb299-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1413"><a href="#cb299-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1414"><a href="#cb299-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_ml =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1415"><a href="#cb299-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>, <span class="sc">-</span>FLP_conc) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1416"><a href="#cb299-1416" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1417"><a href="#cb299-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1418"><a href="#cb299-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1419"><a href="#cb299-1419" aria-hidden="true" tabindex="-1"></a>Introduce factors in table for visualizations</span>
<span id="cb299-1420"><a href="#cb299-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1423"><a href="#cb299-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1424"><a href="#cb299-1424" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb299-1425"><a href="#cb299-1425" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb299-1426"><a href="#cb299-1426" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb299-1427"><a href="#cb299-1427" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb299-1428"><a href="#cb299-1428" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb299-1429"><a href="#cb299-1429" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb299-1430"><a href="#cb299-1430" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-1431"><a href="#cb299-1431" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-1432"><a href="#cb299-1432" aria-hidden="true" tabindex="-1"></a>site_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E76F51"</span>, <span class="st">"#264653"</span>)</span>
<span id="cb299-1433"><a href="#cb299-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(site_color) <span class="ot">&lt;-</span> site_fullname</span>
<span id="cb299-1434"><a href="#cb299-1434" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>FIELDORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb299-1435"><a href="#cb299-1435" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>VENTORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb299-1436"><a href="#cb299-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1437"><a href="#cb299-1437" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp</span></span>
<span id="cb299-1438"><a href="#cb299-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1439"><a href="#cb299-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1440"><a href="#cb299-1440" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot FLP/grazer /minute</span></span>
<span id="cb299-1441"><a href="#cb299-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1444"><a href="#cb299-1444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1445"><a href="#cb299-1445" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb299-1446"><a href="#cb299-1446" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb299-1447"><a href="#cb299-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1448"><a href="#cb299-1448" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1449"><a href="#cb299-1449" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span></span>
<span id="cb299-1450"><a href="#cb299-1450" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1451"><a href="#cb299-1451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_CATEGORY_WREP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1452"><a href="#cb299-1452" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1453"><a href="#cb299-1453" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-1454"><a href="#cb299-1454" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1455"><a href="#cb299-1455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, FIELD, EXP_CATEGORY, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1456"><a href="#cb299-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> VENTORDER, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-1457"><a href="#cb299-1457" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-1458"><a href="#cb299-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-1459"><a href="#cb299-1459" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb299-1460"><a href="#cb299-1460" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb299-1461"><a href="#cb299-1461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-1462"><a href="#cb299-1462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-1463"><a href="#cb299-1463" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-1464"><a href="#cb299-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>FIELDORDER, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-1465"><a href="#cb299-1465" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb299-1466"><a href="#cb299-1466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-1467"><a href="#cb299-1467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1468"><a href="#cb299-1468" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-1469"><a href="#cb299-1469" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-1470"><a href="#cb299-1470" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-1471"><a href="#cb299-1471" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-1472"><a href="#cb299-1472" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-1473"><a href="#cb299-1473" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-1474"><a href="#cb299-1474" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-1475"><a href="#cb299-1475" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1476"><a href="#cb299-1476" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb299-1477"><a href="#cb299-1477" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-1478"><a href="#cb299-1478" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-1479"><a href="#cb299-1479" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span>
<span id="cb299-1480"><a href="#cb299-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1481"><a href="#cb299-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1482"><a href="#cb299-1482" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1</span></span>
<span id="cb299-1483"><a href="#cb299-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1484"><a href="#cb299-1484" aria-hidden="true" tabindex="-1"></a>Create table with all base experiment results. Including, grazing rate derived from slope (and corrected), number of experiments, replicates, and prok and euk counts.</span>
<span id="cb299-1485"><a href="#cb299-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1486"><a href="#cb299-1486" aria-hidden="true" tabindex="-1"></a>For IGT experiments, or experiments where in situ prok counts were not obtained, the average in situ prok count was used.</span>
<span id="cb299-1487"><a href="#cb299-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1490"><a href="#cb299-1490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1491"><a href="#cb299-1491" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb299-1492"><a href="#cb299-1492" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb299-1493"><a href="#cb299-1493" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb299-1494"><a href="#cb299-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1495"><a href="#cb299-1495" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_grazerate_wflp)</span></span>
<span id="cb299-1496"><a href="#cb299-1496" aria-hidden="true" tabindex="-1"></a><span class="co"># View(euk_prok_counts)</span></span>
<span id="cb299-1497"><a href="#cb299-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1498"><a href="#cb299-1498" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb299-1499"><a href="#cb299-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Experiment_rep, FIELD, Name, SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, RATE, <span class="at">RATE_minute =</span> GRAZE_RATE, FLP_ml, TimePoints, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1500"><a href="#cb299-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(euk_prok_counts, <span class="fu">join_by</span>(Experiment_rep <span class="sc">==</span> Experiment_rep, Name <span class="sc">==</span> Name, FIELD <span class="sc">==</span> Site)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1501"><a href="#cb299-1501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(PROK_ml), avg_insitu, PROK_ml))</span>
<span id="cb299-1502"><a href="#cb299-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1503"><a href="#cb299-1503" aria-hidden="true" tabindex="-1"></a><span class="co"># table_grazerate_wflp_wprok_weuk</span></span>
<span id="cb299-1504"><a href="#cb299-1504" aria-hidden="true" tabindex="-1"></a><span class="co"># names(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb299-1505"><a href="#cb299-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1506"><a href="#cb299-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1507"><a href="#cb299-1507" aria-hidden="true" tabindex="-1"></a>Description of variables above:</span>
<span id="cb299-1508"><a href="#cb299-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1509"><a href="#cb299-1509" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FIELD - vent location</span>
<span id="cb299-1510"><a href="#cb299-1510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NAME - name of vent site, or plume/background</span>
<span id="cb299-1511"><a href="#cb299-1511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>EXP - experiment type, bag or IGT</span>
<span id="cb299-1512"><a href="#cb299-1512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SAMPLE - vent site</span>
<span id="cb299-1513"><a href="#cb299-1513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_minute = GRAZE_RATE - FLPs per grazer per minute (SLOPE of best fitline)</span>
<span id="cb299-1514"><a href="#cb299-1514" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FLP_ml - FLP concentration at T0</span>
<span id="cb299-1515"><a href="#cb299-1515" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prok_ml, sem - concentration and standard mean error of concentration of prokaryotes</span>
<span id="cb299-1516"><a href="#cb299-1516" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Euk_ml, sem - concentration and standard mean error of concentration of eukaryotes.</span>
<span id="cb299-1517"><a href="#cb299-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1518"><a href="#cb299-1518" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grazing rate calculations</span></span>
<span id="cb299-1519"><a href="#cb299-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1520"><a href="#cb299-1520" aria-hidden="true" tabindex="-1"></a>Based on Unrein et al. 2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</span>
<span id="cb299-1521"><a href="#cb299-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1524"><a href="#cb299-1524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1525"><a href="#cb299-1525" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb299-1526"><a href="#cb299-1526" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb299-1527"><a href="#cb299-1527" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb299-1528"><a href="#cb299-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_minute <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb299-1529"><a href="#cb299-1529" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb299-1530"><a href="#cb299-1530" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb299-1531"><a href="#cb299-1531" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb299-1532"><a href="#cb299-1532" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb299-1533"><a href="#cb299-1533" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb299-1534"><a href="#cb299-1534" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb299-1535"><a href="#cb299-1535" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb299-1536"><a href="#cb299-1536" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb299-1537"><a href="#cb299-1537" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb299-1538"><a href="#cb299-1538" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb299-1539"><a href="#cb299-1539" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb299-1540"><a href="#cb299-1540" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb299-1541"><a href="#cb299-1541" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb299-1542"><a href="#cb299-1542" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb299-1543"><a href="#cb299-1543" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb299-1544"><a href="#cb299-1544" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb299-1545"><a href="#cb299-1545" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb299-1546"><a href="#cb299-1546" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb299-1547"><a href="#cb299-1547" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb299-1548"><a href="#cb299-1548" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb299-1549"><a href="#cb299-1549" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1550"><a href="#cb299-1550" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-1551"><a href="#cb299-1551" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span>
<span id="cb299-1552"><a href="#cb299-1552" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs, file = "output-data/table-wcalc.txt", delim = "\t")</span></span>
<span id="cb299-1553"><a href="#cb299-1553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1554"><a href="#cb299-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1555"><a href="#cb299-1555" aria-hidden="true" tabindex="-1"></a>Explanation of units for table with calculated values.</span>
<span id="cb299-1556"><a href="#cb299-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1557"><a href="#cb299-1557" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RATE_min &amp; RATE_hr = Grazing rate as 'FLPs per grazer per minute' and per hour</span>
<span id="cb299-1558"><a href="#cb299-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1559"><a href="#cb299-1559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>CLEARANCE_RATE = ml or nL per grazer per hour</span>
<span id="cb299-1560"><a href="#cb299-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1561"><a href="#cb299-1561" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</span>
<span id="cb299-1562"><a href="#cb299-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1563"><a href="#cb299-1563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GRAZING EFFECT = bacteria per ml per hour</span>
<span id="cb299-1564"><a href="#cb299-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1565"><a href="#cb299-1565" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bacterial turnover rate = % per day</span>
<span id="cb299-1566"><a href="#cb299-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1567"><a href="#cb299-1567" aria-hidden="true" tabindex="-1"></a>Table 1 and S1 - grazing experiment information only</span>
<span id="cb299-1568"><a href="#cb299-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1571"><a href="#cb299-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1572"><a href="#cb299-1572" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Table 1</span></span>
<span id="cb299-1573"><a href="#cb299-1573" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb299-1574"><a href="#cb299-1574" aria-hidden="true" tabindex="-1"></a>              <span class="co"># select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE, EUK_ml, EUK_MinMax, PROK_ml, PROK_MinMax, GRAZING_EFFECT_hr, RATE_minute, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb299-1575"><a href="#cb299-1575" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb299-1576"><a href="#cb299-1576" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb299-1577"><a href="#cb299-1577" aria-hidden="true" tabindex="-1"></a><span class="co"># # ## Table S2</span></span>
<span id="cb299-1578"><a href="#cb299-1578" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs %&gt;%</span></span>
<span id="cb299-1579"><a href="#cb299-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#               select(SiteOrder, NameOrder, FLUID_ORIGIN, CRUISE_SAMPLE,</span></span>
<span id="cb299-1580"><a href="#cb299-1580" aria-hidden="true" tabindex="-1"></a><span class="co">#                      TimePoints, starts_with("EXP"), starts_with("CTRL"), EUK_ml, EUK_MinMax, EUK_sem, PROK_ml, PROK_MinMax, PROK_sem, FLP_ml, GRAZE_RATE_DAY, Slope = RATE, RATE_minute, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, BAC_TURNOVER_PERC),</span></span>
<span id="cb299-1581"><a href="#cb299-1581" aria-hidden="true" tabindex="-1"></a><span class="co">#             file = "output-data/tableS2-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb299-1582"><a href="#cb299-1582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1583"><a href="#cb299-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1584"><a href="#cb299-1584" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass for eukaryotes</span></span>
<span id="cb299-1585"><a href="#cb299-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1586"><a href="#cb299-1586" aria-hidden="true" tabindex="-1"></a>References for estimating biovolume *Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al. (2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782--792.*</span>
<span id="cb299-1587"><a href="#cb299-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1590"><a href="#cb299-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1591"><a href="#cb299-1591" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb299-1592"><a href="#cb299-1592" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb299-1593"><a href="#cb299-1593" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span>
<span id="cb299-1594"><a href="#cb299-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1595"><a href="#cb299-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1596"><a href="#cb299-1596" aria-hidden="true" tabindex="-1"></a><span class="fu">## C factor based on biovolume</span></span>
<span id="cb299-1597"><a href="#cb299-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1598"><a href="#cb299-1598" aria-hidden="true" tabindex="-1"></a>(1) Calculate biovolume based on observed/imaged cells</span>
<span id="cb299-1599"><a href="#cb299-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1602"><a href="#cb299-1602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1603"><a href="#cb299-1603" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate biovolume, then apply carbon by biomass estimate for protists derived from biovolume.</span></span>
<span id="cb299-1604"><a href="#cb299-1604" aria-hidden="true" tabindex="-1"></a><span class="co"># h = largest cell dimension "height"</span></span>
<span id="cb299-1605"><a href="#cb299-1605" aria-hidden="true" tabindex="-1"></a><span class="co"># d = largest cross-section of h</span></span>
<span id="cb299-1606"><a href="#cb299-1606" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb299-1607"><a href="#cb299-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIOVOLUME =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> h)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb299-1608"><a href="#cb299-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_dino =</span> (<span class="fl">0.760</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.819</span>))) <span class="sc">%&gt;%</span> <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb299-1609"><a href="#cb299-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell_MD_nodiatom =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (BIOVOLUME<span class="sc">^</span><span class="fl">0.939</span>))) <span class="co"># Menden-Deuer and Lessard 2000</span></span>
<span id="cb299-1610"><a href="#cb299-1610" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb299-1611"><a href="#cb299-1611" aria-hidden="true" tabindex="-1"></a><span class="co"># biov_calc</span></span>
<span id="cb299-1612"><a href="#cb299-1612" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(c(80, 360))</span></span>
<span id="cb299-1613"><a href="#cb299-1613" aria-hidden="true" tabindex="-1"></a><span class="co"># no diatom is what Pernice used.</span></span>
<span id="cb299-1614"><a href="#cb299-1614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1615"><a href="#cb299-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1616"><a href="#cb299-1616" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`pgC_cell_MD_nodiatom`</span> moving forward.</span>
<span id="cb299-1617"><a href="#cb299-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1618"><a href="#cb299-1618" aria-hidden="true" tabindex="-1"></a>(2) Get a summary pg per cell for vent and background samples. This is derived from biovolume estimates.</span>
<span id="cb299-1619"><a href="#cb299-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1620"><a href="#cb299-1620" aria-hidden="true" tabindex="-1"></a><span class="fu">## Biomass summaries</span></span>
<span id="cb299-1621"><a href="#cb299-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1624"><a href="#cb299-1624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1625"><a href="#cb299-1625" aria-hidden="true" tabindex="-1"></a>c_factor_biov <span class="ot">&lt;-</span> </span>
<span id="cb299-1626"><a href="#cb299-1626" aria-hidden="true" tabindex="-1"></a>  biov_calc <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>EXP, <span class="sc">-</span>h, <span class="sc">-</span>d) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1627"><a href="#cb299-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(BIOVOLUME, <span class="fu">starts_with</span>(<span class="st">"pgC_"</span>)), <span class="at">names_to =</span> <span class="st">"VARIABLES"</span>, <span class="at">values_to =</span> <span class="st">"VALUES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1628"><a href="#cb299-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW, VARIABLES) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1629"><a href="#cb299-1629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(VALUES),</span>
<span id="cb299-1630"><a href="#cb299-1630" aria-hidden="true" tabindex="-1"></a>              <span class="at">max =</span> <span class="fu">max</span>(VALUES),</span>
<span id="cb299-1631"><a href="#cb299-1631" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fu">min</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1632"><a href="#cb299-1632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VENT_BSW, <span class="at">values_from =</span> <span class="fu">c</span>(mean, max,min), <span class="at">names_sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb299-1633"><a href="#cb299-1633" aria-hidden="true" tabindex="-1"></a><span class="co"># View(c_factor_biov)</span></span>
<span id="cb299-1634"><a href="#cb299-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1635"><a href="#cb299-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1636"><a href="#cb299-1636" aria-hidden="true" tabindex="-1"></a>(3) Assign a C conversion factor for background and within vents based on biovolume</span>
<span id="cb299-1637"><a href="#cb299-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1640"><a href="#cb299-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1641"><a href="#cb299-1641" aria-hidden="true" tabindex="-1"></a><span class="co"># pg C per cell (pgC_cell)</span></span>
<span id="cb299-1642"><a href="#cb299-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1643"><a href="#cb299-1643" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_BSW</span>
<span id="cb299-1644"><a href="#cb299-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1645"><a href="#cb299-1645" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>mean_vent</span>
<span id="cb299-1646"><a href="#cb299-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1647"><a href="#cb299-1647" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_BSW</span>
<span id="cb299-1648"><a href="#cb299-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1649"><a href="#cb299-1649" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_min <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>min_vent</span>
<span id="cb299-1650"><a href="#cb299-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1651"><a href="#cb299-1651" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_BSW</span>
<span id="cb299-1652"><a href="#cb299-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1653"><a href="#cb299-1653" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent_max <span class="ot">&lt;-</span> <span class="fu">subset</span>(c_factor_biov, VARIABLES <span class="sc">==</span> <span class="st">"pgC_cell_MD_nodiatom"</span>)<span class="sc">$</span>max_vent</span>
<span id="cb299-1654"><a href="#cb299-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1655"><a href="#cb299-1655" aria-hidden="true" tabindex="-1"></a>pgC_cell_BSW</span>
<span id="cb299-1656"><a href="#cb299-1656" aria-hidden="true" tabindex="-1"></a>pgC_cell_vent</span>
<span id="cb299-1657"><a href="#cb299-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1658"><a href="#cb299-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1659"><a href="#cb299-1659" aria-hidden="true" tabindex="-1"></a>(4) Combine with count table to estimate total standing stock in carbon</span>
<span id="cb299-1660"><a href="#cb299-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1661"><a href="#cb299-1661" aria-hidden="true" tabindex="-1"></a>Isolate at T0 all the euk cells per ml counts. Then add in the mean, min/max for the pg C per cell, based on the vent vs non-vent.</span>
<span id="cb299-1662"><a href="#cb299-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1665"><a href="#cb299-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1666"><a href="#cb299-1666" aria-hidden="true" tabindex="-1"></a><span class="co"># counts_cellsml_avg</span></span>
<span id="cb299-1667"><a href="#cb299-1667" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb299-1668"><a href="#cb299-1668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1669"><a href="#cb299-1669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1670"><a href="#cb299-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1671"><a href="#cb299-1671" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-1672"><a href="#cb299-1672" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-1673"><a href="#cb299-1673" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-1674"><a href="#cb299-1674" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1675"><a href="#cb299-1675" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pg C per ml = (cells per ml)*(pg C per)</span></span>
<span id="cb299-1676"><a href="#cb299-1676" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Apply the non-vent and vent pg C per cell value to total cells per ml</span></span>
<span id="cb299-1677"><a href="#cb299-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1678"><a href="#cb299-1678" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW,</span>
<span id="cb299-1679"><a href="#cb299-1679" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent,</span>
<span id="cb299-1680"><a href="#cb299-1680" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1681"><a href="#cb299-1681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_min =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1682"><a href="#cb299-1682" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_min,</span>
<span id="cb299-1683"><a href="#cb299-1683" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_min</span>
<span id="cb299-1684"><a href="#cb299-1684" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1685"><a href="#cb299-1685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_ml_max =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1686"><a href="#cb299-1686" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Non-vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_BSW_max,</span>
<span id="cb299-1687"><a href="#cb299-1687" aria-hidden="true" tabindex="-1"></a>    SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span> <span class="sc">~</span> MEAN <span class="sc">*</span> pgC_cell_vent_max</span>
<span id="cb299-1688"><a href="#cb299-1688" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1689"><a href="#cb299-1689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1690"><a href="#cb299-1690" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1691"><a href="#cb299-1691" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-1692"><a href="#cb299-1692" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1693"><a href="#cb299-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span>
<span id="cb299-1694"><a href="#cb299-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1695"><a href="#cb299-1695" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample</span>
<span id="cb299-1696"><a href="#cb299-1696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1697"><a href="#cb299-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1698"><a href="#cb299-1698" aria-hidden="true" tabindex="-1"></a>Table reports the total pg of carbon per ml when we consider the whole eukaryote community (based on cell count).</span>
<span id="cb299-1699"><a href="#cb299-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1700"><a href="#cb299-1700" aria-hidden="true" tabindex="-1"></a>Report in pg of C per ml.</span>
<span id="cb299-1701"><a href="#cb299-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1704"><a href="#cb299-1704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1705"><a href="#cb299-1705" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"Shrimpocalypse"</span>, </span>
<span id="cb299-1706"><a href="#cb299-1706" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ShrimpHole"</span>, <span class="st">"X18"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"OMT"</span>)</span>
<span id="cb299-1707"><a href="#cb299-1707" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"Shrimpocalypse"</span>,  </span>
<span id="cb299-1708"><a href="#cb299-1708" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Shrimp Hole"</span>, <span class="st">"X-18"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Old Man Tree"</span>)</span>
<span id="cb299-1709"><a href="#cb299-1709" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-1710"><a href="#cb299-1710" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-1711"><a href="#cb299-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1712"><a href="#cb299-1712" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb299-1713"><a href="#cb299-1713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1714"><a href="#cb299-1714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1715"><a href="#cb299-1715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pgC_ml_mean))) <span class="sc">+</span></span>
<span id="cb299-1716"><a href="#cb299-1716" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb299-1717"><a href="#cb299-1717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (pgC_ml_min), <span class="at">ymax =</span> (pgC_ml_max))) <span class="sc">+</span></span>
<span id="cb299-1718"><a href="#cb299-1718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-1719"><a href="#cb299-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-1720"><a href="#cb299-1720" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-1721"><a href="#cb299-1721" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1722"><a href="#cb299-1722" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-1723"><a href="#cb299-1723" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-1724"><a href="#cb299-1724" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb299-1725"><a href="#cb299-1725" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-1726"><a href="#cb299-1726" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-1727"><a href="#cb299-1727" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-1728"><a href="#cb299-1728" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-1729"><a href="#cb299-1729" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb299-1730"><a href="#cb299-1730" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb299-1731"><a href="#cb299-1731" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb299-1732"><a href="#cb299-1732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-1733"><a href="#cb299-1733" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - derived from biovolume"</span>)</span>
<span id="cb299-1734"><a href="#cb299-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1735"><a href="#cb299-1735" aria-hidden="true" tabindex="-1"></a>by_biovol_plot</span>
<span id="cb299-1736"><a href="#cb299-1736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1737"><a href="#cb299-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1738"><a href="#cb299-1738" aria-hidden="true" tabindex="-1"></a><span class="fu">## C biomass based on size fraction</span></span>
<span id="cb299-1739"><a href="#cb299-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1740"><a href="#cb299-1740" aria-hidden="true" tabindex="-1"></a>Derived from Caron et al. 1995</span>
<span id="cb299-1741"><a href="#cb299-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1742"><a href="#cb299-1742" aria-hidden="true" tabindex="-1"></a>(1) Assign by size class</span>
<span id="cb299-1743"><a href="#cb299-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1744"><a href="#cb299-1744" aria-hidden="true" tabindex="-1"></a>Assuming conversion factor is 183 fg C per um.</span>
<span id="cb299-1745"><a href="#cb299-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1746"><a href="#cb299-1746" aria-hidden="true" tabindex="-1"></a>For nanoplankton <span class="sc">\&lt;</span>20um, picoplankton are included for now. We are assuming the size range of nanoplankton are 3um.</span>
<span id="cb299-1747"><a href="#cb299-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1750"><a href="#cb299-1750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1751"><a href="#cb299-1751" aria-hidden="true" tabindex="-1"></a>vol_nano <span class="ot">&lt;-</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> pi <span class="sc">*</span> (<span class="dv">3</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb299-1752"><a href="#cb299-1752" aria-hidden="true" tabindex="-1"></a>vol_nano <span class="co"># units are um^3</span></span>
<span id="cb299-1753"><a href="#cb299-1753" aria-hidden="true" tabindex="-1"></a>fg_nano_c <span class="ot">&lt;-</span> <span class="dv">183</span> <span class="sc">*</span> vol_nano <span class="co">#units are now fg per C</span></span>
<span id="cb299-1754"><a href="#cb299-1754" aria-hidden="true" tabindex="-1"></a>c_n <span class="ot">&lt;-</span> (fg_nano_c)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb299-1755"><a href="#cb299-1755" aria-hidden="true" tabindex="-1"></a>c_n</span>
<span id="cb299-1756"><a href="#cb299-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1757"><a href="#cb299-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1758"><a href="#cb299-1758" aria-hidden="true" tabindex="-1"></a>For microplankton, we are assuming the cell diameter is 50 um.</span>
<span id="cb299-1759"><a href="#cb299-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1762"><a href="#cb299-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1763"><a href="#cb299-1763" aria-hidden="true" tabindex="-1"></a>vol_micr <span class="ot">&lt;-</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> pi <span class="sc">*</span> (<span class="dv">50</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb299-1764"><a href="#cb299-1764" aria-hidden="true" tabindex="-1"></a>vol_micr <span class="co"># units are um^3</span></span>
<span id="cb299-1765"><a href="#cb299-1765" aria-hidden="true" tabindex="-1"></a>fg_micr_c <span class="ot">&lt;-</span> <span class="dv">183</span> <span class="sc">*</span> vol_micr <span class="co">#units are now fg per C</span></span>
<span id="cb299-1766"><a href="#cb299-1766" aria-hidden="true" tabindex="-1"></a>c_m <span class="ot">&lt;-</span> (fg_micr_c)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb299-1767"><a href="#cb299-1767" aria-hidden="true" tabindex="-1"></a>c_m</span>
<span id="cb299-1768"><a href="#cb299-1768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1769"><a href="#cb299-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1772"><a href="#cb299-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1773"><a href="#cb299-1773" aria-hidden="true" tabindex="-1"></a>c_n</span>
<span id="cb299-1774"><a href="#cb299-1774" aria-hidden="true" tabindex="-1"></a>c_m <span class="sc">*</span> (<span class="fl">1e-6</span>)</span>
<span id="cb299-1775"><a href="#cb299-1775" aria-hidden="true" tabindex="-1"></a><span class="co"># 1pg to 1e-6ug</span></span>
<span id="cb299-1776"><a href="#cb299-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1777"><a href="#cb299-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1780"><a href="#cb299-1780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1781"><a href="#cb299-1781" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample_tmp <span class="ot">&lt;-</span> counts_cellsml_avg <span class="sc">%&gt;%</span> </span>
<span id="cb299-1782"><a href="#cb299-1782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1783"><a href="#cb299-1783" aria-hidden="true" tabindex="-1"></a>    IGT_REP <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-1784"><a href="#cb299-1784" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> IGT_REP</span>
<span id="cb299-1785"><a href="#cb299-1785" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1786"><a href="#cb299-1786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment_rep"</span>, Name, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1787"><a href="#cb299-1787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-1788"><a href="#cb299-1788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">!=</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> <span class="co"># isolate micro vs. nano</span></span>
<span id="cb299-1789"><a href="#cb299-1789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1790"><a href="#cb299-1790" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-1791"><a href="#cb299-1791" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-1792"><a href="#cb299-1792" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-1793"><a href="#cb299-1793" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1794"><a href="#cb299-1794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_cell =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-1795"><a href="#cb299-1795" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"microCONC"</span> <span class="sc">~</span> c_m,</span>
<span id="cb299-1796"><a href="#cb299-1796" aria-hidden="true" tabindex="-1"></a>    VARIABLE <span class="sc">==</span> <span class="st">"nanoCONC"</span> <span class="sc">~</span> c_n</span>
<span id="cb299-1797"><a href="#cb299-1797" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1798"><a href="#cb299-1798" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiply mean cells per ml of micro and nano by pg C for each size fraction:</span></span>
<span id="cb299-1799"><a href="#cb299-1799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pg_C_ml_TMP =</span> MEAN <span class="sc">*</span> pg_C_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1800"><a href="#cb299-1800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1801"><a href="#cb299-1801" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Take the average of the micro and nano for each experiment.</span></span>
<span id="cb299-1802"><a href="#cb299-1802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml_TMP))</span>
<span id="cb299-1803"><a href="#cb299-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1804"><a href="#cb299-1804" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate total euk for each experiment by adding.</span></span>
<span id="cb299-1805"><a href="#cb299-1805" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb299-1806"><a href="#cb299-1806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Experiment_rep, Site, Name, TimePoint, EXP_TYPE, IGT_REP, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1807"><a href="#cb299-1807" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add across micro and nano to get total</span></span>
<span id="cb299-1808"><a href="#cb299-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pg_C_ml =</span> <span class="fu">sum</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1809"><a href="#cb299-1809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">VARIABLE =</span> <span class="st">"totaleuk"</span>)</span>
<span id="cb299-1810"><a href="#cb299-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1811"><a href="#cb299-1811" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp2, pgC_ml_sizefrac_bysample_tmp)</span>
<span id="cb299-1812"><a href="#cb299-1812" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample</span>
<span id="cb299-1813"><a href="#cb299-1813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1814"><a href="#cb299-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1817"><a href="#cb299-1817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1818"><a href="#cb299-1818" aria-hidden="true" tabindex="-1"></a>pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb299-1819"><a href="#cb299-1819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, VARIABLE) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1820"><a href="#cb299-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb299-1821"><a href="#cb299-1821" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb299-1822"><a href="#cb299-1822" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml))</span>
<span id="cb299-1823"><a href="#cb299-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1824"><a href="#cb299-1824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1825"><a href="#cb299-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1828"><a href="#cb299-1828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1829"><a href="#cb299-1829" aria-hidden="true" tabindex="-1"></a>by_sizefrac_plot <span class="ot">&lt;-</span> pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb299-1830"><a href="#cb299-1830" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-1831"><a href="#cb299-1831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1832"><a href="#cb299-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Experiment_rep, <span class="at">y =</span> (pg_C_ml))) <span class="sc">+</span></span>
<span id="cb299-1833"><a href="#cb299-1833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> VARIABLE)) <span class="sc">+</span> </span>
<span id="cb299-1834"><a href="#cb299-1834" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_linerange(aes(ymin = (pgC_ml_min/1000), ymax = (pgC_ml_max/1000))) +</span></span>
<span id="cb299-1835"><a href="#cb299-1835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder <span class="sc">+</span> NameOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-1836"><a href="#cb299-1836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-1837"><a href="#cb299-1837" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-1838"><a href="#cb299-1838" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1839"><a href="#cb299-1839" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-1840"><a href="#cb299-1840" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-1841"><a href="#cb299-1841" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb299-1842"><a href="#cb299-1842" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-1843"><a href="#cb299-1843" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-1844"><a href="#cb299-1844" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-1845"><a href="#cb299-1845" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-1846"><a href="#cb299-1846" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb299-1847"><a href="#cb299-1847" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb299-1848"><a href="#cb299-1848" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb299-1849"><a href="#cb299-1849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Estimated total biomass: pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-1850"><a href="#cb299-1850" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Carbon pool of protists - based on size fraction"</span>)</span>
<span id="cb299-1851"><a href="#cb299-1851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1852"><a href="#cb299-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1853"><a href="#cb299-1853" aria-hidden="true" tabindex="-1"></a>Combined supplementary plot showing two routes of determining total biomass.</span>
<span id="cb299-1854"><a href="#cb299-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1855"><a href="#cb299-1855" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure S3</span></span>
<span id="cb299-1856"><a href="#cb299-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1857"><a href="#cb299-1857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=7}</span></span>
<span id="cb299-1858"><a href="#cb299-1858" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS3_new.svg", h = 8, w = 7)</span></span>
<span id="cb299-1859"><a href="#cb299-1859" aria-hidden="true" tabindex="-1"></a>by_biovol_plot <span class="sc">+</span> by_sizefrac_plot <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb299-1860"><a href="#cb299-1860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb299-1861"><a href="#cb299-1861" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-1862"><a href="#cb299-1862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1863"><a href="#cb299-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1864"><a href="#cb299-1864" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare total carbon biomass - euks</span></span>
<span id="cb299-1865"><a href="#cb299-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1866"><a href="#cb299-1866" aria-hidden="true" tabindex="-1"></a>Compilation table of carbon biomass values for microeukaryotes by sample type and vent field</span>
<span id="cb299-1867"><a href="#cb299-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1868"><a href="#cb299-1868" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table S4</span></span>
<span id="cb299-1869"><a href="#cb299-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1872"><a href="#cb299-1872" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1873"><a href="#cb299-1873" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon biomass derived from biovolume, by vent field (vent only)</span></span>
<span id="cb299-1874"><a href="#cb299-1874" aria-hidden="true" tabindex="-1"></a>table4_cbiomass_total <span class="ot">&lt;-</span> pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb299-1875"><a href="#cb299-1875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, EXP_TYPE, SAMPLE_TYPE_BIN) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1876"><a href="#cb299-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pgC_ml_mean),</span>
<span id="cb299-1877"><a href="#cb299-1877" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pgC_ml_mean),</span>
<span id="cb299-1878"><a href="#cb299-1878" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pgC_ml_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1879"><a href="#cb299-1879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"bybiovolume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1880"><a href="#cb299-1880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(pgC_ml_sizefrac_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb299-1881"><a href="#cb299-1881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VARIABLE, Site, SAMPLE_TYPE_BIN, EXP_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1882"><a href="#cb299-1882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_pg_C_ml =</span> <span class="fu">mean</span>(pg_C_ml),</span>
<span id="cb299-1883"><a href="#cb299-1883" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX_pg_C_ml =</span> <span class="fu">max</span>(pg_C_ml),</span>
<span id="cb299-1884"><a href="#cb299-1884" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN_pg_C_ml =</span> <span class="fu">min</span>(pg_C_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1885"><a href="#cb299-1885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">ORIGIN =</span> <span class="st">"sizefrac"</span>)</span>
<span id="cb299-1886"><a href="#cb299-1886" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb299-1887"><a href="#cb299-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1888"><a href="#cb299-1888" aria-hidden="true" tabindex="-1"></a><span class="co"># table4_cbiomass_total</span></span>
<span id="cb299-1889"><a href="#cb299-1889" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(table4_cbiomass_total, <span class="at">file =</span> <span class="st">"output-data/tableS4-cbiomass.csv"</span>)</span>
<span id="cb299-1890"><a href="#cb299-1890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1891"><a href="#cb299-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1892"><a href="#cb299-1892" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare biovolumes from literature to measured in this study</span></span>
<span id="cb299-1893"><a href="#cb299-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1894"><a href="#cb299-1894" aria-hidden="true" tabindex="-1"></a>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10\^7 µm\^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</span>
<span id="cb299-1895"><a href="#cb299-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1896"><a href="#cb299-1896" aria-hidden="true" tabindex="-1"></a>Import the heterotroph species volume and carbon content to compare to my measured values. Compare to md-lessard (Supplementary)</span>
<span id="cb299-1897"><a href="#cb299-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1900"><a href="#cb299-1900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1901"><a href="#cb299-1901" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb299-1902"><a href="#cb299-1902" aria-hidden="true" tabindex="-1"></a><span class="co"># c_prev</span></span>
<span id="cb299-1903"><a href="#cb299-1903" aria-hidden="true" tabindex="-1"></a><span class="co"># biov</span></span>
<span id="cb299-1904"><a href="#cb299-1904" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb299-1905"><a href="#cb299-1905" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb299-1906"><a href="#cb299-1906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1907"><a href="#cb299-1907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1908"><a href="#cb299-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, <span class="at">Volume =</span> BIOVOLUME, <span class="at">pgC_cell =</span> pgC_cell_MD_nodiatom)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1909"><a href="#cb299-1909" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb299-1910"><a href="#cb299-1910" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-1911"><a href="#cb299-1911" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb299-1912"><a href="#cb299-1912" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb299-1913"><a href="#cb299-1913" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb299-1914"><a href="#cb299-1914" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb299-1915"><a href="#cb299-1915" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1916"><a href="#cb299-1916" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb299-1917"><a href="#cb299-1917" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb299-1918"><a href="#cb299-1918" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb299-1919"><a href="#cb299-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1920"><a href="#cb299-1920" aria-hidden="true" tabindex="-1"></a>carbon_compare</span>
<span id="cb299-1921"><a href="#cb299-1921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1922"><a href="#cb299-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1923"><a href="#cb299-1923" aria-hidden="true" tabindex="-1"></a>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</span>
<span id="cb299-1924"><a href="#cb299-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1925"><a href="#cb299-1925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=5, fig.width=4}</span></span>
<span id="cb299-1926"><a href="#cb299-1926" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_biov_bysample)</span></span>
<span id="cb299-1927"><a href="#cb299-1927" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(pgC_ml_biov_bysample)</span></span>
<span id="cb299-1928"><a href="#cb299-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1929"><a href="#cb299-1929" aria-hidden="true" tabindex="-1"></a>pgC_ml_biov_bysample <span class="sc">%&gt;%</span> </span>
<span id="cb299-1930"><a href="#cb299-1930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"SITE_TYPE"</span>, Site, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1931"><a href="#cb299-1931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pgC_ml_mean, <span class="at">x =</span> SAMPLE_TYPE_BIN, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-1932"><a href="#cb299-1932" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-1933"><a href="#cb299-1933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb299-1934"><a href="#cb299-1934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-1935"><a href="#cb299-1935" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb299-1936"><a href="#cb299-1936" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb299-1937"><a href="#cb299-1937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-1938"><a href="#cb299-1938" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-1939"><a href="#cb299-1939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-1940"><a href="#cb299-1940" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(.~FIELDORDER, space = "free", scales = "free") +</span></span>
<span id="cb299-1941"><a href="#cb299-1941" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb299-1942"><a href="#cb299-1942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-1943"><a href="#cb299-1943" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1944"><a href="#cb299-1944" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-1945"><a href="#cb299-1945" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-1946"><a href="#cb299-1946" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-1947"><a href="#cb299-1947" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-1948"><a href="#cb299-1948" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-1949"><a href="#cb299-1949" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-1950"><a href="#cb299-1950" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-1951"><a href="#cb299-1951" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-1952"><a href="#cb299-1952" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb299-1953"><a href="#cb299-1953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-1954"><a href="#cb299-1954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1955"><a href="#cb299-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1956"><a href="#cb299-1956" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass for prokaryotes</span></span>
<span id="cb299-1957"><a href="#cb299-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1958"><a href="#cb299-1958" aria-hidden="true" tabindex="-1"></a>Now, report estimated carbon per cell for bacteria.</span>
<span id="cb299-1959"><a href="#cb299-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1960"><a href="#cb299-1960" aria-hidden="true" tabindex="-1"></a>Units: fg C per cell.</span>
<span id="cb299-1961"><a href="#cb299-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1962"><a href="#cb299-1962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Incorporate prokaryote carbon estimates}</span></span>
<span id="cb299-1963"><a href="#cb299-1963" aria-hidden="true" tabindex="-1"></a>bac_carbon_Mor_fg <span class="ot">&lt;-</span> (<span class="dv">86</span>) </span>
<span id="cb299-1964"><a href="#cb299-1964" aria-hidden="true" tabindex="-1"></a><span class="co">#From Derived from Morono et al. 2011 </span></span>
<span id="cb299-1965"><a href="#cb299-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1966"><a href="#cb299-1966" aria-hidden="true" tabindex="-1"></a>bac_carbon_Lof_fg <span class="ot">&lt;-</span> (<span class="dv">173</span>) </span>
<span id="cb299-1967"><a href="#cb299-1967" aria-hidden="true" tabindex="-1"></a><span class="co"># Derived from McNichol et al. 2018; LOFERER-KROBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb299-1968"><a href="#cb299-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1969"><a href="#cb299-1969" aria-hidden="true" tabindex="-1"></a><span class="co"># fg C per cell</span></span>
<span id="cb299-1970"><a href="#cb299-1970" aria-hidden="true" tabindex="-1"></a>bac_carbon_mean <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb299-1971"><a href="#cb299-1971" aria-hidden="true" tabindex="-1"></a>bac_carbon_min <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb299-1972"><a href="#cb299-1972" aria-hidden="true" tabindex="-1"></a>bac_carbon_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb299-1973"><a href="#cb299-1973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1974"><a href="#cb299-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1975"><a href="#cb299-1975" aria-hidden="true" tabindex="-1"></a>Import main table with all estimates of cells</span>
<span id="cb299-1976"><a href="#cb299-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1979"><a href="#cb299-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1980"><a href="#cb299-1980" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs &lt;- read_delim(file = "output-data/table1-grazing-exp-list.txt", delim = "\t")</span></span>
<span id="cb299-1981"><a href="#cb299-1981" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb299-1982"><a href="#cb299-1982" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-1983"><a href="#cb299-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1984"><a href="#cb299-1984" aria-hidden="true" tabindex="-1"></a>RATE_min units = FLPs per grazer per minute Clearance rate <span class="sc">\_</span>ml = ml per grazer per hour</span>
<span id="cb299-1985"><a href="#cb299-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-1988"><a href="#cb299-1988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-1989"><a href="#cb299-1989" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb299-1990"><a href="#cb299-1990" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb299-1991"><a href="#cb299-1991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE,  <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, RATE_minute) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1992"><a href="#cb299-1992" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in calcs by fg C per cell.</span></span>
<span id="cb299-1993"><a href="#cb299-1993" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Estimates of carbon pool of microbes per ml. </span></span>
<span id="cb299-1994"><a href="#cb299-1994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MOR_fgC_ml =</span> bac_carbon_Mor_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb299-1995"><a href="#cb299-1995" aria-hidden="true" tabindex="-1"></a>         <span class="at">LOF_fgC_ml =</span> bac_carbon_Lof_fg <span class="sc">*</span> PROK_ml,</span>
<span id="cb299-1996"><a href="#cb299-1996" aria-hidden="true" tabindex="-1"></a>         <span class="at">MEAN_fgC_ml =</span> bac_carbon_mean <span class="sc">*</span> PROK_ml,</span>
<span id="cb299-1997"><a href="#cb299-1997" aria-hidden="true" tabindex="-1"></a>         <span class="at">MAX_fgC_ml =</span> bac_carbon_max <span class="sc">*</span> PROK_ml,</span>
<span id="cb299-1998"><a href="#cb299-1998" aria-hidden="true" tabindex="-1"></a>         <span class="at">MIN_fgC_ml =</span> bac_carbon_min <span class="sc">*</span> PROK_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb299-1999"><a href="#cb299-1999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"fgC_ml"</span>), <span class="at">names_to =</span> <span class="st">"prokC_category"</span>, <span class="at">values_to =</span> <span class="st">"fgC_ml"</span>)</span>
<span id="cb299-2000"><a href="#cb299-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2001"><a href="#cb299-2001" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span>
<span id="cb299-2002"><a href="#cb299-2002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2003"><a href="#cb299-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2004"><a href="#cb299-2004" aria-hidden="true" tabindex="-1"></a>Get summary of prokaryotic biomass</span>
<span id="cb299-2005"><a href="#cb299-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2008"><a href="#cb299-2008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2009"><a href="#cb299-2009" aria-hidden="true" tabindex="-1"></a>est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb299-2010"><a href="#cb299-2010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2011"><a href="#cb299-2011" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2012"><a href="#cb299-2012" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2013"><a href="#cb299-2013" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-2014"><a href="#cb299-2014" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-2015"><a href="#cb299-2015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE_BIN, prokC_category) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2016"><a href="#cb299-2016" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 fg == 0.001 pg</span></span>
<span id="cb299-2017"><a href="#cb299-2017" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to pg C per ml</span></span>
<span id="cb299-2018"><a href="#cb299-2018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_pgC_ml =</span> <span class="fu">mean</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb299-2019"><a href="#cb299-2019" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_pgC_ml =</span> <span class="fu">min</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>)),</span>
<span id="cb299-2020"><a href="#cb299-2020" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_pgC_ml =</span> <span class="fu">max</span>((fgC_ml)<span class="sc">*</span>(<span class="fl">0.001</span>))) </span>
<span id="cb299-2021"><a href="#cb299-2021" aria-hidden="true" tabindex="-1"></a><span class="co"># head(est_prok_carbon)</span></span>
<span id="cb299-2022"><a href="#cb299-2022" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2023"><a href="#cb299-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2024"><a href="#cb299-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">## Incorporate carbon biomass of prey and grazing rate</span></span>
<span id="cb299-2025"><a href="#cb299-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2026"><a href="#cb299-2026" aria-hidden="true" tabindex="-1"></a>Clearance rate is mL per grazer per hour (Table S3). Grazing effect is prokaryotes ml-1 hr-1 (Table S3).</span>
<span id="cb299-2027"><a href="#cb299-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2030"><a href="#cb299-2030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2031"><a href="#cb299-2031" aria-hidden="true" tabindex="-1"></a><span class="do">## Carbon consumed based on clearance rate</span></span>
<span id="cb299-2032"><a href="#cb299-2032" aria-hidden="true" tabindex="-1"></a>carbon_consumed <span class="ot">&lt;-</span> est_prok_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb299-2033"><a href="#cb299-2033" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use only value from Morono et al., convert to pg C per cell.</span></span>
<span id="cb299-2034"><a href="#cb299-2034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prokC_category <span class="sc">==</span> <span class="st">"MOR_fgC_ml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2035"><a href="#cb299-2035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_carbon_Mor_pg =</span> (bac_carbon_Mor_fg <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2036"><a href="#cb299-2036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, NameOrder, SiteOrder, FLUID_ORIGIN, CRUISE_SAMPLE, PROK_ml, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, bac_carbon_Mor_pg, fgC_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2037"><a href="#cb299-2037" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clearance rate * fg of prok == pg C per grazer per hr</span></span>
<span id="cb299-2038"><a href="#cb299-2038" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bac_carbon_Mor_pg * grazing effect == pg C per ml per hr</span></span>
<span id="cb299-2039"><a href="#cb299-2039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_pergrazer_CLEARANCE =</span> (fgC_ml<span class="sc">*</span><span class="fl">0.001</span>) <span class="sc">*</span> CLEARANCE_RATE_ml,</span>
<span id="cb299-2040"><a href="#cb299-2040" aria-hidden="true" tabindex="-1"></a>         <span class="at">pgC_perml_perhr =</span> bac_carbon_Mor_pg <span class="sc">*</span> GRAZING_EFFECT_hr)</span>
<span id="cb299-2041"><a href="#cb299-2041" aria-hidden="true" tabindex="-1"></a>carbon_consumed</span>
<span id="cb299-2042"><a href="#cb299-2042" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2043"><a href="#cb299-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2044"><a href="#cb299-2044" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environmental parameters - MCR</span></span>
<span id="cb299-2045"><a href="#cb299-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2046"><a href="#cb299-2046" aria-hidden="true" tabindex="-1"></a>Import from Hu et al. (*Molecular Ecology*).</span>
<span id="cb299-2047"><a href="#cb299-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2050"><a href="#cb299-2050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2051"><a href="#cb299-2051" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb299-2052"><a href="#cb299-2052" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb299-2053"><a href="#cb299-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2054"><a href="#cb299-2054" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb299-2055"><a href="#cb299-2055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2056"><a href="#cb299-2056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb299-2057"><a href="#cb299-2057" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb299-2058"><a href="#cb299-2058" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2059"><a href="#cb299-2059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2060"><a href="#cb299-2060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"num"</span>, <span class="st">"loc"</span>, <span class="st">"loc2"</span>, <span class="st">"fluid_origin"</span>, <span class="st">"name"</span>, <span class="st">"FLUID_ORIGIN"</span>, <span class="st">"else"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2061"><a href="#cb299-2061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE,FLUID_ORIGIN, <span class="fu">everything</span>(), <span class="sc">-</span>num, <span class="sc">-</span>loc, <span class="sc">-</span>loc2, <span class="sc">-</span>fluid_origin, <span class="sc">-</span>name, <span class="sc">-</span><span class="st">`</span><span class="at">else</span><span class="st">`</span>)</span>
<span id="cb299-2062"><a href="#cb299-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2063"><a href="#cb299-2063" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb299-2064"><a href="#cb299-2064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2065"><a href="#cb299-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2066"><a href="#cb299-2066" aria-hidden="true" tabindex="-1"></a>Generate supplementary table.</span>
<span id="cb299-2067"><a href="#cb299-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2070"><a href="#cb299-2070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2071"><a href="#cb299-2071" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb299-2072"><a href="#cb299-2072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc, <span class="fu">everything</span>())</span>
<span id="cb299-2073"><a href="#cb299-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2074"><a href="#cb299-2074" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb299-2075"><a href="#cb299-2075" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span>
<span id="cb299-2076"><a href="#cb299-2076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2077"><a href="#cb299-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2078"><a href="#cb299-2078" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis of grazing rate results</span></span>
<span id="cb299-2079"><a href="#cb299-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2080"><a href="#cb299-2080" aria-hidden="true" tabindex="-1"></a>Re-import table from output table with all grazing values</span>
<span id="cb299-2081"><a href="#cb299-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2082"><a href="#cb299-2082" aria-hidden="true" tabindex="-1"></a>Format and factor values to plot, and prioritize these values:</span>
<span id="cb299-2083"><a href="#cb299-2083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2084"><a href="#cb299-2084" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing rate column == FLP per minute consumed</span>
<span id="cb299-2085"><a href="#cb299-2085" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grazing effect hr == cells per ml per hr</span>
<span id="cb299-2086"><a href="#cb299-2086" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</span>
<span id="cb299-2087"><a href="#cb299-2087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2088"><a href="#cb299-2088" aria-hidden="true" tabindex="-1"></a>Report grazing rates</span>
<span id="cb299-2089"><a href="#cb299-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2092"><a href="#cb299-2092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2093"><a href="#cb299-2093" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb299-2094"><a href="#cb299-2094" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate_wflp_wprok_weuk)</span></span>
<span id="cb299-2095"><a href="#cb299-2095" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_biov_bysample)</span></span>
<span id="cb299-2096"><a href="#cb299-2096" aria-hidden="true" tabindex="-1"></a><span class="co"># head(pgC_ml_sizefrac_bysample)</span></span>
<span id="cb299-2097"><a href="#cb299-2097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2098"><a href="#cb299-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2099"><a href="#cb299-2099" aria-hidden="true" tabindex="-1"></a><span class="co"># save(table_grazerate_wflp_wprok_weuk, table_wcalcs, pgC_ml_biov_bysample, pgC_ml_sizefrac_bysample, carbon_consumed, file = "output-data/processed-dfs-mcr-grazing.RData")</span></span>
<span id="cb299-2100"><a href="#cb299-2100" aria-hidden="true" tabindex="-1"></a><span class="co"># load("output-data/processed-dfs-mcr-grazing.RData")</span></span>
<span id="cb299-2101"><a href="#cb299-2101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2102"><a href="#cb299-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2103"><a href="#cb299-2103" aria-hidden="true" tabindex="-1"></a>Plot grazing rates</span>
<span id="cb299-2104"><a href="#cb299-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2107"><a href="#cb299-2107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2108"><a href="#cb299-2108" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb299-2109"><a href="#cb299-2109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2110"><a href="#cb299-2110" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2111"><a href="#cb299-2111" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2112"><a href="#cb299-2112" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-2113"><a href="#cb299-2113" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-2114"><a href="#cb299-2114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2115"><a href="#cb299-2115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2116"><a href="#cb299-2116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb299-2117"><a href="#cb299-2117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2118"><a href="#cb299-2118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-2119"><a href="#cb299-2119" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2120"><a href="#cb299-2120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-2121"><a href="#cb299-2121" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2122"><a href="#cb299-2122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb299-2123"><a href="#cb299-2123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb299-2124"><a href="#cb299-2124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE, </span>
<span id="cb299-2125"><a href="#cb299-2125" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fill =</span> SITE_TYPE, <span class="at">color =</span> SITE_TYPE),</span>
<span id="cb299-2126"><a href="#cb299-2126" aria-hidden="true" tabindex="-1"></a>               <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb299-2127"><a href="#cb299-2127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-2128"><a href="#cb299-2128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2129"><a href="#cb299-2129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2130"><a href="#cb299-2130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-2131"><a href="#cb299-2131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2132"><a href="#cb299-2132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2133"><a href="#cb299-2133" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-2134"><a href="#cb299-2134" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2135"><a href="#cb299-2135" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>, </span>
<span id="cb299-2136"><a href="#cb299-2136" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-2137"><a href="#cb299-2137" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2138"><a href="#cb299-2138" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2139"><a href="#cb299-2139" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2140"><a href="#cb299-2140" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2141"><a href="#cb299-2141" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb299-2142"><a href="#cb299-2142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-2143"><a href="#cb299-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2144"><a href="#cb299-2144" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb299-2145"><a href="#cb299-2145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2146"><a href="#cb299-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2149"><a href="#cb299-2149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2150"><a href="#cb299-2150" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific_10)</span>
<span id="cb299-2151"><a href="#cb299-2151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2152"><a href="#cb299-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2155"><a href="#cb299-2155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2156"><a href="#cb299-2156" aria-hidden="true" tabindex="-1"></a>grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>))</span>
<span id="cb299-2157"><a href="#cb299-2157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2158"><a href="#cb299-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2159"><a href="#cb299-2159" aria-hidden="true" tabindex="-1"></a><span class="fu">### Box plots: Grazing rate</span></span>
<span id="cb299-2160"><a href="#cb299-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2163"><a href="#cb299-2163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2164"><a href="#cb299-2164" aria-hidden="true" tabindex="-1"></a>boxplot_rate_site <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb299-2165"><a href="#cb299-2165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2166"><a href="#cb299-2166" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2167"><a href="#cb299-2167" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2168"><a href="#cb299-2168" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-2169"><a href="#cb299-2169" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-2170"><a href="#cb299-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2171"><a href="#cb299-2171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2172"><a href="#cb299-2172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE_TYPE_BIN) %&gt;%</span></span>
<span id="cb299-2173"><a href="#cb299-2173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2174"><a href="#cb299-2174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-2175"><a href="#cb299-2175" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2176"><a href="#cb299-2176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SAMPLE_TYPE_BIN, <span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb299-2177"><a href="#cb299-2177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb299-2178"><a href="#cb299-2178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">color =</span> SiteOrder, <span class="at">fill =</span> SiteOrder)) <span class="sc">+</span></span>
<span id="cb299-2179"><a href="#cb299-2179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2180"><a href="#cb299-2180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2181"><a href="#cb299-2181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb299-2182"><a href="#cb299-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>SiteOrder) <span class="sc">+</span></span>
<span id="cb299-2183"><a href="#cb299-2183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2184"><a href="#cb299-2184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb299-2185"><a href="#cb299-2185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2186"><a href="#cb299-2186" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-2187"><a href="#cb299-2187" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2188"><a href="#cb299-2188" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb299-2189"><a href="#cb299-2189" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb299-2190"><a href="#cb299-2190" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2191"><a href="#cb299-2191" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2192"><a href="#cb299-2192" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2193"><a href="#cb299-2193" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2194"><a href="#cb299-2194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-2195"><a href="#cb299-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2196"><a href="#cb299-2196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2197"><a href="#cb299-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2200"><a href="#cb299-2200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2201"><a href="#cb299-2201" aria-hidden="true" tabindex="-1"></a>boxplot_rate_exp <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span></span>
<span id="cb299-2202"><a href="#cb299-2202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE_BIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2203"><a href="#cb299-2203" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2204"><a href="#cb299-2204" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Non-vent"</span>,</span>
<span id="cb299-2205"><a href="#cb299-2205" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-2206"><a href="#cb299-2206" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb299-2207"><a href="#cb299-2207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NameOrder =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2208"><a href="#cb299-2208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SiteOrder =</span> <span class="fu">factor</span>(FIELD, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2209"><a href="#cb299-2209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Experiment_rep, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"exptype_rep"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2210"><a href="#cb299-2210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exptype =</span> <span class="fu">case_when</span>(exptype_rep <span class="sc">==</span> <span class="st">"Shipboard"</span> <span class="sc">~</span> <span class="st">"Shipboard"</span>,</span>
<span id="cb299-2211"><a href="#cb299-2211" aria-hidden="true" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2212"><a href="#cb299-2212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_TYPE_BIN <span class="sc">==</span> <span class="st">"Vent"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2213"><a href="#cb299-2213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exptype, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb299-2214"><a href="#cb299-2214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb299-2215"><a href="#cb299-2215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> exptype)) <span class="sc">+</span></span>
<span id="cb299-2216"><a href="#cb299-2216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">19</span>)) <span class="sc">+</span> </span>
<span id="cb299-2217"><a href="#cb299-2217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb299-2218"><a href="#cb299-2218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(.~SiteOrder) +</span></span>
<span id="cb299-2219"><a href="#cb299-2219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2220"><a href="#cb299-2220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb299-2221"><a href="#cb299-2221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2222"><a href="#cb299-2222" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-2223"><a href="#cb299-2223" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2224"><a href="#cb299-2224" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb299-2225"><a href="#cb299-2225" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>), </span>
<span id="cb299-2226"><a href="#cb299-2226" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2227"><a href="#cb299-2227" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2228"><a href="#cb299-2228" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2229"><a href="#cb299-2229" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2230"><a href="#cb299-2230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span> <span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-2231"><a href="#cb299-2231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2232"><a href="#cb299-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2233"><a href="#cb299-2233" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 1 compilation</span></span>
<span id="cb299-2234"><a href="#cb299-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2235"><a href="#cb299-2235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=10}</span></span>
<span id="cb299-2236"><a href="#cb299-2236" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig1.svg", w = 10, h = 8)</span></span>
<span id="cb299-2237"><a href="#cb299-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2238"><a href="#cb299-2238" aria-hidden="true" tabindex="-1"></a>  (euk_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb299-2239"><a href="#cb299-2239" aria-hidden="true" tabindex="-1"></a>  (prok_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span></span>
<span id="cb299-2240"><a href="#cb299-2240" aria-hidden="true" tabindex="-1"></a>  grazing_min_plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb299-2241"><a href="#cb299-2241" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (grazing_min_plot + theme(legend.position = "none") + scale_y_continuous(limits = c(0, 0.02))) +</span></span>
<span id="cb299-2242"><a href="#cb299-2242" aria-hidden="true" tabindex="-1"></a>  (grazing_rate <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1e5</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2243"><a href="#cb299-2243" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb299-2244"><a href="#cb299-2244" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2245"><a href="#cb299-2245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2246"><a href="#cb299-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2247"><a href="#cb299-2247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=11}</span></span>
<span id="cb299-2248"><a href="#cb299-2248" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig1-revisions.svg", w = 11, h = 6)</span></span>
<span id="cb299-2249"><a href="#cb299-2249" aria-hidden="true" tabindex="-1"></a>(boxplot_eukcell_site <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> </span>
<span id="cb299-2250"><a href="#cb299-2250" aria-hidden="true" tabindex="-1"></a>  (boxplot_rate_site <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb299-2251"><a href="#cb299-2251" aria-hidden="true" tabindex="-1"></a>  (boxplot_eukcell_exp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)) <span class="sc">+</span> </span>
<span id="cb299-2252"><a href="#cb299-2252" aria-hidden="true" tabindex="-1"></a>  (boxplot_rate_exp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())) <span class="sc">+</span></span>
<span id="cb299-2253"><a href="#cb299-2253" aria-hidden="true" tabindex="-1"></a>     patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2254"><a href="#cb299-2254" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb299-2255"><a href="#cb299-2255" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2256"><a href="#cb299-2256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2257"><a href="#cb299-2257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2258"><a href="#cb299-2258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grazing rate vs. cells ml</span></span>
<span id="cb299-2259"><a href="#cb299-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2260"><a href="#cb299-2260" aria-hidden="true" tabindex="-1"></a>Combine metadata from environment with grazing rate results.</span>
<span id="cb299-2261"><a href="#cb299-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2264"><a href="#cb299-2264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2265"><a href="#cb299-2265" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs)</span></span>
<span id="cb299-2266"><a href="#cb299-2266" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span>
<span id="cb299-2267"><a href="#cb299-2267" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify fluid origin to match metadata and results</span></span>
<span id="cb299-2268"><a href="#cb299-2268" aria-hidden="true" tabindex="-1"></a>mod_metadata <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb299-2269"><a href="#cb299-2269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-2270"><a href="#cb299-2270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VENT <span class="sc">!=</span> <span class="st">"Quakeplume"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2271"><a href="#cb299-2271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID"</span>, <span class="st">"HOG"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2272"><a href="#cb299-2272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FLUID_ORIGIN, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID2"</span>, <span class="st">"excess"</span>), <span class="at">sep =</span> <span class="st">"J2"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2273"><a href="#cb299-2273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(excess, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"FLUID3"</span>, <span class="st">"hogexcess"</span>), <span class="at">sep =</span> <span class="st">"HOG"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2274"><a href="#cb299-2274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLUID_ORIGIN =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2275"><a href="#cb299-2275" aria-hidden="true" tabindex="-1"></a>    FLUID2 <span class="sc">==</span> <span class="st">"CTD003"</span> <span class="sc">~</span> <span class="st">"CTD001"</span>, <span class="co">#Correction for plume VD</span></span>
<span id="cb299-2276"><a href="#cb299-2276" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(FLUID3) <span class="sc">~</span> FLUID2,</span>
<span id="cb299-2277"><a href="#cb299-2277" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"J2-"</span>, FLUID3, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb299-2278"><a href="#cb299-2278" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2279"><a href="#cb299-2279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FLUID, <span class="sc">-</span>FLUID2, <span class="sc">-</span>FLUID3, <span class="sc">-</span>HOG, <span class="sc">-</span>excess, <span class="sc">-</span>hogexcess) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2280"><a href="#cb299-2280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2281"><a href="#cb299-2281" aria-hidden="true" tabindex="-1"></a>    VENT <span class="sc">==</span> <span class="st">"OldManTree"</span> <span class="sc">~</span> <span class="st">"OMT"</span>,</span>
<span id="cb299-2282"><a href="#cb299-2282" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> VENT</span>
<span id="cb299-2283"><a href="#cb299-2283" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb299-2284"><a href="#cb299-2284" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(table_wcalcs$Name)</span></span>
<span id="cb299-2285"><a href="#cb299-2285" aria-hidden="true" tabindex="-1"></a><span class="co"># mod_metadata</span></span>
<span id="cb299-2286"><a href="#cb299-2286" aria-hidden="true" tabindex="-1"></a><span class="co"># setdiff(mod_metadata$FLUID_ORIGIN, table_wcalcs$FLUID_ORIGIN)</span></span>
<span id="cb299-2287"><a href="#cb299-2287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2288"><a href="#cb299-2288" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb299-2289"><a href="#cb299-2289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteOrder, Name, Experiment_rep, FLUID_ORIGIN, RATE_minute, <span class="fu">starts_with</span>(<span class="st">"EUK_"</span>), <span class="fu">starts_with</span>(<span class="st">"PROK_"</span>), <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT"</span>), CLEARANCE_RATE_ml, SPEC_GRAZE_RATE_hr, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span></span>
<span id="cb299-2290"><a href="#cb299-2290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mod_metadata, <span class="fu">join_by</span>(Name <span class="sc">==</span> Name, FLUID_ORIGIN <span class="sc">==</span> FLUID_ORIGIN))</span>
<span id="cb299-2291"><a href="#cb299-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2292"><a href="#cb299-2292" aria-hidden="true" tabindex="-1"></a><span class="co"># View(grazing_wenv)</span></span>
<span id="cb299-2293"><a href="#cb299-2293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2294"><a href="#cb299-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2297"><a href="#cb299-2297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2298"><a href="#cb299-2298" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_metadata)</span></span>
<span id="cb299-2299"><a href="#cb299-2299" aria-hidden="true" tabindex="-1"></a>euk_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb299-2300"><a href="#cb299-2300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2301"><a href="#cb299-2301" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2302"><a href="#cb299-2302" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-2303"><a href="#cb299-2303" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-2304"><a href="#cb299-2304" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2305"><a href="#cb299-2305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2306"><a href="#cb299-2306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2307"><a href="#cb299-2307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> EUK_ml, </span>
<span id="cb299-2308"><a href="#cb299-2308" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2309"><a href="#cb299-2309" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymin = (log10(EUK_ml)-(EUK_sem)),ymax = (log10(EUK_ml)+(EUK_sem)))) +</span></span>
<span id="cb299-2310"><a href="#cb299-2310" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   geom_errorbarh(aes(xmin = log10(GRAZING_EFFECT_hr_min),xmax = log10(GRAZING_EFFECT_hr_max))) +</span></span>
<span id="cb299-2311"><a href="#cb299-2311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((EUK_ml)<span class="sc">-</span>(EUK_sem)),<span class="at">ymax =</span> ((EUK_ml)<span class="sc">+</span>(EUK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-2312"><a href="#cb299-2312" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-2313"><a href="#cb299-2313" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(shape = EXP_TYPE), size = 4, stroke = 2) +</span></span>
<span id="cb299-2314"><a href="#cb299-2314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2315"><a href="#cb299-2315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb299-2316"><a href="#cb299-2316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb299-2317"><a href="#cb299-2317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb299-2318"><a href="#cb299-2318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb299-2319"><a href="#cb299-2319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb299-2320"><a href="#cb299-2320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2321"><a href="#cb299-2321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb299-2322"><a href="#cb299-2322" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb299-2323"><a href="#cb299-2323" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb299-2324"><a href="#cb299-2324" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb299-2325"><a href="#cb299-2325" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2326"><a href="#cb299-2326" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2327"><a href="#cb299-2327" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb299-2328"><a href="#cb299-2328" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2329"><a href="#cb299-2329" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2330"><a href="#cb299-2330" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2331"><a href="#cb299-2331" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2332"><a href="#cb299-2332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-2333"><a href="#cb299-2333" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-2334"><a href="#cb299-2334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2335"><a href="#cb299-2335" aria-hidden="true" tabindex="-1"></a>euk_temp</span>
<span id="cb299-2336"><a href="#cb299-2336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2337"><a href="#cb299-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2340"><a href="#cb299-2340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2341"><a href="#cb299-2341" aria-hidden="true" tabindex="-1"></a>prok_temp <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb299-2342"><a href="#cb299-2342" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2343"><a href="#cb299-2343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2344"><a href="#cb299-2344" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-2345"><a href="#cb299-2345" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-2346"><a href="#cb299-2346" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2347"><a href="#cb299-2347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2348"><a href="#cb299-2348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2349"><a href="#cb299-2349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> PROK_ml, </span>
<span id="cb299-2350"><a href="#cb299-2350" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> TEMP, <span class="at">color =</span> TEMP, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2351"><a href="#cb299-2351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ((PROK_ml)<span class="sc">-</span>(PROK_sem)),<span class="at">ymax =</span> ((PROK_ml)<span class="sc">+</span>(PROK_sem))), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-2352"><a href="#cb299-2352" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> (GRAZING_EFFECT_hr_min),<span class="at">xmax =</span> (GRAZING_EFFECT_hr_max)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-2353"><a href="#cb299-2353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2354"><a href="#cb299-2354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span> </span>
<span id="cb299-2355"><a href="#cb299-2355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb299-2356"><a href="#cb299-2356" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_shape_manual(values = c(1, 19)) +</span></span>
<span id="cb299-2357"><a href="#cb299-2357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="dv">6</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb299-2358"><a href="#cb299-2358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb299-2359"><a href="#cb299-2359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">direction=</span><span class="dv">2</span>, <span class="at">na.value =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb299-2360"><a href="#cb299-2360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2361"><a href="#cb299-2361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb299-2362"><a href="#cb299-2362" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb299-2363"><a href="#cb299-2363" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f0f0f0"</span>),</span>
<span id="cb299-2364"><a href="#cb299-2364" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb299-2365"><a href="#cb299-2365" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#737373"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2366"><a href="#cb299-2366" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2367"><a href="#cb299-2367" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb299-2368"><a href="#cb299-2368" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2369"><a href="#cb299-2369" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2370"><a href="#cb299-2370" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2371"><a href="#cb299-2371" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2372"><a href="#cb299-2372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Microbial prey cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-2373"><a href="#cb299-2373" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-2374"><a href="#cb299-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2375"><a href="#cb299-2375" aria-hidden="true" tabindex="-1"></a>prok_temp</span>
<span id="cb299-2376"><a href="#cb299-2376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2377"><a href="#cb299-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2378"><a href="#cb299-2378" aria-hidden="true" tabindex="-1"></a><span class="fu"># Figure 2 compilation</span></span>
<span id="cb299-2379"><a href="#cb299-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2380"><a href="#cb299-2380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, fig.height=10, fig.width=7}</span></span>
<span id="cb299-2381"><a href="#cb299-2381" aria-hidden="true" tabindex="-1"></a><span class="co"># fig2 &lt;- (euk_temp + labs(x = "") + theme(legend.position = "none")) + prok_temp + patchwork::plot_layout(ncol = 1) + patchwork::plot_annotation(tag_levels = "a")</span></span>
<span id="cb299-2382"><a href="#cb299-2382" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-2383"><a href="#cb299-2383" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2.svg", h = 10, w = 7)</span></span>
<span id="cb299-2384"><a href="#cb299-2384" aria-hidden="true" tabindex="-1"></a><span class="co"># fig2</span></span>
<span id="cb299-2385"><a href="#cb299-2385" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2386"><a href="#cb299-2386" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb299-2387"><a href="#cb299-2387" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2-a.svg", h = 5, w = 7)</span></span>
<span id="cb299-2388"><a href="#cb299-2388" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_temp</span></span>
<span id="cb299-2389"><a href="#cb299-2389" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2390"><a href="#cb299-2390" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-2391"><a href="#cb299-2391" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/fig2-b.svg", h = 5, w = 7)</span></span>
<span id="cb299-2392"><a href="#cb299-2392" aria-hidden="true" tabindex="-1"></a><span class="co"># prok_temp</span></span>
<span id="cb299-2393"><a href="#cb299-2393" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2394"><a href="#cb299-2394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2395"><a href="#cb299-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2396"><a href="#cb299-2396" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison with Gorda Ridge</span></span>
<span id="cb299-2397"><a href="#cb299-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2398"><a href="#cb299-2398" aria-hidden="true" tabindex="-1"></a>Import data from Gorda Ridge</span>
<span id="cb299-2399"><a href="#cb299-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2402"><a href="#cb299-2402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2403"><a href="#cb299-2403" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2021/Grazing-at-GordaRidge-SKH-2021/data-input/Grazing-calc-wCarbon-results.txt"</span>)</span>
<span id="cb299-2404"><a href="#cb299-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2405"><a href="#cb299-2405" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../GordaRidgeCruise_2019/protist-gordaridge-2019-analysis/temperature-allvents.txt"</span>)</span>
<span id="cb299-2406"><a href="#cb299-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2407"><a href="#cb299-2407" aria-hidden="true" tabindex="-1"></a>mcr_graze <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span>
<span id="cb299-2408"><a href="#cb299-2408" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mcr_graze)</span>
<span id="cb299-2409"><a href="#cb299-2409" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gr)</span>
<span id="cb299-2410"><a href="#cb299-2410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2411"><a href="#cb299-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2412"><a href="#cb299-2412" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combine GR and MCR data</span></span>
<span id="cb299-2413"><a href="#cb299-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2416"><a href="#cb299-2416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2417"><a href="#cb299-2417" aria-hidden="true" tabindex="-1"></a>all_vents <span class="ot">&lt;-</span> mcr_graze <span class="sc">%&gt;%</span></span>
<span id="cb299-2418"><a href="#cb299-2418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-2419"><a href="#cb299-2419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SAMPLE, FIELD, Name, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2420"><a href="#cb299-2420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> NameOrder, SAMPLE, <span class="at">EXP =</span> CRUISE_SAMPLE, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2421"><a href="#cb299-2421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(gr <span class="sc">%&gt;%</span></span>
<span id="cb299-2422"><a href="#cb299-2422" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">FIELD =</span> <span class="st">"Gorda Ridge"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2423"><a href="#cb299-2423" aria-hidden="true" tabindex="-1"></a>          <span class="fu">add_column</span>(<span class="at">EUK_ml =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2424"><a href="#cb299-2424" aria-hidden="true" tabindex="-1"></a>          <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2425"><a href="#cb299-2425" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(FIELD, NAME, SAMPLE, <span class="at">EXP =</span> Bottle, <span class="at">PROK_ml =</span> prok_avg, EUK_ml, <span class="at">GRAZING_EFFECT_hr =</span> GrazingRate_hr, <span class="at">GRAZING_EFFECT_hr_min =</span> GrazingRate_hr_min, <span class="at">GRAZING_EFFECT_hr_max =</span> GrazingRate_hr_max, <span class="at">BAC_TURNOVER_PERC =</span> Prok_turnover)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2426"><a href="#cb299-2426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(temps) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2427"><a href="#cb299-2427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2428"><a href="#cb299-2428" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"BSW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb299-2429"><a href="#cb299-2429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Near vent BW"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb299-2430"><a href="#cb299-2430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Background"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>, </span>
<span id="cb299-2431"><a href="#cb299-2431" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Plume"</span>, NAME) <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb299-2432"><a href="#cb299-2432" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb299-2433"><a href="#cb299-2433" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb299-2434"><a href="#cb299-2434" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb299-2435"><a href="#cb299-2435" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vents</span></span>
<span id="cb299-2436"><a href="#cb299-2436" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(all_vents, file = "output-data/grazing-cellcounts-GR_MCR.txt", delim = "\t")</span></span>
<span id="cb299-2437"><a href="#cb299-2437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2438"><a href="#cb299-2438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2439"><a href="#cb299-2439" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot combined results</span></span>
<span id="cb299-2440"><a href="#cb299-2440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2443"><a href="#cb299-2443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2444"><a href="#cb299-2444" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb299-2445"><a href="#cb299-2445" aria-hidden="true" tabindex="-1"></a>allrates <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-2446"><a href="#cb299-2446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPERIMENTTYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2447"><a href="#cb299-2447" aria-hidden="true" tabindex="-1"></a>    EXP <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-2448"><a href="#cb299-2448" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-2449"><a href="#cb299-2449" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2450"><a href="#cb299-2450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EXPERIMENTTYPE, FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2451"><a href="#cb299-2451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-2452"><a href="#cb299-2452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE)) <span class="sc">+</span></span>
<span id="cb299-2453"><a href="#cb299-2453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb299-2454"><a href="#cb299-2454" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb299-2455"><a href="#cb299-2455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> FIELD, <span class="at">shape =</span> EXPERIMENTTYPE),</span>
<span id="cb299-2456"><a href="#cb299-2456" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb299-2457"><a href="#cb299-2457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb299-2458"><a href="#cb299-2458" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#addd8e"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2459"><a href="#cb299-2459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-2460"><a href="#cb299-2460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2461"><a href="#cb299-2461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2462"><a href="#cb299-2462" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-2463"><a href="#cb299-2463" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2464"><a href="#cb299-2464" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb299-2465"><a href="#cb299-2465" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-2466"><a href="#cb299-2466" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2467"><a href="#cb299-2467" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2468"><a href="#cb299-2468" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2469"><a href="#cb299-2469" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2470"><a href="#cb299-2470" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb299-2471"><a href="#cb299-2471" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2472"><a href="#cb299-2472" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb299-2473"><a href="#cb299-2473" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb299-2474"><a href="#cb299-2474" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb299-2475"><a href="#cb299-2475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-2476"><a href="#cb299-2476" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb299-2477"><a href="#cb299-2477" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_fill_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb299-2478"><a href="#cb299-2478" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb299-2479"><a href="#cb299-2479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2480"><a href="#cb299-2480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2481"><a href="#cb299-2481" aria-hidden="true" tabindex="-1"></a>Add Gorda Ridge comparison to supplementary?</span>
<span id="cb299-2482"><a href="#cb299-2482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2483"><a href="#cb299-2483" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure S8</span></span>
<span id="cb299-2484"><a href="#cb299-2484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2485"><a href="#cb299-2485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=6}</span></span>
<span id="cb299-2486"><a href="#cb299-2486" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates</span></span>
<span id="cb299-2487"><a href="#cb299-2487" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7.svg", h = 4, w = 6)</span></span>
<span id="cb299-2488"><a href="#cb299-2488" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb299-2489"><a href="#cb299-2489" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2490"><a href="#cb299-2490" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span>
<span id="cb299-2491"><a href="#cb299-2491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2492"><a href="#cb299-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2493"><a href="#cb299-2493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=6}</span></span>
<span id="cb299-2494"><a href="#cb299-2494" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates</span></span>
<span id="cb299-2495"><a href="#cb299-2495" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7.svg", h = 4, w = 6)</span></span>
<span id="cb299-2496"><a href="#cb299-2496" aria-hidden="true" tabindex="-1"></a>allrates <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>))</span>
<span id="cb299-2497"><a href="#cb299-2497" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2498"><a href="#cb299-2498" aria-hidden="true" tabindex="-1"></a><span class="co"># allrates + scale_y_continuous(limits = c(0,1000))</span></span>
<span id="cb299-2499"><a href="#cb299-2499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2500"><a href="#cb299-2500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2501"><a href="#cb299-2501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=5, fig.width=4}</span></span>
<span id="cb299-2502"><a href="#cb299-2502" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb299-2503"><a href="#cb299-2503" aria-hidden="true" tabindex="-1"></a>all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-2504"><a href="#cb299-2504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPERIMENTTYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2505"><a href="#cb299-2505" aria-hidden="true" tabindex="-1"></a>    EXP <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-2506"><a href="#cb299-2506" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-2507"><a href="#cb299-2507" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2508"><a href="#cb299-2508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EXPERIMENTTYPE, FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2509"><a href="#cb299-2509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-2510"><a href="#cb299-2510" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SAMPLE_TYPE == "Vent" ) %&gt;% </span></span>
<span id="cb299-2511"><a href="#cb299-2511" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2512"><a href="#cb299-2512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb299-2513"><a href="#cb299-2513" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (GRAZING_EFFECT_hr_max), ymin = (GRAZING_EFFECT_hr_min)), </span></span>
<span id="cb299-2514"><a href="#cb299-2514" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># width = 0.2, position = position_dodge(width = 0.4), color = "black") +</span></span>
<span id="cb299-2515"><a href="#cb299-2515" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">color =</span> FIELD),</span>
<span id="cb299-2516"><a href="#cb299-2516" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb299-2517"><a href="#cb299-2517" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb299-2518"><a href="#cb299-2518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#addd8e"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2519"><a href="#cb299-2519" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-2520"><a href="#cb299-2520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2521"><a href="#cb299-2521" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2522"><a href="#cb299-2522" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-2523"><a href="#cb299-2523" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2524"><a href="#cb299-2524" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb299-2525"><a href="#cb299-2525" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-2526"><a href="#cb299-2526" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2527"><a href="#cb299-2527" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2528"><a href="#cb299-2528" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2529"><a href="#cb299-2529" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2530"><a href="#cb299-2530" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb299-2531"><a href="#cb299-2531" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb299-2532"><a href="#cb299-2532" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb299-2533"><a href="#cb299-2533" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb299-2534"><a href="#cb299-2534" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb299-2535"><a href="#cb299-2535" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-2536"><a href="#cb299-2536" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb299-2537"><a href="#cb299-2537" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_fill_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb299-2538"><a href="#cb299-2538" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = c("#E76F51", "#264653")) +</span></span>
<span id="cb299-2539"><a href="#cb299-2539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2540"><a href="#cb299-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2541"><a href="#cb299-2541" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove undetected grazing rate</span></span>
<span id="cb299-2542"><a href="#cb299-2542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2543"><a href="#cb299-2543" aria-hidden="true" tabindex="-1"></a>Repeat grazing rate plot, but removed undetectable</span>
<span id="cb299-2544"><a href="#cb299-2544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2547"><a href="#cb299-2547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2548"><a href="#cb299-2548" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb299-2549"><a href="#cb299-2549" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-2550"><a href="#cb299-2550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2551"><a href="#cb299-2551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, SAMPLE_TYPE, <span class="fu">starts_with</span>(<span class="st">"GRAZING_EFFECT_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2552"><a href="#cb299-2552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-2553"><a href="#cb299-2553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZING_EFFECT_hr, <span class="at">x =</span> NAME, <span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2554"><a href="#cb299-2554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (GRAZING_EFFECT_hr_max), <span class="at">ymin =</span> (GRAZING_EFFECT_hr_min)), </span>
<span id="cb299-2555"><a href="#cb299-2555" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb299-2556"><a href="#cb299-2556" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD, <span class="at">shape =</span> SAMPLE_TYPE),</span>
<span id="cb299-2557"><a href="#cb299-2557" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb299-2558"><a href="#cb299-2558" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb299-2559"><a href="#cb299-2559" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>, <span class="st">"#addd8e"</span>)) <span class="sc">+</span></span>
<span id="cb299-2560"><a href="#cb299-2560" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> SAMPLE_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">space =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-2561"><a href="#cb299-2561" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2562"><a href="#cb299-2562" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2563"><a href="#cb299-2563" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb299-2564"><a href="#cb299-2564" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2565"><a href="#cb299-2565" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb299-2566"><a href="#cb299-2566" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb299-2567"><a href="#cb299-2567" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb299-2568"><a href="#cb299-2568" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb299-2569"><a href="#cb299-2569" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2570"><a href="#cb299-2570" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2571"><a href="#cb299-2571" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb299-2572"><a href="#cb299-2572" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb299-2573"><a href="#cb299-2573" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb299-2574"><a href="#cb299-2574" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb299-2575"><a href="#cb299-2575" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb299-2576"><a href="#cb299-2576" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"cells"</span><span class="sc">~</span>ml<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb299-2577"><a href="#cb299-2577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2578"><a href="#cb299-2578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2579"><a href="#cb299-2579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=4, fig.width=7}</span></span>
<span id="cb299-2580"><a href="#cb299-2580" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("compare-all-rates-color-nonZero.svg", h = 4, w = 7)</span></span>
<span id="cb299-2581"><a href="#cb299-2581" aria-hidden="true" tabindex="-1"></a>allrates_nonzero <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb299-2582"><a href="#cb299-2582" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2583"><a href="#cb299-2583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2584"><a href="#cb299-2584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2585"><a href="#cb299-2585" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot variables as a factor of grazing rate.</span></span>
<span id="cb299-2586"><a href="#cb299-2586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2587"><a href="#cb299-2587" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure S7</span></span>
<span id="cb299-2588"><a href="#cb299-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2589"><a href="#cb299-2589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=10}</span></span>
<span id="cb299-2590"><a href="#cb299-2590" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6.svg", h = 8, w = 10)</span></span>
<span id="cb299-2591"><a href="#cb299-2591" aria-hidden="true" tabindex="-1"></a>grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb299-2592"><a href="#cb299-2592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2593"><a href="#cb299-2593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2594"><a href="#cb299-2594" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-2595"><a href="#cb299-2595" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-2596"><a href="#cb299-2596" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2597"><a href="#cb299-2597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2598"><a href="#cb299-2598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2599"><a href="#cb299-2599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EUK_ml =</span> <span class="fu">as.character</span>(EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2600"><a href="#cb299-2600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">as.character</span>(PROK_ml)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2601"><a href="#cb299-2601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.character</span>(temp),</span>
<span id="cb299-2602"><a href="#cb299-2602" aria-hidden="true" tabindex="-1"></a>         <span class="at">pH =</span> <span class="fu">as.character</span>(pH),</span>
<span id="cb299-2603"><a href="#cb299-2603" aria-hidden="true" tabindex="-1"></a>         <span class="at">mg =</span> <span class="fu">as.character</span>(mg),</span>
<span id="cb299-2604"><a href="#cb299-2604" aria-hidden="true" tabindex="-1"></a>         <span class="at">h2 =</span> <span class="fu">as.character</span>(h2),</span>
<span id="cb299-2605"><a href="#cb299-2605" aria-hidden="true" tabindex="-1"></a>         <span class="at">ch4 =</span> <span class="fu">as.character</span>(ch4),</span>
<span id="cb299-2606"><a href="#cb299-2606" aria-hidden="true" tabindex="-1"></a>         <span class="at">percseawater =</span> <span class="fu">as.character</span>(percseawater)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2607"><a href="#cb299-2607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE_TYPE, SiteOrder, EXP_TYPE, Experiment_rep, GRAZING_EFFECT_hr, EUK_ml, PROK_ml, temp, DEPTH, pH, percseawater, mg, h2, ch4) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2608"><a href="#cb299-2608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> EUK_ml<span class="sc">:</span>ch4, <span class="at">values_to =</span> <span class="st">"VALUES"</span>, <span class="at">values_ptypes =</span> <span class="fu">list</span>(<span class="at">VALUES =</span> <span class="fu">character</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2609"><a href="#cb299-2609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VALUES =</span> <span class="fu">as.numeric</span>(VALUES)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2610"><a href="#cb299-2610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-2611"><a href="#cb299-2611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> GRAZING_EFFECT_hr, <span class="at">y =</span> VALUES, </span>
<span id="cb299-2612"><a href="#cb299-2612" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2613"><a href="#cb299-2613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2614"><a href="#cb299-2614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb299-2615"><a href="#cb299-2615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb299-2616"><a href="#cb299-2616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb299-2617"><a href="#cb299-2617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-2618"><a href="#cb299-2618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2619"><a href="#cb299-2619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2620"><a href="#cb299-2620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2621"><a href="#cb299-2621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2622"><a href="#cb299-2622" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2623"><a href="#cb299-2623" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb299-2624"><a href="#cb299-2624" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2625"><a href="#cb299-2625" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2626"><a href="#cb299-2626" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2627"><a href="#cb299-2627" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2628"><a href="#cb299-2628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-2629"><a href="#cb299-2629" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-2630"><a href="#cb299-2630" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2631"><a href="#cb299-2631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2632"><a href="#cb299-2632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2635"><a href="#cb299-2635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2636"><a href="#cb299-2636" aria-hidden="true" tabindex="-1"></a>grazing_wenv_forLM <span class="ot">&lt;-</span> grazing_wenv <span class="sc">%&gt;%</span> </span>
<span id="cb299-2637"><a href="#cb299-2637" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(Name == "Shrimpocalypse" &amp; grepl("IGT", Experiment_rep))) %&gt;%</span></span>
<span id="cb299-2638"><a href="#cb299-2638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-2639"><a href="#cb299-2639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">TEMP =</span> <span class="fu">as.numeric</span>(temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2640"><a href="#cb299-2640" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2641"><a href="#cb299-2641" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Experiment_rep) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb299-2642"><a href="#cb299-2642" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Shipboard"</span></span>
<span id="cb299-2643"><a href="#cb299-2643" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2644"><a href="#cb299-2644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(SITE_TYPE, SiteOrder, EXP_TYPE, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2645"><a href="#cb299-2645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(SITE_TYPE <span class="sc">==</span> <span class="st">"NA-IGT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2646"><a href="#cb299-2646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EUK_ml =</span> <span class="fu">as.character</span>(EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2647"><a href="#cb299-2647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_ml =</span> <span class="fu">as.character</span>(PROK_ml),</span>
<span id="cb299-2648"><a href="#cb299-2648" aria-hidden="true" tabindex="-1"></a>         <span class="at">PROK_EUK_RATIO =</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(PROK_ml)<span class="sc">/</span><span class="fu">as.numeric</span>(EUK_ml))) <span class="sc">%&gt;%</span></span>
<span id="cb299-2649"><a href="#cb299-2649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.character</span>(temp),</span>
<span id="cb299-2650"><a href="#cb299-2650" aria-hidden="true" tabindex="-1"></a>         <span class="at">pH =</span> <span class="fu">as.character</span>(pH),</span>
<span id="cb299-2651"><a href="#cb299-2651" aria-hidden="true" tabindex="-1"></a>         <span class="at">mg =</span> <span class="fu">as.character</span>(mg),</span>
<span id="cb299-2652"><a href="#cb299-2652" aria-hidden="true" tabindex="-1"></a>         <span class="at">h2 =</span> <span class="fu">as.character</span>(h2),</span>
<span id="cb299-2653"><a href="#cb299-2653" aria-hidden="true" tabindex="-1"></a>         <span class="at">ch4 =</span> <span class="fu">as.character</span>(ch4),</span>
<span id="cb299-2654"><a href="#cb299-2654" aria-hidden="true" tabindex="-1"></a>         <span class="at">percseawater =</span> <span class="fu">as.character</span>(percseawater)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2655"><a href="#cb299-2655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SITE_TYPE, SiteOrder, EXP_TYPE, Experiment_rep, GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, SPEC_GRAZE_RATE_hr, BAC_TURNOVER_PERC, EUK_ml, PROK_ml, PROK_EUK_RATIO, temp, DEPTH, pH, percseawater, mg, h2, ch4) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2656"><a href="#cb299-2656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, CLEARANCE_RATE_ml, SPEC_GRAZE_RATE_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-2657"><a href="#cb299-2657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, temp, DEPTH, pH, percseawater, mg, h2, ch4, PROK_EUK_RATIO), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-2658"><a href="#cb299-2658" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2659"><a href="#cb299-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2660"><a href="#cb299-2660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2661"><a href="#cb299-2661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2664"><a href="#cb299-2664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2665"><a href="#cb299-2665" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb299-2666"><a href="#cb299-2666" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> grazing_wenv_forLM <span class="sc">%&gt;%</span></span>
<span id="cb299-2667"><a href="#cb299-2667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PARAMS_VALUE =</span> <span class="fu">as.numeric</span>(PARAMS_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2668"><a href="#cb299-2668" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb299-2669"><a href="#cb299-2669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb299-2670"><a href="#cb299-2670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2671"><a href="#cb299-2671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb299-2672"><a href="#cb299-2672" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2673"><a href="#cb299-2673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb299-2674"><a href="#cb299-2674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS,</span>
<span id="cb299-2675"><a href="#cb299-2675" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb299-2676"><a href="#cb299-2676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb299-2677"><a href="#cb299-2677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb299-2678"><a href="#cb299-2678" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2679"><a href="#cb299-2679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2680"><a href="#cb299-2680" aria-hidden="true" tabindex="-1"></a>regression_results_S8 <span class="ot">&lt;-</span> grazing_wenv_forLM <span class="sc">%&gt;%</span></span>
<span id="cb299-2681"><a href="#cb299-2681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span></span>
<span id="cb299-2682"><a href="#cb299-2682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2683"><a href="#cb299-2683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb299-2684"><a href="#cb299-2684" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span></span>
<span id="cb299-2685"><a href="#cb299-2685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span></span>
<span id="cb299-2686"><a href="#cb299-2686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb299-2687"><a href="#cb299-2687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(grazing_wenv_forLM) <span class="sc">%&gt;%</span></span>
<span id="cb299-2688"><a href="#cb299-2688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb299-2689"><a href="#cb299-2689" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2690"><a href="#cb299-2690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2691"><a href="#cb299-2691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2692"><a href="#cb299-2692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2693"><a href="#cb299-2693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2694"><a href="#cb299-2694" aria-hidden="true" tabindex="-1"></a>Supplementary Table</span>
<span id="cb299-2695"><a href="#cb299-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2698"><a href="#cb299-2698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2699"><a href="#cb299-2699" aria-hidden="true" tabindex="-1"></a>regression_results_TABLE <span class="ot">&lt;-</span> regression_results_S8 <span class="sc">%&gt;%</span> </span>
<span id="cb299-2700"><a href="#cb299-2700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared, SLOPE) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2701"><a href="#cb299-2701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb299-2702"><a href="#cb299-2702" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(regression_results_TABLE, file = "output-data/LM-results-table.csv")</span></span>
<span id="cb299-2703"><a href="#cb299-2703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2704"><a href="#cb299-2704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2705"><a href="#cb299-2705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=18}</span></span>
<span id="cb299-2706"><a href="#cb299-2706" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS6.svg", h = 8, w = 10)</span></span>
<span id="cb299-2707"><a href="#cb299-2707" aria-hidden="true" tabindex="-1"></a>grazing_for_supp <span class="ot">&lt;-</span> regression_results_S8</span>
<span id="cb299-2708"><a href="#cb299-2708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2709"><a href="#cb299-2709" aria-hidden="true" tabindex="-1"></a><span class="co"># y = mx+b</span></span>
<span id="cb299-2710"><a href="#cb299-2710" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 = slope (x) + b</span></span>
<span id="cb299-2711"><a href="#cb299-2711" aria-hidden="true" tabindex="-1"></a><span class="co"># solve for b</span></span>
<span id="cb299-2712"><a href="#cb299-2712" aria-hidden="true" tabindex="-1"></a>plot_r2 <span class="ot">&lt;-</span> grazing_for_supp <span class="sc">%&gt;%</span> </span>
<span id="cb299-2713"><a href="#cb299-2713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(RATE_VALUE), <span class="at">y =</span> <span class="fu">as.numeric</span>(PARAMS_VALUE), </span>
<span id="cb299-2714"><a href="#cb299-2714" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2715"><a href="#cb299-2715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2716"><a href="#cb299-2716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> PARAMS <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb299-2717"><a href="#cb299-2717" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb299-2718"><a href="#cb299-2718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb299-2719"><a href="#cb299-2719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scientific_10) <span class="sc">+</span></span>
<span id="cb299-2720"><a href="#cb299-2720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-2721"><a href="#cb299-2721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2722"><a href="#cb299-2722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2723"><a href="#cb299-2723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2724"><a href="#cb299-2724" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2725"><a href="#cb299-2725" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2726"><a href="#cb299-2726" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb299-2727"><a href="#cb299-2727" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2728"><a href="#cb299-2728" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2729"><a href="#cb299-2729" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2730"><a href="#cb299-2730" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2731"><a href="#cb299-2731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-2732"><a href="#cb299-2732" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-2733"><a href="#cb299-2733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2734"><a href="#cb299-2734" aria-hidden="true" tabindex="-1"></a>plot_wslope <span class="ot">&lt;-</span> grazing_for_supp <span class="sc">%&gt;%</span> </span>
<span id="cb299-2735"><a href="#cb299-2735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">b =</span> (SLOPE)<span class="sc">*</span>(<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2736"><a href="#cb299-2736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_xint =</span> ((<span class="dv">0</span> <span class="sc">-</span> b)<span class="sc">/</span>SLOPE)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2737"><a href="#cb299-2737" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">new_xint_2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb299-2738"><a href="#cb299-2738" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> (<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>)<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb299-2739"><a href="#cb299-2739" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> (<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>),</span>
<span id="cb299-2740"><a href="#cb299-2740" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2741"><a href="#cb299-2741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(PARAMS_VALUE)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2742"><a href="#cb299-2742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(RATE_VALUE), <span class="at">y =</span> <span class="fu">as.numeric</span>(PARAMS_VALUE), </span>
<span id="cb299-2743"><a href="#cb299-2743" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> SITE_TYPE, <span class="at">fill =</span> SITE_TYPE, <span class="at">shape =</span> SITE_TYPE)) <span class="sc">+</span></span>
<span id="cb299-2744"><a href="#cb299-2744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> SITE_TYPE), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb299-2745"><a href="#cb299-2745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> PARAMS <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb299-2746"><a href="#cb299-2746" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb299-2747"><a href="#cb299-2747" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous() +</span></span>
<span id="cb299-2748"><a href="#cb299-2748" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_log10() +</span></span>
<span id="cb299-2749"><a href="#cb299-2749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="fu">log10_trans</span>(),</span>
<span id="cb299-2750"><a href="#cb299-2750" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb299-2751"><a href="#cb299-2751" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb299-2752"><a href="#cb299-2752" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> (SLOPE), <span class="at">intercept =</span> (<span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb299-2753"><a href="#cb299-2753" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_abline(aes(slope = (SLOPE), yintercept = (b)), color = "black", linetype = "dashed", size = 0.5) +</span></span>
<span id="cb299-2754"><a href="#cb299-2754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb299-2755"><a href="#cb299-2755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#264653"</span>, <span class="st">"white"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2756"><a href="#cb299-2756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#264653"</span>, <span class="st">"#264653"</span>, <span class="st">"#E76F51"</span>, <span class="st">"#E76F51"</span>)) <span class="sc">+</span></span>
<span id="cb299-2757"><a href="#cb299-2757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-2758"><a href="#cb299-2758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2759"><a href="#cb299-2759" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb299-2760"><a href="#cb299-2760" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb299-2761"><a href="#cb299-2761" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2762"><a href="#cb299-2762" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb299-2763"><a href="#cb299-2763" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb299-2764"><a href="#cb299-2764" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">13</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb299-2765"><a href="#cb299-2765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Cells consumed "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>hr<span class="sc">^-</span><span class="dv">1</span>), <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb299-2766"><a href="#cb299-2766" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb299-2767"><a href="#cb299-2767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2768"><a href="#cb299-2768" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_wslope</span></span>
<span id="cb299-2769"><a href="#cb299-2769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2770"><a href="#cb299-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2771"><a href="#cb299-2771" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure S7 #2</span></span>
<span id="cb299-2772"><a href="#cb299-2772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2773"><a href="#cb299-2773" aria-hidden="true" tabindex="-1"></a>Supplementary figure</span>
<span id="cb299-2774"><a href="#cb299-2774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2775"><a href="#cb299-2775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=16}</span></span>
<span id="cb299-2776"><a href="#cb299-2776" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7_log.svg", h = 8, w = 16)</span></span>
<span id="cb299-2777"><a href="#cb299-2777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2778"><a href="#cb299-2778" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_r2</span></span>
<span id="cb299-2779"><a href="#cb299-2779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2780"><a href="#cb299-2780" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("../../../Manuscripts_presentations_reviews/MCR-grazing-2023/svg-files-figures/figS7_slope.svg", h = 8, w = 16)</span></span>
<span id="cb299-2781"><a href="#cb299-2781" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-2782"><a href="#cb299-2782" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_wslope</span></span>
<span id="cb299-2783"><a href="#cb299-2783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2784"><a href="#cb299-2784" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb299-2785"><a href="#cb299-2785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2786"><a href="#cb299-2786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2787"><a href="#cb299-2787" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear regression &amp; tidy models</span></span>
<span id="cb299-2788"><a href="#cb299-2788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2789"><a href="#cb299-2789" aria-hidden="true" tabindex="-1"></a>Use tidymodels to perform linear regression.</span>
<span id="cb299-2790"><a href="#cb299-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2791"><a href="#cb299-2791" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR and GR data as input</span></span>
<span id="cb299-2792"><a href="#cb299-2792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2795"><a href="#cb299-2795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2796"><a href="#cb299-2796" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb299-2797"><a href="#cb299-2797" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb299-2798"><a href="#cb299-2798" aria-hidden="true" tabindex="-1"></a><span class="co"># e IGT</span></span>
<span id="cb299-2799"><a href="#cb299-2799" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb299-2800"><a href="#cb299-2800" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_input &lt;- all_vents %&gt;%</span></span>
<span id="cb299-2801"><a href="#cb299-2801" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;%</span></span>
<span id="cb299-2802"><a href="#cb299-2802" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Highest.Temp)) %&gt;%</span></span>
<span id="cb299-2803"><a href="#cb299-2803" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, TEMP = Highest.Temp) %&gt;%</span></span>
<span id="cb299-2804"><a href="#cb299-2804" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(PROK_EUK_RATIO = (PROK_ml/EUK_ml)) %&gt;%</span></span>
<span id="cb299-2805"><a href="#cb299-2805" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = c(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), names_to = "RATE", values_to = "RATE_VALUE") %&gt;%</span></span>
<span id="cb299-2806"><a href="#cb299-2806" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = c(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), names_to = "PARAMS", values_to = "PARAMS_VALUE") %&gt;%</span></span>
<span id="cb299-2807"><a href="#cb299-2807" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb299-2808"><a href="#cb299-2808" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-2809"><a href="#cb299-2809" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_tmp &lt;- regression_input %&gt;%</span></span>
<span id="cb299-2810"><a href="#cb299-2810" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Set up the linear regression</span></span>
<span id="cb299-2811"><a href="#cb299-2811" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(RATE, PARAMS) %&gt;%</span></span>
<span id="cb299-2812"><a href="#cb299-2812" aria-hidden="true" tabindex="-1"></a><span class="co">#   nest(-RATE, -PARAMS) %&gt;%</span></span>
<span id="cb299-2813"><a href="#cb299-2813" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(lm_fit = map(data, ~lm(RATE_VALUE ~ PARAMS_VALUE, data = .)),</span></span>
<span id="cb299-2814"><a href="#cb299-2814" aria-hidden="true" tabindex="-1"></a><span class="co">#     tidied = map(lm_fit, tidy)) %&gt;%</span></span>
<span id="cb299-2815"><a href="#cb299-2815" aria-hidden="true" tabindex="-1"></a><span class="co">#   unnest(tidied) %&gt;%</span></span>
<span id="cb299-2816"><a href="#cb299-2816" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(RATE, PARAMS,</span></span>
<span id="cb299-2817"><a href="#cb299-2817" aria-hidden="true" tabindex="-1"></a><span class="co">#     term, estimate) %&gt;%</span></span>
<span id="cb299-2818"><a href="#cb299-2818" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(names_from = term, values_from = estimate) %&gt;%</span></span>
<span id="cb299-2819"><a href="#cb299-2819" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(everything(), SLOPE = PARAMS_VALUE) %&gt;%</span></span>
<span id="cb299-2820"><a href="#cb299-2820" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb299-2821"><a href="#cb299-2821" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-2822"><a href="#cb299-2822" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_results &lt;- regression_input %&gt;%</span></span>
<span id="cb299-2823"><a href="#cb299-2823" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(RATE, PARAMS) %&gt;%</span></span>
<span id="cb299-2824"><a href="#cb299-2824" aria-hidden="true" tabindex="-1"></a><span class="co">#   nest(-RATE, -PARAMS) %&gt;%</span></span>
<span id="cb299-2825"><a href="#cb299-2825" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(lm_fit = map(data, ~lm(RATE_VALUE ~ PARAMS_VALUE, data = .)),</span></span>
<span id="cb299-2826"><a href="#cb299-2826" aria-hidden="true" tabindex="-1"></a><span class="co">#     glanced = map(lm_fit, glance)) %&gt;%</span></span>
<span id="cb299-2827"><a href="#cb299-2827" aria-hidden="true" tabindex="-1"></a><span class="co">#   unnest(glanced) %&gt;%</span></span>
<span id="cb299-2828"><a href="#cb299-2828" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(RATE, PARAMS, r.squared, adj.r.squared) %&gt;%</span></span>
<span id="cb299-2829"><a href="#cb299-2829" aria-hidden="true" tabindex="-1"></a><span class="co">#   right_join(regression_tmp) %&gt;%</span></span>
<span id="cb299-2830"><a href="#cb299-2830" aria-hidden="true" tabindex="-1"></a><span class="co">#   right_join(regression_input) %&gt;%</span></span>
<span id="cb299-2831"><a href="#cb299-2831" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb299-2832"><a href="#cb299-2832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2833"><a href="#cb299-2833" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results)</span></span>
<span id="cb299-2834"><a href="#cb299-2834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2835"><a href="#cb299-2835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2836"><a href="#cb299-2836" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb299-2837"><a href="#cb299-2837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2838"><a href="#cb299-2838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb299-2839"><a href="#cb299-2839" aria-hidden="true" tabindex="-1"></a><span class="co"># regression_results %&gt;%</span></span>
<span id="cb299-2840"><a href="#cb299-2840" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb299-2841"><a href="#cb299-2841" aria-hidden="true" tabindex="-1"></a><span class="co">#   # filter(PARAMS == "TEMP") %&gt;%</span></span>
<span id="cb299-2842"><a href="#cb299-2842" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = PARAMS_VALUE, y = RATE_VALUE, shape = SAMPLE_TYPE, fill = FIELD)) +</span></span>
<span id="cb299-2843"><a href="#cb299-2843" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_abline(aes(slope = SLOPE, intercept = `X.Intercept.`), color = "black", linetype = "dashed", size = 0.5) +</span></span>
<span id="cb299-2844"><a href="#cb299-2844" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(color = "black", aes(shape = SAMPLE_TYPE, fill = FIELD)) +</span></span>
<span id="cb299-2845"><a href="#cb299-2845" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_shape_manual(values = c(21, 24)) +</span></span>
<span id="cb299-2846"><a href="#cb299-2846" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_fill_manual(values = c("#476AA7","#7299CE", "#A2937A")) +</span></span>
<span id="cb299-2847"><a href="#cb299-2847" aria-hidden="true" tabindex="-1"></a><span class="co">#     facet_wrap(PARAMS ~ RATE + round(r.squared, 3), scales = "free", ncol = 5,</span></span>
<span id="cb299-2848"><a href="#cb299-2848" aria-hidden="true" tabindex="-1"></a><span class="co">#              strip.position = "bottom", labeller = label_parsed) +</span></span>
<span id="cb299-2849"><a href="#cb299-2849" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb299-2850"><a href="#cb299-2850" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb299-2851"><a href="#cb299-2851" aria-hidden="true" tabindex="-1"></a><span class="co">#     strip.background = element_blank(),</span></span>
<span id="cb299-2852"><a href="#cb299-2852" aria-hidden="true" tabindex="-1"></a><span class="co">#     strip.placement = "outside",</span></span>
<span id="cb299-2853"><a href="#cb299-2853" aria-hidden="true" tabindex="-1"></a><span class="co">#     strip.text = element_text(color = "black", size = 10),</span></span>
<span id="cb299-2854"><a href="#cb299-2854" aria-hidden="true" tabindex="-1"></a><span class="co">#     axis.title = element_text(color = "black", size = 10),</span></span>
<span id="cb299-2855"><a href="#cb299-2855" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend.title = element_blank()) # +</span></span>
<span id="cb299-2856"><a href="#cb299-2856" aria-hidden="true" tabindex="-1"></a><span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb299-2857"><a href="#cb299-2857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2858"><a href="#cb299-2858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2859"><a href="#cb299-2859" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR only</span></span>
<span id="cb299-2860"><a href="#cb299-2860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2861"><a href="#cb299-2861" aria-hidden="true" tabindex="-1"></a>repeat MCR only</span>
<span id="cb299-2862"><a href="#cb299-2862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2865"><a href="#cb299-2865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2866"><a href="#cb299-2866" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb299-2867"><a href="#cb299-2867" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb299-2868"><a href="#cb299-2868" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb299-2869"><a href="#cb299-2869" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-2870"><a href="#cb299-2870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2871"><a href="#cb299-2871" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb299-2872"><a href="#cb299-2872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2873"><a href="#cb299-2873" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2874"><a href="#cb299-2874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2875"><a href="#cb299-2875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2876"><a href="#cb299-2876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2877"><a href="#cb299-2877" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2878"><a href="#cb299-2878" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(regression_input)</span>
<span id="cb299-2879"><a href="#cb299-2879" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb299-2880"><a href="#cb299-2880" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb299-2881"><a href="#cb299-2881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2882"><a href="#cb299-2882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2883"><a href="#cb299-2883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb299-2884"><a href="#cb299-2884" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2885"><a href="#cb299-2885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2886"><a href="#cb299-2886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb299-2887"><a href="#cb299-2887" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2888"><a href="#cb299-2888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2889"><a href="#cb299-2889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb299-2890"><a href="#cb299-2890" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2891"><a href="#cb299-2891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2892"><a href="#cb299-2892" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb299-2893"><a href="#cb299-2893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2894"><a href="#cb299-2894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2895"><a href="#cb299-2895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb299-2896"><a href="#cb299-2896" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2897"><a href="#cb299-2897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2898"><a href="#cb299-2898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2899"><a href="#cb299-2899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb299-2900"><a href="#cb299-2900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb299-2901"><a href="#cb299-2901" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2902"><a href="#cb299-2902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2903"><a href="#cb299-2903" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_mcr)</span></span>
<span id="cb299-2904"><a href="#cb299-2904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2905"><a href="#cb299-2905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2906"><a href="#cb299-2906" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb299-2907"><a href="#cb299-2907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2908"><a href="#cb299-2908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb299-2909"><a href="#cb299-2909" aria-hidden="true" tabindex="-1"></a>regression_results_mcr <span class="sc">%&gt;%</span> </span>
<span id="cb299-2910"><a href="#cb299-2910" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb299-2911"><a href="#cb299-2911" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb299-2912"><a href="#cb299-2912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb299-2913"><a href="#cb299-2913" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb299-2914"><a href="#cb299-2914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb299-2915"><a href="#cb299-2915" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb299-2916"><a href="#cb299-2916" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb299-2917"><a href="#cb299-2917" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb299-2918"><a href="#cb299-2918" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb299-2919"><a href="#cb299-2919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb299-2920"><a href="#cb299-2920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb299-2921"><a href="#cb299-2921" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-2922"><a href="#cb299-2922" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb299-2923"><a href="#cb299-2923" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb299-2924"><a href="#cb299-2924" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb299-2925"><a href="#cb299-2925" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb299-2926"><a href="#cb299-2926" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb299-2927"><a href="#cb299-2927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2928"><a href="#cb299-2928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2929"><a href="#cb299-2929" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCR vent sites only</span></span>
<span id="cb299-2930"><a href="#cb299-2930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2931"><a href="#cb299-2931" aria-hidden="true" tabindex="-1"></a>Repeat with only vent sites &amp; remove undetected grazing.</span>
<span id="cb299-2932"><a href="#cb299-2932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2935"><a href="#cb299-2935" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2936"><a href="#cb299-2936" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb299-2937"><a href="#cb299-2937" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb299-2938"><a href="#cb299-2938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2939"><a href="#cb299-2939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2942"><a href="#cb299-2942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-2943"><a href="#cb299-2943" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb299-2944"><a href="#cb299-2944" aria-hidden="true" tabindex="-1"></a><span class="co"># ?pivot_longer</span></span>
<span id="cb299-2945"><a href="#cb299-2945" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$FIELD)</span></span>
<span id="cb299-2946"><a href="#cb299-2946" aria-hidden="true" tabindex="-1"></a>regression_input <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-2947"><a href="#cb299-2947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(FIELD <span class="sc">==</span> <span class="st">"Gorda Ridge"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2948"><a href="#cb299-2948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Background"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">==</span> <span class="st">"Plume"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2949"><a href="#cb299-2949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2950"><a href="#cb299-2950" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!(SAMPLE == "Piccard-Shrimpocalypse" &amp; EXP == "IGT")) %&gt;% </span></span>
<span id="cb299-2951"><a href="#cb299-2951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2952"><a href="#cb299-2952" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(FIELD, NAME, SAMPLE, SAMPLE_TYPE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, BAC_TURNOVER_PERC, <span class="at">TEMP =</span> Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2953"><a href="#cb299-2953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2954"><a href="#cb299-2954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(GRAZING_EFFECT_hr, BAC_TURNOVER_PERC), <span class="at">names_to =</span> <span class="st">"RATE"</span>, <span class="at">values_to =</span> <span class="st">"RATE_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2955"><a href="#cb299-2955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml, PROK_EUK_RATIO, TEMP), <span class="at">names_to =</span> <span class="st">"PARAMS"</span>, <span class="at">values_to =</span> <span class="st">"PARAMS_VALUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2956"><a href="#cb299-2956" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2957"><a href="#cb299-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2958"><a href="#cb299-2958" aria-hidden="true" tabindex="-1"></a>regression_tmp <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb299-2959"><a href="#cb299-2959" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the linear regression</span></span>
<span id="cb299-2960"><a href="#cb299-2960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2961"><a href="#cb299-2961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2962"><a href="#cb299-2962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)), </span>
<span id="cb299-2963"><a href="#cb299-2963" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2964"><a href="#cb299-2964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2965"><a href="#cb299-2965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, </span>
<span id="cb299-2966"><a href="#cb299-2966" aria-hidden="true" tabindex="-1"></a>    term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2967"><a href="#cb299-2967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2968"><a href="#cb299-2968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">SLOPE =</span> PARAMS_VALUE) <span class="sc">%&gt;%</span></span>
<span id="cb299-2969"><a href="#cb299-2969" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2970"><a href="#cb299-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2971"><a href="#cb299-2971" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="ot">&lt;-</span> regression_input <span class="sc">%&gt;%</span> </span>
<span id="cb299-2972"><a href="#cb299-2972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RATE, PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2973"><a href="#cb299-2973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>RATE, <span class="sc">-</span>PARAMS) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2974"><a href="#cb299-2974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(RATE_VALUE <span class="sc">~</span> PARAMS_VALUE, <span class="at">data =</span> .)),</span>
<span id="cb299-2975"><a href="#cb299-2975" aria-hidden="true" tabindex="-1"></a>    <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2976"><a href="#cb299-2976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2977"><a href="#cb299-2977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RATE, PARAMS, r.squared, adj.r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2978"><a href="#cb299-2978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_tmp) <span class="sc">%&gt;%</span></span>
<span id="cb299-2979"><a href="#cb299-2979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_input) <span class="sc">%&gt;%</span></span>
<span id="cb299-2980"><a href="#cb299-2980" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb299-2981"><a href="#cb299-2981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2982"><a href="#cb299-2982" aria-hidden="true" tabindex="-1"></a><span class="co"># View(regression_results_vent)</span></span>
<span id="cb299-2983"><a href="#cb299-2983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-2984"><a href="#cb299-2984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2985"><a href="#cb299-2985" aria-hidden="true" tabindex="-1"></a>Plot results from regression</span>
<span id="cb299-2986"><a href="#cb299-2986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-2987"><a href="#cb299-2987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=15}</span></span>
<span id="cb299-2988"><a href="#cb299-2988" aria-hidden="true" tabindex="-1"></a>regression_results_vent <span class="sc">%&gt;%</span> </span>
<span id="cb299-2989"><a href="#cb299-2989" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(RATE == "GRAZING_EFFECT_hr") %&gt;%</span></span>
<span id="cb299-2990"><a href="#cb299-2990" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(PARAMS == "TEMP") %&gt;% </span></span>
<span id="cb299-2991"><a href="#cb299-2991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PARAMS_VALUE, <span class="at">y =</span> RATE_VALUE, <span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb299-2992"><a href="#cb299-2992" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> <span class="st">`</span><span class="at">X.Intercept.</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb299-2993"><a href="#cb299-2993" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> SAMPLE_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb299-2994"><a href="#cb299-2994" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb299-2995"><a href="#cb299-2995" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#476AA7"</span>,<span class="st">"#7299CE"</span>, <span class="st">"#A2937A"</span>)) <span class="sc">+</span></span>
<span id="cb299-2996"><a href="#cb299-2996" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(PARAMS <span class="sc">~</span> RATE <span class="sc">+</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb299-2997"><a href="#cb299-2997" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb299-2998"><a href="#cb299-2998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb299-2999"><a href="#cb299-2999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb299-3000"><a href="#cb299-3000" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-3001"><a href="#cb299-3001" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb299-3002"><a href="#cb299-3002" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb299-3003"><a href="#cb299-3003" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb299-3004"><a href="#cb299-3004" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb299-3005"><a href="#cb299-3005" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(y = bquote("Cells "~mL^-1 ~hr^-1), x = "Temperature (C)")</span></span>
<span id="cb299-3006"><a href="#cb299-3006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3007"><a href="#cb299-3007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3008"><a href="#cb299-3008" aria-hidden="true" tabindex="-1"></a>*Regression thoughts*: Unremarkable r squared values (numbers at the bottom of each plot). Some trends, mainly associated with temperature.</span>
<span id="cb299-3009"><a href="#cb299-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3010"><a href="#cb299-3010" aria-hidden="true" tabindex="-1"></a>Bacterial abundance typically increases with temperature (White et al. 1991) - which could ultimately increase bacterial ingestion rate and total protist cells. But at this type of niche environment, I hypothesize that there is a trend but threshold of not detected grazing under certain conditions.</span>
<span id="cb299-3011"><a href="#cb299-3011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3012"><a href="#cb299-3012" aria-hidden="true" tabindex="-1"></a>If euk per ml numbers are high, but we see lower grazing rates, could this be competition? Curds and Cockburn 1968. Additionally with temperature... in Vaque et al GRF (specific grazing rates of flagellates) increased with temperature, but overall grazing rate reached a plateau at 18C. Does this mean that temperature will be an important factor depending on the community diversity?</span>
<span id="cb299-3013"><a href="#cb299-3013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3016"><a href="#cb299-3016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3017"><a href="#cb299-3017" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_vents)</span>
<span id="cb299-3018"><a href="#cb299-3018" aria-hidden="true" tabindex="-1"></a>allvent_data <span class="ot">&lt;-</span> all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3019"><a href="#cb299-3019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PROK_EUK_RATIO =</span> (PROK_ml<span class="sc">/</span>EUK_ml))</span>
<span id="cb299-3020"><a href="#cb299-3020" aria-hidden="true" tabindex="-1"></a><span class="co"># head(allvent_data)</span></span>
<span id="cb299-3021"><a href="#cb299-3021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3022"><a href="#cb299-3022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3023"><a href="#cb299-3023" aria-hidden="true" tabindex="-1"></a>Function to plot results by two parameters.</span>
<span id="cb299-3024"><a href="#cb299-3024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3027"><a href="#cb299-3027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3028"><a href="#cb299-3028" aria-hidden="true" tabindex="-1"></a>two_params <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x_var, y_var, x_title, y_title){</span>
<span id="cb299-3029"><a href="#cb299-3029" aria-hidden="true" tabindex="-1"></a>  X_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(x_var)</span>
<span id="cb299-3030"><a href="#cb299-3030" aria-hidden="true" tabindex="-1"></a>  Y_VAR <span class="ot">&lt;-</span> <span class="fu">enquo</span>(y_var)</span>
<span id="cb299-3031"><a href="#cb299-3031" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb299-3032"><a href="#cb299-3032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, <span class="at">X =</span> <span class="sc">!!</span>X_VAR, <span class="at">Y =</span> <span class="sc">!!</span>Y_VAR) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3033"><a href="#cb299-3033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-3034"><a href="#cb299-3034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb299-3035"><a href="#cb299-3035" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb299-3036"><a href="#cb299-3036" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3037"><a href="#cb299-3037" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-3038"><a href="#cb299-3038" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> x_title, <span class="at">y =</span> y_title)</span>
<span id="cb299-3039"><a href="#cb299-3039" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb299-3040"><a href="#cb299-3040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3041"><a href="#cb299-3041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3042"><a href="#cb299-3042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3043"><a href="#cb299-3043" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by euk:prok and then euk and prok</span></span>
<span id="cb299-3044"><a href="#cb299-3044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3047"><a href="#cb299-3047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3048"><a href="#cb299-3048" aria-hidden="true" tabindex="-1"></a><span class="fu">two_params</span>(allvent_data, <span class="st">`</span><span class="at">PROK_EUK_RATIO</span><span class="st">`</span>, <span class="st">`</span><span class="at">Highest.Temp</span><span class="st">`</span>, <span class="st">"Prok:Euk ratio"</span>, <span class="st">"Temperature (max)"</span>)</span>
<span id="cb299-3049"><a href="#cb299-3049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3050"><a href="#cb299-3050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3051"><a href="#cb299-3051" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot temperature by grazing rate</span></span>
<span id="cb299-3052"><a href="#cb299-3052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3055"><a href="#cb299-3055" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3056"><a href="#cb299-3056" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allvent_data)</span>
<span id="cb299-3057"><a href="#cb299-3057" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, `Highest.Temp`, "ugC_L_perday", "Temperature (max)")</span></span>
<span id="cb299-3058"><a href="#cb299-3058" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, ugC_L_perday, EUK_ml, "ugC_L_perday", "Euk cells per ml") + scale_y_log10()</span></span>
<span id="cb299-3059"><a href="#cb299-3059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3060"><a href="#cb299-3060" aria-hidden="true" tabindex="-1"></a><span class="co"># two_params(allvent_data, EUK_ml, PROK_ml, "Euk", "Prok") + scale_y_log10() + scale_x_log10()</span></span>
<span id="cb299-3061"><a href="#cb299-3061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3062"><a href="#cb299-3062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3063"><a href="#cb299-3063" aria-hidden="true" tabindex="-1"></a><span class="fu"># Carbon biomass investigation</span></span>
<span id="cb299-3064"><a href="#cb299-3064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3067"><a href="#cb299-3067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3068"><a href="#cb299-3068" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb299-3069"><a href="#cb299-3069" aria-hidden="true" tabindex="-1"></a><span class="co"># GRAZING_EFFECT_hr = "Cells~mL^{-1}~hr^{-1}"</span></span>
<span id="cb299-3070"><a href="#cb299-3070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3071"><a href="#cb299-3071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3072"><a href="#cb299-3072" aria-hidden="true" tabindex="-1"></a>If we assume that carbon content per prey cell is between 86 - 300 fgC per cell. What does the amount consumed look like?</span>
<span id="cb299-3073"><a href="#cb299-3073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3076"><a href="#cb299-3076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3077"><a href="#cb299-3077" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame</span></span>
<span id="cb299-3078"><a href="#cb299-3078" aria-hidden="true" tabindex="-1"></a><span class="co"># carbon_density &lt;- crossing(fgC_cell = seq(86, 300, by = 1), </span></span>
<span id="cb299-3079"><a href="#cb299-3079" aria-hidden="true" tabindex="-1"></a><span class="co">#                              GRAZING_EFFECT_hr = seq(min(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb299-3080"><a href="#cb299-3080" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   max(all_vents$GRAZING_EFFECT_hr),</span></span>
<span id="cb299-3081"><a href="#cb299-3081" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   length.out = 215))  %&gt;%</span></span>
<span id="cb299-3082"><a href="#cb299-3082" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb299-3083"><a href="#cb299-3083" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb299-3084"><a href="#cb299-3084" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;%</span></span>
<span id="cb299-3085"><a href="#cb299-3085" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame</span></span>
<span id="cb299-3086"><a href="#cb299-3086" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-3087"><a href="#cb299-3087" aria-hidden="true" tabindex="-1"></a><span class="co"># # unique(all_vents$GRAZING_EFFECT_hr)</span></span>
<span id="cb299-3088"><a href="#cb299-3088" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb299-3089"><a href="#cb299-3089" aria-hidden="true" tabindex="-1"></a><span class="co"># samples_lines &lt;- select(all_vents, GRAZING_EFFECT_hr, FIELD) %&gt;% </span></span>
<span id="cb299-3090"><a href="#cb299-3090" aria-hidden="true" tabindex="-1"></a><span class="co">#   distinct() %&gt;% </span></span>
<span id="cb299-3091"><a href="#cb299-3091" aria-hidden="true" tabindex="-1"></a><span class="co">#   crossing(fgC_cell = seq(86, 300, by = 20)) %&gt;%</span></span>
<span id="cb299-3092"><a href="#cb299-3092" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(fgC_ml_perday = ((GRAZING_EFFECT_hr*24) * fgC_cell),</span></span>
<span id="cb299-3093"><a href="#cb299-3093" aria-hidden="true" tabindex="-1"></a><span class="co">#     ugC_L_perday = (fgC_ml_perday * (1e-09) * 1000)</span></span>
<span id="cb299-3094"><a href="#cb299-3094" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb299-3095"><a href="#cb299-3095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3096"><a href="#cb299-3096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3099"><a href="#cb299-3099" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3100"><a href="#cb299-3100" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(carbon_density, aes(x = fgC_cell, y = GRAZING_EFFECT_hr)) +</span></span>
<span id="cb299-3101"><a href="#cb299-3101" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_raster(aes(fill = ugC_L_perday)) +</span></span>
<span id="cb299-3102"><a href="#cb299-3102" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_gradientn(colors = c("#fef0d9", "#b30000"), name = bquote("ug C"~L^-1 ~day^-1)) +</span></span>
<span id="cb299-3103"><a href="#cb299-3103" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_fill_discrete(name = "New Legend Title")</span></span>
<span id="cb299-3104"><a href="#cb299-3104" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(expand = c(0,0)) +</span></span>
<span id="cb299-3105"><a href="#cb299-3105" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(expand = c(0,0)) +</span></span>
<span id="cb299-3106"><a href="#cb299-3106" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb299-3107"><a href="#cb299-3107" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black"),</span></span>
<span id="cb299-3108"><a href="#cb299-3108" aria-hidden="true" tabindex="-1"></a><span class="co">#         rect = element_rect(fill = "transparent"),</span></span>
<span id="cb299-3109"><a href="#cb299-3109" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill = "transparent"),</span></span>
<span id="cb299-3110"><a href="#cb299-3110" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill = "transparent", color = NA)) +</span></span>
<span id="cb299-3111"><a href="#cb299-3111" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = bquote("Cells "~mL^-1 ~consumed ~hr^-1), x = bquote("fg C"~cell^-1)) +</span></span>
<span id="cb299-3112"><a href="#cb299-3112" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(data = samples_lines,</span></span>
<span id="cb299-3113"><a href="#cb299-3113" aria-hidden="true" tabindex="-1"></a><span class="co">#             aes(x = 87,</span></span>
<span id="cb299-3114"><a href="#cb299-3114" aria-hidden="true" tabindex="-1"></a><span class="co">#             y = GRAZING_EFFECT_hr, shape = FIELD), size = 1)</span></span>
<span id="cb299-3115"><a href="#cb299-3115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3116"><a href="#cb299-3116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3117"><a href="#cb299-3117" aria-hidden="true" tabindex="-1"></a>Eukaryote biomass comparison with measured vs. literature</span>
<span id="cb299-3118"><a href="#cb299-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3121"><a href="#cb299-3121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3122"><a href="#cb299-3122" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated in ASV code right now!</span></span>
<span id="cb299-3123"><a href="#cb299-3123" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata &lt;- env_params %&gt;% </span></span>
<span id="cb299-3124"><a href="#cb299-3124" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(SAMPLETYPE != "Incubation") %&gt;%</span></span>
<span id="cb299-3125"><a href="#cb299-3125" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(VENT != "Quakeplume") %&gt;% </span></span>
<span id="cb299-3126"><a href="#cb299-3126" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(SITE, VENT, SAMPLETYPE, TEMP, DEPTH, starts_with("PROK_"), starts_with("EUK_"), starts_with("GRAZING_EFFECT_hr"))</span></span>
<span id="cb299-3127"><a href="#cb299-3127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3128"><a href="#cb299-3128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3129"><a href="#cb299-3129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=5}</span></span>
<span id="cb299-3130"><a href="#cb299-3130" aria-hidden="true" tabindex="-1"></a><span class="co"># head(plot_metadata)</span></span>
<span id="cb299-3131"><a href="#cb299-3131" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_metadata %&gt;% </span></span>
<span id="cb299-3132"><a href="#cb299-3132" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(Euk_biomass_Hu)) %&gt;% </span></span>
<span id="cb299-3133"><a href="#cb299-3133" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Euk_biomass_Hu_fg = Euk_biomass_Hu * 1000000000,</span></span>
<span id="cb299-3134"><a href="#cb299-3134" aria-hidden="true" tabindex="-1"></a><span class="co">#          Euk_biomass_lit_fg = Euk_biomass_lit * 1000000000) %&gt;% </span></span>
<span id="cb299-3135"><a href="#cb299-3135" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(y = VENT)) +</span></span>
<span id="cb299-3136"><a href="#cb299-3136" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_Hu_fg), color = "black", fill = "darkgreen", shape = 21, size = 4) +</span></span>
<span id="cb299-3137"><a href="#cb299-3137" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(x = Euk_biomass_lit), color = "black", fill = "lightgreen", shape = 21, size = 4) +</span></span>
<span id="cb299-3138"><a href="#cb299-3138" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb299-3139"><a href="#cb299-3139" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb299-3140"><a href="#cb299-3140" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_text(color = "black")) +</span></span>
<span id="cb299-3141"><a href="#cb299-3141" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(SAMPLETYPE ~ ., space = "free", scales = "free") +</span></span>
<span id="cb299-3142"><a href="#cb299-3142" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "fg C of eukaryote population", y = "")</span></span>
<span id="cb299-3143"><a href="#cb299-3143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3144"><a href="#cb299-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3145"><a href="#cb299-3145" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction of MCR data with parameters</span></span>
<span id="cb299-3146"><a href="#cb299-3146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3147"><a href="#cb299-3147" aria-hidden="true" tabindex="-1"></a>Best model to estimate community grazing rate in Vaque et al. considered FLP uptake and similar experiments (in contrast to disappearance experiments).</span>
<span id="cb299-3148"><a href="#cb299-3148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3149"><a href="#cb299-3149" aria-hidden="true" tabindex="-1"></a>From Vaque et al. 1994 paper equation (1):</span>
<span id="cb299-3150"><a href="#cb299-3150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3151"><a href="#cb299-3151" aria-hidden="true" tabindex="-1"></a>See Figure 6</span>
<span id="cb299-3152"><a href="#cb299-3152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3153"><a href="#cb299-3153" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; log(GT) = -3.21 + 0.99 log (HNF) + 0.028 (T) + 0.55 log(BAC)</span></span>
<span id="cb299-3154"><a href="#cb299-3154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3155"><a href="#cb299-3155" aria-hidden="true" tabindex="-1"></a>*GT* = grazing rate (cells ml-1 hr-1) *HNF* = heterotrophic nanoflagellates (cells ml-1) T = temperature (C) *BAC* = prokaryote abundance (cells ml-1)</span>
<span id="cb299-3156"><a href="#cb299-3156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3157"><a href="#cb299-3157" aria-hidden="true" tabindex="-1"></a>Start with non-zero grazing rate values, etc. Where... *GT* == Grazing effect hr *HNF* == Euk_ml *BAC* == PROK_ml *T* == highest temp</span>
<span id="cb299-3158"><a href="#cb299-3158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3159"><a href="#cb299-3159" aria-hidden="true" tabindex="-1"></a>We only have these for MCR data.. can include GR for the "predicting euk_ml"</span>
<span id="cb299-3160"><a href="#cb299-3160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3161"><a href="#cb299-3161" aria-hidden="true" tabindex="-1"></a>Function to use above formula and estimate</span>
<span id="cb299-3162"><a href="#cb299-3162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3165"><a href="#cb299-3165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3166"><a href="#cb299-3166" aria-hidden="true" tabindex="-1"></a>est_predicted <span class="ot">&lt;-</span> <span class="cf">function</span>(df, TITLE){</span>
<span id="cb299-3167"><a href="#cb299-3167" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb299-3168"><a href="#cb299-3168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr, Highest.Temp) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3169"><a href="#cb299-3169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3170"><a href="#cb299-3170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FIELD, NAME, SAMPLE, EXP, PROK_ml, EUK_ml, GRAZING_EFFECT_hr) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3171"><a href="#cb299-3171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TEMP =</span> <span class="fu">mean</span>(Highest.Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3172"><a href="#cb299-3172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb299-3173"><a href="#cb299-3173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PREDICTED_TEMP =</span> (((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml))) <span class="sc">/</span> <span class="fl">0.028</span>),</span>
<span id="cb299-3174"><a href="#cb299-3174" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_GRAZING_EFFECT_hr =</span> (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.21</span> <span class="sc">+</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">+</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP) <span class="sc">+</span> (<span class="fl">0.55</span><span class="sc">*</span>(<span class="fu">log10</span>(PROK_ml))))),</span>
<span id="cb299-3175"><a href="#cb299-3175" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_EUK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.55</span><span class="sc">*</span><span class="fu">log10</span>(PROK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.99</span>)),</span>
<span id="cb299-3176"><a href="#cb299-3176" aria-hidden="true" tabindex="-1"></a>         <span class="at">PREDICTED_PROK =</span> (<span class="dv">10</span><span class="sc">^</span>(((<span class="fu">log10</span>(GRAZING_EFFECT_hr)) <span class="sc">+</span> <span class="fl">3.21</span> <span class="sc">-</span> (<span class="fl">0.99</span><span class="sc">*</span><span class="fu">log10</span>(EUK_ml)) <span class="sc">-</span> (<span class="fl">0.028</span><span class="sc">*</span>TEMP))<span class="sc">/</span><span class="fl">0.55</span>)))</span>
<span id="cb299-3177"><a href="#cb299-3177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots</span></span>
<span id="cb299-3178"><a href="#cb299-3178" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3179"><a href="#cb299-3179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_GRAZING_EFFECT_hr, <span class="at">y =</span> GRAZING_EFFECT_hr)) <span class="sc">+</span></span>
<span id="cb299-3180"><a href="#cb299-3180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3181"><a href="#cb299-3181" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3182"><a href="#cb299-3182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_GRAZING_EFFECT_hr), <span class="at">y =</span> <span class="fu">log10</span>(GRAZING_EFFECT_hr))) <span class="sc">+</span></span>
<span id="cb299-3183"><a href="#cb299-3183" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3184"><a href="#cb299-3184" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3185"><a href="#cb299-3185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_EUK, <span class="at">y =</span> EUK_ml)) <span class="sc">+</span></span>
<span id="cb299-3186"><a href="#cb299-3186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3187"><a href="#cb299-3187" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3188"><a href="#cb299-3188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_EUK), <span class="at">y =</span> <span class="fu">log10</span>(EUK_ml))) <span class="sc">+</span></span>
<span id="cb299-3189"><a href="#cb299-3189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3190"><a href="#cb299-3190" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3191"><a href="#cb299-3191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_PROK, <span class="at">y =</span> PROK_ml)) <span class="sc">+</span></span>
<span id="cb299-3192"><a href="#cb299-3192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3193"><a href="#cb299-3193" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3194"><a href="#cb299-3194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_PROK), <span class="at">y =</span> <span class="fu">log10</span>(PROK_ml))) <span class="sc">+</span></span>
<span id="cb299-3195"><a href="#cb299-3195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3196"><a href="#cb299-3196" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3197"><a href="#cb299-3197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PREDICTED_TEMP, <span class="at">y =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb299-3198"><a href="#cb299-3198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3199"><a href="#cb299-3199" aria-hidden="true" tabindex="-1"></a>  df_out <span class="sc">%&gt;%</span> </span>
<span id="cb299-3200"><a href="#cb299-3200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(PREDICTED_TEMP), <span class="at">y =</span> <span class="fu">log10</span>(TEMP))) <span class="sc">+</span></span>
<span id="cb299-3201"><a href="#cb299-3201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb299-3202"><a href="#cb299-3202" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> TITLE)</span>
<span id="cb299-3203"><a href="#cb299-3203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return(df_out)</span></span>
<span id="cb299-3204"><a href="#cb299-3204" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb299-3205"><a href="#cb299-3205" aria-hidden="true" tabindex="-1"></a><span class="co"># head(all_vents)</span></span>
<span id="cb299-3206"><a href="#cb299-3206" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(all_vents$NAME)</span></span>
<span id="cb299-3207"><a href="#cb299-3207" aria-hidden="true" tabindex="-1"></a><span class="co"># range(all_vents$Highest.Temp)</span></span>
<span id="cb299-3208"><a href="#cb299-3208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3209"><a href="#cb299-3209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3210"><a href="#cb299-3210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=, fig.height=6, fig.width=12}</span></span>
<span id="cb299-3211"><a href="#cb299-3211" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents, <span class="st">"all values"</span>)</span>
<span id="cb299-3212"><a href="#cb299-3212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3213"><a href="#cb299-3213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3214"><a href="#cb299-3214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb299-3215"><a href="#cb299-3215" aria-hidden="true" tabindex="-1"></a>mcr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb299-3216"><a href="#cb299-3216" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Backgound"</span>, <span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Near vent BW"</span>)</span>
<span id="cb299-3217"><a href="#cb299-3217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3218"><a href="#cb299-3218" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr), "Mid-Cayman Rise only")</span></span>
<span id="cb299-3219"><a href="#cb299-3219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3220"><a href="#cb299-3220" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(FIELD %in% mcr) %&gt;% filter(GRAZING_EFFECT_hr &gt; 0), "Mid-Cayman Rise only, no undetected")</span></span>
<span id="cb299-3221"><a href="#cb299-3221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3222"><a href="#cb299-3222" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)), <span class="st">"Mid-Cayman Rise only, no undetected, vents only"</span>)</span>
<span id="cb299-3223"><a href="#cb299-3223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3224"><a href="#cb299-3224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3225"><a href="#cb299-3225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb299-3226"><a href="#cb299-3226" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb299-3227"><a href="#cb299-3227" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% filter(!(NAME %in% bsw)), "Vent samples only")</span></span>
<span id="cb299-3228"><a href="#cb299-3228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3229"><a href="#cb299-3229" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"Vent samples only where grazing was detected"</span>)</span>
<span id="cb299-3230"><a href="#cb299-3230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3231"><a href="#cb299-3231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3232"><a href="#cb299-3232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb299-3233"><a href="#cb299-3233" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_vents)</span></span>
<span id="cb299-3234"><a href="#cb299-3234" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3235"><a href="#cb299-3235" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3236"><a href="#cb299-3236" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">%in%</span> mcr) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3237"><a href="#cb299-3237" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb299-3238"><a href="#cb299-3238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3239"><a href="#cb299-3239" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3240"><a href="#cb299-3240" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span>(NAME <span class="sc">%in%</span> bsw)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3241"><a href="#cb299-3241" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(FIELD <span class="sc">==</span> <span class="st">"Von Damm"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3242"><a href="#cb299-3242" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"MCR vent samples only where grazing was detected"</span>)</span>
<span id="cb299-3243"><a href="#cb299-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3244"><a href="#cb299-3244" aria-hidden="true" tabindex="-1"></a><span class="co"># not really enough in Piccard to make this statistically sound.</span></span>
<span id="cb299-3245"><a href="#cb299-3245" aria-hidden="true" tabindex="-1"></a><span class="co"># est_predicted(all_vents %&gt;% </span></span>
<span id="cb299-3246"><a href="#cb299-3246" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb299-3247"><a href="#cb299-3247" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(FIELD == "Piccard") %&gt;% </span></span>
<span id="cb299-3248"><a href="#cb299-3248" aria-hidden="true" tabindex="-1"></a><span class="co">#                 filter(GRAZING_EFFECT_hr &gt; 0), "MCR vent samples only where grazing was detected")</span></span>
<span id="cb299-3249"><a href="#cb299-3249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3250"><a href="#cb299-3250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3253"><a href="#cb299-3253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3254"><a href="#cb299-3254" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(all_vents<span class="sc">$</span>Highest.Temp)</span>
<span id="cb299-3255"><a href="#cb299-3255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3256"><a href="#cb299-3256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3257"><a href="#cb299-3257" aria-hidden="true" tabindex="-1"></a>What about a temperature threshold? Perhaps this exists, but maybe not enough data to include.</span>
<span id="cb299-3258"><a href="#cb299-3258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3259"><a href="#cb299-3259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb299-3260"><a href="#cb299-3260" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3261"><a href="#cb299-3261" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb299-3262"><a href="#cb299-3262" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps higher than 60C"</span>)</span>
<span id="cb299-3263"><a href="#cb299-3263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3264"><a href="#cb299-3264" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3265"><a href="#cb299-3265" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter(!(NAME %in% bsw)) %&gt;% </span></span>
<span id="cb299-3266"><a href="#cb299-3266" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"All samples, temps lower than 60C"</span>)</span>
<span id="cb299-3267"><a href="#cb299-3267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3268"><a href="#cb299-3268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3269"><a href="#cb299-3269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8, fig.width=15}</span></span>
<span id="cb299-3270"><a href="#cb299-3270" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3271"><a href="#cb299-3271" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-3272"><a href="#cb299-3272" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&gt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps higher than 60C"</span>)</span>
<span id="cb299-3273"><a href="#cb299-3273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3274"><a href="#cb299-3274" aria-hidden="true" tabindex="-1"></a><span class="fu">est_predicted</span>(all_vents <span class="sc">%&gt;%</span> </span>
<span id="cb299-3275"><a href="#cb299-3275" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(GRAZING_EFFECT_hr <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-3276"><a href="#cb299-3276" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Highest.Temp <span class="sc">&lt;</span> <span class="dv">60</span>), <span class="st">"Removed undetected, temps lower than 60C"</span>)</span>
<span id="cb299-3277"><a href="#cb299-3277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3278"><a href="#cb299-3278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3279"><a href="#cb299-3279" aria-hidden="true" tabindex="-1"></a><span class="fu"># Save Robjects for Results</span></span>
<span id="cb299-3280"><a href="#cb299-3280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3283"><a href="#cb299-3283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3284"><a href="#cb299-3284" aria-hidden="true" tabindex="-1"></a><span class="co"># Oct 22, 2023</span></span>
<span id="cb299-3285"><a href="#cb299-3285" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(euk_prok_counts, table_grazerate_wflp_wprok_weuk,</span>
<span id="cb299-3286"><a href="#cb299-3286" aria-hidden="true" tabindex="-1"></a>     table_wcalcs, biov_calc, c_factor_biov,</span>
<span id="cb299-3287"><a href="#cb299-3287" aria-hidden="true" tabindex="-1"></a>     pgC_ml_biov_bysample, pgC_ml_sizefrac_bysample,</span>
<span id="cb299-3288"><a href="#cb299-3288" aria-hidden="true" tabindex="-1"></a>     carbon_consumed, <span class="at">file =</span> <span class="st">"input-data/all-dfs-for-Tables.RData"</span>)</span>
<span id="cb299-3289"><a href="#cb299-3289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-3290"><a href="#cb299-3290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3291"><a href="#cb299-3291" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session</span></span>
<span id="cb299-3292"><a href="#cb299-3292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3295"><a href="#cb299-3295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb299-3296"><a href="#cb299-3296" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb299-3297"><a href="#cb299-3297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>