<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mid-Cayman Rise analysis - Protistan grazing analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Mid-Cayman Rise analysis</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./grazing.html" aria-current="page">Grazing analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./asv.html">Sequence processing</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-format-data" id="toc-import-format-data" class="nav-link active" data-scroll-target="#import-format-data">Import &amp; format data</a>
  <ul class="collapse">
  <li><a href="#set-up-working-r-environment" id="toc-set-up-working-r-environment" class="nav-link" data-scroll-target="#set-up-working-r-environment">Set up working R environment</a></li>
  <li><a href="#import-raw-count-data" id="toc-import-raw-count-data" class="nav-link" data-scroll-target="#import-raw-count-data">Import raw count data</a></li>
  </ul></li>
  <li><a href="#calculate-cells-per-ml-euk" id="toc-calculate-cells-per-ml-euk" class="nav-link" data-scroll-target="#calculate-cells-per-ml-euk">Calculate cells per ml (euk)</a>
  <ul class="collapse">
  <li><a href="#plot-eukaryote-cells-per-ml" id="toc-plot-eukaryote-cells-per-ml" class="nav-link" data-scroll-target="#plot-eukaryote-cells-per-ml">Plot eukaryote cells per ml</a></li>
  <li><a href="#isolate-t0-only-counts-for-cellsml-plot" id="toc-isolate-t0-only-counts-for-cellsml-plot" class="nav-link" data-scroll-target="#isolate-t0-only-counts-for-cellsml-plot">Isolate T0 only counts for cells/ml plot</a></li>
  </ul></li>
  <li><a href="#bacteria-archaea-cell-counts" id="toc-bacteria-archaea-cell-counts" class="nav-link" data-scroll-target="#bacteria-archaea-cell-counts">Bacteria &amp; archaea cell counts</a>
  <ul class="collapse">
  <li><a href="#cells-per-ml-prok" id="toc-cells-per-ml-prok" class="nav-link" data-scroll-target="#cells-per-ml-prok">Cells per ml (prok)</a>
  <ul class="collapse">
  <li><a href="#combine-with-previous-mcr-cell-counts" id="toc-combine-with-previous-mcr-cell-counts" class="nav-link" data-scroll-target="#combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimate-grazing-effect" id="toc-estimate-grazing-effect" class="nav-link" data-scroll-target="#estimate-grazing-effect">Estimate grazing effect</a>
  <ul class="collapse">
  <li><a href="#determine-flp-per-euk-cell" id="toc-determine-flp-per-euk-cell" class="nav-link" data-scroll-target="#determine-flp-per-euk-cell">Determine FLP per euk cell</a></li>
  <li><a href="#calculate-flp-per-euk-cell-calculation" id="toc-calculate-flp-per-euk-cell-calculation" class="nav-link" data-scroll-target="#calculate-flp-per-euk-cell-calculation">Calculate FLP per euk cell calculation</a></li>
  <li><a href="#calculate-linear-regression-to-obtain-slope" id="toc-calculate-linear-regression-to-obtain-slope" class="nav-link" data-scroll-target="#calculate-linear-regression-to-obtain-slope">Calculate linear regression to obtain slope</a>
  <ul class="collapse">
  <li><a href="#plot-linear-regression-trend" id="toc-plot-linear-regression-trend" class="nav-link" data-scroll-target="#plot-linear-regression-trend">Plot linear regression trend</a></li>
  </ul></li>
  <li><a href="#remove-igt-tf-time-points." id="toc-remove-igt-tf-time-points." class="nav-link" data-scroll-target="#remove-igt-tf-time-points.">Remove IGT Tf time points.</a></li>
  <li><a href="#compile-and-save-grazing-experiment-results" id="toc-compile-and-save-grazing-experiment-results" class="nav-link" data-scroll-target="#compile-and-save-grazing-experiment-results">Compile and save grazing experiment results</a></li>
  </ul></li>
  <li><a href="#check-flp-control-experiments" id="toc-check-flp-control-experiments" class="nav-link" data-scroll-target="#check-flp-control-experiments">Check FLP control experiments</a>
  <ul class="collapse">
  <li><a href="#bag-grazing-experiment-controls" id="toc-bag-grazing-experiment-controls" class="nav-link" data-scroll-target="#bag-grazing-experiment-controls">Bag grazing experiment controls</a></li>
  <li><a href="#igt-experiment-controls" id="toc-igt-experiment-controls" class="nav-link" data-scroll-target="#igt-experiment-controls">IGT experiment controls</a></li>
  </ul></li>
  <li><a href="#generate-complete-table-with-grazing-rates-and-values" id="toc-generate-complete-table-with-grazing-rates-and-values" class="nav-link" data-scroll-target="#generate-complete-table-with-grazing-rates-and-values">Generate complete table with grazing rates and values</a>
  <ul class="collapse">
  <li><a href="#plot-flpgrazer-minute" id="toc-plot-flpgrazer-minute" class="nav-link" data-scroll-target="#plot-flpgrazer-minute">Plot FLP/grazer /minute</a></li>
  </ul></li>
  <li><a href="#grazing-rate-calculations" id="toc-grazing-rate-calculations" class="nav-link" data-scroll-target="#grazing-rate-calculations">Grazing rate calculations</a>
  <ul class="collapse">
  <li><a href="#gt-table-option" id="toc-gt-table-option" class="nav-link" data-scroll-target="#gt-table-option">gt table option</a></li>
  <li><a href="#carbon-biomass" id="toc-carbon-biomass" class="nav-link" data-scroll-target="#carbon-biomass">Carbon biomass</a></li>
  <li><a href="#compare-carbon-biomass-with-literature" id="toc-compare-carbon-biomass-with-literature" class="nav-link" data-scroll-target="#compare-carbon-biomass-with-literature">Compare carbon biomass with literature</a>
  <ul class="collapse">
  <li><a href="#carbon-biomass-for-prokaryotes" id="toc-carbon-biomass-for-prokaryotes" class="nav-link" data-scroll-target="#carbon-biomass-for-prokaryotes">Carbon biomass for prokaryotes</a></li>
  </ul></li>
  <li><a href="#amend-table-with-bounded-carbon-estimates" id="toc-amend-table-with-bounded-carbon-estimates" class="nav-link" data-scroll-target="#amend-table-with-bounded-carbon-estimates">Amend table with ‘bounded’ carbon estimates</a></li>
  </ul></li>
  <li><a href="#compare-with-axial-euk-cell-count" id="toc-compare-with-axial-euk-cell-count" class="nav-link" data-scroll-target="#compare-with-axial-euk-cell-count">Compare with Axial euk cell count</a></li>
  <li><a href="#environmental-parameters---mcr" id="toc-environmental-parameters---mcr" class="nav-link" data-scroll-target="#environmental-parameters---mcr">Environmental parameters - MCR</a></li>
  <li><a href="#analysis-of-grazing-rate-results" id="toc-analysis-of-grazing-rate-results" class="nav-link" data-scroll-target="#analysis-of-grazing-rate-results">Analysis of grazing rate results</a>
  <ul class="collapse">
  <li><a href="#function-to-plot-grazing-results" id="toc-function-to-plot-grazing-results" class="nav-link" data-scroll-target="#function-to-plot-grazing-results">Function to plot grazing results</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Protistan grazing analysis</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="import-format-data" class="level1">
<h1>Import &amp; format data</h1>
<p>Code below details how to import cell count (FLP count) information from Mid-Cayman Rise protistan grazing incubations and estimate grazing rate and cell biomass.</p>
<section id="set-up-working-r-environment" class="level2">
<h2 class="anchored" data-anchor-id="set-up-working-r-environment">Set up working R environment</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(cowplot); <span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-raw-count-data" class="level2">
<h2 class="anchored" data-anchor-id="import-raw-count-data">Import raw count data</h2>
<p>Import eukaryotic cell count data from grazing experiments. In this section, we will calculate cells per ml from raw counts (Field of view, etc.) and use to estimate protist cell concentration. These will be used below in grazing experiment calculations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/euk-counts-compiled.txt"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>counts[<span class="fu">is.na</span>(counts)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Raw data table collected during microscopy count process. Below code reviews the structure of this raw data and updates column headers to be more ‘R’ friendly.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(counts)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DATE"</span>, <span class="st">"SAMPLE"</span>, <span class="st">"EXPID"</span>, <span class="st">"VOL"</span>, <span class="st">"MAG"</span>, <span class="st">"FOV"</span>, <span class="st">"nanoNoFLP"</span>, <span class="st">"microNoFLP"</span>, <span class="st">"nanoFLP"</span>, <span class="st">"microFLP"</span>, <span class="st">"NOTES"</span>, <span class="st">"DateCompiled"</span>); <span class="fu">colnames</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DATE"         "SAMPLE"       "EXPID"        "VOL"          "MAG"         
 [6] "FOV"          "nanoNoFLP"    "microNoFLP"   "nanoFLP"      "microFLP"    
[11] "NOTES"        "DateCompiled"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>To count occurrence and number of FLP ingested by eukaryotic cells, the number of FLPs ingested was tallied and comma separated for multiple eukaryotic cells with FLP. These values need to separated and counted as 1 eukaryotic cell each, but retain the number of FLP per cell.</p>
</blockquote>
<p>Parse raw microscopy count data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>counts_occur <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove incomplete</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOTES <span class="sc">!=</span> <span class="st">"Not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count number of euk cells observed with FLPs (ex. if "1,2", 'occur' will = 2)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(nanoFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">microFLP_occur =</span> <span class="fu">as.numeric</span>(<span class="fu">str_count</span>(microFLP, <span class="st">"[1-9]</span><span class="sc">\\</span><span class="st">d*"</span>)),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Add number of euk cells with FLPs to those without for total number of euk cells</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nanoNoFLP) <span class="sc">+</span> nanoFLP_occur, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(microNoFLP) <span class="sc">+</span> microFLP_occur,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calculate-cells-per-ml-euk" class="level1">
<h1>Calculate cells per ml (euk)</h1>
<p>Input data are the raw microscopy counts by FOV. Code below calculations cells/ml based on these values. Additionaly, variance and standard deviation are also calculated. Eukaryotic cells were also classified by size, where micro equates to &gt;20um and nano is &lt;20um. All counts were done at 100x magnification, confirm this: <code>unique(counts_occur$MAG)</code>.</p>
<p>Calculate cell concentration (cells/ml).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_all <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, VOL) <span class="sc">%&gt;%</span> <span class="co">#Calculate averages by sample</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar))), </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab scope, it is 283.385):</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(expmeta) %&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Replicates belong to the same experiment for either Bag or IGT incubation. Below, modify these names and label new column with bag or igt. And create an average across replicates.</p>
</blockquote>
<p>Average cells/ml across replicates, pivot to long format</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, nanoCONC, microCONC, eukCONC) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Replicate) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Name, TimePoint, EXP_TYPE, IGT_REP, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean, variance, SD, min, and max</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR =</span> <span class="fu">var</span>(CONCENTRATION),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CONCENTRATION),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span>(<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MIN =</span> <span class="fu">min</span>(CONCENTRATION),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MAX =</span> <span class="fu">max</span>(CONCENTRATION),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop_last'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>NOTES on calculations:</p>
<p><em>VAR</em> = takes the sum of the squares of each value’s deviation from the mean and divides by the number of such values minus one. This differs from the calculation of variance across an entire population in that the latter divides by the size of the dataset without subtracting one.</p>
<p><em>SD</em> = standard deviation of all values</p>
<p><em>SEM</em> = standard deviation of sampling distribution; standard deviation divided by the square root of the sample size.</p>
<p>Save output file</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, file = "input-data/raw-avg-eukcount.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Reformat to parse experiment information type</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format and add column that reports IGT vs bag experiment</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plot_euk_conc <span class="ot">&lt;-</span> counts_cellsml_all <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site, Name, TimePoint, Replicate, <span class="fu">ends_with</span>(<span class="st">"CONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"CONC"</span>), <span class="at">names_to =</span> <span class="st">"VARIABLE"</span>, <span class="at">values_to =</span> <span class="st">"CONCENTRATION"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Factor cell count data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(plot_euk_conc<span class="sc">$</span>Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LotsOShrimp"    "Plume"          "Shrimpocalypse" "BSW"           
[5] "MustardStand"   "OMT"            "Rav2"           "ShrimpHole"    
[9] "X18"           </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plot_euk_conc<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_conc<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-eukaryote-cells-per-ml" class="level2">
<h2 class="anchored" data-anchor-id="plot-eukaryote-cells-per-ml">Plot eukaryote cells per ml</h2>
<p><a href="#fig-boxplot-all">Figure&nbsp;1</a> reports all eukaryote cells per ml counts from all grazing assay counts..</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>conc_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_conc, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">y =</span> CONCENTRATION, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">group =</span> NameOrder,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> VARIABLE,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not color by time point</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">fill =</span> VARIABLE,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e7298a"</span>, <span class="st">"#fcbba1"</span>, <span class="st">"#c6dbef"</span>)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(limits = c(10,1000), expand = c(0, 0)) +</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scale =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Distribution of all eukaryotic cell counts"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>conc_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis
Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing non-finite values (stat_boxplot).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplot-all" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="grazing_files/figure-html/fig-boxplot-all-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Eukaryote cell concentration (cells/ml) are lower in the background and plume samples compared to vent sites. ~300 cells/ml in background and plume compared to ~1000 cells per ml at the vent sites. These values are also consistent between each vent site (Von Damm and Piccard) and between Bag and IGT samples.</p>
<blockquote class="blockquote">
<p>Boxplot represents the median (line in box) and the 1st and 3rd quartiles in the lower and upper hinges, respectively (25th and 75th percentiles). Black data points are outliers from the boxplot. Upper and lower whiskers represent the 1.5 * interquartile ranges. Pink data points are the values contributing to the boxplot (individial counts across replicates and time points.)</p>
</blockquote>
<blockquote class="blockquote">
<p>eukCONC is the sum of micro and nano. Because there was a discrepency between the micro and nano cell counts, we plan to combine for most of the analysis. Here we show that the cell concentration across replicate samples was similar throughout experiments. And that the bag versus IGT experiment results were within range of one another.</p>
</blockquote>
<p>Plot eukaryote cell concentration over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(counts_cellsml_avg<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trend line of euk cell count for all experiments</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>counts_cellsml_avg <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, NameOrder, IGT_REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> MEAN, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> NameOrder)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_errorbar(aes(ymax = (MEAN + SD), ymin = (MEAN - SD)), width = 0.2) +</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE)) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(SiteOrder <span class="sc">~</span> EXP_TYPE, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                            <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total euk cell counts for each experiment"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Average eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>) <span class="sc">+</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">21</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>note there is an overall drop in euk cells/ml in the final time point. Especially with the IGT samples. Take this into consideration</p>
</blockquote>
</section>
<section id="isolate-t0-only-counts-for-cellsml-plot" class="level2">
<h2 class="anchored" data-anchor-id="isolate-t0-only-counts-for-cellsml-plot">Isolate T0 only counts for cells/ml plot</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="ot">&lt;-</span> plot_euk_conc <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TimePoint <span class="sc">==</span> <span class="st">"T0"</span> <span class="sc">&amp;</span> (VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteOrder, NameOrder, TimePoint, EXP_TYPE, VARIABLE) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_conc =</span> <span class="fu">mean</span>(CONCENTRATION),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM_conc =</span> (<span class="fu">sd</span>(CONCENTRATION)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CONCENTRATION))),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SiteOrder, NameOrder, EXP_TYPE, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>plot_euk_format<span class="sc">$</span>Site_Order <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_euk_format<span class="sc">$</span>SiteOrder, <span class="at">levels =</span> site_fullname, <span class="at">labels =</span> site_fullname)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># View(plot_euk_format)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>euk_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_euk_format, <span class="fu">aes</span>(<span class="at">x =</span> NameOrder, <span class="at">y =</span> avg_conc, <span class="at">fill =</span> Site_Order)) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (avg_conc <span class="sc">+</span> SEM_conc), <span class="at">ymin =</span> (avg_conc <span class="sc">-</span> SEM_conc)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Site_Order), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_Order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#de2d26"</span>)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Eukaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>),</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>euk_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Print table of eukaryote cell count information.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VARIABLE <span class="sc">==</span> <span class="st">"eukCONC"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    NameOrder <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> SiteOrder</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN_cellml =</span> <span class="fu">format</span>(<span class="fu">mean</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">min_cellml =</span> <span class="fu">format</span>(<span class="fu">min</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">max_cellml =</span> <span class="fu">format</span>(<span class="fu">max</span>(avg_conc), <span class="at">scientific =</span> T),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">num =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  SAMPLE_TYPE MEAN_cellml  min_cellml   max_cellml     num
  &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;
1 Background  9.183773e+01 9.183773e+01 9.183773e+01     1
2 Piccard     3.801791e+02 2.309063e+02 4.548154e+02     3
3 Plume       1.185379e+02 7.930115e+01 1.577747e+02     2
4 Von Damm    4.105001e+02 2.597696e+02 6.20998e+02      6</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(counts_cellsml_all, counts_cellsml_avg, counts_occur, file = "output-data/MCR-cellcount-dfs")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="bacteria-archaea-cell-counts" class="level1">
<h1>Bacteria &amp; archaea cell counts</h1>
<p>DAPI slide counts from prokaryotes from same sites. Import and compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>insitu_proks <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MEAN =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(CELLML)),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(CELLML),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> (<span class="fu">sd</span>(CELLML)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(CELLML))),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cells-per-ml-prok" class="level2">
<h2 class="anchored" data-anchor-id="cells-per-ml-prok">Cells per ml (prok)</h2>
<p>Visualize counts</p>
<p>Factor site names, etc.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Name_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"BSW"</span>, <span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>, <span class="st">"HotChimlet1"</span>, <span class="st">"ShrimpGulley"</span>, <span class="st">"SouthofHotChimlet"</span>, <span class="st">"SouthofLungSnack"</span>, <span class="st">"ArrowLoop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Rav1"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>insitu_proks<span class="sc">$</span>Site_order <span class="ot">&lt;-</span> <span class="fu">factor</span>(insitu_proks<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>prok_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(insitu_proks, <span class="fu">aes</span>(<span class="at">x =</span> Name_order, <span class="at">y =</span> MEAN)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (MEAN <span class="sc">+</span> SEM), <span class="at">ymin =</span> (MEAN <span class="sc">-</span> SEM)), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Site), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Site_order, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Prokaryote cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>prok_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="combine-with-previous-mcr-cell-counts" class="level3">
<h3 class="anchored" data-anchor-id="combine-with-previous-mcr-cell-counts">Combine with previous MCR cell counts</h3>
<p>Compare <em>in situ</em> prokaryote cell counts from 2020 to previous years</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>prok_prev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/cellcount_previousyr.csv"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>prok_prev_formatted <span class="ot">&lt;-</span> prok_prev <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VENTSITE =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Piccard"</span>, Site) <span class="sc">~</span> <span class="st">"Piccard"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Von Damm"</span>, Site) <span class="sc">~</span> <span class="st">"VD"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(YEAR)) <span class="sc">%&gt;%</span> <span class="co">#QC of </span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "NC") %&gt;% </span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "") %&gt;% </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(cells_ml != "no data") %&gt;% </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>, <span class="at">numerals =</span> <span class="st">"no.loss"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, <span class="at">NAME =</span> Name, <span class="at">REP=</span>Replicate, <span class="at">CELLML =</span> cells_ml, <span class="at">ORIGSAMPLE =</span> Orig_vent_site_ID, ID_number, Origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Re-import 2020 data to compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-import 2020</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>prok <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/prokINSITU-counts-compiled.txt"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View(prok)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>proks_allyrs <span class="ot">&lt;-</span> prok <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"VENTSITE"</span>, <span class="st">"NAME"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, VENTSITE, NAME, REP, CELLML, <span class="at">ORIGSAMPLE =</span> BAC) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(prok_prev_formatted <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID_number, <span class="sc">-</span>Origin)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove not countable or not data samples:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"no data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CELLML <span class="sc">!=</span> <span class="st">"not countable"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View(proks_allyrs)</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View(as.data.frame(unique(proks_allyrs$NAME)))</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>vent_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"NearsummitBeebee"</span>,<span class="st">"MainOrifice"</span>,<span class="st">"NearMainOrifice"</span>,<span class="st">"Rav1"</span>,<span class="st">"HotChimlet1"</span>,<span class="st">"HotChimlet"</span>,<span class="st">"SouthofHotChimlet"</span>,<span class="st">"NearHotChimlet"</span>,<span class="st">"HotCracks1"</span>,<span class="st">"HotCracks2"</span>,<span class="st">"ShrimpHole"</span>,<span class="st">"ShrimpHole(X18)"</span>,<span class="st">"X18"</span>,<span class="st">"X19"</span>,<span class="st">"SouthofLungSnack"</span>,<span class="st">"TwinPeaks"</span>,<span class="st">"OMT"</span>,<span class="st">"WhiteCastle"</span>,<span class="st">"GingerCastle"</span>,<span class="st">"ArrowLoop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"LotsOShrimp"</span>,<span class="st">"MustardStand"</span>,<span class="st">"ShrimpButtery"</span>,<span class="st">"ShrimpCanyon"</span>,<span class="st">"ShrimpGulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"ShrimpVegas"</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>vent_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>,<span class="st">"Quakeplume"</span>,<span class="st">"Near summit Beebee Vents Mound"</span>,<span class="st">"Main Orifice"</span>,<span class="st">"Near Main Orifice"</span>,<span class="st">"Ravelin #1"</span>,<span class="st">"Hot Chimlet #1"</span>,<span class="st">"Hot Chimlet"</span>,<span class="st">"South of Hot Chimlet"</span>,<span class="st">"Near Hot Chimlet"</span>,<span class="st">"Hot Cracks #1"</span>,<span class="st">"Hot Cracks #2"</span>,<span class="st">"Shrimp Hole"</span>,<span class="st">"Shrimp Hole (X-18)"</span>,<span class="st">"X-18"</span>,<span class="st">"X-19"</span>,<span class="st">"South of Lung Snack"</span>,<span class="st">"Twin Peaks"</span>,<span class="st">"Old Man Tree"</span>,<span class="st">"White Castle"</span>,<span class="st">"Ginger Castle"</span>,<span class="st">"Arrow Loop"</span>,<span class="st">"Bartizan"</span>,<span class="st">"Lots O Shrimp"</span>,<span class="st">"Mustard Stand"</span>,<span class="st">"Shrimp Buttery"</span>,<span class="st">"Shrimp Canyon"</span>,<span class="st">"Shrimp Gulley"</span>,<span class="st">"Shrimpocalypse"</span>,<span class="st">"Shrimp Vegas"</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>NAME, <span class="at">levels =</span> vent_order, <span class="at">labels =</span> vent_names)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>proks_allyrs<span class="sc">$</span>VENTSITE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(proks_allyrs<span class="sc">$</span>VENTSITE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"VD"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Piccard"</span>, <span class="st">"Von Damm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot by year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf("compare-across-yr-cellcount-04052021.pdf", h = 8, w = 7)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proks_allyrs, <span class="fu">aes</span>(<span class="at">x =</span> NAME_ORDER, <span class="at">y =</span> <span class="fu">as.numeric</span>(CELLML), <span class="at">fill =</span> <span class="fu">factor</span>(YEAR), <span class="at">shape =</span> VENTSITE_ORDER)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(YEAR)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(VENTSITE_ORDER <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1c9099"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#fc4e2a"</span>)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Cells "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">22</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="estimate-grazing-effect" class="level1">
<h1>Estimate grazing effect</h1>
<p>Calculate FLP per eukaryotic cell over time. Goal is to make these calculations and then determine best fit line. Slope of best fit line is the grazing rate. Need to take into account euk cells with FLPs and then the euk cells withOUT FLPs, these will be zeroes to take into account for FLPs/euk averages.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"output-data/MCR-cellcount-dfs"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading objects:
  counts_cellsml_all
  counts_cellsml_avg
  counts_occur</code></pre>
</div>
</div>
<section id="determine-flp-per-euk-cell" class="level2">
<h2 class="anchored" data-anchor-id="determine-flp-per-euk-cell">Determine FLP per euk cell</h2>
<p>Isolate euk cell counts with FLPs (comma separated for counts). These need to be separated into rows, use <code>counts_occur</code> data frame from above.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select nano and micro counts with FLPs</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>counts_sepflp <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NOTES <span class="sc">==</span> <span class="st">"Discard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DATE, SAMPLE, EXPID, VOL, MAG, FOV, nanoFLP, microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inputs that are comma separated will be split into a new row</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(microFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(nanoFLP, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace NAs with zeroes</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">microFLP =</span> <span class="dv">0</span>, <span class="at">nanoFLP =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>optional gut check of data table modification</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check, see FOV 23, separated into rows.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_sepflp %&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View(counts_occur %&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(SAMPLE == "VD-Rav2" &amp; EXPID == "T10-Rep1"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Isolate counts that are &gt;0, so only eukaryote cells that were observed to have FLPs are included. Then calculate FLP per euk cell by dividing by 1 (each row is a euk cell, based on data transformation above).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>counts_flp <span class="ot">&lt;-</span> counts_sepflp <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoFLP, <span class="at">micro_size =</span> microFLP) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_FLP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_of_FLP <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_FLP =</span> <span class="fu">sum</span>(num_of_FLP),</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">n</span>(),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>OUTPUT COLUMNS: (1) total_FLP = sum of FLPs found inside a euk cell (2) total_euks_wflp = number of euks counted with ingested FLP</p>
<p>Repeat above operation for euk cells without any FLP. Here, subset total number of observations where there was a euk cell without FLP. These need to be counted as euk cell without an FLP.</p>
<blockquote class="blockquote">
<p>Below code repeats process and compiles with other FLP/euk cell data.</p>
</blockquote>
<p>Repeat above process for euk cells without FLPs (0 FLP per euk cell needs to be included in overall average).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled <span class="ot">&lt;-</span> counts_occur <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"Discard"</span>)) <span class="sc">%&gt;%</span> <span class="co">#Discard bad counts</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(NOTES <span class="sc">==</span> <span class="st">"DTAF stain prevented counts of FLP, Euks only"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#modify str() for columns</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, EXPID, <span class="at">nano_size =</span> nanoNoFLP, <span class="at">micro_size =</span> microNoFLP) <span class="sc">%&gt;%</span> <span class="co">#select non flp</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">ends_with</span>(<span class="st">"_size"</span>), <span class="at">names_to =</span> <span class="st">"SizeFrac"</span>, <span class="at">values_to =</span> <span class="st">"num_of_euks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXP_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"IGT"</span>, Replicate) <span class="sc">~</span> <span class="st">"IGT"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Rep"</span>, Replicate) <span class="sc">~</span> <span class="st">"Bag"</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IGT_REP =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> Replicate,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Bag"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(num_of_euks &gt; 0) %&gt;% # Remove observed zero counts</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(num_of_euks),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join with FLP count information</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## SAMPLE, EXPID, EXPTYPE, IGTREP, and SizeFrac variables should match</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(counts_flp) <span class="sc">%&gt;%</span> <span class="co"># Join with the counts of FLP per euk cell</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">total_FLP =</span> <span class="dv">0</span>, <span class="at">total_euks_wflp =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co">#Replace NAs with zero</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "EXPID", "EXP_TYPE", "IGT_REP", "SizeFrac")</code></pre>
</div>
</div>
<p>Extract total eukaryote cell value by adding across nano and micro. Then combine the nano and micro cell counts.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>counts_flp_compiled_all <span class="ot">&lt;-</span> counts_flp_compiled <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exclude size fraction:</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXPID, EXP_TYPE, IGT_REP) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_euks_noFLP =</span> <span class="fu">sum</span>(total_euks_noFLP),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_FLP =</span> <span class="fu">sum</span>(total_FLP), </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_euks_wflp =</span> <span class="fu">sum</span>(total_euks_wflp),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">SizeFrac =</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> <span class="co">#Add SizeFrac column</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(counts_flp_compiled) <span class="sc">%&gt;%</span> <span class="co"># Combine back with flp compiled list</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculate-flp-per-euk-cell-calculation" class="level2">
<h2 class="anchored" data-anchor-id="calculate-flp-per-euk-cell-calculation">Calculate FLP per euk cell calculation</h2>
<p>First need to import and compile with metadata to get exact timing of experiments.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/flp-exp-metadata-compiled.txt"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>exp_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"input-data/flp_exp_metadata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Add metadata</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>counts_flp_calcs_all <span class="ot">&lt;-</span> counts_flp_compiled_all <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in metadata</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># IGTXb are replicate counts, include them as replicates!</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"REP"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT5b"</span>, REP), <span class="st">"IGT5"</span>, REP),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"IGT4b"</span>, REP), <span class="st">"IGT4"</span>, REP),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">REP =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Bag"</span>, EXP_TYPE), <span class="st">"Bag"</span>, REP)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"TimePoint"</span> <span class="ot">=</span> <span class="st">"TimePoint"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(exp_metadata, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"REP"</span> <span class="ot">=</span> <span class="st">"REP"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SAMPLE, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(EXPID, <span class="fu">c</span>(<span class="st">"TimePoint"</span>, <span class="st">"Replicate_ID"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts completely separate</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Treat repeated IGT counts as replicates (e.g., IGT4b and IGT4 == IGT4)</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Name, EXPID, TimePoint, Replicate_ID, EXP_TYPE, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># FLPperEuk is the total FLP divided by the total number of euk cells counted</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLPperEuk =</span> total_FLP<span class="sc">/</span>(<span class="fu">sum</span>(total_euks_noFLP, total_euks_wflp))) <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"Experiment"</span>, Name, REP, <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>COLS: Timepoint, Minutes = time point label, actual incubated minutes</p>
</blockquote>
<blockquote class="blockquote">
<p>COLS: Replicate_ID, REP, and IGT_REP = full replicate identified for IGTs and Bags, designation of biological replicates, and designation of technical replicates for IGT experiments</p>
</blockquote>
</section>
<section id="calculate-linear-regression-to-obtain-slope" class="level2">
<h2 class="anchored" data-anchor-id="calculate-linear-regression-to-obtain-slope">Calculate linear regression to obtain slope</h2>
<p>Use <code>lm()</code> function in R to calculate linear regression for each experiment. Slope equates to grazing rate. Function inputs the FLP per euk cell data, performs regression and then adds a column for slope and r-squared values.</p>
<p>Function to estimate slope. Uses broom and tidymodels, then extracts slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>calculate_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  regression_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keep technical replicates separate for IGTs</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac) %&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nest(-SAMPLE, -Site, -Experiment, -Name, -IGT_REP, -SizeFrac) %&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Combine technical replicates for IGTs</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(lm_fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span> </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(SAMPLE, Site, Experiment, Name, IGT_REP, SizeFrac, term, estimate) %&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reset column names</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(regression_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SAMPLE"</span>, <span class="st">"Site"</span>, </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Experiment"</span>, <span class="st">"Name"</span>, <span class="st">"REP"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"SizeFrac"</span>, <span class="st">"INTERCEPT"</span>, <span class="st">"SLOPE"</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Repeat broom model to get R2</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  out_regression <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="sc">-</span>SAMPLE, <span class="sc">-</span>Site, <span class="sc">-</span>Experiment, <span class="sc">-</span>Name, <span class="sc">-</span>REP, <span class="sc">-</span>SizeFrac) <span class="sc">%&gt;%</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(FLPperEuk <span class="sc">~</span> Minutes, <span class="at">data =</span> .)),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(lm_fit, glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced) <span class="sc">%&gt;%</span> </span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, Site, Experiment, Name, REP, SizeFrac, r.squared) <span class="sc">%&gt;%</span> </span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(regression_1) <span class="sc">%&gt;%</span> </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(df) <span class="sc">%&gt;%</span> </span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>Site, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>))</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  out_regression<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(out_regression<span class="sc">$</span>EXP_TYPE, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bag"</span>, <span class="st">"IGT"</span>))</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_regression)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Note that an error may occur when running the below function. This is due to the fact that some experiments did not have replicates.</p>
</blockquote>
<p>Apply to all data to obtain slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(counts_flp_calcs_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(x): essentially perfect fit: summary may be unreliable

Warning in summary.lm(x): essentially perfect fit: summary may be unreliable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")
Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")</code></pre>
</div>
</div>
<p><em>gut check</em> linear regression work. Use below commands out to recalculate one linear regression. Above function uses the <code>nest()</code> capability of tidyverse. Below, one experiment is subset to check the value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only plume-bag experiment from VD</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume &lt;- filter(counts_flp_calcs_all, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks")</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp_plume # View</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out &lt;- lm(FLPperEuk ~ Minutes, data = tmp_plume)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check output</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm_out)</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_out$coefficients #Intercept=intercept #Minutes = SLOPE</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Compare with nested function output</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(calcs_wslope_regression, Experiment == "Plume-Bag") %&gt;% filter(Site == "VD") %&gt;% filter(SizeFrac == "total_euks") %&gt;% head</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-linear-regression-trend" class="level3">
<h3 class="anchored" data-anchor-id="plot-linear-regression-trend">Plot linear regression trend</h3>
<p>Plot all bag experiments with estimated slope.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-width: 7</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># | fig-height: 8</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Site, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> Site)) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Data points represent the FLP per euk cells (based on total eukaryote cells counts). Y-axis represents the duration of incubation (in minutes). The dashed purple line reprents the slope and intercept of the experiment.</p>
</section>
</section>
<section id="remove-igt-tf-time-points." class="level2">
<h2 class="anchored" data-anchor-id="remove-igt-tf-time-points.">Remove IGT Tf time points.</h2>
<p>IGT experiment results appear to have bottle effect, especially in the final time point. Additionally, due to the lack of biological replicates in the IGT experiments, technical replicates are treated as biological replicates in the regression below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>IGT_lm_woTf <span class="ot">&lt;-</span> counts_flp_calcs_all <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only IGT experiments with total eukaryotes, remove Tf (T3)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">&amp;</span> <span class="sc">!</span>(TimePoint <span class="sc">==</span> <span class="st">"T3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">IGT_cor =</span> <span class="st">"rm Tf"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculate lm(), keep replicates separate</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="ot">&lt;-</span> <span class="fu">calculate_lm</span>(IGT_lm_woTf) <span class="co"># Recalculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?
All elements of `...` must be named.
Did you want `data = c(-SAMPLE, -Site, -Experiment, -Name, -REP, -SizeFrac)`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")
Joining, by = c("SAMPLE", "Site", "Experiment", "Name", "REP", "SizeFrac")</code></pre>
</div>
</div>
<p>Plot IGT grazing experiments with newly calculated grazing effect.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>igt_regression_noTf <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(SizeFrac == "total_euks") %&gt;% </span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(TYPE != "IGT") %&gt;% </span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(EXPERIMENT, SITE, Experiment, <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Minutes, <span class="at">y =</span> FLPperEuk, <span class="at">fill =</span> Site, <span class="at">shape =</span> TYPE, <span class="at">group =</span> Experiment)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> SLOPE, <span class="at">intercept =</span> INTERCEPT), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TYPE, <span class="at">fill =</span> Site)) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Minutes"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP"</span><span class="sc">~</span>eukaryote<span class="sc">^-</span><span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Grazing experiment regression"</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> EXPERIMENT) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Report r.squared</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(FLPperEuk), <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(SLOPE, <span class="dv">4</span>))), </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>results are more consistent across experiments.</p>
</blockquote>
</section>
<section id="compile-and-save-grazing-experiment-results" class="level2">
<h2 class="anchored" data-anchor-id="compile-and-save-grazing-experiment-results">Compile and save grazing experiment results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update <span class="ot">&lt;-</span> calcs_wslope_regression <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TYPE <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(igt_regression_noTf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>IGT_cor)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor for shipboard</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>SiteOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Site, <span class="at">levels =</span> site_ids, <span class="at">labels =</span> site_fullname)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>calcs_wslope_regression_update<span class="sc">$</span>NameOrder <span class="ot">&lt;-</span> <span class="fu">factor</span>(calcs_wslope_regression_update<span class="sc">$</span>Name, <span class="at">levels =</span> vent_ids, <span class="at">labels =</span> vent_fullname)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(calcs_wslope_regression_update, file = "output-data/estimated-slopes-grazingexp.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="check-flp-control-experiments" class="level1">
<h1>Check FLP control experiments</h1>
<p>All incubations had control experiments run alongside them. This was to ensure added FLP did not decrease or change in concentration over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>bac_ctrl <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/bac-counts-compiled.txt"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(bac_ctrl)</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>dtaf <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(SampleID, <span class="fu">c</span>(<span class="st">"exp"</span>, <span class="st">"Replicate"</span>, <span class="st">"TimePoint"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Site, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Name"</span>), <span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stain <span class="sc">==</span> <span class="st">"DTAF"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 17 rows [33, 34, 35,
36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49].</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(bac_ctrl)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(dtaf)</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="ot">&lt;-</span> dtaf <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TimePoint, Stain, Site, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_cellsperml =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'TimePoint', 'Stain', 'Site'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<section id="bag-grazing-experiment-controls" class="level2">
<h2 class="anchored" data-anchor-id="bag-grazing-experiment-controls">Bag grazing experiment controls</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">!=</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">!=</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="igt-experiment-controls" class="level2">
<h2 class="anchored" data-anchor-id="igt-experiment-controls">IGT experiment controls</h2>
<p>Repeat for IGT experiments.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dtaf_avg <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Site <span class="sc">==</span> <span class="st">"IGT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TimePoint, <span class="at">y =</span> Avg_cellsperml, <span class="at">fill =</span> Name, <span class="at">shape =</span> Site)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">filter</span>(dtaf_avg, TimePoint <span class="sc">==</span> <span class="st">"T0"</span>, Site <span class="sc">==</span> <span class="st">"IGT"</span>), <span class="fu">aes</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymin =</span> (Avg_cellsperml<span class="sc">-</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml)),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">ymax =</span> (Avg_cellsperml<span class="sc">+</span>(<span class="fl">0.1</span><span class="sc">*</span>Avg_cellsperml))), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">6</span>, <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Name)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> Site, <span class="at">fill =</span> Name), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c("black","#9970ab", "#5aae61")) +</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Name <span class="sc">~</span> Site) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"FLP counts for controls"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Log FLP "</span><span class="sc">~</span>mL<span class="sc">^-</span><span class="dv">1</span>), <span class="at">x =</span> <span class="st">"Time point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="generate-complete-table-with-grazing-rates-and-values" class="level1">
<h1>Generate complete table with grazing rates and values</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(calcs_wslope_regression_update)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(calcs_wslope_regression_update)</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate final table</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>table_grazerate <span class="ot">&lt;-</span> calcs_wslope_regression_update <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SizeFrac <span class="sc">==</span> <span class="st">"total_euks"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, SiteOrder, NameOrder, SLOPE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, <span class="at">Site=</span>SiteOrder, <span class="at">Name=</span>NameOrder, <span class="at">RATE =</span> SLOPE, Minutes) <span class="sc">%&gt;%</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, FLUID_ORIGIN, CRUISE_SAMPLE, EXP_TYPE, EXP_REPS, EXP_VOL, CTRL_REPS, CTRL_VOL, Site, Name, RATE) <span class="sc">%&gt;%</span> </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TimePoints =</span> <span class="fu">str_c</span>(Minutes, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    RATE <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Plume"</span> <span class="sc">~</span> <span class="st">"Plume"</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    Name <span class="sc">==</span> <span class="st">"Background"</span> <span class="sc">~</span> <span class="st">"Background"</span>,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span> <span class="sc">~</span> <span class="st">"Vent-IGT"</span>,</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    EXP_TYPE <span class="sc">==</span> <span class="st">"Bag"</span> <span class="sc">~</span> <span class="st">"Vent-Bag"</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'FLUID_ORIGIN', 'CRUISE_SAMPLE',
'EXP_TYPE', 'EXP_REPS', 'EXP_VOL', 'CTRL_REPS', 'CTRL_VOL', 'Site', 'Name'. You
can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>Amend table with estimated FLP concentration</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_grazerate)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>dtaf_igt <span class="ot">&lt;-</span> <span class="fl">5352.8278</span> <span class="co"># Manually insert FLP concentration for IGT experiments; this value is estimated from how IGT FLP spike-ins were calculated</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp <span class="ot">&lt;-</span> bac_ctrl <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FLP_t0 <span class="sc">==</span> <span class="st">"use"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">EXP_TYPE =</span> <span class="st">"Bag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, EXP_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">FLP_conc =</span> <span class="fu">mean</span>(Cells.ml)) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span> <span class="ot">=</span> <span class="st">"SAMPLE"</span>, <span class="st">"EXP_TYPE"</span> <span class="ot">=</span> <span class="st">"EXP_TYPE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FLP_conc =</span> <span class="fu">ifelse</span>(EXP_TYPE <span class="sc">==</span> <span class="st">"IGT"</span>, dtaf_igt, FLP_conc)) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>(), <span class="at">FIELD =</span> <span class="st">`</span><span class="at">Site.y</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Introduce factors in table for visualizations</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>type_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Vent-Bag"</span>, <span class="st">"Vent-IGT"</span>, <span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>TYPE <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>type, <span class="at">levels =</span> type_order)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>vent_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BSW"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"LotsOShrimp"</span>, <span class="st">"X18"</span>, <span class="st">"OMT"</span>, <span class="st">"Rav2"</span>, <span class="st">"MustardStand"</span>, <span class="st">"ShrimpHole"</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>vent_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>site_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"VD"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>site_fullname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Von Damm"</span>, <span class="st">"Piccard"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>vent_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#0868ac"</span>, <span class="st">"#41ab5d"</span>, <span class="st">"#e7298a"</span>, <span class="st">"#c994c7"</span>, <span class="st">"#fc4e2a"</span>, <span class="st">"#fed976"</span>, <span class="st">"#6a51a3"</span>, <span class="st">"#ffeda0"</span>, <span class="st">"#a1d99b"</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(vent_colors) <span class="ot">&lt;-</span> vent_fullname</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp<span class="sc">$</span>NAME <span class="ot">&lt;-</span> <span class="fu">factor</span>(table_grazerate_wflp<span class="sc">$</span>Name, <span class="at">levels =</span> vent_fullname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-flpgrazer-minute" class="level2">
<h2 class="anchored" data-anchor-id="plot-flpgrazer-minute">Plot FLP/grazer /minute</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svg("", h =, w = )</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>grazing_min_plot <span class="ot">&lt;-</span> table_grazerate_wflp <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> GRAZE_RATE, <span class="at">x =</span> NAME, <span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP_TYPE, <span class="at">fill =</span> FIELD),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Site, <span class="at">space =</span> <span class="st">"free"</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_flip() +</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>, </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text =</span><span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"FLP "</span> <span class="sc">~</span>grazer<span class="sc">^-</span><span class="dv">1</span> <span class="sc">~</span>min<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>grazing_min_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Amend table with eukaryote and prokaryote estimated biomass.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the average in situ prok cells/ml for non-background samples</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">filter</span>(insitu_proks, Name <span class="sc">!=</span> <span class="st">"BSW"</span>, Name <span class="sc">!=</span> <span class="st">"Plume"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(MEAN)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>avg_insitu <span class="ot">&lt;-</span> <span class="fu">mean</span>(tmp<span class="sc">$</span>MEAN)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># head(insitu_proks)</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to master table with data</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok <span class="ot">&lt;-</span> insitu_proks <span class="sc">%&gt;%</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Site =</span> SAMPLE, <span class="at">Prok_conc =</span> MEAN, <span class="at">Prok_sem =</span> SEM) <span class="sc">%&gt;%</span> </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp) <span class="sc">%&gt;%</span> </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Prok_conc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Prok_conc), avg_insitu, Prok_conc)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "Site"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>table_grazerate_wflp_wprok_weuk <span class="ot">&lt;-</span> plot_euk_format <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Name =</span> NameOrder, <span class="at">FIELD =</span> SiteOrder, <span class="at">euk_conc =</span> avg_conc, EXP_TYPE, <span class="at">euk_conc_sem =</span> SEM_conc) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(table_grazerate_wflp_wprok) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, <span class="at">NAME =</span> Name, <span class="at">EXP =</span> EXP_TYPE, <span class="at">SAMPLE =</span> Site, <span class="at">RATE_min =</span> GRAZE_RATE, <span class="at">FLP_ml =</span> FLP_conc, <span class="at">PROK_ml =</span> Prok_conc, <span class="at">PROK_sem =</span> Prok_sem, <span class="at">EUK_ml =</span> euk_conc, <span class="at">EUK_sem =</span> euk_conc_sem, TimePoints, EXP_REPS, EXP_VOL,  CTRL_REPS, CTRL_VOL) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("Name", "FIELD", "EXP_TYPE")</code></pre>
</div>
</div>
</section>
</section>
<section id="grazing-rate-calculations" class="level1">
<h1>Grazing rate calculations</h1>
<p>Based on Unrein et al.&nbsp;2007, we use the estimated grazing rate, in situ prok abundance, in situ euk abundance, and the concentration of FLP to make additional estimates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs <span class="ot">&lt;-</span> table_grazerate_wflp_wprok_weuk <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingestion rate per hour</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_hr =</span> (RATE_min <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE_day =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span>), <span class="co">#Compare to GR?</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># FLP concentration per L</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">FLP_L =</span> (FLP_ml <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># mL per grazer per hr</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_ml =</span> (RATE_hr<span class="sc">/</span>FLP_ml),</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>         <span class="co"># nL per grazer per hour</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">CLEARANCE_RATE_nL =</span> ((RATE_hr<span class="sc">/</span>FLP_ml)<span class="sc">/</span><span class="fl">1.00E+6</span>), </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per hr</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_GRAZE_RATE_hr =</span> (CLEARANCE_RATE_ml <span class="sc">*</span> PROK_ml), </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per grazer per day</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZE_RATE_DAY =</span> (<span class="dv">24</span> <span class="sc">*</span> SPEC_GRAZE_RATE_hr),</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>         <span class="co"># proks per ml per hr</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> EUK_ml),</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_min =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">-</span> EUK_sem)),</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_hr_max =</span> (SPEC_GRAZE_RATE_hr <span class="sc">*</span> (EUK_ml <span class="sc">+</span> EUK_sem)),</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># cells per ml per day</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">GRAZING_EFFECT_day =</span> ((SPEC_GRAZE_RATE_hr <span class="sc">*</span> <span class="dv">24</span>) <span class="sc">*</span> EUK_ml),</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Percentage per day</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> PROK_ml),</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_min =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">-</span> PROK_sem)),</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">BAC_TURNOVER_PERC_max =</span> <span class="dv">100</span><span class="sc">*</span>(GRAZING_EFFECT_day <span class="sc">/</span> (PROK_ml <span class="sc">+</span> PROK_sem))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explanation of units for table with calculated values.</p>
<ul>
<li><p>RATE_min &amp; RATE_hr = Grazing rate as ‘FLPs per grazer per minute’ and per hour</p></li>
<li><p>CLEARANCE_RATE = ml or nL per grazer per hour</p></li>
<li><p>SPEC_GRAZE_RATE (Specific grazing rate) = Prokaryotes per grazer per hour</p></li>
<li><p>GRAZING EFFECT = bacteria per ml per hour</p></li>
<li><p>Bacterial turnover rate = % per day</p></li>
</ul>
<section id="gt-table-option" class="level3">
<h3 class="anchored" data-anchor-id="gt-table-option">gt table option</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(table_wcalcs)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bkgd &lt;- c("Background", "Plume")</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gt)</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs %&gt;% </span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(loc_type = case_when(</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     NAME %in% bkgd ~ "Background",</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     TRUE ~ "Vent fluid"</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   )) %&gt;%</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   # group_by(loc_type, SITE, EXP) %&gt;% </span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-SAMPLE) %&gt;% </span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt(</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     groupname_col = c("FIELD", "EXP", "loc_type"),</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowname_col = "NAME"</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(RATE_min = html("minute&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_hr = html("hour&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              RATE_day = html("day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              EXP_REPS = html("# of incubations"),</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_ml = html("FLP ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_ml = html("Prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="co">#              PROK_sem = html("SEM prokaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_ml = html("Eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="co">#              EUK_sem = html("SEM eukaryote cells ml&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="co">#              FLP_L = html("FLP L&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_ml = html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="co">#              CLEARANCE_RATE_nL = html("nl grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="co">#              SPEC_GRAZE_RATE_hr = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZE_RATE_DAY = html("Prokaryote grazer&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_min = html("MIN"),</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_hr_max = html("MAX"),</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="co">#              GRAZING_EFFECT_day = html("Prokaryote ml&lt;sup&gt;-1&lt;/sup&gt; day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC = html("Bacteria turnover % day&lt;sup&gt;-1&lt;/sup&gt;"),</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_min = html("MIN"),</span></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="co">#              BAC_TURNOVER_PERC_max = html("MAX")) %&gt;% </span></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Turnover")),</span></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("BAC_TURNOVER")</span></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Grazing rate: prokaryote cells consumed")),</span></span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = starts_with("GRAZING_EFFECT")</span></span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("ml grazer&lt;sup&gt;-1&lt;/sup&gt; hr&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(CLEARANCE_RATE_ml, CLEARANCE_RATE_nL)</span></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = html("Specific grazing rate"),</span></span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(SPEC_GRAZE_RATE_hr, GRAZE_RATE_DAY)</span></span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("FLPs grazer&lt;sup&gt;-1&lt;/sup&gt;")),</span></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(RATE_hr, RATE_min, RATE_day),</span></span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_spanner(</span></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     label = (html("Cell counts")),</span></span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = c(PROK_ml, PROK_sem, EUK_ml, EUK_sem, FLP_L, FLP_ml),</span></span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_source_note(source_note = "NAs indicate values were unavailable.</span></span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Zero values for rates indicate no grazing pressure detected.") %&gt;% </span></span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_scientific(columns = everything()) %&gt;% </span></span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(</span></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.font.size = 12,</span></span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.border.top.color = "black",</span></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.color = "black",</span></span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_labels.border.bottom.width= px(3),</span></span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a><span class="co">#     table.width = pct(100))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="carbon-biomass" class="level2">
<h2 class="anchored" data-anchor-id="carbon-biomass">Carbon biomass</h2>
<p>References for estimating biovolume <em>Pernice, M.C., Forn, I., Gomes, A., Lara, E., Alonso-Sáez, L., Arrieta, J.M., et al.&nbsp;(2015) Global abundance of planktonic heterotrophic protists in the deep ocean. ISME J 9: 782–792.</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import manual biovolume measurements</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>biov <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/biovol-euk-12-10-2020.txt"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov)</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate volume</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="ot">&lt;-</span> biov <span class="sc">%&gt;%</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SizeFrac =</span> <span class="fu">case_when</span>(</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    h <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"micro"</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"nano"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Volume =</span> ((pi<span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> (d<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> d)) <span class="sc">%&gt;%</span> <span class="co"># Calculate volume (um cubed) # Hillebrand et al. 1999</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pgC_cell =</span> (<span class="fl">0.216</span> <span class="sc">*</span> (Volume<span class="sc">^</span><span class="fl">0.939</span>))) <span class="sc">%&gt;%</span> <span class="co"># Calculate Cell biomass in pg C per cell # Menden-Deuer and Lessard 2000</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># View(biov_calc)</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>biov_calc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   EXP VENT_BSW      h      d SizeFrac     Volume     pgC_cell
1  IGT     vent 30.077 25.764    micro 8954.44130 1110.2426245
2  IGT     vent 89.582 10.000    micro  523.59878   77.1957618
3  Bag      BSW 14.595  8.036     nano  271.71800   41.6956679
4  Bag      BSW 12.480  8.982     nano  379.41786   57.0486460
5  Bag     vent  9.218  3.120     nano   15.90239    2.9015292
6  IGT     vent 17.255  9.986     nano  521.40274   76.8917043
7  Bag     vent 41.153 21.000    micro 4849.04826  624.1445904
8  IGT     vent 10.282  4.136     nano   37.04591    6.4194942
9  IGT     vent 29.776 25.852    micro 9046.50993 1120.9583343
10 IGT     vent 10.991  4.000     nano   33.51032    5.8424695
11 Bag     vent 14.333  2.000     nano    4.18879    0.8290772
12 Bag     vent 36.164  3.000    micro   14.13717    2.5980292
13 Bag      BSW 16.206 14.924     nano 1740.42111  238.4669404
14 Bag      BSW  7.000  7.000     nano  179.59438   28.2640658
15 Bag     vent 10.069  5.000     nano   65.44985   10.9544849</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Volume is reported as um^3</p>
</blockquote>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by experiment type</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EXP) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  EXP     VOL     C
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Bag    836.  112.
2 IGT   3186.  400.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by euk size</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SizeFrac) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  SizeFrac   VOL     C
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 micro    4678. 587. 
2 nano      325.  46.9</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume by site</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>biov_calc <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VENT_BSW) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">VOL =</span> <span class="fu">mean</span>(Volume), <span class="at">C =</span> <span class="fu">mean</span>(pgC_cell))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  VENT_BSW   VOL     C
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 BSW       643.  91.4
2 vent     2188. 276. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(biov_calc)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>euk_vol <span class="ot">&lt;-</span> <span class="fu">mean</span>(biov_calc<span class="sc">$</span>Volume);euk_vol <span class="co"># in um^3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1775.759</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>euk_carbon <span class="ot">&lt;-</span> <span class="fu">mean</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon <span class="co"># in pg C per cell</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 226.9636</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>euk_carbon_min <span class="ot">&lt;-</span> <span class="fu">min</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon_min</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8290772</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>euk_carbon_max <span class="ot">&lt;-</span> <span class="fu">max</span>(biov_calc<span class="sc">$</span>pgC_cell); euk_carbon_max</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1120.958</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># euk_carbon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Avg euk biomass pg C per individual cell == <code>{r}euk_carbon</code></p>
</section>
<section id="compare-carbon-biomass-with-literature" class="level2">
<h2 class="anchored" data-anchor-id="compare-carbon-biomass-with-literature">Compare carbon biomass with literature</h2>
<p>Compare with Menden-Deuer and Lessard 2000, Table 2 - using only the heterotrophic species measured. Based on Table 2, the min volume was 4745 and the maximum was 1.2 x10^7 µm^3. Carbon content was measured at pg per cell, this was 469.48-35,339 pg per cell.</p>
<p>Import the heterotroph species volume and carbon content to compare to my measured values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hu-measured</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(biov_calc<span class="sc">$</span>Volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    4.18879 9046.50993</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(biov_calc<span class="sc">$</span>pgC_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]    0.8290772 1120.9583343</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>c_prev <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"input-data/md-lessard-2000.txt"</span>) <span class="co"># Table 2, heterotrophs only</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>carbon_compare <span class="ot">&lt;-</span> c_prev <span class="sc">%&gt;%</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"Menden-Deuer Lessard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, <span class="at">Volume =</span> vol, pgC_cell) <span class="sc">%&gt;%</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(biov_calc <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">source =</span> <span class="st">"MCR"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(source, Volume, pgC_cell)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> pgC_cell, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> source), <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compare literature to measured cell volume &amp; C content"</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">bquote</span>(<span class="st">"Volume"</span> <span class="sc">~</span>µm<span class="sc">^-</span><span class="dv">3</span>),</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"pg C"</span> <span class="sc">~</span>cell<span class="sc">^-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>carbon_compare</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_min <span class="ot">&lt;-</span> <span class="fu">min</span>(c_prev<span class="sc">$</span>pgC_cell)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>euk_carbon_lit_max <span class="ot">&lt;-</span> <span class="fu">max</span>(c_prev<span class="sc">$</span>pgC_cell)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Upon comparison, the measured carbon content was much lower from the grazing experiments. This makes sense, as I am looking at preserved specimen and a smaller total number of cells. AND the deep-sea protist cell sizes may be smaller overall.</p>
<p>Find lowest estimates or protist carbon, benthic estimates, and others? How does it compare to my measurements?</p>
<section id="carbon-biomass-for-prokaryotes" class="level3">
<h3 class="anchored" data-anchor-id="carbon-biomass-for-prokaryotes">Carbon biomass for prokaryotes</h3>
<p>Below adding in biomass estimates from prokaryotes and protists.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>bac_carbon_ug <span class="ot">&lt;-</span> (<span class="dv">86</span>)<span class="sc">*</span>(<span class="fl">1.00E-9</span>) <span class="co"># From Derived from Morono et al. 2011 </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bac_carbon_ug</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>bac_carbon_ug_2 <span class="ot">&lt;-</span> (<span class="dv">173</span>)<span class="sc">*</span>(<span class="fl">1.00E-9</span>) <span class="co"># Derived from McNichol et al. 2018; LOFERER-KRO ̈ ßBACHER, J. KLIMA &amp; R. PSENNER 1998</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># table_wcalcs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Amend all to table Incorporate calculations that include biomass of population and ug C consumed. For rate measurements, only incorporate the Morono et al.&nbsp;2011 biomass for prokaryotes. This way it is on the lower end and is comparable to Gorda Ridge work.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>bsw <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Plume"</span>, <span class="st">"Background"</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass <span class="ot">&lt;-</span> table_wcalcs <span class="sc">%&gt;%</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">euk_C_ug_Hu =</span> (euk_carbon <span class="sc">/</span> (<span class="fl">1.00E+06</span>))) <span class="sc">%&gt;%</span> <span class="co"># Convert to ug from pg</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">euk_C_ug_lit =</span> (euk_carbon_lit_mean <span class="sc">/</span> (<span class="fl">1.00E+06</span>))) <span class="sc">%&gt;%</span> <span class="co"># literature</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_C_ug =</span> bac_carbon_ug) <span class="sc">%&gt;%</span> </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bac_C_ug_2 =</span> bac_carbon_ug_2) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grazing rate in ug C per bac per day</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RATE_ugCbac_pergrazer_perday =</span> (RATE_hr <span class="sc">*</span> <span class="dv">24</span> <span class="sc">*</span> bac_C_ug), <span class="co"># Grazing rate as ug C per grazer per day</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>         <span class="co"># % of cell carbon per day</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_INGESTION_RATE =</span> (RATE_ugCbac_pergrazer_perday <span class="sc">/</span> euk_C_ug_Hu),</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPEC_INGESTION_RATE_lit =</span> (RATE_ugCbac_pergrazer_perday <span class="sc">/</span> euk_C_ug_lit),</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass =</span> PROK_ml <span class="sc">*</span> bac_carbon_ug,</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu =</span> EUK_ml <span class="sc">*</span> euk_C_ug_Hu,</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit =</span> EUK_ml <span class="sc">*</span> euk_C_ug_lit,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_L =</span> PROK_ml <span class="sc">*</span> bac_carbon_ug <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_L =</span> EUK_ml <span class="sc">*</span> euk_C_ug_Hu <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_L =</span> EUK_ml <span class="sc">*</span> euk_C_ug_lit <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Repeat with SEM values</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_sem =</span> PROK_sem <span class="sc">*</span> bac_carbon_ug,</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_sem =</span> EUK_sem <span class="sc">*</span> euk_C_ug_Hu,</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_sem =</span> EUK_sem <span class="sc">*</span> euk_C_ug_lit,</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">Prok_biomass_sem_L =</span> PROK_sem <span class="sc">*</span> (bac_carbon_ug<span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_Hu_sem_L =</span> EUK_sem <span class="sc">*</span> (euk_C_ug_Hu <span class="sc">*</span> <span class="dv">1000</span>),</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Euk_biomass_lit_sem_L =</span> EUK_sem <span class="sc">*</span> (euk_C_ug_lit <span class="sc">*</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">as.is =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">detected =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>    RATE_min <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Not detected"</span>,</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Detected"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">%in%</span> bsw <span class="sc">~</span> NAME,</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">"Vent"</span>, EXP, <span class="at">sep=</span><span class="st">"-"</span>)</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GRAZE_RATE =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>    RATE_min <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> RATE_min</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type_site =</span> <span class="fu">case_when</span>(</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>    NAME <span class="sc">%in%</span> bsw <span class="sc">~</span> NAME,</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Vent"</span></span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs_biomass)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Volume is reported as um^3</p>
</blockquote>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
</ul>
</section>
</section>
<section id="amend-table-with-bounded-carbon-estimates" class="level2">
<h2 class="anchored" data-anchor-id="amend-table-with-bounded-carbon-estimates">Amend table with ‘bounded’ carbon estimates</h2>
<p>Also make a “bounded” table that demonstrates the ug C consumed in the context of McNichol et al.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># G = number of cells grazed during experiment duration</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> table_wcalcs_biomass <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">fgC_cell =</span> <span class="dv">86</span>) <span class="sc">%&gt;%</span> <span class="co"># Add in Morono et al. 2011 value</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cells_consumed_perday = (G / 1), # Rate of cells consumed * in situ prok, per day</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fgC_ml_perday =</span> (GRAZING_EFFECT_day <span class="sc">*</span> fgC_cell), <span class="co"># Convert cell amount to fg C</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ugC_L_perday =</span> (fgC_ml_perday <span class="sc">*</span> (<span class="fl">1e-09</span>) <span class="sc">*</span> <span class="dv">1000</span>), <span class="co"># Convert to ug C per L</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_mcnichol =</span> <span class="dv">100</span><span class="sc">*</span>(ugC_L_perday <span class="sc">/</span> <span class="fl">17.3</span>),</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_mcnichol =</span> <span class="dv">100</span><span class="sc">*</span>(ugC_L_perday <span class="sc">/</span> <span class="fl">321.4</span>)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  data.frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(table_wcalcs_biomass_bounded)</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(table_wcalcs_biomass_bounded)</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_delim(table_wcalcs_biomass_bounded, file = "output-data/table-wcalc.txt", delim = "\t")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="compare-with-axial-euk-cell-count" class="level1">
<h1>Compare with Axial euk cell count</h1>
<p>From Axial Seamount cruise (July 2022) - have Anemone vent and plume euk cell counts to compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>counts_ax <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../GrazingatAxial-2022/euk-cell-counts-10122022.csv"</span>, </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">blank.lines.skip =</span> <span class="cn">FALSE</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>),</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># Import</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>counts_ax[<span class="fu">is.na</span>(counts_ax)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Change blanks to zeroes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Modify grazing code to count euk cells/ml so it considers euk cell count samples only.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># counts_cellsml_all &lt;- </span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>counts_ax <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE, <span class="at">EXP =</span> <span class="st">`</span><span class="at">EXP.ID</span><span class="st">`</span>, <span class="at">VOL =</span> <span class="st">`</span><span class="at">vol..ml.</span><span class="st">`</span>, <span class="at">MAG =</span> <span class="st">`</span><span class="at">Mag..x.</span><span class="st">`</span>, <span class="at">nano =</span> <span class="st">`</span><span class="at">X.20um..no.FLP</span><span class="st">`</span>, <span class="at">micro =</span> <span class="st">`</span><span class="at">X.20um..no.FLP.1</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE, EXP, VOL) <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoTOTAL =</span> <span class="fu">as.numeric</span>(nano), </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">microTOTAL =</span> <span class="fu">as.numeric</span>(micro),</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">euksTOTAL =</span> nanoTOTAL <span class="sc">+</span> microTOTAL) <span class="sc">%&gt;%</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalFOV =</span> <span class="fu">n</span>(), <span class="co"># Count total FOV counted</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoAvg =</span> <span class="fu">sum</span>(nanoTOTAL)<span class="sc">/</span>totalFOV, <span class="co">#Average per FOV</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoVar =</span> <span class="fu">var</span>(nanoTOTAL), <span class="co">#Variance</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">nanoSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(nanoVar))), <span class="co">#Standard deviation</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">microAvg =</span> <span class="fu">sum</span>(microTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for microeuks</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">microVar =</span> <span class="fu">var</span>(microTOTAL), </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">microSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(microVar))), </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksAvg =</span> <span class="fu">sum</span>(euksTOTAL)<span class="sc">/</span>totalFOV, <span class="do">## Repeat for total cell count</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksVar =</span> <span class="fu">var</span>(euksTOTAL), </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">euksSd =</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sqrt</span>(euksVar)))) <span class="sc">%&gt;%</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cells/ml based on magnification (at x100, 0.01 is vol of grid), volume filtered (VOL), dilution factor (0.9), and area of counting grid (for Huber lab filter rig, it is 283.385):</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nanoCONC =</span> ((nanoAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">microCONC =</span> ((microAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>)),</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">eukCONC =</span> ((euksAvg <span class="sc">*</span> <span class="fl">283.385</span>)<span class="sc">/</span>(VOL <span class="sc">*</span> <span class="fl">0.0256</span> <span class="sc">*</span> <span class="fl">0.9</span>))</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SAMPLE', 'EXP'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 16
# Groups:   SAMPLE, EXP [5]
  SAMPLE      EXP     VOL total…¹ nanoAvg nanoVar nanoSd micro…² micro…³ microSd
  &lt;chr&gt;       &lt;chr&gt; &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Anemone     euk …   200      30     1.3   1.32    2.30  0.1     0.0931   0.610
2 Anemone     eukc…   200      30     0.9   0.921   1.92  0.0333  0.0333   0.365
3 ASHES Plume count   200      30     0.4   0.455   1.35  0.133   0.120    0.691
4 Internatio… euk …   200      20     0.4   0.463   1.36  0       0        0    
5 Internatio… euk …   200      20     0.4   0.253   1.01  0       0        0    
# … with 6 more variables: euksAvg &lt;dbl&gt;, euksVar &lt;dbl&gt;, euksSd &lt;dbl&gt;,
#   nanoCONC &lt;dbl&gt;, microCONC &lt;dbl&gt;, eukCONC &lt;dbl&gt;, and abbreviated variable
#   names ¹​totalFOV, ²​microAvg, ³​microVar</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # left_join(expmeta) %&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(SAMPLE, c("Site", "Name"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate(EXPID, c("TimePoint", "Replicate"), sep = "-", remove = FALSE) %&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data.frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Thoughts on cell counts. Combining nano and micro for now, as the de-pressurization can cause issues in size. Likely underestimates for these counts.</p>
<p>This is further supported because the biovolumes of all cells were pretty low.</p>
</section>
<section id="environmental-parameters---mcr" class="level1">
<h1>Environmental parameters - MCR</h1>
<p>Import from Hu et al.&nbsp;(<em>Molecular Ecology</em>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>env_tmp <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"../../microeuks_deepbiosphere_datamine/microeuk-amplicon-survey/data-input/samplelist-metadata.txt"</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(env_tmp)</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>mcr_metadata <span class="ot">&lt;-</span> env_tmp <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SITE <span class="sc">==</span> <span class="st">"VonDamm"</span> <span class="sc">|</span> SITE  <span class="sc">==</span> <span class="st">"Piccard"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FIELD =</span>  <span class="fu">case_when</span>(</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"VonDamm"</span>  <span class="sc">~</span> <span class="st">"Von Damm"</span>,</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    SITE <span class="sc">==</span> <span class="st">"Piccard"</span> <span class="sc">~</span> <span class="st">"Piccard"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLETYPE <span class="sc">!=</span> <span class="st">"Incubation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sample_or_Control, <span class="sc">-</span>SAMPLEID, <span class="sc">-</span>ref_num, <span class="sc">-</span>SITE, <span class="at">SEQ_SAMPLE =</span> SAMPLE, <span class="fu">everything</span>())</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View(mcr_metadata)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generate supplementary table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>supp_table_env_mcr <span class="ot">&lt;-</span> mcr_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, VENT, SAMPLETYPE, DEPTH, <span class="at">TEMP =</span> temp, <span class="at">PH =</span> pH, <span class="at">PERCSEA =</span> percseawater, <span class="at">MG =</span> mg, <span class="at">H2 =</span> h2, <span class="at">H2S =</span> h2s, <span class="at">CH4 =</span> ch4, <span class="at">MICROBIAL =</span> ProkConc)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save supplementary metadata table:</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(supp_table_env_mcr, file = "output-data/supp_table_MCR_metadata.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis-of-grazing-rate-results" class="level1">
<h1>Analysis of grazing rate results</h1>
<p>Re-import table from output table with all grazing values</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>table_wcalcs_biomass_bounded <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"output-data/table-wcalc.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Format and factor values to plot, and prioritize these values:</p>
<ul>
<li>Grazing rate column == FLP per minute consumed</li>
<li>Grazing effect hr == cells per ml per hr</li>
<li>Specific ingestion rate == % of cell carbon per day, estimated with literature and measured carbon values</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(table_wcalcs_biomass_bounded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     FIELD         NAME EXP   SAMPLE    RATE_min    FLP_ml   PROK_ml PROK_sem
1 Von Damm   Background Bag   VD-BSW 0.002958889  4861.824  37889.62 8608.427
2 Von Damm        Plume Bag VD-Plume 0.005274231 34242.354  16478.31 2623.935
3 Von Damm         X-18 Bag   VD-X18 0.001744429  3148.722 111429.78 2973.793
4 Von Damm Old Man Tree IGT   VD-OMT 0.014510943  5352.828  71147.40       NA
5 Von Damm   Ravelin #2 Bag  VD-Rav2 0.003470217 51890.942  71147.40       NA
6 Von Damm   Ravelin #2 IGT  VD-Rav2 0.015395240  5352.828  71147.40       NA
     EUK_ml   EUK_sem        TimePoints EXP_REPS EXP_VOL CTRL_REPS CTRL_VOL
1  91.83773  21.86613 0, 10, 15, 20, 40        3    2.00         2      0.5
2 157.77468  67.09859 0, 10, 15, 25, 57        3    2.00         2      1.0
3 314.87222 104.95741     0, 15, 20, 40        2    1.50         2      0.5
4 472.30833 122.45031          0, 7, 25        1    0.15        NA       NA
5 409.33389  73.47019 0, 10, 15, 21, 40        3    1.50         2      0.5
6 620.99799 123.17702         0, 12, 20        1    0.15        NA       NA
    RATE_hr  RATE_day    FLP_L CLEARANCE_RATE_ml CLEARANCE_RATE_nL
1 0.1775333  4.260800  4861824      3.651579e-05      3.651579e-11
2 0.3164538  7.594892 34242354      9.241591e-06      9.241591e-12
3 0.1046657  2.511977  3148722      3.324070e-05      3.324070e-11
4 0.8706566 20.895758  5352828      1.626536e-04      1.626536e-10
5 0.2082130  4.997113 51890942      4.012512e-06      4.012512e-12
6 0.9237144 22.169145  5352828      1.725657e-04      1.725657e-10
  SPEC_GRAZE_RATE_hr GRAZE_RATE_DAY GRAZING_EFFECT_hr GRAZING_EFFECT_hr_min
1          1.3835695      33.205668         127.06388              96.81058
2          0.1522858       3.654860          24.02685              13.80868
3          3.7040034      88.896081        1166.28778             777.52519
4         11.5723785     277.737084        5465.73080            4048.68948
5          0.2854798       6.851515         116.85656              95.88230
6         12.2775993     294.662382        7624.36451            6112.04639
  GRAZING_EFFECT_hr_max GRAZING_EFFECT_day BAC_TURNOVER_PERC
1             157.31719          3049.5332          8.048465
2              34.24501           576.6444          3.499414
3            1555.05037         27990.9067         25.119772
4            6882.77212        131177.5392        184.374334
5             137.83081          2804.5574          3.941897
6            9136.68264        182984.7483        257.191065
  BAC_TURNOVER_PERC_min BAC_TURNOVER_PERC_max  euk_C_ug_Hu euk_C_ug_lit
1             10.414647              6.558411 0.0002269636   0.01147298
2              4.162182              3.018725 0.0002269636   0.01147298
3             25.808540             24.466811 0.0002269636   0.01147298
4                    NA                    NA 0.0002269636   0.01147298
5                    NA                    NA 0.0002269636   0.01147298
6                    NA                    NA 0.0002269636   0.01147298
  bac_C_ug bac_C_ug_2 RATE_ugCbac_pergrazer_perday SPEC_INGESTION_RATE
1  8.6e-08   1.73e-07                 3.664288e-07         0.001614483
2  8.6e-08   1.73e-07                 6.531607e-07         0.002877822
3  8.6e-08   1.73e-07                 2.160300e-07         0.000951827
4  8.6e-08   1.73e-07                 1.797035e-06         0.007917726
5  8.6e-08   1.73e-07                 4.297517e-07         0.001893483
6  8.6e-08   1.73e-07                 1.906547e-06         0.008400232
  SPEC_INGESTION_RATE_lit Prok_biomass Euk_biomass_Hu Euk_biomass_lit
1            3.193840e-05  0.003258508     0.02084382        1.053653
2            5.693033e-05  0.001417135     0.03580910        1.810146
3            1.882946e-05  0.009582961     0.07146452        3.612524
4            1.566319e-04  0.006118676     0.10719678        5.418786
5            3.745771e-05  0.006118676     0.09290388        4.696281
6            1.661770e-04  0.006118676     0.14094392        7.124700
  Prok_biomass_L Euk_biomass_Hu_L Euk_biomass_lit_L Prok_biomass_sem
1       3.258508         20.84382          1053.653     0.0007403247
2       1.417135         35.80910          1810.146     0.0002256584
3       9.582961         71.46452          3612.524     0.0002557462
4       6.118676        107.19678          5418.786               NA
5       6.118676         92.90388          4696.281               NA
6       6.118676        140.94392          7124.700               NA
  Euk_biomass_Hu_sem Euk_biomass_lit_sem Prok_biomass_sem_L
1        0.004962814           0.2508697          0.7403247
2        0.015228935           0.7698210          0.2256584
3        0.023821507           1.2041746          0.2557462
4        0.027791758           1.4048704                 NA
5        0.016675055           0.8429222                 NA
6        0.027956696           1.4132080                 NA
  Euk_biomass_Hu_sem_L Euk_biomass_lit_sem_L detected       type  GRAZE_RATE
1             4.962814              250.8697 Detected Background 0.002958889
2            15.228935              769.8210 Detected      Plume 0.005274231
3            23.821507             1204.1746 Detected   Vent-Bag 0.001744429
4            27.791758             1404.8704 Detected   Vent-IGT 0.014510943
5            16.675055              842.9222 Detected   Vent-Bag 0.003470217
6            27.956696             1413.2080 Detected   Vent-IGT 0.015395240
   type_site fgC_cell fgC_ml_perday ugC_L_perday lower_mcnichol upper_mcnichol
1 Background       86     262259.86   0.26225986      1.5159529     0.08159921
2      Plume       86      49591.42   0.04959142      0.2866556     0.01542981
3       Vent       86    2407217.98   2.40721798     13.9145548     0.74897884
4       Vent       86   11281268.37  11.28126837     65.2096438     3.51003994
5       Vent       86     241191.93   0.24119193      1.3941730     0.07504416
6       Vent       86   15736688.36  15.73668836     90.9635165     4.89629383</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot <span class="ot">&lt;-</span> table_wcalcs_biomass_bounded <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FIELD, NAME, EXP, SAMPLE, type, </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>        PROK_ml, EUK_ml, PROK_sem, EUK_sem,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_L, Euk_biomass_Hu_L, Euk_biomass_lit_L,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>        Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>        GRAZING_EFFECT_hr, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max, BAC_TURNOVER_PERC, BAC_TURNOVER_PERC_min, BAC_TURNOVER_PERC_max,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>        GRAZE_RATE, RATE_ugCbac_pergrazer_perday,</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>        SPEC_INGESTION_RATE, SPEC_INGESTION_RATE_lit) <span class="sc">%&gt;%</span> </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_ml, EUK_ml,</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>                        Prok_biomass_L, Euk_biomass_Hu_L, Euk_biomass_lit_L,</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                        GRAZING_EFFECT_hr, BAC_TURNOVER_PERC,</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>                        GRAZE_RATE, RATE_ugCbac_pergrazer_perday,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                        SPEC_INGESTION_RATE, SPEC_INGESTION_RATE_lit),</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(PROK_sem, EUK_sem, Prok_biomass_sem_L, Euk_biomass_Hu_sem_L, Euk_biomass_lit_sem_L,</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>                        BAC_TURNOVER_PERC_max, BAC_TURNOVER_PERC_min, GRAZING_EFFECT_hr_max, GRAZING_EFFECT_hr_min, GRAZING_EFFECT_hr_max),</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"SEM_variable"</span>, <span class="at">values_to =</span> <span class="st">"SEM"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  data.frame</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>NAME_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>NAME, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Background"</span>,<span class="st">"Plume"</span>, <span class="st">"Quakeplume"</span>, <span class="st">"Shrimpocalypse"</span>, <span class="st">"Lots 'O Shrimp"</span>, <span class="st">"X-18"</span>, <span class="st">"Old Man Tree"</span>, <span class="st">"Ravelin #2"</span>, <span class="st">"Mustard Stand"</span>, <span class="st">"Shrimp Hole"</span>, <span class="st">"Hot Chimlet #1"</span>, <span class="st">"Shrimp Gulley"</span>, <span class="st">"South of Hot Chimlet"</span>, <span class="st">"South of LungSnack"</span>, <span class="st">"Arrow Loop"</span>, <span class="st">"Bartizan"</span>, <span class="st">"Ravelin #1"</span>))</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>biomass_rate_plot<span class="sc">$</span>VARIABLE_ORDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(biomass_rate_plot<span class="sc">$</span>Variable, </span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PROK_ml"</span>, <span class="st">"EUK_ml"</span>,</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prok_biomass_L"</span>, <span class="st">"Euk_biomass_Hu_L"</span>, <span class="st">"Euk_biomass_lit_L"</span>,</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZING_EFFECT_hr"</span>, <span class="st">"BAC_TURNOVER_PERC"</span>,</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"GRAZE_RATE"</span>, <span class="st">"RATE_ugCbac_pergrazer_perday"</span>,</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"SPEC_INGESTION_RATE"</span>, <span class="st">"SPEC_INGESTION_RATE_lit"</span>),</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Prokaryote~cells~mL^{-1}"</span>, <span class="st">"Eukaryote~cells~mL^{-1}"</span>,</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Prokaryote~µg~C~L^{-1}"</span>, <span class="st">"Measured~eukaryote~µg~C~L^{-1}"</span>, <span class="st">"Literature-based~eukaryote~µg~C~L^{-1}"</span>,</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cells~mL^{-1}~hr^{-1}"</span>, <span class="st">"Prokaryote~turnover~'%'~d^{-1}"</span>,</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"FLP~consumed~min^{-1}"</span>, <span class="st">"µg~C~grazer^{-1}~day^{-1}"</span>,</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>                                                      <span class="st">"Cell~carbon~%~day^{-1}"</span>, <span class="st">"Cell~carbon~%~day^{-1}~(lit)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="function-to-plot-grazing-results" class="level2">
<h2 class="anchored" data-anchor-id="function-to-plot-grazing-results">Function to plot grazing results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>conc_rate_plot_mcr <span class="ot">&lt;-</span> <span class="cf">function</span>(df, var, sem){</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Variable <span class="sc">==</span> var) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(SEM_variable <span class="sc">==</span> sem) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> NAME_ORDER, <span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD)) <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Value <span class="sc">+</span> SEM), <span class="at">ymin =</span> (Value <span class="sc">-</span> SEM)), </span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">shape =</span> EXP, <span class="at">fill =</span> FIELD),</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>)) <span class="sc">+</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#de2d26"</span>, <span class="st">"#1c9099"</span>)) <span class="sc">+</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(VARIABLE_ORDER <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>), <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, </span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>), </span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(),</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span>))),</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="st">"black"</span>))) <span class="sc">+</span></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "PROK_ml", "PROK_sem")</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "EUK_ml", "EUK_sem")</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "Prok_biomass_L", "Prok_biomass_sem_L")</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conc_rate_plot_mcr</span>(biomass_rate_plot, <span class="st">"Euk_biomass_Hu_L"</span>, <span class="st">"Euk_biomass_Hu_sem_L"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="grazing_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># conc_rate_plot_mcr(biomass_rate_plot, "GRAZING_EFFECT_hr")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>